2007-06-04  Rob Savoye  <rob@bertha.welcomehome.org>

	* NEWS, README: Update for upcoming release.
	* macros/kde.m4: Use newlist so we don't stomp on libslist.
	* server/asobj/Makefile.am: Don't link ffmpeg to convienince lib. 
	* server/parser/Makefile.am: We don't need ffmpeg or gstreamer
	headers for this directory.

2007-06-04 Sandro Santilli <strk@keybit.net>

	* backend/render_handler.h: expose a new getBitsPerPixel interface.
	* backend/render_handler_agg.{cpp,h}: implement getBitsPerPixel,
	  const-correct the existing getBytesPerPixel.
	* testsuite/MovieTester.cpp (checkPixel): never use a tolerance
	  inferior to the minimum tolerance for a renderer, with min tolerance
	  being a function of BPP (formula suggested by UdoG).
	  Fixes bug #20035.

2007-06-04 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamFfmpeg.cpp (av_streamer): sleep for 1
	  microsecond between iterations, to allow other threads to run.
	  Fixes the 100% CPU problem (thanks to UdoG for support).

2007-06-04 Sandro Santilli <strk@keybit.net>

	* libbase/FLVParser.h: updated dox for nextAudioFrame() and
	  nextVideoFrame() noting the non-blocking nature of the calls;
	  add a parsingCompleted() method.
	* server/asobj/NetStreamFfmpeg.h: update documentation of
	  decodeFLVFrame()

2007-06-04 Sandro Santilli <strk@keybit.net>

	* libbase/FLVParser.{cpp,h}: put FLVParser in the gnash namespace.

2007-06-04 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamFfmpeg.{cpp,h}: Drop the decoder mutex and
	  conditional variable. Decoder should never stop till the end of
	  the stream is fully decoder. Rename {pause,unpause}Decoding to
	  {pause,unpause}Playback, which is matches reality more, and is
	  also more correct.

2007-06-04 Sandro Santilli <strk@keybit.net>

	* server/timers.cpp (expired): allow now == _start.
	  Hopefully fixes bug #20047.

2007-06-02 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStream.cpp (::bufferLength): return milliseconds,
	  as (correctly) documented.

2007-06-02 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/render_handler_ogl.cpp,libbase/log.cpp, macros/opengl.m4,
	  server/asobj/Date.cpp: Fixes for builing on win32/MSYS/mingw.
	  Linking is still broken.

2007-06-02 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (CommonGetUrl): log about _level#
	  target for GetUrl being unsupported.

2007-06-02 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/NetConnection.{cpp,h}: Permit openConnection 
	to be called more than once with the same URL.
	* server/asobj/NetStreamFfmpeg.cpp: Call detach_aux_streamer
	with a valid owner argument, so something will actually
	happen. Make sure that the NetConnection position is 0
	just in case openConnection was called before. Fix a deadlock
	by avoiding calls to the sound handler in startPlayback().
	This is cheating, but fixes bug #20036.

2007-06-01 Bastiaan Jacques <bastiaan@bjacques.org>

	* macros/ffmpeg.m4: Avoid using libswscale with broken ffmpeg
	versions.
	* configure.ac: Revert unintentional change.

2007-06-01 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamGst.cpp: protect all log_debug calls
	  with a GNASH_DEBUG macro.

2007-06-01 Sandro Santilli <strk@keybit.net>

	* libbase/rc.{cpp,h}: Add a "StartStopped" variable, to
	  have the gui start in "stop" mode.
	* doc/C/gnashrc.xml: document the new "StartStopped" variable.
	* gui/Player.cpp (init_gui): set the Gui to "stop" if requested
	  by the user (trough gnashrc)
	* testsuite/libbase/: TCXXRc.cpp, gnashrc.in: test "StartStopped"
	  variable.

2007-06-01 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStream.{cpp,h}: split processStatusNotifications
	  so that onStatus handler call is performed while the statusMutex
	  is NOT locked, to prevent attempts to lock the mutex again while
	  reacting to status handlers. statusQueue type changed from vector
	  to deque, for faster pop_front.

2007-06-01 Sandro Santilli <strk@keybit.net>

	* gui/Player.cpp (run): remove sound_handler cleanup, will
	  be done by gnash::clear().
	* gui/: gtk.cpp, gtksup.h: implement gui::quit()
	* server/impl.cpp (clear): report the problem with cleaning
	  up resources before all threads are completed, exit() rather
	  then cleanup and document the reason for doing so.
	* utilities/processor.cpp (main): call gnash::clear() again, that's
	  where proper threads cleanup is supposed to be implemented.

2007-06-01 Sandro Santilli <strk@keybit.net>

	* server/vm/ActionExec.cpp (call operator): if pc == oldPc that's
	  still to be considered a branch-back, so count it; Increment
	  branch-back limit to 2^16 (65535).
	* gui/Player.cpp: print a debugging message when the main gui loop
	  returns so we know if we exited cleanly or due to a call to exit().
	* gui/gui.cpp{cpp,h}: add a quit() virtual method, for returning
	  from the main rendering loop. This is aimed at removing the exit()
	  call, altought currently we'll still call it as the default
	  implementation.

2007-05-31 Bastiaan Jacques <bastiaan@bjacques.org>

	* macros/ffmpeg.m4: Define HAVE_SWSCALE_H if swscale.h is present.
	* libbase/embedVideoDecoderFfmpeg.cpp: If swscale.h is available,
	use swscale and friends. Otherwise, default to img_convert. Also,
	conditionally include swscale.h itself.
	* server/asobj/NetStreamFfmpeg.cpp: Remove unused include.

2007-05-31 Sandro Santilli <strk@keybit.net>

	* backend/sound_handler.h: document attach_aux_streamer and
	  detach_aux_streamer; add TODO items.
	* backend/sound_handler_sdl.cpp (sdl_audio_callback): documentation,
	  TODO items, early return if buffer len passed by SDL == 0.

2007-05-31 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStream*.{h,cpp}: Always use milliseconds internally.

2007-05-31  Rob Savoye  <rob@ute.welcomehome.org>

	* configure.ac: Change renderer default to opengl.

2007-05-31 Sandro Santilli <strk@keybit.net>

	* server/asobj/: NetStream.cpp, NetStreamFfmpeg.cpp:
	  More debugging lines protection.

2007-05-31 Sandro Santilli <strk@keybit.net>

	* libbase/FLVParser.cpp: protect seek debugging by
	  a GNASH_DEBUG_SEEK macro
	* server/asobj/NetStreamFfmpeg.cpp: dont debug condition
	  variable signaling if GNASH_DEBUG_THREADS is undefined.

2007-05-31 Sandro Santilli <strk@keybit.net>

	* libbase/log.{cpp,h}: lock the io Mutex on closeLog, to
	  prevent race conditions between a thread using log()
	  and one using closeLog().

2007-05-31 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/FLVParser.cpp: (FLVFrame* FLVParser::nextMediaFrame)
	  Fixed a bug causing nextMediaFrame to return NULL.

2007-05-31 Martin Guy <martinwguy@yahoo.it>

        * libbase/embedVideoDecoderFfmpeg.cpp,
          server/asobj/NetStreamFfmpeg.cpp:
          Add comments by commented img_convert()s to use sws_scale() when
          implementing.
	* Change default renderer to agg for 0.8.0 release
	* Revert default renderer back to OpenGL.

2007-05-31 Sandro Santilli <strk@keybit.net>

	* libbase/embedVideoDecoderFfmpeg.{cpp,h}:
	  Make convertRGB24 a public static function.
	* server/asobj/NetStreamFfmpeg.cpp: use
	  embedVideoDecoderFfmpeg::convertRGB24, dropping the
	  duplicated implementation.

2007-05-31 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/NetStreamFfmpeg.cpp, 
	libbase/embedVideoDecoderFfmpeg.cpp: Use libswscale instead of
	img_convert for YUV->RGB conversion, because it is deprecated and
	has been removed from recent ffmpeg.

2007-05-30 Sandro Santilli <strk@keybit.net>

	* configure.ac: add missing quote in martin's commit (no ChangeLog
	  entry for it, btw)
	* server/asobj/README.NetStream: add design notes for NetStream.

2007-05-30 Sandro Santilli <strk@keybit.net>

	* server/video_stream_instance.cpp (display): update call to
	  get_video.
	* server/asobj/NetStream.{cpp,h}: change get_video to return by
	  auto_ptr to encode ownership transfer.
	* server/asobj/NetStreamFfmpeg.h: update refreshVieoFrame() dox.

2007-05-30 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStream.cpp: fix NetStream.bufferTime getter to
	  return value in seconds, not milliseconds.

2007-05-30 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamFfmpeg.cpp: Fixed seeking to work when not
	  seeking to 0.
	* server/asobj/SoundFfmpeg.cpp: Silence a compiler warning.

2007-05-30 Sandro Santilli <strk@keybit.net>

	* libbase/FLVParser.h: document timestamp units for media frames
	  and isTimeLoaded().
	* server/asobj/NetStreamFfmpeg.{cpp,h}: document units for time
	  members; (advance): fix isTimeLoaded() call, thanks Martin Guy
	  for noticing.

2007-05-30 Sandro Santilli <strk@keybit.net>

	* libbase/FLVParser.{cpp,h}: drop setLoadThread method, require
	  a LoadThread to be passed on construction.
	* server/asobj/NetConnection.{cpp,h}: drop connectParser, substitute
	  with getConnectedParser().
	* server/asobj/: NetStreamFfmpeg.cpp, NetStreamGst.cpp: use
	  NetConnection::getConnectedParser() for initializing an FLV parser.

2007-05-30 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetConnection.h: add documentation about which calls
	  are blocking and which not.
	* server/asobj/NetConnection.cpp (openConnection): return false if
	  already connected

2007-05-29 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/NetStreamFfmpeg.cpp: Two casts to quiet compiler warnings
	* configure.ac: Add rpm/deb help for AGG
	* configure.ac: Warn if libcurl is missing

2007-05-30 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamFfmpeg.cpp (decodeFLVFrame): Don't modify m_bufferTime
	  internally: should only be done on user request. (advance):
	  bufferFull condition is when parser loaded current+buffer time.
	  (av_streamer): add bufferTime/Length info in Decoding iteration
	  message - this shows that the playback is NOT waiting for bufferTime
	  to be reached before starting again (bug).

2007-05-30 Sandro Santilli <strk@keybit.net>

	* libbase/FLVParser.{h,cpp}: document which methods lock and which
	  not, add locking in getBufferLength().
	* server/asobj/NetStream.{h,cpp}: fix documentation for bufferLength
	  method (return milliseconds, not seconds); have
	  NetStream.bufferLength return in fractional seconds, as expected;
	  Change bufferTime to take milliseconds, convert from seconds
	  in the AS method (so we can accept fractional seconds..);
	  make locking debugging messages a compile-time option.

2007-05-30 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/LoadThread.cpp: Close the download thread even if
	  download wasen't completed.

2007-05-29 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/LoadThread.cpp: Don't lock the mutex and try to join the 
	  download thread when calling complete(), instead do that in the
	  destrutor. Fixes some blocking (with the no-decode-thread-patch
	  for NetStreamFfmpeg).

2007-05-29 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamFfmpeg.{cpp,h}: don't lock
	  the mutex in seek() even, also intended to be called by
	  the VM..

2007-05-29 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamFfmpeg.{cpp,h}: Don't lock the mutex
	  in pause(), play() and close(), all intended to be called
	  by the locking advance(). More dox about locking in the header.
	* testsuite/actionscript.all/rtmp.as: remove any
	  trace of "rtmp" from the code to show that bug #19886
	  is unrelated to RTMP.

2007-05-29 Sandro Santilli <strk@keybit.net>

	* backend/sound_handler.h: add numSoundsStarted() and
	  numSoundsStopped() methods to be used in testing, and
	  associated protected counts.
	* backend/: sound_handler_gst.cpp, sound_handler_sdl.cpp:
	  Increment started/stopped sound counters.
	* testsuite/FuzzyPixel.h: remove unused header.
	* testsuite/: Makefile.am, sound_handler_test.{cpp,h}:
	  drop sound_handler_test, testing will now be done against
	  the built sound_handler.
	* testsuite/MovieTester.{cpp,h}: initialize the currently
	  configured sound handler and use that for testing.

2007-05-29 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamFfmpeg.{cpp,h}: drop
	  the decode_wait_mutex, use decoding_mutex instead.
	  Document which function lock it and which not, adding
	  more locking. Seems to fix bug #19978, but exposes
	  a deadlock playing youtube with a full-offline setup
	  with reduced bandwidth.

2007-05-29 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: testing for gray
	  is funny, but better let's be accurate ;) 
			
2007-05-29 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: reintruduce
	  the pixel-accurate test after Udo fix for #19828.

2007-05-29 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: Fix coordinate translation and  
	  pixel hinting. Fixes bug #19828.

2007-05-29 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all: Makefile.am, key_event_test3.c, 
	  key_event_test3runner.cpp: new testcase for key listeners.

	
2007-05-29 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/key_event_test2runner.cpp: remove obsolete comments
	  
2007-05-29 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/key_event_test2.c, 
	  key_event_test2runner.cpp: add more tests.
	* server/movie_root.cpp: add comments for ::cleanup_key_listeners().
	  
2007-05-29 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/NetStreamFfmpeg.cpp: Fix sign/unsign compiler warning
	* packaging/debian/control: Add missing build dependency for opengl-gtk

2007-05-28 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStream*.{cpp,h}: Updated a comment and made play()
	  return void to be closer to defined behavoir.

2007-05-28 Sandro Santilli <strk@keybit.net>

	* server/asobj/: NetStream.{cpp,h},
	  NetStreamFfmpeg.cpp, NetStreamGst.cpp:
	  Encode FLVParser ownership by using an auto_ptr;
	  cleanup startPlayback method in FFMPEG implementation
	  removing the "this" alias.

2007-05-28 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStream.h: drop playing() method (unclear
	  and unnecessary).
	* server/video_stream_instance.cpp (display): stop
	  calling NetStream::playing().

2007-05-28 Ann Barcomb <kudra@domaintje.com>

	* many files: Add a paragraph break before the line 'You should
	  have received...' in the copyright notice.
	* devtools/testsuite/copyright_notices.t: Minor code improvement
	* many files: Add current year to all copyright notices which were
	  lacking it.

2007-05-28 Sandro Santilli <strk@keybit.net>

	* server/video_stream_instance.{cpp,h}: add brief class description,
	  drop unused member.
	* testsuite/misc-ming.all/matrix_test.c: Really round numbers, don't
	  just truncate them up to 2nd decimal position.

2007-05-28 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all: Makefile.am, key_event_test2.c, 
	  key_event_test2runner.cpp: add tests for key listeners.
	* server/sprite_instance.cpp: call "unload" for characters removed
	  in ::resetDisplayList, partly fix the increasing key listeners
	  problem when loop back.
	
2007-05-28 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/matrix_test.c: round numbers
	  to 1/100 to reduce floating number based errors.

2007-05-27 Ann Barcomb <kudra@domaintje.com>

	* devtools/testsuite/copyright_notices.t: Added a script to look
	  for incorrect copyright notices.

2007-05-27  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/archflag.m4: Drop --with-gcc-arch, and use --with-cpu,
	which is more standard.
	* configure.ac: Add a --with-top-level option to specify where
	development packages are when cross configuring. Add --with-cpu to
	set the compiler flags correctly when cross compiling for similar
	architectures, like pentium->geode, which are supported by the
	same compiler.

2007-05-27 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/{FLVParser.h, LoadThread.h, embedVideoDecoderFfmpeg.h,
	extension.h, tu_timer.h} server/{debugger.h, movie_root.h},
	server/sprite_instance.h, server/vm/VM.h: Mark symbols which are
	used across DSOs as DSOEXPORT. This allows compilation with
	-fvisibility=hidden.
	* macros/kde.m4: When detecting QT, also allow for the check for
	the possibility that the QTDIR environment variable points to
	the base QT directory, no strings attached (and no version
	numbers required).

2007-05-27 Ann Barcomb <kudra@domaintje.com>

	* doc/C/usermanual/installation/documentation_dependencies.xml:
	  Corrected information about FOP requirement.
	* doc/C/usermanual/installation/install.xml: Placeholder file.
	* doc/C/usermanual/installation.xml,
	  doc/C/usermanual/installation/building.xml: Started a section on
	  building Gnash.

2007-05-26 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamGst.cpp: Don't allow play url to be changed,
	  might not be correct behavoir... Fix some issues when closing 
	  NetStream before playback has been set up.

2007-05-26 Ann Barcomb <kudra@domaintje.com>

	* doc/C/gnashrc.xml: Corrected spelling
	* doc/C/usermanual/usage/gnashrc.xml: Propogated changes from
	  ../../gnashrc.xml r1.3357 to the new gnashrc file.
	* doc/C/usermanual/installation/cross_compiling.xml: Made the
	  cross compilation information more generic.

2007-05-26 Jurka <jurka@ejurka.com>

	* gui/gnash.cpp, libbase/FLVParser.cpp: Clear up printf-related
	warnings.

2007-05-26 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/FLVParser.cpp: When seeking the frame after the correct
	  one was returned.
	* server/asobj/NetConnection.cpp: Don't allow url prefix to be changed,
	  might not be correct behavoir...
	* server/asobj/NetStreamFfmpeg.cpp: Don't allow play url to be changed,
	  might not be correct behavoir... Fix some issues when closing 
	  NetStream before playback has been set up.

2007-05-26 Bastiaan Jacques <bastiaan@bjacques.org>

	* plugin/plugin.cpp: Initialise _width and _height to safe defaults,
	in case SetWindow is never called (for "hidden" flash movies).
	* gui/gnash.cpp: If the plugin attempts to create a 0x0 pixels window
	don't try to create a rendering GUI.
	* macros/kde.m4: Check if we actually need the kde subdirectory of the
	KDE prefix we got from kde-config.

2007-05-26 Ann Barcomb <kudra@domaintje.com>

	* doc/C/usermanual/installation/cross_compiling.xml,
	doc/C/usermanual/installation.xml: Added section on cross compiling
	* doc/C/usermanual/installation/configuration.xml: Resolved a TODO
	* doc/C/usermanual/installation/code_dependencies.xml: Marked a TODO
	* doc/C/usermanual/installation/sources.xml: RAM requirements
	* doc/C/usermanual/installation/sources.xml: Disk space requirements
	* doc/C/usermanual/installation/configuration/feature_configuration.xml,
	custompath_configuration.xml: Formatting
	* doc/C/usermanual/installation/configuration/sources.xml:
	  Include development snapshots as a download option

2007-05-25 Sandro Santilli <strk@keybit.net>

	* extensions/gnashrc: new file, with required variables
	  for running extensions tests.
	* extensions/fileio/Makefile.am: Provide a GNASHRC variable
	  to the generic-testrunner.sh
	* libbase/rc.cpp (loadFiles): load a GNASHRC if specified, after
	  all precedent files are loaded. See task #6937.

2007-05-25 Sandro Santilli <strk@keybit.net>

	* testsuite/libbase/: TCXXRc.cpp, gnashrc.in: test EnableExtensions.
	* doc/C/gnashrc.xml: document new EnableExtensions gnashrc
	  variable
	* libbase/rc.{cpp,h}: add support for EnableExtensions variable,
	  defaults to OFF. Cleanup const-correctness and static methods.
	* server/asobj/Global.cpp: Don't load extensions if disabled 
	  by gnashrc.

2007-05-25 Sandro Santilli <strk@keybit.net>

	* libgeometry/snappingrange.h: add intersects(Range2d)
	* testsuite/misc-ming.all/: Makefile.am,
	  loop_test2.c, loop_test2runner.cpp: Add a visual test
	  runner, showing that 2nd redesign attempt is really
	  bogus.

2007-05-25 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp: don't print a separate error
	  when call stack limit is exceeded, leave that to the 
	  exception handler.
	* server/vm/ActionExec.cpp: implement number of iterations
	  limit (should be a timeout in second actually, but better
	  this then hanging forever). Fixes bug #19961.

2007-05-25 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/swf/tag_loaders.cpp: Move the assignment into the data
	pointer up to right after the corresponding memory is allocated,
	because the DO_{MONO,STEREO}_BLOCK macros use the temporary
	pointer to iterate the buffer. This was causing delete[] to be
	called on the pointer which had walked to the end of the buffer
	and, thus, crashing.

2007-05-25 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{cpp,h}: drop unused remove_display_item
	  taking a std::string as argument..

2007-05-25 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamFfmpeg.h: Fix resampling for some FLVs,
	  fixes bug #19959.

2007-05-25 Sandro Santilli <strk@keybit.net>

	* libbase/log.cpp (timestamp): include PID in timestamp,
	  so its easier to read the gnash-dbg.log file after browsing
	  the web...

2007-05-24 Sandro Santilli <strk@keybit.net>

	* libbase/zlib_adapter.cpp: fix seek function to respect
	  tu_file interface. Fix inflater to no set an error condition
	  when inflate() just needs more calls to complete the request.
	  Fixes bug #19931.

2007-05-24 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/LoadThread.{cpp,h}: Made the download loop sleep when
	  read() wants to get a lock on the mutex.
	* libbase/curl_adapter.cpp: Decreased the sleeping time in fill_cache.
	* backend/{sound_handler.h,sound_handler_gst.h,sound_handler_sdl.h}:
	  Moved sound_data class to the base header.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* server/stream.cpp (open_tag): print end tag position in verbose
	  parse mode; (close_tag): assertion checking (shows a bug in
	  zlib_adapter, see bug #19931).
	* libbase/tu_file.cpp (std_seek_func): assertion checking and minor
	  cleanups.
	* libbase/curl_adapter.cpp (CurlStreamFile::seek): use the _cached
	  member for checking wheter a seek will succeed or not (fseek
	  allows you to seek past the end of the file otherwise).

2007-05-24 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/Makefile.am: When building FLTK GUI, also include
	the X11 CFLAGS (when available).
	* gui/fltk.cpp: Only try to do X11 things with FLTK if
	X11 is actually available. Should fix compilation on
	OS X (bug #19618).
	* macros/x11.m4: Don't forget to set the x11 flag
	variable which is used to check if X11 was found.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* server/: Makefile.am, impl.cpp, swf/DoActionTag.h,
	  swf/tag_loaders.cpp:
	  Move DoAction and DoInitAction tag stuff to its 
	  own file (both loader and parser).

2007-05-24 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (replace_display_object):
	  When the object being replaced is NOT a scriptable object,
	  move instead of replacing.
	* testsuite/misc-ming.all/: replace_buttons1test.c,
	  replace_buttons1test_runner.cpp, replace_sprites1test.c,
	  replace_sprites1test_runner.cpp: Expect less failures.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* server/: dlist.{cpp,h}, sprite_instance.{cpp,h},
	  server/swf/PlaceObject2Tag.cpp, server/vm/action.cpp:
	  Drop the use_matrix/use_color_xform parameters, use
	  pointers for the actual matrix/color_xform so that NULL
	  signifies "don't use".

2007-05-24 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/replace_sprites1test.c: 
	  Add onClipEvent(unload) to both PLACE and REPLACE tag.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* backend/sound_handler_gst.cpp: warn only once about fluendo plugin
	  being too old.
	* server/parser/shape_character_def.cpp (read): 
	  Fix typo reporting false malformations in the SWF.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* server/character.h: add isActionScriptReferenciable() 
	  method to find "scriptable objects". See:
	  http://www.gnashdev.org/wiki/index.php/ScriptableCharacters
	* server/sprite_instance.cpp (get_member, get_relative_target):
	  When requested name matches a NON scriptable instance, return
	  self.
	* server/video_stream_instance.h: implement wantsInstanceName()
	  [ used by isActionScriptReferenciable ]
	* testsuite/misc-ming.all/replace_shapes1test.c: expect less failures.
	* testsuite/misc-ming.all/shape_test.c: don't expect any more failure

2007-05-24 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am,
	  replace_buttons1test.c, replace_buttons1test_runner.cpp:
	  New test for buttons replacement.
	* testsuite/misc-ming.all/replace_sprites1test.c:
	  Add new test checking for _x.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* server/dlist.cpp (replace_character): always call ::construct
	  on the new character.
	* backend/sound_handler_sdl.h: fix const-correctness
	  of active_sound (btw, do we really need two different
	  definitions of that class for SDL and GST ?).

2007-05-24 Sandro Santilli <strk@keybit.net>

	* server/button_character_instance.cpp: protect vector
	  elements dereferencing by assertions. I have a segfault
	  triggered by a new uncommitted testcase replacing buttons...

2007-05-24 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{cpp,h}: remove unused
	  sprite_instance::mouse_state typedef and member.
	* server/parser/BitmapMovieDefinition.h,
	  server/parser/movie_def_impl.h,
	  server/parser/movie_definition.h,
	  server/parser/sprite_definition.h,
	  testsuite/DummyMovieDefinition.h:
	  Const-corrected get_playlist.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/replace_shapes1test.c:
	  Add more tests, updated comments.
	* testsuite/actionscript.all/MovieClip.as:
	  Add test for _root.getDepth() being static-0.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* backend/sound_handler.h, backend/sound_handler_gst.cpp,
	  backend/sound_handler_gst.h, backend/sound_handler_sdl.cpp,
	  backend/sound_handler_sdl.h, server/execute_tag.h,
	  server/sprite_instance.cpp, server/sprite_instance.h,
	  server/parser/sound_definition.cpp,
	  server/parser/sound_definition.h,
	  server/swf/DisplayListTag.h, server/swf/PlaceObject2Tag.cpp,
	  server/swf/PlaceObject2Tag.h, server/swf/RemoveObjectTag.cpp,
	  server/swf/RemoveObjectTag.h, server/swf/tag_loaders.cpp,
	  testsuite/sound_handler_test.cpp, testsuite/sound_handler_test.h:
	  Const-corrected execute_tag::execute and execute_state, and
	  cascading changes
	* testsuite/misc-ming.all/loop_test7.c: fix wrong expected failures.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am,
	  loop_test6.c, loop_test7.c:
	  Add a clone of "Jumping backward to the end of a character's
	  lifetime" test this time with onUnload defined.

2007-05-24 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: replace_shapes1test.c,
	  replace_sprites1test.c: SWFMovie_replace returns 0 on success
	  and non-0 on failure. Fixed code to reflect that (I'm not sure
	  I like this interface, anyway this is what we have in current
	  Ming head).

2007-05-23 Sandro Santilli <strk@keybit.net>

	* server/swf/: tag_loaders.cpp, DefineFontAlignZonesTag.{cpp,h},
	  DisplayListTag.h, PlaceObject2Tag.{cpp,h},
	  RemoveObjectTag.{cpp,h}:
	  Move one namespace up (gnash::SWF - strip tag_loaders);
	  Provide a static public loader() function for use by 
	  register_tag_loader (moved implementation from tag_loaders.cpp
	  to the classes themselves).
	* server/impl.cpp: update loaders registration to call the new
	  public static methods of ReplaceObjectTag and PlaceObject2Tag.

2007-05-23 Sandro Santilli <strk@keybit.net>

	* server/execute_tag.h: drop is_remove_tag() method.
	* server/sprite_instance.{cpp,h}: drop unused
	  execute_remove_tags() method.
	* server/Makefile.am, server/swf/: DisplayListTag.h,
	  PlaceObject2Tag.h, RemoveObjectTag.{cpp,h}
	  tag_loaders.cpp: Add a DisplayListTag subclass of
	  execute_tag, and make RemoveObject and PlaceObject subclasses
	  of it.

2007-05-23 Ann Barcomb <kudra@domaintje.com>

	* doc/C/usermanual/installation/feature_configuration.xml,
	  doc/C/usermanual/installation/configuration.xml: Incorporated
	  some changes from r1.38 of doc/C/sources.xml.

2007-05-23 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, loop_test6.c:
	  New test for "Jumping backward after a character's lifetime".
	  Reveals a conceptual bug in last step of all redesign attempts
	  for displaylist reconstruction (execute *all* frame tags
	  from start to target frame).

2007-05-23 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, replace_shapes1test.c,
	  replace_sprites1test.c, replace_shapes1test_runner.cpp,
	  replace_sprites1test_runner.cpp: Modified coordinates and size
	  of shapes to help writing test runners. Wrote real test
	  runners checking for rendering and bounds invalidation.
	* testsuite/MovieTester.cpp (render): don't force redraw
	  always (don't cheat) - do only when asked to do so..

2007-05-23 Sandro Santilli <strk@keybit.net>

	* server/character.h: Extended TimelineInfo to store information
	  about wheter a character was placed by a REPLACE tag.
	* server/sprite_instance.cpp: implemented 3rd redesign attempt
	  for DisplayList reconstruction compile-time enableable by
	  setting NEW_TIMELINE_DESIGN to 3. Defined to 2 by defualt
	  which gives us 2nd redesign attempt. See wiki.
	  3rd redesign is promising and give us lots of unexpected
	  successes, but also some unexpected failures for the new
	  testcases for REPLACE tag. 

2007-05-23 Sandro Santilli <strk@keybit.net>

	* server/dlist.{cpp,h}: Add new reset() method taking
	  enough parameters (I hope) to remove what needs to
	  on jump-back; drop obsoleted clear_unaffected function.
	* testsuite/misc-ming.all/: replace_shapes1test.c,
	  replace_sprites1test.c: Fix implementation (don't
	  use Ming internal methods); add new tests and comments
	  about why Gnash fails.

2007-05-23 Bastiaan Jacques <bastiaan@bjacques.org>

	* cygnal/cygnal.cpp: Don't include <libintl.h> directly; instead,
	rely on our own gettext.h to do the right thing.
	* gui/fltk.cpp: Update the FLTK GUI to the new Gnash key handling 
	API. Make sure the window is listening for key events even if it
	is not the first window to receive key notifications.
	* macros/gnashpkgtool.m4: Don't forget to set the "found" flag
	for CFLAGS when --with-pkg-incl is used to find the include path.
	* libbase/FLVParser.cpp: Fix more memory bugs by adding padding
	zero bytes. Should fix bug #19898.

2007-05-23 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Made it a bit more thread-safe by
	  locking when attaching/detaching a aux_streamer.
	  Fixed a crash when removing attached sounds from the aux_streamer list.
	* libbase/FLVParser.{h,cpp}: Added audioFrameDelay(), and a fixes.
	* libbase/curl_adapter.cpp: Changed min and max sleep.
	* server/asobj/NetStreamFfmpeg.{h,cpp}: Cleanup! Splitted the big
	  decode function (read_frame) into 3 functions. Changed a few names
	  to make more sence. Improved syncing, and made it depend on audio 
	  if available, not video. Plus some overall improvements.

2007-05-23 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/shape_test.c: add tests for shapes.
	* testsuite/misc-ming.all/Makefile.am: activate some testcases.
	 	
2007-05-22 Martin Guy <martinwguy@yahoo.it>

	* configure.ac: add help text for ffmpeg-devel RPM package
	* server/swf/tag_loaders.cpp: Fix NELLYMOSER bombing out

2007-05-22 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp (place_object_2_loader): don't
	  add a TimelineDepth if read depth is out of static depth zone 
	  boundaries (warn user about it too...).
	* gui/Player.cpp (run): use movie url for window title (-u).
	  Useful when reading stdin...
	* server/parser/shape_character_def.cpp (read): don't force
	  fill and line style of glyphs to have a corresponding style
	  definition, just warn if the value in a styleChangeRecord is
	  neither 0 or 1. Set style to 0 when invalid.

2007-05-22 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/loop_test-Runner.cpp: don't expect
	  failure in invalidated bounds after Udo commits.
	* testsuite/misc-ming.all/replace_sprites1test.c: Change expected
	  Gnash behaviour (previous one was based on 3rd displaylist reset
	  design implementation).

2007-05-22 Sandro Santilli <strk@keybit.net>

	* configure.ac: add MING_SUPPORTS_REPLACE_TAG conditinal variable,
	  based on version (0.4.0.beta5).
	* testsuite/misc-ming.all/: Makefile.am, replace_shapes1test.c,
	  replace_sprites1test.c: Add a couple of test for REPLACE tags.
	  Needs a Ming version that supports it, checked by
	  MING_SUPPORTS_REPLACE as set by ./configure.

2007-05-22 Ann Barcomb <kudra@domaintje.com>

	* doc/C/usermanual/installation/configuration.xml: List interesting
	  options before custom path options
	* doc/C/usermanual/installation/feature_configuration.xml: Added
	  missing title (it had been left in configuration.xml).

2007-05-22 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/character.{h,cpp}: Added preprocessor code to analyze 
	  calls to set_invalidated() more easily.
	* server/cxform.h: Implemented == operator
	* server/dlist.cpp: inherit invalidated bounds when replacing a
	  character
	* server/sprite_instance.cpp: avoid call to set_invalidated()
    (of parent) when replacing a char	  				
		 
2007-05-22 Ann Barcomb <kudra@domaintje.com>

	* doc/C/usermanual/*: Added files for the new user manual.
	* doc/C/app_authors.xml: Added a file which is used in the user manual
	  but might be cross-referenced by other documents.

2007-05-22 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/misc-ming.all/NetStream-SquareTest.c: add missing end quote
	* testsuite/actionscript.all/XML.as: fix broken string

2007-05-21 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, displaylist_depths_test11.c:
	  New timeline control test.
	* server/parser/Timeline.h: fix getFrameDepths to really return
	  depths. Add output operator.

2007-05-21 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Only try to detach video-sound
	  input, if it exists.
	* server/asobj/NetStreamFfmpeg.cpp: Shutdown the decoding thread
	  proberbly.

2007-05-21  Rob Savoye  <rob@bertha.welcomehome.org>

	* libbase/Makefile.am: Build the installable libltdl before
	libgnashbase.

2007-05-21 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/displaylist_depths_test9.c: add
	  a construct event handler for the static character placed
	  and replaced (duplicated), and tests for its run.

2007-05-21  Rob Savoye  <rob@bertha.welcomehome.org>

	* libbase/Makefile.am: Don't include LIBLTDL in libgnashbase.la.

2007-05-21 Sandro Santilli <strk@keybit.net>

	* server/parser/: movie_definition.h, movie_def_impl.h,
	  sprite_definition.h: add getTimelineDepths() methods
	  and implementations.

2007-05-21 Sandro Santilli <strk@keybit.net>

	* server/parser/: Makefile.am, Timeline.h: new class for
	  timeline control.
	* server/parser/: movie_definition.h, movie_def_impl.{cpp,h},
	  sprite_definition.{cpp,h}: new addTimelineDepth() and
	  removeTimelineDepth() interfaces in base class, implementation
	  in subclasses.
	* server/swf/tag_loaders.cpp (remove_object2_tag): add getDepth()
	  method; call movie_definition::addTimelineDepth when a PlaceObject
	  tag is parsed and movie_definition::removeTimelineDepth when
	  a RemoveObject is parsed.
	* server/swf/PlaceObject2Tag.h: add getDepth() method, more dox
	  and 3 new inspectors to know wheter it's a place, replace or move
	  tag.

2007-05-21 Sandro Santilli <strk@keybit.net>

	* libbase/log.h: removed useless 'while (0) {};' snippet from
	  IF_VERBOSE_ASCODING_ERRORS and IF_VERBOSE_MALFORMED_SWF

2007-05-21 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/loop_test5.c:
	 	more for "Timeline control".
	 	
2007-05-21 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: build libgnashmingutils
	  as a convenience library; have Dejagnu.swf users depend on
	  the local copy, not the one moved one dir up.
	* libbase/log.{cpp,h}: make LogFile output operators
	  private, provide a sipler thread-safe log() method.
	  Have all printf-like log_*() method use this new method.
	  Fixes bug bug #19906.
	* cygnal/stream.cpp, server/parser/action_buffer.cpp,
	  server/parser/action_buffer.h, server/vm/ActionExec.cpp,
	  testsuite/server/PropertyListTest.cpp: remove any
	  use of LogFile::operator<<, substitute with log_*() calls.

2007-05-21 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/loop_test4.c:
	 	add a another check, comments
	 	
2007-05-21 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/loop_test4.c:
	 	new testcase for timeline control.
	 	
2007-05-21 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/place_object_test2.c:
	 	testcase for placeObject2.
	 	
2007-05-20  Rob Savoye  <rob@bertha.welcomehome.org>

	* libbase/log.h: Add empty braces around a while(0) to shut up GCC
	4.3.

2007-05-20 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/displaylist_depths_test9.c:
	 	more tests, all passed.
		
2007-05-19 Markus Gothe <nietzsche@lysator.liu.se>

	* server/asobj/NetStream.cpp: Got rid of make_pair in favor of
	  std::pair<>();
	* server/cxform.h: include <string>

2007-05-19 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/tu_timer.cpp: Fixed a compiler warning.
	* server/asobj/NetStreamFfmpeg.{h,cpp}: Changed the way the decoding
	  loops works. We now use condition variables to pause the decoding 
	  loop. We now disconnect from the soundhandler when pausing.

2007-05-18 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, loop_test2.c, loop_test3.c:
	  New Timeline control test. GNASH FAILS THESE ONES !!

2007-05-18 Sandro Santilli <strk@keybit.net>

	* server/dlist.h: document the addAll() and add() methods.
	* server/asobj/NetStreamGst.cpp: provide a buildFLVPipeline() calling
	  the video/audio versions internally and locking the pipelineMutex.
	  Lock the pipelineMutex from buildPipeline() too. Document locking
	  in header.
	* testsuite/misc-ming.all/: loop_test-Runner.cpp, loop_test.c:
	  Make loop_test.swf self-contained. Use the runner for checking
	  invalidated bounds and rendering.

2007-05-18  Rob Savoye  <rob@bertha.welcomehome.org>

	* backend/sound_handler.cpp: Include cstring so memcpy is
	defined.
	* libbase/Makefile.am: Add makefile rules from libltd.

2007-05-18 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, displaylist_depths_test10.c:
	  Add test for "Skipping frames backward".
	* Makefile.am, configure.ac: detect 'swfmill'
	* testsuite/misc-swfmill.all/: .cvsignore, Makefile.am:
	  new testsuite dir for swfmill
	* testsuite/misc-swfmill.all/hello.xml: small example on
	  how to produce an swf. Build with 'make hello.swf'.

2007-05-18 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/getTimer_test.c,
	  server/vm/VM.{h,cpp}, server/vm/ASHandlers.cpp,
	  gui/fb.cpp: cleanup "ActionGetTimer" related stuff.
	* server/movie_root.h
	  remove unused get_timer, set_timer.
	  
2007-05-17  Martin Guy  <martinwguy@yahoo.it>

	* configure.ac: Change package help message format
	  and fix typo MYSQC_CFLAGS
	* backend/sound_handler.h: Remove old adpcm_expand() decl
	* macros/x11.m4: Two typoes "if x${a} != xfoo"
	* utilities/parser.cpp: Shut compiler up
	* backend/sound_handler_gst.cpp, testsuite/sound_handler_test.cpp:
	  Remove never-implemented stub declaration.
	* server/swf/tag_loaders.cpp: Rewrite of sample-reading code to decode
	  all linear formats in one place.
	* backend/sound_handler_{sdl,gst}.cpp: Remove now unnecessary attempts
	  at decoding other linear audio formats.
	* backend/sound_handler_gst.cpp, testsuite/sound_handler_test.cpp:
	  Replace never-implemented stub declarations, symptom of a deeper ill.
	* backend/sound_handler.h,
	  backend/sound_handler_gst.cpp,
	  backend/sound_handler_gst.h,
	  backend/sound_handler_sdl.cpp,
	  backend/sound_handler_sdl.h,
	  testsuite/sound_handler_test.cpp,
	  testsuite/sound_handler_test.h,
	  server/asobj/SoundMad.cpp:
	  Add two params to convert_raw_data so that it is SDL-independent
	* backend/sound_handler.h,
	  backend/sound_handler.cpp,
	  backend/sound_handler_gst.cpp,
	  backend/sound_handler_gst.h,
	  backend/sound_handler_sdl.cpp,
	  backend/sound_handler_sdl.h,
	  testsuite/sound_handler_test.cpp,
	  testsuite/sound_handler_test.h:
	  convert_raw_samples is now just a static fn of sound_handler::
	* backend/sound_handler.cpp: Speed convert_raw_data and handle stereo
	  upsampling correctly
	* backend/sound_handler_sdl.cpp: Remove bug 19750 that garbled
	  SOUNDSTREAM audio.
	* server/swf/tag_loaders.cpp: Bug fix: calculate # samples correctly.
	* macros/ffmpeg.m4,configure.ac: Workaround /usr/include/ffmpeg reported
	  by pkg-config; move libavformat absence test to final report.

2007-05-17  Rob Savoye  <rob@bertha.welcomehome.org>

	* libbase/Makefile.am: Build libltdl optionally by duplicating the
	  way libltdl/Makefile used to buuld this library.

2007-05-17 Sandro Santilli <strk@keybit.net>

	* macros/: boost.m4, x11.m4: avoid explicit -L/usr/lib.

2007-05-17  Rob Savoye  <rob@bertha.welcomehome.org>

	* libbase/Makefile.am: Add ltdl.h to noinst_HEADERS.
	* po/Makefile.am: Use DESTDIR when installing. 
	* testsuite/server/Makefile.am: Link in FFMPEG is configured to do so.
	* libbase/Makefile.am: Add path for ltdl.h.

2007-05-17 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac: Check if LD supports --as-needed.
	* server/asobj/Date.cpp: Clean up and fixed uneeded ftime() use.

2007-05-17 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamGst.cpp (unrefElements): don't attempt
	  to unref NULL objects, set objects to NULL after unreffing. Add
	  TODO item.
	* testsuite/misc-ming.all/NetStream-SquareTest.c:
	  Add self-contained tests.
	* testsuite/misc-ming.all/NetStream-SquareTestRunner.cpp:
	  Adjust to simply run the self-contained tests.

2007-05-17 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/getTimer_test.c:
		make the time dependent tests be more tolerant
	
2007-05-17 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all: getTimer_test.c, Makefile.am
	  add a new testcase; activate action_execution_order_test9.c
	* server/vm/VM.{h,cpp}: add a getStartTime() for VM.
	* server/vm/ASHandlers.cpp: use new "getStartTime()" interface,
	  fix ActionGetTimer;
	* libbase/tu_timer.{h,cpp}: change time unit for non-win32 version
	  "get_ticks()";
	  
2007-05-16  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/boost.m4: Look for shared libs with version numbers after
	the suffix, for OpenBSD.

2007-05-16 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStream.{h,cpp}, 
	  server/asobj/NetStream{Gst,Ffmpeg}.{h,cpp}: Updated documentation.
	* libbase/FLVParser.{h,cpp}, server/asobj/NetStream.{h,cpp}: 
	  Implemented bufferLength.

2007-05-16 Sandro Santilli <strk@keybit.net>

	* libbase/FLVParser.h: class documentation.

2007-05-16 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamGst.{h,cpp}: Splitted buildFLVPipeline
	  into buildFLVVideoPipeline and buildFLVSoundPipeline.

2007-05-16 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am,
	  NetStream-SquareTestRunner.cpp, Video-EmbedSquareTestRunner.cpp:
	  Stub video test runners.

2007-05-16 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamGst.{cpp,h}: Split startPlayback() into 
	  smaller function (buildFLVPipeline and buildPipeline). Made sure
	  gstreamer elements are cleaned up if setup fails.

2007-05-16  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Eval lists so the embedded variables get
	expanded on all systems. Turn on --as-needed for all
	builds. Define LIBLTDL variables and DLOPEN again.
	* backend/Makefile.am: Don't use no-undefined -export-dynamic for
	a library.
	* libbase/Makefile.am: Build standalone libltdl now so we can work
	with an installed one too, which appears to be necessary on 64 bit
	systems.
	* macros/boost.m4: Rewrite to support Boost 3.4, which of course
	changed the library names. Get all libraries with of the right
	type, and sort through the variants to choose the correct one,
	preferably ending in *-mt.so.
	* macros/kde.m4: Define newlist, so we don't stomp the value of
	libslist, which produces bizarre side effects when cross
	compiling.
	* macros/libltdl.m4: Our build of libltdl.la lives in libbase
	instead of libltdl. NOTE: This will unfortunately have to be done
	again if this file is updated in the future from the version
	included on libtool.
	* gui/Makefile.am: -framework Carbon should be defined in
	$OPENGL_LIBS.

2007-05-16 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamGst.{cpp,h}: define and use 
	  mutex-protected pipeline control methods.

2007-05-16 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamGst.cpp: always check return code
	  from gst_element_factory_make. Handling in case of failure
	  is not verified to be correct. Tgc, could you check it out ?
	* gui/Makefile.am: don't put LDFLAGS in LIBADD, remove
	  spurious character likely slipped in due to Markus
	  fighting with his new keyboard ;)

2007-05-15 Markus Gothe <nietzsche@lysator.liu.se>
	
	* po/se.po: Initial start of Swedish translation.
	* gui/aqua*: Stubs for getting a native OS X UI.
	
2007-05-15 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStreamGst.{h,cpp}: add a resetPipeline() private
	  method doing some checks on the return code (some situations are 
	  still unhandled); use resetPipeline() when needed.
	* server/asobj/NetStream.cpp: warn once about unimplemented stuff.

2007-05-15  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Use C++ compiler instead of C compiler so the
	SIZET_FMT test works correctly with GCC 4.3.x. Move libltdl tests
	to top level. Don't configure in the libltdl directory. 
	* gnash/Makefile.am: Don't list libltdl as a SUBDIR.
	* gnash/autogen.sh: Only run libtoolize once.
	* backend/sound_handler_sdl.cpp: Rearranage header order for
	braindead platforms.
	* libbase/Makefile.am: Built ltdl into libbase. Drop linking with
	--no-undefined --export-dynamic.
	* libgeometry/Makefile.am: Built ltdl into libbase. Drop linking
	with --no-undefined --export-dynamic.
	* macros/ffmpeg.m4: Don't add ffmpeg to include path. Fix test for
	avformat.h to be more portable.
	* po/Makefile.am: Install all the translations in a loop.
	* server/URLAccessManager.cpp: Include iconv.h. Use lower case for
	winsock2.h.
	* server/asobj/NetStreamFfmpeg.cpp: Use lower case for winsock2.h.
	* server/asobj/xmlsocket.cpp: Use lower case for winsock2.h.
	* utilities/parser.cpp, processor.cpp: Include libintl.h and
	locale.h for braindead platforms.
	* macros/libltdl.m4: Add autoconf support from libltdl.

	
2007-05-15 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp (inflate_wrapper): fix infinite loop
	  on inflate errors.
	* server/parser/morph2_character_def.cpp (read): don't abort
	  if number of edges in start and end shapes are not equal.
	  Just raise an SWF error.
	* server/stream.{cpp,h} (skip_bytes): return a boolean value
	  for success/failure.
	* server/swf/PlaceObject2Tag.cpp (readPlaceAction): check
	  return from stream::skip_bytes.
	* libbase/jpeg.cpp: fix typo introduced in last commit.
	* server/swf/PlaceObject2Tag.cpp (readPlaceActions): don't abort when
	  reserved flag != 0.

2007-05-15 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStream.{cpp.h}, server/asobj/NetStreamFfmpeg.{cpp,h},
	  server/asobj/NetStreamGst.{cpp,h}: Moved shared code from 
	  NetStreamFfmpeg and NetStreamGst to the NetStream base class.

2007-05-15 Sandro Santilli <strk@keybit.net>

	* libbase/jpeg.{cpp,h}: cleanups and robustness (first pass).

2007-05-15 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_{sdl,gst}.cpp: Use the 
	  IF_VERBOSE_MALFORMED_SWF macro.
	* libbase/log.h: Added gnash:: to RcInitFile calls.
	* server/swf/tag_loaders.cpp: Use stream::read() instead of loops.

2007-05-15 Sandro Santilli <strk@keybit.net>

	* libbase/GnashException.h: add missing <string> include.

2007-05-15 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/action_execution_order_test9.c:
	  improved comments.
	  
2007-05-15 Sandro Santilli <strk@keybit.net>

	* server/stream.{cpp,h} (set_position): document and change return
	  type to signal failures.
	* server/font.cpp (readDefineFont, readDefineFont2_or_3): use
	  stream::set_position return code to detect SWF malformations.

2007-05-15 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_{gst,sdl}.cpp: Make soundhandlers more robust.
	* server/swf/tag_loaders.cpp: Remember to pass the mp3 data and size.

2007-05-15 Sandro Santilli <strk@keybit.net>

	* server/movie_instance.cpp (advance): safely handle movies 
	  with 0 total frames (malformed SWF).
	* gui/gui.cpp (advance_movie): handle no looping when the
	  total frame count is 0 (malformed SWF).
	* server/dlist.cpp (swapDepth): fix an out-of-bound access.

2007-05-15 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/duplicate_movie_clip_test2.c:
	  more tests.
	* testsuite/misc-ming.all/action_execution_order_test9.c:
	  new testcase.
	  
2007-05-14 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.cpp (read_all_swf): handle premature
	  SWF::END tag.
	* libbase/tu_file.{cpp,h}: changed set_position signature to return
	  an int (0 for success TU_FILE_SEEK_ERROR on error).
	* server/stream.cpp (end_tag): check return from
	  tu_file::set_position().

2007-05-14 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, NetStream-Square.c,
	  NetStream-SquareTest.c, Video-EmbedSquare.c,
	  Video-EmbedSquareTest.c: Renamed video tests to conform
	  to the tests naming convention (end with "test"). Enabled
	  build of the SWF. Test runners still missing.
	  Get FLV path on command line.

2007-05-14 Sandro Santilli <strk@keybit.net>

	* server/font.cpp: more robustness improvements.
	* server/font.cpp (readDefineFont, readDefineFont2_or_3): pass
	  shape_character_def the real tag we're parsing.
	* server/parser/shape_character_def.cpp (read): when parsing
	  DEFINEFONT tags provide a dummy solid white fill style to
	  act as a placeholder for consistency checking.

2007-05-14 Sandro Santilli <strk@keybit.net>

	* server/fill_style.{cpp,h}: document default constructor and type.
	* server/vm/ASHandlers.cpp (CommonGetUrl): check url security also
	  when invoking firefox.
	* server/font.cpp (readDefineFont, readDefineFont2_or_3): use 
	  symbolic names for tag type.
	* server/parser/shape_character_def.cpp (read): temporarely 
	  disabled the "don't set line and fill styles if not defined yet".
	  It seems to break a lot of movies. We should find out why though,
	  as I'd think styles must *first* be defined, and *after* referred.

2007-05-14 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_agg_style.h (is_solid): check argument
	  with an assertion before accessing the m_styles vector.
	* server/parser/shape_character_def.cpp (read): don't set line and
	  fill styles to unavailable values. Drop a weird an likely bogus
	  modification of tag_type when  a flagHasNewStyle is set and the
	  tag is DEFINESHAPE.

2007-05-14 Sandro Santilli <strk@keybit.net>

	* utilities/Makefile.am: don't set LDFLAGS twice.
	* server/parser/shape_character_def.{cpp,h}: add ShapeRecordFlags
	  enum to use symbolic names while parsing. Don't change tag type
	  when encountering the flagHasNewStyles set and the tag type
	  is DEFINESHAPE (for which supposedly that flag is reserved);
	  keep parsing instead and print a message about SWF malformacy.
	* gui/Player.cpp (run): exit with a failure if input movie has
	  collapsed dimensions (malformed SWF most likely).
	* server/asobj/xml.{cpp,h}: change extractNode interface to return a
	  bool, so it can implement a custom ignoreWhite thing (the libxml2
	  XML_PARSE_NOBLANKS seems to be not working. Add getXMLOptions()
	  and getIgnoreWhite() utility methods (privates). Fixes bug #19865.
	* testsuite/actionscript.all/XML.as: more tests for ignoreWhite.

2007-05-14 Sandro Santilli <strk@keybit.net>

	* server/asobj/xmlnode.cpp (stringify): represent empty nodes with the
	  "<openclose />" format.
	* server/asobj/xml.{cpp,h}: parseDoc made private; add clear()
	  method for dropping childs and attibutes; clear() on parseXML() or
	  load() calls.
	* testsuite/actionscript.all/XML.as: add a cleaner test for parseXML
	  not appending new definitions. Misses the same for load()

2007-05-14 Sandro Santilli <strk@keybit.net>

	* utilities/Makefile.am: put GNASH_LIBS in LDADD and external
	  libs in LDFLAGS. Drop '-dlopen self'. Please review.

2007-05-14  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/mtasc.m4: Patch #9531, fix variable name for MTASC.
	* libbase/noseek_fd_adapter.cpp: Include cstring to get C string
	functions used for char * manipulation.
	* libbase/URL.cpp: Include cstring to get C string functions used
	for char * manipulation. 
	* libbase/embedVideoDecoderFfmpeg.cpp: Include cstring to get C
	string functions used for char * manipulation.
	* libbase/curl_adapter.cpp: Include cstring to get C string
	functions used for char * manipulation. 

	* server/gnash.h: Include memory for auto_ptr.
	* libamf/amf.h: Include cstring for C string functions.
	* libamf/amf.cpp: Use lower case for win32 headers, as that's what
	Mingw32 uses.
	
2007-05-14 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/displaylist_depths_test7.c: fix description
	  to match actual implementation. Don't expect a wrong behaviour.

2007-05-14 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: duplicate_movie_clip_test2.c,
	  displaylist_depths_test9.c: don't expect any failure. 
	* server/as_environment.cpp (find_target): strip leading colon chars
	  in path components (fixes ActionDuplicateClip bug).
	* testsuite/misc-ming.all/Makefile.am: fixed bad typo (missing
	  backslash) which triggered NO warning from ./autogen.sh
	  but still resulted in bogus Makefile.in produced (sic!).

2007-05-14 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/FLVParser.cpp: Fixed a out-of-bound error (bug #19866).
	* testsuite/media/square.flv: Added. Used for testing.
	* testsuite/misc-ming.all/NetStream-Square.c: Added. Created simple
	  SWF which plays square.flv using NetStream.
	* testsuite/misc-ming.all/Video-EmbedSquare.c: Added. Created simple
	  SWF which plays an embedded video (ripped from square.flv).

2007-05-14 Sandro Santilli <strk@keybit.net>

	* po/Makefile.am: create destination directories before trying to
	  install things there.

2007-05-14  John Gilmore  <gnu@toad.com>

	Internationalization, further cleanup:
	
	* po/Makefile.am:  Pass proper flags to xgettext to handle _(...).
	* po/LINGUAS:  Remove, superseded by Makefile.am's "translations".
	* backend/sound_handler_gst.cpp, cygnal/cygnal.cpp, cygnal/http.cpp,
	  cygnal/statistics.cpp, cygnal/stream.cpp, gui/gtk.cpp,
	  gui/gtk_glue_gtkglext.cpp, gui/kde.cpp, gui/stl_agg_glue.cpp,
	  libamf/amf.cpp, libamf/rtmp.cpp, libbase/rc.cpp,
	  libbase/sharedlib.cpp, server/movie_root.cpp, utilities/parser.cpp,
	  utilities/processor.cpp: Insert header
	  comment and fix up copyright spacing.
	* backend/sound_handler_gst.cpp, cygnal/cygnal.cpp, cygnal/http.cpp,
	  cygnal/statistics.cpp, cygnal/stream.cpp, gui/Player.cpp,
	  gui/gtk.cpp, gui/gtk_glue_gtkglext.cpp, gui/stl_agg_glue.cpp,
	  libamf/amf.cpp, libamf/rtmp.cpp, libbase/network.cpp, libbase/rc.cpp,
	  libbase/sharedlib.cpp, server/as_function.cpp, server/debugger.cpp,
	  server/movie_root.cpp, utilities/parser.cpp, utilities/processor.cpp:
	  Pass messages through _(...).
	* backend/sound_handler_gst.cpp, backend/sound_handler_mp3.cpp,
	  cygnal/README, cygnal/cygnal.cpp, cygnal/http.cpp,
	  cygnal/statistics.cpp, cygnal/stream.cpp, gui/Player.cpp,
	  gui/gtk.cpp, gui/gtk_glue_gtkglext.cpp, gui/stl_agg_glue.cpp,
	  libamf/amf.cpp, libamf/rtmp.cpp, libbase/network.cpp,
	  libbase/rc.cpp, libbase/sharedlib.cpp, server/as_function.cpp,
	  server/debugger.cpp, server/dlist.cpp, server/movie_root.cpp,
	  utilities/parser.cpp, utilities/processor.cpp:
	  Clean up messages (remove \n's and !s, change wording, use
	  log_XXX functions rather than dbglogfile <<, use proper log_XXX
	  function, fix typos, etc).
	* backend/sound_handler_mp3.cpp: New 2007 Free Software Foundation
	  copyrights applied (to formerly public domain code)
	* cygnal/cygnal.cpp, cygnal/http.cpp, cygnal/statistics.cpp,
	  cygnal/stream.cpp, gui/gtk_glue_gtkglext.cpp, gui/kde.cpp,
	  gui/stl_agg_glue.cpp, libbase/sharedlib.cpp: Update copyright
	  to 2007.
	* cygnal/http.cpp (HTTP::sendGetReply),
	  cygnal/stream.cpp (sendfile_thread),
	  libamf/amf.cpp (AMF::encodeElement, AMF::extractElementLength,
	  AMF::parseBody, AMF::extractVariable),
	  server/debugger.cpp (Debugger::dumpStackFrame): Insert FIXME
	  about likely bug.
	* gui/kde.cpp (qwidget::qwidget):  Translate strings for the
	  pop-up menu items.
	* libbase/network.cpp (Network::writeNet):  Remove dead code.
	* AUTHORS, gui/gtk.cpp (authors):  Add myself to authors list.
	
2007-05-14 Sandro Santilli <strk@keybit.net>

	* server/rect.{cpp,h} (read): check for min/max values swapped
	  reporting SWF malformation and setting the rect to NULL if
	  that happens.
	* server/parser/movie_def_impl.cpp (readHeader): report SWF
	  malformation if movie bounds were malformed.

2007-05-14 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/: displaylist_depths_test9.c, Makefile.am:
	  new scenario for Timeline Control, gnash passes.
	  But luckly, caught a bug in ActionDuplicateClip :)
	* testsuite/misc-ming.all/action_execution_order_test8.c: indent
	* testsuite/misc-ming.all/: duplicate_movie_clip_test2.c, Makefile.am:
	  new testcase for duplicateMovieClip.
	  
2007-05-13  Rob Savoye  <rob@bertha.welcomehome.org>

	* po/Makefile.am: Add install-data-hook target so the .gmo files
	get installed. Build and install German translation.
	* po/de.po: German translation by benjamin.goose@lrz.uni-muenchen.de.
	* doc/C/sources.xml: Fix unclosed <para> tags.
	* macros/ffmpeg.m4: Only print warning and reset
	ac_cv_path_ffmpeg_incl if avformat.h doesn't exist.
	
2007-05-13 Sandro Santilli <strk@keybit.net>

	* macros/boost.m4: typo fix (might need another go at testing)
	* testsuite/actionscript.all/Number.as: skip conversion-to-number
	  tests if Ming doesnt' support ASM.
	* testsuite/actionscript.all/XML.as: add tests exposing two bugs
	  with XML (parseXML appending newly parsed stuff and ignoreWhite
	  being unsupported).

2007-05-12 Martin Guy <martinwguy@yahoo.it>

	* server/stream.{h.cpp}: Punch a block-read primitive through the
	  stream layer.
	* server/parser/sound_definition.cpp: Move ADPCM code elsewhere
	* server/swf/tag_loaders.cpp: Decode all linear formats into native 16,
	  move ADPCM code here where it's used.

2007-05-12 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_gst.cpp: Make sure sounds are stopped
	  when done being played. Should fix bug #19628.
	* libbase/FLVParser.{h,cpp}: Switched from referring to the last
	  frame we used, to the next frame we're going to use.
	* libbase/curl_adapter.cpp: Fix use of usleep() on windows.
	* macros/opengl.m4: Fixed detection on windows.
	* macros/boost.m4: Re-commited Deannas boost patch with a small fix.

2007-05-12 Sandro Santilli <strk@keybit.net>

	* server/character.h (isDynamic): the root movie, not having
	  been placed in a parent displaylist, has NO TimelineInfo
	  associated. Consider this in the assertion aimed at dropping
	  the _dynamicallyCreated flag.
	* libbase/tu_file.cpp (std_tell_func): don't require not to 
	  be at EOF on tell() call. See bug #19861.

2007-05-12 Sandro Santilli <strk@keybit.net>

	* server/execute_tag.h, server/swf/PlaceObject2Tag.{cpp,h},
	  server/swf/tag_loaders.cpp: Drop execute_tag::execute_state_reverse()
	  and execute_tag::get_depth_id_of_replace_or_add_tag) methods.
	* server/sprite_instance.{cpp,h}: (advance_sprite, execute_frame_tags):
	  call resetDisplayList in advance_sprite rather then delegate to
	  execute_frame_tags, to avoid an invocation during
	  restoreDisplayList(). (restoreDisplayList): fix comment for
	  step1, remove commented out code. Drop the m_is_reverse_execution
	  flag and associated getter. Drop execute_frame_tags_reverse() method.
	  Drop find_previous_replace_or_add_tag method. (goto_frame) Move
	  UdoG comment where it belonge [old design block], add comment about
	  possible problem with clearing the action queue after displaylist 
	  restoration.
	* testsuite/misc-ming.all/loop_test-Runner.cpp: Don't set action
	  verbosity.

2007-05-11 Sandro Santilli <strk@keybit.net>

	* server/dlist.{cpp,h}: Add another DisplayList mass-removal
	  function taking a vector of gnash::characters to remove.
	* server/character.h: Add support for attaching TimelineInfo
	  records to (timeline) instances.
	* server/sprite_instance.cpp: 
	  (add_display_object, replace_display_object):
	  add TimelineInfo record to placed timeline instance. 
	  (restoreDisplayList): implemented DisplayList reconstruction
	  algorithm as defined on the "Timeline control" wiki page.
	  (goto_frame): use restoreDisplayList when jumping-back, properly
	  set m_current_frame when jumping-forward, for proper TimelineInfo
	  construction.
	* testsuite/misc-ming.all/: displaylist_depths_test4.c,
	  displaylist_depths_test5.c, displaylist_depths_test6.c,
	  displaylist_depths_test7.c, displaylist_depths_test8.c:
	  Most new Timeline-focused testcases pass now.
	  PLEASE HELP MAKING MORE !!

2007-05-11  Rob Savoye  <rob@ute.welcomehome.org>

	* macros/curl.m4, sdl.m4: Drop extraneous results.
	* macros/x11.m4: Remove --enable test, remove extraneous results.

2007-05-11 Sandro Santilli <strk@keybit.net>

	* server/dlist.h (move_display_object): document the call to
	  accept_anim_move().
	* testsuite/misc-ming.all/displaylist_depths_test7.c: fix missing
	  failure "expectance" and associated comment.
	* testsuite/misc-ming.all/: Makefile.am, displaylist_depths_test8.c:
	  New case: "Jumping backward to the start of a character's lifetime
	  after dynamic transformation"

2007-05-11 Sandro Santilli <strk@keybit.net>

	* server/dlist.{cpp,h} (swapDepths): abort if target depth
	  equals depth of source character.
	* server/sprite_instance.cpp (sprite_swap_depths): raise
	  a debugging message and skip any depths swap if target depth
	  equals depth of source character.
	* testsuite/misc-ming.all/: Makefile.am, displaylist_depths_test7.c:
	  New scenario testing that swapDepth(currentdepth) has no effect.

2007-05-11 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/displaylist_depths_test6.c:
	  Jump to frame 5, to avoid a failure and success of
	  the same test in two different points in time, and *stop* there
	  (wiki updated).
	* server/dlist.{cpp,h}: drop dangerous swap_characters, add safe,
	  documented and correct swapDepths. (fixes displaylist_depths_test6).
	* server/sprite_instance.{cpp,h}: drop dangerous swap_characters,
	  add safe and swapDepths proxy to DisplayList's.

2007-05-11 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: enabled
	  displaylist_depths_test6.swf runner
	* testsuite/misc-ming.all/displaylist_depths_test6.c:
	  Some comments cleanup, and an additional expected failure
	  (slightly unrelated to test focus, I'd say).

2007-05-11 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.h: improved documentation for the
	  add_display_object() method. I think this is where we're going
	  to add a TimelineInfo record (see Timeline Control page on the
	  wiki).

2007-05-11 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/: displaylist_depths_test6.c:
	  new scenario for Timeline Control
	  NOTE: Gnash fails this one !!
	  
2007-05-11 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, displaylist_depths_test5.c:
	  new scenario for Timeline Control (see wiki for more details).
	  NOTE: Gnash fails this one !!

2007-05-10 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, displaylist_depths_test4.c:
	  new scenario for Timeline Control (see wiki for more details).
	  NOTE: Gnash fails this one !!

2007-05-10 Sandro Santilli <strk@keybit.net>

	* testsuite/analyse-results.sh: print an header before the actual
	  results; don't limit depth of search for summary files.
	* Makefile.am, add an anal rule to run the test results analyzer.
	  Run the analyzer at end of 'make check', so the report doesn't
	  scroll-up.
	* testsuite/Makefile.am: don't run the analyzer from testsuite/ dir
	  as it would miss some tests in upper directories.

2007-05-10 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, displaylist_depths_test2.c,
	  displaylist_depths_test3.c: Cleanup comments for test2 and add
	  new scenario for Timeline Control (see wiki for more details).

2007-05-10 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am,
	  SpriteButtonEventsTest-Runner.cpp, SpriteButtonEventsTest.c:
	  Produced a MovieClip versio of the ButtonEventTest.swf movie.
	  Seems to work fine, test automated.

2007-05-10 Sandro Santilli <strk@keybit.net>

	* server/event_id.h, server/vm/action.cpp: add
	  event_id::is_button_event() method
	* server/sprite_instance.{cpp,h}: add isEnabled() method,
	  (on_event): don't react to button events if not enabled.
	* testsuite/misc-ming.all: ButtonEventsTest-Runner.cpp,
	  ButtonEventsTest.c: add test for Button.enable flag.

2007-05-10 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as: more and better tests for
	  MovieClip.enabled.
	* server/sprite_instance.cpp (attachMovieClipInterface): initialize
	  an 'enabled' property in MovieClip.prototype (fixes old and new
	  tests for it in MovieClip.as); 

2007-05-10 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/displaylist_depths_test2.c: target
	  SWF7, use getInstanceAtDepth() to verify Gnash succeeds the
	  test, despite the fact it's "soft references" implementation 
	  is bogus (thanks to zou for the tip!). We might still want a
	  MovieTester based runner to check for rendering in any case,
	  but less urgent...
	* server/sprite_instance.{cpp,h}: Implemented
	  MovieClip.getInstanceAtDepth() and MovieClip.getSWFVersion();
	  stubbed MovieClip.getTextSnapshot().
	* testsuite/actionscript.all/MovieClip.as: tested
	  MovieClip.getSWFVersion() and MovieClip.getInstanceAtDepth().

2007-05-10 Sandro Santilli <strk@keybit.net>

	* server/as_value.{cpp,h}: encoding of movieclip values
	  by target path made optional, to help future attempts
	  at changing it, due to conceptual bug found in it running
	  the displaylist_depths_test2.swf testcase. The default is
	  no change. Undefine MOVIECLIP_AS_SOFTREF to keep them by
	  pointer (still fails some testcases so not enabled).

2007-05-10 Martin Guy <martinwguy@yahoo.it>

	* configure.ac: Don't warn about ffmpeg/mad absence during tests;
	  they are checked and nogoed at the end.
	* configure.ac: Don't report SDL FLAGS and help message twice.
	* macros/ffmpeg.m4: Avoid spurious syntax errors when avcodec not found

2007-05-09 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, displaylist_depths_test2.c:
	  New test showing the effects of a swapDepth moving a static
	  instance to the dynamic zone when jumping back to a frame in which
	  the char is supposed to be at it's original depth.
	  Incredibly, Gnash passes all tests, except a couple which are due
	  to the way we implemented "soft references" and that makes it
	  hard to test for actual existance of the old instance.

2007-05-09 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: fix ambiguous 
	  strk() call  

2007-05-09 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: don't build the
	  alltests-v#-Runners on make check. We dont' use them currently.
	* testsuite/misc-ming.all/: Makefile.am, .cvsignore:
	  Enabled static_vs_dynamic testcases.
	* testsuite/misc-ming.all/static_vs_dynamic1.c: Don't expect a failure
	  as we're not failing :)

2007-05-09 Sandro Santilli <strk@keybit.net>

	* extensions/fileio/fileio.{cpp,h}: don't forget to setup
	  the FileIO exported interface; Fix some const-correctness
	  for the class methods; have seek() return the correct value;
	  cast arguments to the expected type. Needs more love, but
	  I won't give it *now* :)
	* configure.ac: drop unneeded LTVERSION_VERSION macro call.
	* gui/: fltk.cpp, gtk.cpp, sdl.cpp:
	  Check if createRenderHandler of the glue returns
	  NULL, and return false in that case.

2007-05-09 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.cpp (initTestingRenderers): try initializing
	  an AGG renderer for *each* known pixel format.
	* backend/render_handler_agg.{cpp,h} (create_render_handler_agg):
	  Take pixelformat by *const* pointer, do NOT abort when the given
	  pixelformat is unsupported, just return NULL.
	* testsuite/misc-ming.all/action_execution_order_test8.c:
	  Added description as reported on bug #19727.
	* testsuite/misc-ming.all/static_vs_dynamic2.c:
	  Moved description of the test on top.
	* gui/Makefile.am: fixed typo preventing 'dist' to work.
	* testsuite/misc-ming.all/action_execution_order_test8.c:
	  Fixed access to uninitialized memory (segfault).

2007-05-09 Andrew Guertin <bugzilla@dolphinling.net>

	* macros/ming.m4: cleaner fix for #19826 (don't redirect
	  stderr...)

2007-05-09 Sandro Santilli <strk@keybit.net>

	* macros/ming.m4: redirect stderr to /dev/null when using
	  passing the beta version to printf (would complain if
	  the version has no beta component). Closes bug #19826.

2007-05-09 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/static_vs_dynamic1.c, static_vs_dynamic2.c:
	  test what we discussed yestoday.
	  
2007-05-08 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: tolerate
	  a 1-pixel Y drift for the harilined black line, as introduced
	  by latest "pixel hinting" "fix" in AGG (see bug #19775);
	  Also, changed checked point for the diagonal violet line for
	  the same reason. See bug #19828 for more info.
	* extensions/dejagnu/Makefile.am, extensions/gtk2/Makefile.am,
	  extensions/mysql/Makefile.am: remove other direct references
	  to convenience libraries.
	* testsuite/Makefile.am, testsuite/server/Makefile.am:
	  Do not explicitly link convenience libraries under the server/
	  dir. Fixes bug #19821.
	* libbase/extension.cpp: print plugins path.
	* extensions/fileio/Makefile.am: export GNASH_PLUGINS to the buil tree
	  when running the test program.
	* testsuite/generic-testrunner.sh: export any GNASH variable in the
	  environment, so to allow generic test runners to specify a plugin
	  dir, and eventually a GNASHRC file (when we add support for it).
	* Makefile.am (dumpconfig): add info about which extensions are being
	  built (if not null extensions are scanned, would be better to 
	  just report wheter extensions are buil or not instead..)
	* configure.ac: define USE_EXTENSIONS if build of any extension is
	  enabled.

2007-05-08 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: Fix vector alignment ("pixel
	  hinting"). Fixes bug #19775. 

2007-05-08 Sandro Santilli <strk@keybit.net>

	* libbase/LoadThread.h: threading enabled by default.
	* macros/ffmpeg.m4: set LIBS and CFLAGS to the detected or provided
	  values for the macro lifetime, so to more easily find any dependent
	  lib in custom dirs; do not discard user-provided libdir; be more
	  verbose about version checking.
	* server/asobj/NetStream.cpp (fix members initialization order).
	* server/asobj/NetStreamGst.{cpp,h}: Make start thread
	  use a compile-time option. Defaults to true for now,
	  but worth disabling for better testing (btw: why do
	  we need a "start" thread and a "continue" thread?)

2007-05-07 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/FLVParser.cpp: When seeking to 0 just go to
	  the first frames.
	* server/asobj/NetStream.{h,cpp}: Moved setBufferTime() to
	  the base class, implemented bufferTime().
	* server/asobj/NetStreamFfmpeg.{cpp,h}: Moved setBufferTime()
	  to the base class.
	* server/asobj/NetStreamGst.{cpp,h}: Moved setBufferTime() to
	  the base class. tried to improve seeking by using an offset
	  to avoid telling gstreamer about the seek.

2007-05-07 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStream{Ffmpeg,Gst}.cpp: After playback stops,
	  make it possible to restart video by seeking to 0 and setting
	  pause to false.

2007-05-07 Martin Guy <martinwguy@yahoo.it>

	* backend/sound_handler.h: Fix commentary about RAW and UNCOMPRESSED
	  formats.
	* configure.ac: Make absence of ffmpeg or libmad libraries a fatal error
	  when they are selected, instead of quietly turning media handling off.
	* configure.ac: Fix names of Debian packages required for ffmpeg.
	* configure.ac: Fix logic of missing ffmpeg library reporting code.

2007-05-07 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetConnection.cpp (openConnect): print FLV url before
	  setting loader stream so that it's visible before full download in
	  case threading is disabled.
	* libbase/log.h: fully qualify __Host_Function_Report__ so
	  GNASH_REPORT_FUNCTION can be used by classes outside of 'gnash'
	  namespace.
	* libbase/curl_adapter.cpp (fill_cache): avoid aggressive polling by
	  taking naps between iterations. "Smart" sleep times are taken
	  in consideration so we can tweak them.

2007-05-07 Sandro Santilli <strk@keybit.net>

	* libbase/LoadThread.{cpp,h}: Make thread usage a compile-time
	  configuration. Temporarely defaults to NOT using thread till
	  we fix bug #19811 and general CPU hogs during loading.

2007-05-07 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac, gui/aqua*: Added aqua/carbon-stubs.

2007-05-06 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/LoadThread.cpp: Delete the thread after use so we don't
	  try to join it again. Fixes bug #19811.
	* server/asobj/NetStreamGst.cpp: Fixed pausing and play, bug #19797.

2007-05-06 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/sprite_instance.cpp: Stop all sounds when restarting 
	  a movie, fixes bug #19568.
	* server/asobj/NetStreamFfmpeg.cpp: Fixed return time.
	* server/asobj/NetStreamFfmpeg.h: Added a comment.
	* server/asobj/NetStreamGst.cpp: Moved gst-init to the
	  contructor, fixes bug #19795. Only create audio/video elements
	  if needed.

2007-05-04 Sandro Santilli <strk@keybit.net>

	* testsuite/samples/clip_as_button2-TestRunner.cpp: add pixel
	  color checking.
	* testsuite/actionscript.all/NetConnection.as: unexpected success..

2007-05-04 Sandro Santilli <strk@keybit.net>

	* libbase/FLVParser.h (FLVVideoFrame): add isKeyFrame() method;
	  use typedefs for video and audio frame containers.
	* libbase/FLVParser.cpp: use isKeyFrame(), easier to read.

2007-05-04 Sandro Santilli <strk@keybit.net>

	* libbase/FLVParser.cpp (seekAudio, seekVideo): fixed seeking and
	  hopefully made a bit more readable. The computed values are
	  now printed for further debugging. They seem correct to me, but
	  it seems they are not correctly used.
	* server/asobj/: NetStream.{cpp,h}, NetStreamFfmpeg.{cpp,h},
	  NetStreamGst.{cpp,h}: change play() method to take a std::string
	  ref instead of a char*; always pass environment when casting args
	  to numbers or strings.

2007-05-04 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetStream.cpp: stubbed missing methods and
	  properties.
	* libbase/tu_file.cpp (std_get_stream_size_func): use fstat to 
	  get stream size. (other funx for filesystem access): add some assertions
	  to prevent seeking past the end of the stream.
	* libbase/LoadThread.cpp (read): don't seek past the end of the
	  stream. Add a few assertions checking that _loadPosition is
	  never > then _streamSize.

2007-05-04 Markus Gothe <nietzsche@lysator.liu.se>

	* gui/aqua.cpp: Initial creation.

2007-05-04 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/boost.m4: Fixed a bug in GNASH_BOOST_PATH.
	* server/asobj/SoundFfmpeg.h: Build on OS X.
	* backend/sound_handler_sdl.h: Build on OS X.

2007-05-03 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetConnection.{cpp,h}: change openConnection interface
	  to take url by ref (not by pointer) and nothing else (drop owner
	  arg). Stubbed documentation of the method (needs more info).
	* server/asobj/: NetStreamFfmpeg.cpp, NetStreamGst.cpp, Sound.cpp,
	  SoundFfmpeg.cpp, SoundGst.cpp, SoundMad.cpp:
	  Updated calls to openConnection.

2007-05-03 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetConnection.{cpp,h}: keep _loader by auto_ptr, some
	  comments and interfaces cleanup.
	* server/asobj/: NetStreamFfmpeg.cpp, NetStreamGst.cpp: update calls
	  to connectParser(), now taking by ref.

2007-05-03 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetConnection.{cpp,h}: Yay, another ActionScript class
	  layout version. As a side effect stubbed missing properties and
	  methods of the class + cleanups in the connect() method.

2007-05-03 Sandro Santilli <strk@keybit.net>

	* configure.ac: rewording of ffmpeg warnings. Shows a bug in ffmpeg.m4
	  failing to detect version and thus failing to accept it when
	  passed explicit --with-ffmpeg-incl and --with-ffmpeg-lib.
	* server/asobj/: NetStream.{cpp,h},
	  NetStreamFfmpeg.cpp, NetStreamGst.cpp:
	  Use an enum for status codes, avoid notifying multiple
	  times the same status.

2007-05-03 Sandro Santilli <strk@keybit.net>

	* gui/gui.cpp: Add RENDER_ONE_FRAME_EVERY macro to skip
	  rendering of a given fraction of movie frames (for debugging).
	* server/video_stream_instance.cpp (display): call
	  clear_invalidated().

2007-05-03 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/video_stream_instance.cpp: implemented proper 
	  add_invalidated_bounds()

2007-05-03 Sandro Santilli <strk@keybit.net>

	* server/asobj/Makefile.am, server/parser/Makefile.am,
	  server/vm/Makefile.am: -release makes no sense for
	  convenience libraries.
	* testsuite/misc-ming.all/DrawingApiTest.as: reintroduced
	  visual hitTest checks (not automated yet). This time
	  they don't break the exising test.
	* testsuite/MovieTester.{cpp,h}: add redraw() method,
	  by default only force a redraw on *first* advance.

2007-05-03 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_ogl.cpp: Make it work with __APPLE_CC__.

2007-05-03 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (add_empty_movieclip):
	  call set_invalidated as the newly added character might
	  replace a previously existing one. See bug #19683.
	* server/video_stream_instance.{cpp,h},
	  server/parser/video_stream_def.{cpp,h}:
	  Encode ownership of embedded videodecoder by using std::auto_ptr,
	  and document it.
	* server/asobj/NetConnection.cpp (getBytesTotal): return total bytes,
	  not "loaded" bytes... - fixes YouTube buffering bar.

2007-05-03 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: by default use world invalidated
	  bounds (not Null) 	
	* server/character.cpp: negative scaling values are legal (related to 
	  bug #18874, but not fixing it) 	
	* backend/render_handler_agg.cpp: use absolute scaling values when
	  calculating stroke width, fixes 18874  	

2007-05-03 Andrew Guertin <bugzilla@dolphinling.net>

	* backend/: sound_handler.h, sound_handler_gst.cpp,
	  sound_handler_sdl.cpp: Makes Nellymoser not an "unknown" format in
	  the error message, just unsupported, Makes GST's unknown format
	  error message better (copied SDL's), Adds an assertion that
	  ADPCM and UNCOMPRESSED should never be passed to the sound
	  handler, Adds a comment to sound_handler.h

2007-05-02 Sandro Santilli <strk@keybit.net>

	* testsuite/Makefile.am: explicitly list other gnash libs.
	* testsuite/libgeometry/Range2dTest.cpp: tolerate some floating
	  point drift.

2007-05-02 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/Makefile.am: Get sure we link against gettext if found.

2007-05-02  Rob Savoye  <rob@bertha.welcomehome.org>

	* po/Makefile.am: We don't need $(srcdir) since we're specifing
	the directory.
	* server/asobj/Makefile.am: Make libgnashasobjs a a convienience
	library. 
	* server/parser/Makefile.am: Make libgnashparser a a convienience
	library. 
	* server/vm/Makefile.am: Make libgnashvm a a convienience
	library. 
	* utilities/Makefile.am: Don't link in all the other libraries.
	* gui/Makefile.am: Don't link in all the other libraries.

	* libbase/curl_adapter.cpp: Don't redefine snprintf() for win32.
	* libbase/noseek_fd_adapter.cpp: Don't redefine snprintf() for
	win32.
	* libbase/log.h: Include io.h for win32.
	* libbase/network.cpp: Use inet_ntoa() instead of the newer
	inet_ntop(). Include ws2tcpip.h for win32.
	* libbase/tu_timer.cpp: Use lowercase mmsystem.h.
	* libbase/tu_types.h: Don't use __FUNCDNAME__ to redefine
	__PRETTY_FUNCTION__for all win32 builds.
	* macros/boost.m4: Remove extraneous boost directory when
	searching for header files.

2007-05-02 Sandro Santilli <strk@keybit.net>

	* libbase/curl_adapter.cpp (fill_cache): stop uselessly calling
	  fstat(); don't call curl_multi_perform if not needed.
	* libbase/log.cpp: call the logfile singletone getter only once.
	* libbase/image.{cpp,h}: move documentation of the update() method
	  from cpp to h file. This is the most time-expensive routine in 
	  libgnashbase when playing youtube.
	* libbase/LoadThread.{cpp,h}: isPositionConfirmed inlined and
	  const-corrected.

2007-05-02 Martin Guy <martinwguy@yahoo.it>

	* libbase/tu_config.h,libbase/jpeg.cpp,server/swf/tag_loaders.cpp,
	  compatibility_include.h: Having jpeglib is compulsory, so
	  remove TU_CONFIG_LINK_TO_JPEGLIB
	* Revert attempt to use endian.hpp. It broke someone's build. QED.
	* gui/fb.cpp: Fix compiler warnings
	* libbase/tu_config.h,server/swf/tag_loaders.cpp: Allow compilation
	  without zlib, auto-switching TU_CONFIG_LINK_TO_ZLIB on HAVE_ZLIB_H
	  (works with renderer=agg/opengl, gui=fb/sdl, media=gst/mad/none;
	  gtk/kde, cairo, ffmpeg require zlib in their own right)
	* configure.ac: Reformat messages
	* libbase/tu_config.h,libbase/zlib_adapter.{cpp,h},server/tools.cpp,
	  server/{impl.cpp,parser/movie_def_impl.cpp,swf/tag_loaders.cpp},
	  compatibility_include.h: eliminate TU_CONFIG_LINK_TO_ZLIB;
	  use HAVE_ZLIB_H directly.
	* configure.ac: Suggest packages to install when zlib-dev is missing
	* configure.ac,macros/ffmpeg.m4: Fix quotation in ffmpeg detection and
	  skip version checking to avoid syntax errors during "configure"
	  if the library is not found.
	* server/asobj/SoundMad.cpp: Fix compiler warnings.
	* gui/sdl.cpp: Regularize bizarre indentation
	* gui/sdl.cpp: A closer hack at making movies run at correct speed.
	  Before: always at 100 frames per second + cpu time.
	  After: Still not perfect: in non-interactive movie, visuals are a
	  fraction of a second ahead of MP3 soundtrack.

2007-05-02 Sandro Santilli <strk@keybit.net>

	* backend/sound_handler_gst.cpp, gui/Player.cpp, libamf/amf.cpp,
	  libbase/log.h, server/as_function.cpp, server/swf/tag_loaders.cpp,
	  server/button_character_instance.cpp, server/character.cpp,
	  server/sprite_instance.cpp, server/asobj/NetStreamGst.cpp:
	  Drop log_warning, till we find a semantic for it.

2007-05-02 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (sprite_getBounds): remove TESTING
	  warning, I'm pretty confident about this function now.

2007-05-01  Rob Savoye  <rob@bertha.welcomehome.org>

	* libamf/Makefile.am: Add BOOST_CFLAGS so we can find endian.hpp.

2007-05-01 Sandro Santilli <strk@keybit.net>

	* server/asobj/: NetStream.{cpp,h}, NetStreamFfmpeg.{cpp,h},
	  NetStreamGst.{cpp,h}: move all onStatus handling to base class
	  and made thread safe.

2007-05-01 Sandro Santilli <strk@keybit.net>

	* server/movie_root.h: add getWidth() and getHeight()
	* server/asobj/Stage.{cpp,h}: implement Stage.width and
	  Stage.height.
	* testsuite/actionscript.all/Stage.as: small test for
	  Stage.width and Stage.height (not automated)

2007-04-30 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/swfdec_gnash_tester: allow 11 loop-backs.
	* testsuite/swfdec/PASSING: function1.swf now succeeds.

2007-04-30 Sandro Santilli <strk@keybit.net>
		
	* testsuite/libamf.all/Makefile.am: proper clean rule.
	* testsuite/misc-ming.all/Makefile.am: proper clean rule.
	* doc/C/Makefile.am: distribute actionscript.xml and related
	  files.

2007-04-30 Martin Guy <martinwguy@yahoo.it>

	* backend/sound_handler_sdl.cpp: Fix volume scaling in 8->16 bit
	  raw data conversion (closes bug #19747)
	  and convert cascaded ifs to a case.

2007-04-30 Sandro Santilli <strk@keybit.net>

	* Makefile.am: don't put 'po' in EXTRA_DIST, as it's already
	  in SUBDIRS.
	* server/StringPredicates.h: include cctype.
	  See: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=417210.
	* po/Makefile.am: don't update the .po files on every .gmo
	  production. Produce the .gmo in the build tree, not in the
	  source tree.

2007-04-30 Martin Guy <martinwguy@yahoo.it>

	* libbase/tu_types.{h,cpp}, server/swf/tag_loaders.cpp:
	  Eliminate remnants of _TU_LITTLE_ENDIAN_
	* configure.ac: Drop now-redundant endian header detection
	* libamf/amf.{h,cpp}: swapBytes is now file-local and uses libboost

2007-04-30 Sandro Santilli <strk@keybit.net>

	* autogen.sh: only process configure.ac in root dir and under libltdl,
	  running a find annoingly descends in just generated dist dirs.
	* testsuite/samples/Makefile.am: distribute gotoFrameOnKeyEvent.swf.
	* testsuite/actionscript.all/array.as: add test for deleting an
	  array element, and for array indexes being proper properties
	  (fails in gnash).
	* configure.ac: if ffmpeg version doesn't match the required one
	  set media handling to none.
	* testsuite/misc-ming.all/action_execution_order_test8.c: add
	  more output trying to understand the problem better.
	* server/parser/shape_character_def.cpp (compute_bounds): harline
	  strokes don't add anything to the bounds (no need to expand to
	  circle, same as for hidden strokes).
	* testsuite/misc-ming.all/Makefile.am: 
	  Activated action_execution_order_test{7,8}.

2007-04-30 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/action_execution_order_test7.c:
	  a simple and normal one that we should pass.
	* testsuite/misc-ming.all/action_execution_order_test8.c:
		another one for execution order.
	  
2007-04-29 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, DrawingApiTest.as: add
	  tests for hitTest (not automatically run, but works fine so far).
	* server/button_character_instance.{cpp,h}: implement pointInShape().

2007-04-28 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionWith): skip with() blocks
	  given a parameter not casting to an object.
	* testsuite/actionscript.all/with.as: 
	  Add tests explaining why the tests in previous
	  commit are failing in SWF5 version.

2007-04-28 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/actionscript.all/with.as:
	  add more tests

2007-04-28 Sandro Santilli <strk@keybit.net>

	* server/as_environment.{cpp,h}: stop descending
	  the CallStack looking into the callers locals!
	* testsuite/actionscript.all/Function.as: success
	  with SWF5 and (missing) scope chain.

2007-04-27  Rob Savoye  <rob@pawnee.welcomehome.org>

	* gui/fltk.cpp: Cast the key::code so it compiles on Darwin.
	* macros/agg.m4: Don't inherit the -rpath setting fropm
	pkg-config, it screws up the linux on Darwin.
	* macros/incllist, libslist: Look in $with_top_level for support
	packages no in the $prefix path.
	* macros/pthreads.m4: Add -mthreads for mingw32.
	* macros/x11.m4: If X11 is found, also add libSM and libICE if
	they are found to resolve dependencies on Darwin.
	* server/Makefile.am: Remove -no-undefined as it cause dependency
	problems on Darwin.
	* server/vm/Makefile.am: Remove -no-undefined as it causes
	inter-library dependency problems on Darwin.
	* server/parser/Makefile.am: Remove -no-undefined as it causes
	inter-library dependency problems on Darwin.
	* server/asobjsMakefile.am: Remove -no-undefined as it causes
	inter-library dependency problems on Darwin. Add libgeo to the
	link line.
	* server/vm/VM.cpp: Don't use the gnash:: namespace with setting
	the global singleton, it won't compile on Darwin.

2007-04-27 Sandro Santilli <strk@keybit.net>

	* server/swf/PlaceObject2Tag.cpp (readPlaceActions): fix check for
	  all reserved bits being zero (removed an annoying false malformed
	  swf error).
	* gui/gtk.cpp: comment out function tracing for key and mouse events.

2007-04-27 Martin Guy <martinwguy@yahoo.it>

	* configure.ac: Add verbose text for missing gstreamer-dev help

2007-04-27 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-mtasc.all/README: some info about the MTASC
	  testing framework.
	* testsuite/actionscript.all/Global.as: check that _global._global
	  is undefined.
	* testsuite/actionscript.all/Function.as: add another test for
	  nested functions and scope chain.

2007-04-27 Sandro Santilli <strk@keybit.net>

	* server/as_environment.{cpp,h}: changed the ScopeChain
	  typedef to be just a vector of as_objects.
	* server/swf_function.{cpp,h}: take a vector of as_objects
	  as ScopeChain, rather then with_entry vector...
	* server/vm/ActionExec.{cpp,h}: only expose the ScopeChain,
	  not the 'with' stack. When constructed for a function, push
	  the function's activation object to the ScopeChain.
	* server/vm/ASHandlers.cpp: update calls to ActionExec and
	  swf_function when it comes to setting the ScopeChain.
	* testsuite/actionscript.all/Function.as: the scope chain test kai
	  added now succeeds.
	* testsuite/swfdec/PASSING: function-scope-6.swf and function-scope-7.swf
	  now succeed.

2007-04-27 Sandro Santilli <strk@keybit.net>

	* libgeometry/snappingrange.h: add contains(SnappingRange2d) method;
	  fixed contains(Range2d) to take a const ref rather then a value.
	* testsuite/libgeometry/snappingrangetest.cpp: add tests for
	  contains(SnappingRange2d).
	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: add test for
	  renderer and invalidated bounds.

2007-04-27 Sandro Santilli <strk@keybit.net>

	* gui/gui.cpp: add a DEBUG_MOUSE_COORDINATES define, for making
	  writing test runners easier.
	* testsuite/swfdec/swfdec_gnash_tester: use the .trace.org files when
	  avaiable, as in that case it means that the .trace are just swfdec
	  results (Ben is cheating !)
	* testsuite/swfdec/PASSING: double.swf fails again.

2007-04-27 Sandro Santilli <strk@keybit.net>

	* server/as_value.{cpp,h}: add a static doubleToString(double) function
	  moved here from a static in Number.cpp, given its good quality.
	* server/asobj/Number.cpp: use as_value::doubleToString() for
	  returning text value. Drop the string representation cache, no
	  more needed.
	* testsuite/swfdec/PASSING: double.swf now succeeds

2007-04-27 Sandro Santilli <strk@keybit.net>

	* libbase/triangulate_impl.h: include config.h.
	* libbase/network.{cpp,h}: (writeNet): take a const string ref, not a
	  copy.
	* cygnal/: http.cpp, netstats.cpp, statistics.cpp, stream.cpp:
	  Hush compiler.

2007-04-27 Zou Lunkai <zoulunkai@gmail.com>

	* server/asobj/Key.{cpp,h}:
	  cleanups; don't invoke user defined onKeyPress(), it's just a 
	  normal function.
	* server/movie_root.cpp.h, server/sprite_instance.cpp:
		cleanups and add some comments. don't set m_has_key_event when there 
		is a user defined onKeyPress() function.
	* testsuite/misc-ming.all/key_event_testrunner.cpp:	  
		more tests.
	  
2007-04-26  Rob Savoye  <rob@ute.welcomehome.org>

	* Makefile.am: Add po to EXTRA_DIST.
	* configure.ac: Set a conditional for gettext. Build po/Makefile
	now.
	* libbase/Makefile.am: Build all libraries with a release number,
	and add --export-dynamic and -no-undefined. Add gettext.h.
	* backend/Makefile.am: Build all libraries with a release number,
	and add --export-dynamic and -no-undefined.
	* server/Makefile.am: Build all libraries with a release number,
	and add --export-dynamic and -no-undefined.
	* libgeometry/Makefile.am: Build all libraries with a release
	number, and add --export-dynamic and -no-undefined.
	* server/vm/Makefile.am: Build all libraries with a release
	number, and add --export-dynamic and -no-undefined.
	* server/parser/Makefile.am: Build all libraries with a release
	number, and add --export-dynamic and -no-undefined.
	* server/asobjs/Makefile.am: Build all libraries with a release
	number, and add --export-dynamic and -no-undefined.
	* extensions/dejagnu/dejagnu.cpp: Use instrusive pointers instead
	of hard pointers for handlers.
	* extensions/fileio/fileio.cpp: Use instrusive pointers instead
	of hard pointers for handlers.
	* extensions/mysql/mysql_db.cpp: Use instrusive pointers instead
	of hard pointers for handlers.
	* extensions/gtk2/gtkext.cpp: Use instrusive pointers instead
	of hard pointers for handlers.
	
2007-04-26 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Function.as: add a test
	  showing an incompatibility of flash with ECMA262 when
	  it comes to the 'arguments' object in functions activation
	  object.

2007-04-26 Sandro Santilli <strk@keybit.net>

	* server/as_value.cpp (equals): compare m_object_value when both 
	  operatns are either functions or objects.
	* server/as_environment.{cpp,h} (get_variable, get_variable_raw,
	  findLocal): accept an additional argument to return the target
	  object the variable was found in.
	* server/vm/ActionExec.{cpp,h}: provide an additional getVariable
	  method accepting an as_object pointer to return the target object
	  a variable was found in.
	* server/vm/ASHandlers.cpp (ActionCallFunction): set the 'this'
	  pointer to the object found to contain the function.
	* testsuite/actionscript.all/Function.as: more successes.

2007-04-26 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp (get_variable_raw): elements of 
	  the 'with' stack take precedence over locals.
	  See test in Function.as.
	* testsuite/actionscript.all/Function.as: add test for 'with'
	  stack taking precedence over locals when getting variables.

2007-04-26 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Function.as: test for 'this' in
	  local function.
	* server/as_environment.{cpp,h}: refactor local variables
	  so they are stored into a proper object. Will help introducing
	  a VariableRef class that associates a Property to an as_object.

2007-04-26 Sandro Santilli <strk@keybit.net>

	* server/as_environment.h, server/movie_root.h,
	  server/sprite_instance.h, server/vm/action.cpp:
	  Remove some unused code, remove Id tags from headers.

2007-04-26 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/key_event_testrunner.cpp: no more
	  failures expected (thanks kai).
	* server/as_value.cpp (to_primitive): fix missing return
	  from non-void function.

2007-04-26 Zou Lunkai <zoulunkai@gmail.com>

	* server/asobj/Key.h
	  change "Event_id.h" to "event_id.h"
	* server/event_id.h
	  forgot to commit it in last commit
	
2007-04-26 Zou Lunkai <zoulunkai@gmail.com>

	* server/vm/action.cpp:
	  add is_key_event() method
	* server/asobj/Key.{h, cpp}:
	  change notify_listeners() to public; set_key_down() and set_key_up()
	  don't trigger event handler now.
	* server/button_character_instance.cpp:
	* server/edit_text_character.cpp:
	  replace *_keypress_listener() to *_key_listener()
	* server/character.{h, cpp},server/movie_root.{h, cpp}
	  trigger onClipKeyUp and onClipKeyDown event handlers
	* server/sprite_instance.{h, cpp}
	  bypass user defined key events in on_event(), let the global key object 
	  take over user defined key events.	
	* testsuite/misc-ming.all/key_event_testrunner.cpp
	  enable all checks

2007-04-26 Sandro Santilli <strk@keybit.net>

	* server/as_value.{cpp,h}: to_primitive() made private, and had
	  calling any user-defined valueOf for objects; (equals): only
	  return false when to_primitive() returns the same type we were 
	  already.
	* testsuite/actionscript.all/Function.as: two more successes.

2007-04-26 Sandro Santilli <strk@keybit.net>

	* server/as_value.cpp (equals): don't abort on object==movieclip !
	* testsuite/actionscript.all/Function.as: add more tests 'this'
	  reference in 'with' and 'function' scope (see bug #19704).

2007-04-26 Sandro Santilli <strk@keybit.net>

	* server/array.h, server/as_environment.cpp, server/as_function.h,
	  server/as_object.cpp, server/as_object.h, server/character.cpp,
	  server/character.h, server/edit_text_character.cpp,
	  server/edit_text_character.h, server/asobj/Boolean.cpp,
	  server/asobj/Color.cpp, server/asobj/ContextMenu.cpp,
	  server/asobj/CustomActions.cpp, server/asobj/Error.cpp,
	  server/asobj/LoadVars.cpp, server/asobj/Microphone.cpp,
	  server/asobj/Mouse.cpp, server/asobj/Number.cpp,
	  server/asobj/Selection.cpp, server/asobj/SharedObject.cpp,
	  server/asobj/Stage.h, server/asobj/TextSnapshot.cpp,
	  server/asobj/Video.cpp, server/asobj/gen-asclass.pl,
	  server/asobj/gen-asclass.sh, server/asobj/string.cpp,
	  testsuite/server/GetterSetterTest.cpp:
	  Changed get_text_value interface to return by std::string
	  value. Closes bug #19695.
	
2007-04-25  John Gilmore  <gnu@toad.com>

	* README, README_CVS:  Improve configuration instructions.
	  More work is needed to make it match the code.
	* po/.cvsignore:  Ignore all generated .gmo files.

2007-04-25 Sandro Santilli <strk@keybit.net>

	* README_CVS: some info for CVS users.
	* doc/C/asspec/date.xml: fixed typos preventing the asspec
	  from building.
	* doc/C/asspec/movieclip.xml: add docs and conformancy for
	  a few methods.

2007-04-25 Martin Guy <martinwguy@yahoo.it>

	* ChangeLog,server/debugger.{cpp,h},server/vm/ActionExec.cpp:
	  spello dissasemble -> disassemble
	* macros/lib-ld.m4(removed),macros/lib-link.m4:
	  remove repeated test for GNU ld (libtool does this).
	  Closes bug #19623
	* libamf/amf.cpp,libbase/tu_swap.h,server/parser/action_buffer.cpp,
	  server/swf/tag_loaders.cpp:
	  Replace compile-time endianness checking with runtime because
	  it costs almost nothing and reduces maintenance forever.
	  As a side-effect, also now handles architectures with
	  middle-endian IEEE754 doubles and detects non-IEEE arches.
	  Only the Mozilla devkit stuff now detects endianness
	  using its own set of built-in rules.

2007-04-24 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (sprite_hit_test): implement
	  hitTest() - not all call types tested.

2007-04-24 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: globalToLocal and localToGlobal
	  implemented.
	* testsuite/actionscript.all/MovieClip.as: test localToGlobal
	  and globalToLocal.

2007-04-24 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: stubbed localToGlobal and setMask
	* testsuite/actionscript.all/MovieClip.as: test availability of
	  localToGlobal and setMask.
	* testsuite/misc-ming.all/: Makefile.am, DrawingApiTest.as,
	  DrawingApiTestRunner.cpp: Prepared a test for invalidated
	  bounds checking. Gnash clearly fails, but no actual automated
	  tests added to the test runner yet.

2007-04-24 Sandro Santilli <strk@keybit.net>

	* server/vm/ActionExec.{cpp,h}: add delObjectMember() method.
	* server/vm/ASHandlers.cpp (ActionDelete): hopefully fixed -
	  at least as far as we can tell...
	* testsuite/actionscript.all/delete.as: more tests for ActionDelete.

2007-04-24  Rob Savoye  <rob@ute.welcomehome.org>

	* configure.ac: Remove --enable-extension. Add --with-extensions=
	that takes a comma delimited list of extension so you can seclect
	with ones you want to build.
	* Makefile.am: Always add the extensions directory.
	* extensions/Makefile.am: Use new conditionals to select builds
	directories.
	* cygnal/cygnal.cpp: Include posix_time.hpp.
	* extensions/fileio/fileio.cpp: Use intrusive pointers instead of
	explicit pointers.

2007-04-24 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* libgeometry/Range2d.h: added expandToCircle()
	* server/rect.h: added expand_to_circle()
	* server/parser/shape_character_def.cpp: corrected compute_bound()
	  to respect outline widths
	* testsuite/libgeometry/Range2dTest.cpp: added test for 
	  expandToCircle()
	    	
2007-04-24 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: DrawingApiTest.as,
	  DrawingApiTestRunner.cpp: Add a circle drawing and
	  test for collision detection of curved fills.

2007-04-24 Sandro Santilli <strk@keybit.net>

	* server/shape.{cpp,h} (point_test): only check for the
	  "interior" of the shape, forget its boundaries.
	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: one
	  more success.

2007-04-24 Sandro Santilli <strk@keybit.net>

	* server/shape.{cpp,h}: const-corrected point_test and
	  wihinSquareDistance();
	* server/sprite_instance.cpp (sprite_lineStyle): alpha value is given
	  in percent, always pass the env to number converters.
	* testsuite/misc-ming.all/DrawingApiTest.as: add test checking that
	  valueOf is invoked on arguments.
	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: more successes.

2007-04-24 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (on_event): call user-defined function
	  even if clip-events have been found.
	* testsuite/misc-ming.all/action_execution_order_extend_test.c:
	  one more success.
	* testsuite/swfdec/PASSING: event-order.swf now succeeds.
	* testsuite/swfdec/gen_run_swfdec_testsuite.sh: match full lines
	  in the PASSING file, to avoid partial mathes.
	* server/shape.cpp: substitute hash_wrapper with std::map,
	  cleanups.

2007-04-24 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/Makefile.am
	  activate testcases committed yestoday
	* testsuite/misc-ming.all/key_event_test.c
	  fix a typo
	* server/swf/PlaceObject2Tag.{h,cpp}
		minor clean up, keep the "all_event_flags" for future use.
	  
2007-04-23 Sandro Santilli <strk@keybit.net>

	* server/DynamicShape.{h,cpp} (lineStyle): add a line style even
	  if it is for specifying a thickness of 0 (hairline);
	  add a resetLineStyle() function for dropping any style.
	* server/sprite_instance.{cpp,h}: add resetLineStyle() for
	  drawing api.
	* server/parser/shape_character_def.cpp (point_test_local):
	  Use a tolerance of a single twip distance when detecting
	  collision of hairlined strokes.
	* testsuite/misc-ming.all/DrawingApiTest.as: add more comments, and
	  an hairlined line.
	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: more tests.

2007-04-23 Sandro Santilli <strk@keybit.net>

	* server/shape.{cpp,h}: add path::withinSquareDistance.
	* server/types.cpp (point::distance): return 0 for 0 squaredDistance
	  (not 1).
	* server/parser/shape_character_def.cpp (point_test_local):
	  test for point falling in the shape stroke, taking thickness
	  in consideration.
	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: more
	  tests.

2007-04-23 Sandro Santilli <strk@keybit.net>

	* server/shape.{cpp,h}: add primitive distance functions
	  for point-segment
	* testsuite/server/: Makefile.am, EdgeTest.cpp: add tests 
	  for point-segment distance.

2007-04-23 Sandro Santilli <strk@keybit.net>

	* server/: gnash.h, types.cpp: add point::distance() and
	  squaredDistance()
	* testsuite/server/: Makefile.am, PointTest.cpp: point tests.

2007-04-23 Sandro Santilli <strk@keybit.net>

	* server/cxform.{cpp,h}: add output operator and toString method.
	* server/DynamicShape.cpp (moveTo): do not reset current
	  fill style on move. Fixes some of the tests in DrawingApiTest.swf
	  and masks_test.swf.
	* testsuite/misc-ming.all/: DrawingApiTestRunner.cpp,
	  masks_testrunner.cpp: some more successes.

2007-04-23 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: DrawingApiTest.as,
	  DrawingApiTestRunner.cpp: add rendering tests.
	  Add a drawing in which move() is called after beginFill()
	  to confirm the fill is not reset after move().

2007-04-23 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, masks_test.c,
	  masks_testrunner.cpp: Add a MovieTester based test runner
	  for the masks_test movie. Shows a bug in either the renderer
	  or in the core preventing rendering of dynamic clips.
	* libgeometry/snappingrange.h: add unconditional visitor; add
	  cast operator; add contains(Range2d); add scale(factor).
	* testsuite/MovieTester.{cpp,h}: add a getInvalidatedRanges function;
	  drop getInvalidatedBounds one.
	* testsuite/libgeometry/snappingrangetest.cpp: test contains(Range)
	  and cast to int.
	* testsuite/misc-ming.all/simple_loop_testrunner.cpp: update
	  to use the new getInvalidatedRanges.

2007-04-23 Sandro Santilli <strk@keybit.net>

	* libgeometry/snappingrange.h: define the SnappingRanges2d<> in
	  the gnash::geometry namespace. Keep InvalidatedBounds in the
	  gnash namespace, for simplicity.
	* testsuite/misc-ming.all/simple_loop_testrunner.cpp: 
	  Use contains, not intersects, when testing invalidated bounds.

2007-04-23 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/event_handler_scope_test.c
	  testcase for scope in event handlers
	* testsuite/misc-ming.all/key_event_test.c, key_event_testrunner.cpp
	  testcase for key events
	  
2007-04-21 Sandro Santilli <strk@keybit.net>

	* server/: movie_root.{cpp,h}, sprite_instance.{cpp,h},
	  asobj/LoadVars.cpp: nuke ptr_list use so that boost 1.32
	  (version in Debian stable) is still usable.

2007-04-21  John Gilmore  <gnu@toad.com>

	* plugin/plugin.cpp:  In the child process, before executing
	  gnash, close all the file descriptors we inherited from the
	  browser (except stdout and stderr).

2007-04-20 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.{cpp,h}: reworked the
	  pixel checking interface to not force moving
	  the pointer (as moving the pointer might trigger
	  movie events, as was happening with the ButtonEvent
	  test).
	* testsuite/misc-ming.all/ButtonEventsTest-Runner.cpp:
	  All tests pass now.
	* testsuite/misc-ming.all/attachMovieTestRunner.cpp:
	  Updated to work with the correct interface.

2007-04-20 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.{cpp,h} (advance): advance
	  first, *then* render. Cache invalidated bound to
	  avoid loosing them.
	* testsuite/misc-ming.all/attachMovieTestRunner.cpp:
	  Add renderer tests.
	* testsuite/misc-ming.all/ButtonEventsTest-Runner.cpp:
	  Take the covering clip in consideration while testing
	  the renderer - there are a few xfailed that I'd like
	  to fix.

2007-04-20 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler.h (getAveragePixel):
	  fix computation of max x/y values.
	* server/character.h: character are not masks by default
	* server/character.h, server/sprite_instance.cpp: when placing
	  new characters, disable clip_depth (zero is a valid depth)  	

2007-04-20 Sandro Santilli <strk@keybit.net>

	* testsuite/FuzzyPixel.h: const-correctness
	* testsuite/MovieTester.{cpp,h}: prepared for working
	  with all render handlers, implemented support for
	  a single one (AGG only for now); provided 
	  check_pixel and xcheck_pixel macros.
	* testsuite/misc-ming.all/ButtonEventsTest-Runner.cpp:
	  Test pixel checker (doesn't work).

2007-04-20 Sandro Santilli <strk@keybit.net>

	* server/types.{cpp,h}: add toShortString, for neater output.
	* libgeometry/snappingrange.h: add output operator.
	* server/debugger.cpp, server/parser/action_buffer.cpp,
	  server/vm/ActionExec.cpp: don't force creation of the
	  SWFHandlers singleton too early, this hopefully means
	  at time of initialization the VM version will be known.
	* backend/render_handler.h: remove unused parameter warnings.
	  [  I'm afraid this will confuse doxygen :(  ]

2007-04-20  John Gilmore  <gnu@toad.com>

	More internationalization.
	* po/POTFILES.in:  Add all files with gettext-able messages.
	* po/gnash.pot:  Update to include current gettext-able messages.
	* po/{es,fr}.po:  First few languages that have a few translations.
	* po/LINGUAS:  Add es and fr (with only a few translations in each).
	* README:  Gettext program is now a required prerequisite for clean
	  builds of gnash.  (We use the msgfmt program for compiling
	  translations.)

2007-04-20 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler.h: Prototype for initTestBuffer()
	* backend/render_handler_agg.{cpp,h}: implement initTestBuffer() 
		
2007-04-20 Sandro Santilli <strk@keybit.net>

	* testsuite/: Makefile.am, FuzzyPixel.{cpp,h}, 
	  MovieTester.{cpp,h}: framework for renderers
	  testing, needs changes in render_handler to complete.
	  See task #6785.

2007-04-20 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/masks_test.c: draft masks test.
	* doc/C/asspec/movieclip.xml:
	  Dumped a bit of info about _name. Hopefully Ann will give it some
	  formatting.
	* testsuite/misc-ming.all/: Makefile.am, ButtonEventsTest-Runner.cpp:
	  Allow execution of the test runner from a foreign dir.

2007-04-20 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/actionscript.all/MovieClip.as
	  change undefined to a null string.
	  change check to xcheck, add warnings
	  
2007-04-19 Sandro Santilli <strk@keybit.net>

	* server/as_value.cpp (equals): comment out debugging line.
	* testsuite/actionscript.all/MovieClip.as: check that
	  changing a _parent._name changes own _target.
	  WARNING: our soft references are bogus !!

2007-04-19 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/character.{h,cpp}, server/sprite_instance.{h,cpp}: 
	  moved getTarget(), getTargetPath(),
	  get_text_value() to character class so that button instances
	  can deal with "targets" too.
	* server/character.{h,cpp}: implemented "_target" getter-setter	  
	* server/button_character_instance.cpp: added _target getter-setter 
	
2007-04-19 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Number.as:
	  Re-enabled a big block of tests accidentally left
	  cut out. Expect less failures also ! :)

2007-04-19 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/misc-ming.all/matrix_test.c: use Math.round() to
	  really be tolerant	

2007-04-19 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/matrix_test.c: tolerate an 
	  error of 1/100 when testing _rotation.

2007-04-19 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/libamf.all/test_*.cpp: added dummy main() function
	  for the case when HAVE_DEJAGNU_H is not set	

2007-04-19 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Some platforms apparently define SIZET_FMT as
	signed long; add a test for it. Also, use gnashpkgtool.m4 to
	look for dejagnu.h as it is not guaranteed to be in the default
	compiler search path, especially on non-GNU platforms.

2007-04-19 Martin Guy <martinwguy@yahoo.it>

	* testsuite/actionscript.all/Date.as: Change case-[in]dependent
	  method existence detection strategy to see if it fixes v5 testrun.
	* testsuite/libamf.all/test_{object,string,variable}.cpp,
	  testsuite/server/DisplayListTest.cpp,
	  testsuite/misc-ming.all/{PlaceObject2Test,root_stop_test}.c,
	  testsuite/misc-ming.all/action_execution_order_test6.c:
	  Drop/comment unused variables.
	* server/as_value.cpp: Remove vestiges of rejected fix to
	  Number(<function>) (reported as a bug instead)
	* testsuite/actionscript.all/Date.as: Remove tests that fail, including
	  those due the above bug.

2007-04-19 Sandro Santilli <strk@keybit.net>

	* server/asobj/string.cpp: add valueOf own property to String
	  prototype.
	* server/as_value.{h,cpp}: add equalsSameType() function;
	  fix bugs in to_number for function values (version-sensitive it
	  seems); modify equality and inequality operators to follow
	  strict equality semantic.
	* testsuite/movies.all/gravity_embed-TestRunner.cpp: be aware when
	  comparing as_value types, comparisons are strict now!
	* testsuite/swfdec/PASSING: divide-7.swf and object-math-7.swf now
	  succeed.
	* testsuite/actionscript.all/Global.as: small test for isNaN
	  availability
	* testsuite/actionscript.all/Number.as: tests for
	  convertion-to-number.
	* testsuite/actionscript.all/String.as: test valueOf being a property
	  of String.prototype.

2007-04-19 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/duplicate_movie_clip_test.c
	  more tests.
	* libbase/tu_types.h
	  drop SDL integer types 
	* server/cxform.h
	  replace inttypes.h with tu_types.h, hopefully more portable
	* server/vm/action.cpp
	  type definition, get rid of compiler warning
	  
2007-04-18 Sandro Santilli <strk@keybit.net>

	* server/BitmapMovieInstance.cpp: make sure
	  the bitmap character is not considered a mask (sic).
	* testsuite/MovieTester.{cpp,h}:
	  Added interfaces for testing pixel values.
	  Next step would be actually initializing
	  a renderer during testing (if requested, maybe?)

2007-04-18 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler.h: renamed get_pixel() to getPixel() and
	  changed from void to bool return value
	* backend/render_handler.h, backend/render_handler_agg.cpp: 
	  implemented getAveragePixel()
	
2007-04-18 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.h: add click() method.
	* server/BitmapMovieInstance.cpp: place the
	  bitmap character in the "static depth" zone
	  to forbid removal (might still be not enough).
	* testsuite/misc-ming.all/loadMovieTest.c: have
	  the clear button remove the clips, not just clear them
	* testsuite/misc-ming.all/loadMovieTestRunner.cpp:
	  check use of the 'scribble' and 'clear' buttons.

2007-04-18 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/NetStreamFfmpeg.cpp: Fix compile-breaking typo.
	* server/swf/tag_loaders.cpp: Reformat bizarre indentation caused
	  by someone editing with hard tabs set to 4.
	* server/asobj/Date.cpp: Fix signed/unsigned compiler warning.
	* libbase/container.h, doc/C/actionscript/as_value.xml:
	  Expunge the last references to tu_string.
	* libbase/tu_file.h: Purge endian dependence, add \brief to methods.
	* backend/sound_handler_sdl.cpp: Remove commented-out stuff
	* server/swf/tag_loaders.cpp: Remove commented-out stuff

2007-04-18 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/character.h, server/dlist.cpp, server/swf/PlaceObject2Tag.cpp:
	  make masks work again, introduce isMask()   
		
2007-04-18 Martin Guy <martinwguy@yahoo.it>

	* configure.ac: Introduce HAVE_LONG_TIMEZONE if extern long timezone
	  exists, and HAVE_TM_GMTOFF if struct tm has member tm_gmtoff.
	* doc/C/asspec/date.xml: first draft
	* server/asobj/Date.cpp: Complete its implementation
	* server/asobj/Global.cpp: Use definitions of NAN and INFINITY from	
	  as_value.h
	* server/as_value.h: add definition for INFINITY, as for NAN
	* server/as_value.cpp: Reject accidental "Infinity" and "-Infinity"
	  string-to-number conversions (should give NaN);
	  Use NAN from as_value.h;
	  Conversion of an AS function to a number gives NaN, not 0.
	* testsuite/actionscript.all/Date.as: Add extensive constructor tests

2007-04-18 Sandro Santilli <strk@keybit.net>

	* server/matrix.{cpp,h}: add transform_by_inverse(point&).
	* server/character.h: add pointInBounds, pointInShape() and
	  pointInVisibleShape() new methods; document
	  get_topmost_mouse_entity.
	* server/edit_text_character.{h,cpp}: implement pointInShape.
	* server/generic_character.{h,cpp}: implement pointInShape.
	* server/sprite_instance.{h,cpp}: implement pointInShape
	  and pointInVisibleShape; fix get_topmost_mouse_entity
	  implementation.
	* server/parser/character_def.h: document point_test_local.
	* testsuite/misc-ming.all/duplicate_movie_clip_test.c: don't 
	  expect a failure.
	* testsuite/misc-ming.all/loadMovieTestRunner.cpp: add two
	  small tests checking that the new two small buttons
	  are clickable. Needs more tests actually clicking those
	  buttons.

2007-04-18  John Gilmore  <gnu@toad.com>

	* Internationalization, phase 2.
	
	* These modules have had their printed messages passed through
	  _(...).  Those messages have also been cleaned up, thusly:
	    *  Stray \n's removed
	    *  Exclamation points and periods removed at ends of messages
	    *  Typos corrected, and English language wording adjusted.
	    *  Misplaced UPPER CASE shouting removed.
	    *  Many complaints about unknown types, values, etc, now include
	       the offending value, for ease of remote diagnosis.
	    *  C++-style << printouts converted to log_xxx calls.
	    *  Direct accesses to dbglogfile converted to log_xxx calls.
	    *  printf converted to log_xxx calls.
	    *  Function name debug prints converted to GNASH_REPORT_FUNCTION.
	  These changes should also make the messages easier to	translate.
	* Commented-out messages were also cleaned up as above.
	* Many modules have also had log_warning calls changed to log_msg,
	  log_error, log_aserror, log_swferror, or log_unimp, according to
	  the documentation checked in earlier by strk and gnu.
	  IF_VERBOSE_xxx macros were inserted around some calls that
	  lacked them.
	* Header comments (at the top of the file) added or adjusted, to
	  describe each file in its initial line, and to correct whitespace
	  in the copyright notices.  Eliminate trailing spaces and tabs.
	
	* The list of files affected by the above changes:
	  backend/sound_handler_sdl.cpp
	  extensions/mysql/mysql_db.cpp
	  gui/Player.cpp
	  gui/gnash.cpp
	  gui/gui.cpp
	  plugin/klash/klash.cpp
	  plugin/win32/plugin.cpp
	  server/PropertyList.cpp
	  server/StreamProvider.cpp
	  server/array.cpp
	  server/as_environment.cpp
	  server/as_function.cpp
	  server/as_object.cpp
	  server/as_value.cpp
	  server/button_character_instance.cpp
	  server/character.cpp
	  server/dlist.cpp
	  server/dlist.h
	  server/edit_text_character.cpp
	  server/fill_style.cpp
	  server/font.cpp
	  server/generic_character.cpp
	  server/impl.cpp
	  server/sprite_instance.cpp
	  server/text.cpp
	  server/textformat.cpp
	  server/video_stream_instance.cpp
	  server/asobj/Camera.cpp
	  server/asobj/Color.cpp
	  server/asobj/ContextMenu.cpp
	  server/asobj/CustomActions.cpp
	  server/asobj/Date.cpp
	  server/asobj/Error.cpp
	  server/asobj/Global.cpp
	  server/asobj/Key.cpp
	  server/asobj/LoadVars.cpp
	  server/asobj/LocalConnection.cpp
	  server/asobj/Microphone.cpp
	  server/asobj/Mouse.cpp
	  server/asobj/MovieClipLoader.cpp
	  server/asobj/NetConnection.cpp
	  server/asobj/NetStream.cpp
	  server/asobj/NetStreamFfmpeg.cpp
	  server/asobj/NetStreamGst.cpp
	  server/asobj/Number.cpp
	  server/asobj/Object.cpp
	  server/asobj/Selection.cpp
	  server/asobj/SharedObject.cpp
	  server/asobj/Sound.cpp
	  server/asobj/SoundFfmpeg.cpp
	  server/asobj/SoundGst.cpp
	  server/asobj/SoundMad.cpp
	  server/asobj/Stage.cpp	
	  server/asobj/System.cpp	
	  server/asobj/TextSnapshot.cpp	
	  server/asobj/Video.cpp	
	  server/asobj/gen-asclass.pl
	  server/asobj/gen-asclass.sh
	  server/asobj/string.cpp
	  server/asobj/xml.cpp
	  server/asobj/xmlnode.cpp
	  server/asobj/xmlsocket.cpp
	  server/parser/BitmapMovieDefinition.cpp
	  server/parser/action_buffer.cpp
	  server/parser/button_character_def.cpp
	  server/parser/edit_text_character_def.cpp
	  server/parser/morph2_character_def.cpp
	  server/parser/movie_def_impl.cpp
	  server/parser/shape_character_def.cpp
	  server/parser/sprite_definition.cpp
	  server/parser/sprite_definition.h
	  server/parser/text_character_def.cpp
	  server/swf/DefineFontAlignZonesTag.cpp	
	  server/swf/PlaceObject2Tag.cpp
	  server/swf/tag_loaders.cpp
	  server/vm/ASHandlers.cpp
	  server/vm/ActionExec.cpp
	  server/vm/action.cpp
          libbase/curl_adapter.cpp
	  libbase/extension.cpp
	  libbase/log.cpp
	  libbase/network.cpp
	
	* 2007 copyright notices were inserted in:
	  backend/sound_handler_sdl.cpp
	  extensions/mysql/mysql_db.cpp
	  gui/gnash.cpp
	  plugin/klash/klash.cpp
	  plugin/win32/plugin.cpp
	  server/generic_character.cpp
          libbase/curl_adapter.cpp
	
	* New 2006, 2007 Free Software Foundation copyrights applied (to
	  formerly public domain code):
	  server/font.cpp
	  server/text.cpp
	  server/parser/button_character_def.cpp
	  server/parser/edit_text_character_def.cpp
	  server/parser/morph2_character_def.cpp
	  server/parser/movie_def_impl.cpp
	  server/parser/shape_character_def.cpp
	 
	* backend/sound_handler_sdl.cpp: Move stray FORMAT_VORBIS comment.
	* gui/gui.cpp: Commented out "Resize request when no movie" error
	  that appears every time gnash is run.
	* plugins/klash/klash.cpp:  Translated pop-up menu items, about-box,
	  and updated copyright notice printed by --version and --help.
	* server/array.cpp (as_array_object::index_requested):  Avoid
	  c_str accessor when converting string to number.
	* server/dlist.{h,cpp}:  Change API of DisplayList::dump debug
	  function, so it can use log_xxx functions.
	* server/sprite_instance.cpp (sprite_attach_movie):  Comment out
	  log_msg about initializing properties.
        * server/asobj/gen-asclass.{pl,sh}:  Use log_unimpl in generated code.
	  Improve whitespace, and generate header line describing the file.
	* server/asobj/TextSnapshot.cpp:  Fix whitespace to test gen-asclass.
	* text_character_def.cpp:  Remove commented-out includes.
	* FLVParser.{cpp,h}:  Fix compiler warning (signed/unsigned).
	
	I'm sure that I've missed some messages that ought to get 
	translated (with _(...)).  Those will be fixed over time.
	All new messages should be created with _(...) so they can
	be translated.

2007-04-18 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/loadMovieTest.c: add
	  a couple of "buttons" to scribble on and clear
	  the loaded movies. Checks for this in the 
	  test runner should follow.
	* server/BitmapMovieInstance.h:
	  Override restart() to avoid cleaning up
	  the displaylist (since no frame tags will
	  recreate it).

2007-04-18 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/Makefile.am:
	  activate testcast path_format_test.c
	* testsuite/misc-ming.all/duplicate_movie_clip_test.c
	  new testcase for duplicateMovieClip().
	  
2007-04-17 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/loadMovieTest.c: stop prepending
	  'file://' to srcdir as it might be relative and file://
	  should not be used with relative uris.
	* testsuite/misc-ming.all/loadMovieTestRunner.cpp:
	  Don't cheat, run the test !

2004-04-17 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/URL.cpp: Don't attempt to remove an item from the vector
	of strings if the vector is empty.
	* testsuite/libbase/URLTest.cpp: Add a test which shouldn't crash
	anymore.

2007-04-17 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg_style.h: Added DEBUG_LIMIT_COLOR_ALPHA 
	
2007-04-17 Sandro Santilli <strk@keybit.net>

	* gui/sdl.cpp (key_event): update call to notify_key_event
	  to provide no modifiers always (bogus, but at least compiles).
	* testsuite/actionscript.all/XML.as: add test
	  showing that removeNode doesn't recurse to
	  childrens.
	* server/asobj/xmlnode.{cpp,h}: fix removeNode
	  to not delete all childrens.

2007-04-17 Sandro Santilli <strk@keybit.net>

	* libbase/: tu_file.{cpp,h}, curl_adapter.cpp, zlib_adapter.cpp,
	  noseek_fd_adapter.cpp:
	  Add another callback for getting stream error. First pass at
	  documenting the tu_file interfaces (needs more work).
	  Updated implementations to provide the new error getter.
	* server/asobj/xml.cpp (XML::load): check stream status after
	  call to xmlReadIO. The libxml2 function seems immune to 
	  stream errors, but we can handle them and avoid parsing
	  anything if a stream error occurs (404 will be a stream error).

2007-04-17 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg: Replaced drawVideoFrame() to use AGG
	  functions, implemented nearest neighbor transformations, 
	  implemented masked video playback
	  
2007-04-17 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/get_frame_number_test.c:
	  more tests.
	* testsuite/misc-ming.all/path_format_test.c:
	  testcase to verify valid path format
	  
2007-04-16 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp, server/as_value.cpp,
	server/as_value.h, server/debugger.cpp, server/debugger.h,
	server/edit_text_character.cpp, server/movie_root.h,
	server/sprite_instance.cpp, server/sprite_instance.h,
	server/timers.cpp, server/asobj/LoadVars.cpp,
	server/asobj/Object.cpp, server/asobj/Sound.cpp,
	server/asobj/Sound.h, server/asobj/Stage.cpp,
	server/asobj/string.cpp, server/asobj/xml.cpp,
	server/asobj/xmlnode.cpp, server/asobj/xmlsocket.cpp,
	server/vm/ASHandlers.cpp, testsuite/server/GetterSetterTest.cpp:
	 Drop as_value::to_std_string() - update all callers.
	 Deprecated sprite_instance::get_variable.
	 Cost-corrected debugger interfaces.

2007-04-16 Sandro Santilli <strk@keybit.net>

	* server/as_environment.{cpp,h}: add a parse_path method to
	  return an actual object when the given parameter is actually
	  a path.
	* server/vm/ASHandlers.cpp (ActionCallFunction): set 'this'
	  pointer to the object containing the function if the function
	  name is a path. Fixes bug #18698.
	* testsuite/actionscript.all/getvariable.as: success in
	  callFunction(path.to_function), a few more tests of that kind.

2007-04-16 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/getvariable.as: check 'this' pointer when
	  calling a function trough a path.
	* testsuite/server/Makefile.am: add libgnashamf.la to GNASH libs.
	* testsuite/generic-testrunner.sh, doc/C/internals.xml:
	  Add -f switch to specify the maximum number of frame advancements.
	* testsuite/misc-ming.all/Makefile.am: update
	  get_frame_number_testrunner to advance at most 20 times.
	* testsuite/misc-ming.all/get_frame_number_test.c: no more failures
	  expected.
	* server/sprite_instance.cpp (get_frame_number): check frame labels
	  also when convertion to number gives a non-integer value.
	* server/vm/ASHandlers.cpp (ActionGotoExpression): don't pretend
	  any path-looking string is necessarely a path, it can still be
	  a floating number or a frame label.

2007-04-16  John Gilmore  <gnu@toad.com>

	* libbase/log.h: Update documentation for log_* functions; rename
	  log_warning to log_unimpl (with temporary #define for a few days);
	  move gettext and _ definitions from gnash.h to log.h.
	* libbase/log.cpp:  Update log_* functions as above.
	* server/gnash.h:  Move gettext and _ to log.h.

2007-04-16 Sandro Santilli <strk@keybit.net>

	* libbase/log.h: draft documentation for the log_* functions.
	* testsuite/misc-ming.all/matrix_test.c: add test for skewX() matrix
	  (failures are just precision-related).
	* server/debugger.{cpp,h}: (matchWatchPoint) const-corrected
	* server/vm/ASHandlers.cpp: always pass an as_environment pointer
	  when converting as_value to a string, use to_string rather 
	  then to_std_string() when a reference is enough; (ActionDuplicateClip): 
	  properly cleanup the stack on error; (ActionGotoFrameExpression,
	  ActionCallFrame): properly handle unknown target.
	* testsuite/misc-ming.all/Makefile.am:
	  Activated get_frame_number and frame_label_test.

2007-04-16 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/frame_label_test.c:
	  a new testcase.
	* testsuite/misc-ming.all/get_frame_number_test.c:
	  more tests.
	* server/sprite_instance.cpp:
	  update call_frame_actions();
	* server/vm/ASHandlers.cpp:
	  properly process frame label in ActionCallFrame() and ActionGotoExpression().
	  
2007-04-15 Sandro Santilli <strk@keybit.net>

	* server/edit_text_character.cpp (display): move text glyphs
	  so to be inside bounds defined for the textfield character.
	  Fixes bug #17954. This is likely not the cleanest way to
	  do this, see comments.
	* server/matrix.{cpp,h}: provided setters for canonical 
	  parameters.
	* server/character.cpp: avoid direct access to matrix members.
	* server/sprite_instance.cpp: avoid direct acces to matrix members.
	* server/vm/ASHandlers.cpp: fix signedness compiler warnings.
	* testsuite/server/MatrixTest.cpp: add tests for scale concatenation.

2007-04-15 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/container.{cpp,h}: Remove tu_string{,i}.
	* server/as_value.{cpp,h}: Replace tu_string with std::string.
	Remove wide string code that was both unused and inherently
	broken.
	* all over the place: Update to match changes in as_value.h.
	Also, eliminate tu_string usage entirely.

2007-04-15 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as,
	  testsuite/misc-ming.all/matrix_test.c,
	  testsuite/server/MatrixTest.cpp: more successes
	  after Eric patch ! A few more tests added in
	  matrix_test.c too, and more will be needed.

2007-04-15 Eric Hughes <eh@narthex.us>

	* server/matrix.cpp (get_x_scale, get_y_scale): fixed implementations
	  to match the interpretation of matrix used in set_scale_rotation.

2007-04-14 Sandro Santilli <strk@keybit.net>

	* server/character.cpp (height_getset, width_getset): round
	  width and heights to nearest integer twip.
	* testsuite/swfdec/PASSING: height4.swf succeeds.
	* testsuite/misc-ming.all: Makefile.am, matrix_test.c: new test
	  for statically-defined matrix interpretation (just started, needs
	  many more tests).
	  
2007-04-14 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (sprite_getBounds): round bounds
	  to twips.
	* testsuite/actionscript.all/MovieClip.as: more successes.
	* testsuite/actionscript.all/check.as: Revert bastiaan patch,
	  changing semantic of most tests.

2007-04-14 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/{Loadvars,NetStream,Sound,xmlnode}.cpp: Use
	init_readonly_property for read-only properties.
	* server/parser/movie_def_impl.{cpp,h}: Since we're not using
	pthreads, there is no need to have our thread function
	match a specfic pattern; use one that fits our design.
	* testsuite/actionscript.all/check.as: Don't prepend # where
	it is not needed to avoid choking gcc3's C preprocessor.
	* testsuite/libamf.all/{test_number,test_string}.cpp,
	testsuite/misc.ming.all/{intervalTestRunner,
	loadMovieTestRunner}: Add needed includes for OpenBSD.

2007-04-14 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (sprite_getBounds): round bounds
	  to twips.
	* server/matrix.{h,cpp}: fix conceptual bug in Range2d transform
	  function.
	* testsuite/misc-ming.all/displaylist_depths_test.c,
	  testsuite/actionscript.all/MovieClip.as: more successes.

2007-04-12 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/parser/movie_def_impl.{cpp,h}: Replace pthread usage
	by boost threads.
	* libbase/Makefile.am: No longer include Thread.{h,cpp} in the
	build, because this pthread based class is unused and
	deprecated.
	* server/URLAccessManager.cpp: Comment out unused parameter.
	* server/shape.cpp: Comment out dead code.
	* server/textformat.cpp: make text_format DSOEXPORT, because
	it is used in another DSO.
	* all over the place: Remove all inclusions of pthread.h,
	because we're no longer directly using pthreads.
	* server/gnash.h, gui: version two of Antti Ajanki's GUI
	patches, this time the whole thing.
	* libbase/container.h: Remove the last pthread.h include.

2007-04-12 Sandro Santilli <strk@keybit.net>

	* server/asobj/string.cpp (fromCharCode): revert bastiaan change
	  breaking existing tests.
	* server/character.{cpp,h}: add set_x_scale and set_y_scale
	  methods to reduce code messing with matrices. Changed
	  {x,y}scale_getset and {width,height}_getset to use 
	  these two new functions.
	* testsuite/server/MatrixTest.cpp: add a few tests for
	  set_scale_rotation. I'm not sure the tests are correct
	  thought, I'd like to hear from Martin about that.

2007-04-12 Sandro Santilli <strk@keybit.net>

	* server/: button_character_instance.{cpp,h},
	  character.{cpp,h}, edit_text_character.{cpp,h},
	  generic_character.h, sprite_instance.{cpp,h}:
	  get_width() and get_height() made non-virtual
	  methods using getBounds() internally.
	  Fixed _width, _height, _xscale, _yscale and _rotation
	  getter/setter to call valueOf when available.

2007-04-12 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (duplicateMovieClip): 
	  Duplicate also the drawable.
	* testsuite/misc-ming.all/displaylist_depths_test.c:
	  More successes.

2007-04-12 Sandro Santilli <strk@keybit.net>

	* server/matrix.{cpp,h}: add transform and transform_by_inverse
	  for Range2d<float> type.
	* server/character.h: add a getBounds() virutual method.
	* server/: generic_character.h, button_character_instance.{cpp,h},
	  edit_text_character.h, video_stream_instance.h:
	  Implement getBounds.
	* server/character.cpp: fix width_getset and height_getset
	  to use the new getBounds interface.
	* server/sprite_instance.{cpp,h}: implement getBounds;
	  implement MovieClip.getBounds.
	* testsuite/actionscript.all/MovieClip.as: more tests for
	  getBounds, more successes.
	* testsuite/swfdec/PASSING: height2.swf and height3.swf tests
	  now succeed.

2007-04-12 Mathew Cucuzella <kookjr@gmail.com>

	* doc/C/internals.xml plugin.xml: Fix typos in documentation
          (patch #5820).

2007-04-11 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/string.cpp: from_char_code: create a wide string
	in case the user tries to create one.
	* gui: Reverted Antti's patches, because they appear to be
	lacking some changes in the gnash::key namespace. Fixes build.

2007-04-11 Markus Gothe <nietzsche@lysator.liu.se>

	* server/sprite_instance.cpp: uint32 -> uint32_t.

2007-04-11 Stephan Peijnik <sp@gnu.org>

	* gui/gtk.cpp: Changed Copyright years from 2005-2007 -> 2005, 2006,
	  2007. Fixed 'acces'-typo -> 'access'.

2007-04-11 Antti Ajanki <antti.ajanki@iki.fi>
	
	*  gui/gtk.cpp gui/gtksup.h gui/gui.cpp gui/gui.h
	*  gui/kde.cpp gui/kde_glue.h gui/kdesup.h:
	moves the handling of GUI shortcuts (Crtl+R for restarting the 
	movie, Ctrl+Q for quiting, etc.) form GtkGui to base class Gui. 
	This way all GUIs can inherit the same code instead of having 
	to duplicate it.
	adds keyboard handling for the KdeGui using this new interface.
	Currently KdeGui has no support for keyboard input. 

	The destructor of KdeGlue deletes _drawing_area object even though 
	it is not owned by KdeGlue. The _drawing_area is actually the 
	_qwidget object from KdeGui and is (correctly) deleted at the 
	destructor of 
	KdeGui. This double-free error causes a segfault when closing 
	Gnash. 

2007-04-11 Sandro Santilli <strk@keybit.net>

	* server/parser/shape_character_def.cpp (compute_bound):
	  skip anchor point of empty paths; include both control
	  and anchor point of any edge.
	* server/dlist.h: add a visitAll() method for unconditional
	  full scan.
	* server/sprite_instance.cpp: optimize WidthFinder, HeightFinder,
	  ScriptObjectFinder and CharacterExtractor to return void
	  (can be used by visitAll); (get_width, get_height): include
	  scan of DrawingAPI canvas.
	* testsuite/actionscript.all/MovieClip.as, 
	  testsuite/misc-ming.all/displaylist_depths_test.c:
	  few more successes.

2007-04-11 Ann Barcomb <kudra@domaintje.com>

	* devtools/lib/Gnash/Distribution.pm: made it more
	  difficult to mistakenly use the wrong root distribution
	  directory.

2007-04-11 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as: add some tests
	  for _width,_height and getBounds (all failing!).

2007-04-11 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/cxform.h: include required inttypes.h
		
2007-04-11 Sandro Santilli <strk@keybit.net>

	* server/: Makefile.am, gnash.h, types.cpp, cxform.{cpp,h},
	  swf/PlaceObject2Tag.{cpp,h}, swf/tag_loaders.cpp:
	  Extract PlaceObject2Tag from tag_loaders
	  and cxform from gnash.h and types.cpp.
	* server/character.{cpp,h}: add getUserDefinedEventHandler
	  function, change static event handlers function to allow
	  for multiple handlers for the same event.
	* server/vm/ExecutableCode.h: add EventCode class.
	* server/swf_event.h: drop the 'function' member, provide better
	  members protection.
	* testsuite/actionscript.all/MovieClip.as: add tests for
	  user defined events not being proper properties.
	* testsuite/actionscript.all/dejagnu_so_init.as: delete the
	  user-defined onEnterFrame when finished with it.
	* server/execute_tag.h: add missing include.
	* server/event_id.h: add setKeyCode method, for better protection.
	* server/button_character_instance.cpp (on_button_event): look for
	  user-defined event handlers.
	* server/dlist.{cpp,h}, server/impl.h,
	  server/parser/shape_character_def.h,
	  server/parser/button_character_def.h:
	  Update after addition of new files
	* testsuite/misc-ming.all/action_execution_order_extend_test.c:
	  Two unexpected successes, one unexpected failures (due to scrabling
	  of event handling).
	* server/movie_root.{cpp,h}: add pushAction(ExecutableCode).
	* server/sprite_instance.{cpp,h}: stop using gettersetter for event
	  handlers
	* testsuite/misc-ming.all/displaylist_depths_test.c: test that
	  event handlers need to be duplicated too.

2007-04-11 Ann Barcomb <kudra@domaintje.com>

	* testsuite/actionscript.all/gen-index-wiki.sh doc/C/sources.xml:
	  Changed all references of 'gnash.lulu.com' to 'www.gnashdev.org'.

2007-04-11 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/FLVParser.cpp: Append 8 "zero" bytes to the end of the frame
	buffer to prevent decoders from going past the end of our frame buffer.
	This adds NULL-termination, which is also expected by FFMPEG.
	* server/asobj/NetStreamFfmpeg.cpp: Initialize certain members to safe
	defaults so they will not be read in their uninitialised states.
	* backend/render_handler_agg.cpp: Stop relying on bounds passed from
	video definition for image buffer size (since we don't yet do proper
	scaling, that is a bad idea); fixes bug #19511. Also, cut off the
	video image if it extends beyond the width of our buffer.
	* gui/fltk.cpp: Fix compilation by adding statics for GUI methods
	that became nonstatic. Also fix some warnings.
	* all over the place: Replace SDL integer type names by standard ones.
	Thanks to Ann for writing a Perl script to do search-and-replace.

2007-04-11 Sandro Santilli <strk@keybit.net>

	* server/character.h: add protected set_event_handlers(), turn
	  get_event_handelrs into a protected member.
	* server/sprite_instance.cpp (duplicateMovieClip): simplified copying
	  of event handlers.

2007-04-11 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ming_utils.h: define newSWFAction
	  to compileSWFActionCode when using older Ming versions.
	  Now we can use them interxchangeably (the newer newSWFAction
	  has to be preferred though).
	* testsuite/actionscript.all/MovieClip.as: add tests
	  showing that user-defined event handlers must be handled
	  differently then placeobject-defined ones. At least
	  for the sake of duplicating movieclips; add
	  MovieClip.duplicateMovieClip test.
	* testsuite/misc-ming.all/displaylist_depths_test.c:
	  Add tests for duplicateMovieClip, _width and cloning
	  static event handlers.

2007-04-11 Zou Lunkai <zoulunkai@gmail.com>

	* server/as_environment.cpp:
	  don't trim of the last "/" in parse_path(), fix parsing path in format "/:x".
	* testsuite/actionscript.all/getvariable.as:
	  add tests
	  
2007-04-10 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{cpp,h}: add duplicateMovieClip method
	  for use by MovieClip.duplicateMovieClip and ActionDuplicateClip.
	* server/vm/ASHandlers.cpp (ActionDuplicateClip): use the new
	  sprite_instance::duplicateMovieClip method fixing a bogus assumption
	  about the parent to duplicate into.
	* testsuite/actionscript.all/MovieClip.as: add small test for
	  ActionDuplicateClip.

2007-04-10 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamFfmpeg.h: Fixed a bug in the 
	  AudioResampler, which made it only resample the first time.
	* libbase/LoadThread.cpp: Handle the case where the cache is
	filled and we have yet more data to load.

2007-04-10 Markus Gothe <nietzsche@lysator.liu.se>

	* cygnal/http.cpp cygnal/stream.cpp: Added 'return true'-stubs, closes
	  bug #19561.

2007-04-10 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp (readPlaceObject2): reduce
	  calls to IF_VERBOSE_PARSE.

2007-04-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/NetStreamFfmpeg.{cpp,h}: Don't call delete on a
	new[]-allocated pointer. Don't try to copy a byte-aligned
	data buffer into a "flat" one, and vice versa. Add a helper
	class called AudioResampler, which will do audio resampling
	if necessary.
	* server/xmlsocket.cpp: Use SIZET_FMT.
	* libbase/image.cpp: Document update().
	* libbase/image.h: Define a virtual destructor for the image_base
	class so deriving classes will have their destructors called
	when we decide to delete them. Fixes a _big_ memory leak.

2007-04-10  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Test the host to see if we're on a Darwin machine.
	* backend/render_handler_ogl.cpp: Build with the native Darwin
	port of OpenGL.
	* cygnal/netstats.cpp: Include date.hpp.
	* gui/Makefile.am: Add FFMPEG_LIBS for cross compiling.
	* macros/incllist, incllist: Don't search for Darwin specific
	paths, we're correctly using the -framework flag to GCC now.
	* macros/opengl.m4: For Darwin, use the OpenGL and AGL frameworks
	instead of include or linker paths.
	* macros/x11.m4: Find all the right include paths. Look for
	libXplugin too, which is Darwin specific, and in a weird place.
	* server/StreamProvider.cpp: Remove bogus USE_CURL setting.
	* server/StreamProvider.h: Include config.h.
	* server/asobj/Makefile.am: Use FFMPEG_CFLAGS too.
	* server/parser/Makefile.am: Use FFMPEG_CFLAGS too.
	* server/vm/Makefile.am:  Use FFMPEG_CFLAGS too.
	* utilities/Makefile.am: Add FFMPEG_LIBS.
	
2007-04-10 Sandro Santilli <strk@keybit.net>

	* libbase/log.h: allow switching off any VERBOSITY overhead
	  by using -DVERBOSE_WHAT=0.
	* server/as_environment.{cpp,h}: add the concept
	  of a default target to support setTarget() calls
	  (null target spec meaning will to reset the target
	   to its original value).
	* server/vm/ASHandlers.cpp (CommonSetTarget):
	  When target specification is an empty string
	  reset the target to its original value.
	  Use find_target rather then find_object to avoid
	  variables and character names clashes.

2007-04-10 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.cpp (read_all_swf): at
	  end of parsing, check consistency of number of frames 
	  advertised in header and number of frames read from the
	  stream. Update total frame count if needed and properly
	  wake up any frame reached condition waiters.
	* server/movie_instance.cpp (advance) check return from
	  ensure_frame_loaded.

2007-04-10 Sandro Santilli <strk@keybit.net>

	* server/parser/: movie_definition.h, movie_def_impl.{cpp,h},
	  sprite_definition.{cpp,h}: stop using TU legacy hashes
	  and strings: use std::string instead of C strings, use
	  references instead of pointers in a few places.
	* server/sprite_instance.{cpp,h}: use std::string instead
	  of C strings for frame labels, update other uses of changed
	  interfaces of parser.
	* server/swf/tag_loaders.cpp: update uses of changed interfaces
	  of parser.

2007-04-10 Sandro Santilli <strk@keybit.net>

	* server/parser/Makefile.am: add FFMPEG_CFLAGS to AM_CPPFLAGS
	  if using FFMPEG sound.
	* testsuite/actionscript.all/getvariable.as: add test for
	  literal 'invalid:Number' variable name.
	* libbase/log.cpp: stop adding CR to debugging output !!
	* server/stream.cpp (open_tag): print tag offsets as start
	  of the tag (including header). This is to match offsets
	  as printed by Ming's listswf for comparision purposes.
	* server/asobj/xmlnode.{h,cpp}: fix appendChild to properly
	  move the node; implement insertBefore and removeNode; fix
	  cloneNode to respect not copy childs if not deep; implement
	  parentNode gettersetter.
	* testsuite/actionscript.all/XML.as: add tests for insertBefore,
	  appendNode, cloneNode, removeNode and parentNode.
	* macros/ffmpeg.m4: fix --with-ffmpeg-incl to look for
	  avcodec.h under the 'ffmpeg' subdir (this is assumed
	  to exist in Gnash source code).

2007-04-10 Zou Lunkai <zoulunkai@gmail.com>

	* server/parser/shape_character_def.cpp:
	  fix reading fill_styles, actually it was a regression.
	  
2007-04-09 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: activated
	  get_frame_number test.

2007-04-08  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/agg.m4, boost.m4, curl.m4, ffmpeg.m4, firefox.m4,
	glib.m4, gnashpkgtool.m4, gtk2.m4, gtkglext.m4, jpeg.m4, kde.m4,
	libXML.m4, ming.m4, mysql.m4, opengl.m4, pango.m4, pthreads.m4,
	sdl.m4, x11.m4: Use ${shlibext} instead of .so to be more
	portable.
	* macros/ffmpeg.m4: Look for avutil after avformat, as there is a
	dependancy on the order on some systems.
	* macros/x11.m4: Reverse the logic, we *do* want to look for the X11
	librsaries if the X11 headers are found earlier.
	* testsuite/samples/Makefile.am: Add GotoAndPlayTestRunner to CLEANFILES.
	* configure.ac: Improve openbsd host test. Test for Darwin libtool
	vs ar. Reset AR if it's the Darwin libtool. Set FL_MUTEX to 0 if
	lf_flmutext_register isn't found.
	* cygnal/cygnal.cpp: Include libintl.h.
	* libbase/curl_adapter.cpp: Use USE_CURL consistantly instead of
	HAVE_CURL and HAVE_CURL_CURL.
	* libbase/noseek_fd_adapter.cpp: Remove HAVE_STDIN_CURL_H test.
	* libbase/rc.cpp: Include cctype.
	* macros/incllist, libslist: Add Darwin Developer SDK directories.
	
2007-04-08 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/NetStreamFfmpeg{.cpp, .h}: Only use a single
	thread (rather than two extra threads) for decoding. Plug a
	memory leak (ByteIOCxt.buffer). Modularise some more code.

2007-04-08 Ann Barcomb <kudra@domaintje.com>

	* devtools/testsuite/c_casts.t: added this test at Bastiaan's
	  request.
	* devtools/lib/Gnash/Utils.pm: fix bug which caused wrong line
	  numbers to be reported.

2007-04-08 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/get_frame_number_test.c:
	  new testcase for get_frame_number() and goto_frame().
	* server/sprite_instance.{cpp,h}
	  update implementation of get_frame_number() and goto_frame(),
	  fix the above the testcase.
	
2007-04-08 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/XML.as: add tests for XML.attributes

2007-04-07 Sandro Santilli <strk@keybit.net>

	* server/asobj/xml.cpp (extractNode, parseDoc): properly setup
	  the node parent.
	* server/asobj/xmlnode.{cpp,h}: keep parent by intrusive_ptr.
	* testsuite/actionscript.all/XML.as: add tests for
	  nextSibling and previousSibling

2007-04-07 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStream{Ffmpeg,Gst}.cpp: Use the m_imageframe's
	  size to determine the size of the returned frame.

2007-04-07 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* packaging/redhat/gnash.spec: Use --enable-media instead of
	  --enable-sound.
	* server/video_stream_instance.cpp: Delete the image once displayed.
	* server/asobj/NetStream.h: Removed the obsolete getter/setters
	  for onStatus.
	* server/asobj/NetStreamFfmpeg.{h,cpp}: Removed the obsolete 
	  getter/setters for onStatus. Made get_video() threadsafe.
	  Removed \n from log/error messages.
	* server/asobj/NetStreamGst.{cpp,h}: Removed the obsolete 
	  getter/setters for onStatus. Made get_video() threadsafe.
	  Removed \n from log/error messages.
	* server/asobj/NetConnection.cpp: Removed \n from log/error messages.

2007-04-07 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionCallMethod): stop warning
	  about ActionCallMethod arg being not a function (seems
	  to be common behaviour for invoking constructors).

2007-04-07 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_ogl.cpp: Removed mipsmaps code, due to
	  major clean up and rewrite (since it's not used).

2007-04-07 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/NetStreamFfmpeg{.cpp, .h}: Fix a deadlock on non-glibc
	platforms by waiting for a thread rather than hoping for a
	certain execution order (which is fundamentally incompatible with
	threads). Cleanup: modularise some code and use string comparison
	rather than char-by-char comparison.

2007-04-06 Sandro Santilli <strk@keybit.net>

	* server/character.cpp: stop notifying unload event queuing
	* server/asobj/NetStreamGst.cpp: warn only once about fluendos
	  plugin being too old.

2007-04-06 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (ScriptObjectFinder): 
	  use character depth to tell wheter objects have to
	  be considered "script" objects or not. Fixes the
	  all.swf regression and doesn't change our testsuite
	  results.
	* testsuite/actionscript.all/MovieClip.as: test both
	  ActionRemoveClip and MovieClip.removeMovieClip; also
	  tests that there's no such think as a _global.removeMovieClip.
	* testsuite/misc-ming.all/displaylist_depths_test.c:
	  Add a bunch of new tests about removing from protected
	  depth ranges and using swapDepth to move between ranges.
	* server/sprite_instance.{h,cpp}: Add a removeMovieClip
	  public method for common use by ActionRemoveClip tag,
	  global removeMovieClip function and MovieClip.removeMovieClip
	  method; fix swapDepths to accept a depth as argument;
	  fix removeMovieClip to check for allowed depth bounds.
	* server/vm/ASHandlers.cpp (ActionRemoveClip): use the new
	  sprite_instance::removeMovieClip method.

2007-04-06 Sandro Santilli <strk@keybit.net>

	* server/: character.h, dlist.{cpp,h}, sprite_instance.{cpp,h}:
	  Character instance depth is a _signed_ value !
	  Add a character::staticDepthOffset constant to use for converting
	  displaylist tag defined depths to negative values.
	* server/swf/tag_loaders.cpp: convert displaylist tag defined depths
	  to negative values by adding character::staticDepthOffset
	* testsuite/misc-ming.all/: ButtonEventsTest-Runner.cpp,
	  testsuite/samples/clip_as_button2-TestRunner.cpp,
	  testsuite/movies.all/gravity_embedded-TestRunner.cpp:
	  loop_test-Runner.cpp, simple_loop_testrunner.cpp: fix the
	  test runners to take staticDepthOffset into account.
	* testsuite/actionscript.all/MovieClip.as: getNextHighestDepth()
	  test now succeeds.


2007-04-06 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, displaylist_depths_test.c:
	  Add a new interesting (failing) test showing that static characters
	  and dynamic characters use a completely different range
	  of depths !!
	* server/sprite_instance.cpp (sprite_get_depth): only convert
	  depths to negative values for static clips.
	* testsuite/actionscript.all/MovieClip.as: add a couple of
	  tests for getDepth() invoked against dynamic and static
	  clips.

2007-04-05  John Gilmore  <bug-gnu-gettext@gnu.org>

	Internationalize gnash.  Phase 1: use gettextize, update config files.

	* macros/{codeset.m4, gettext.m4, glibc2.m4, glibc21.m4,
	  iconv.m4, intdiv0.m4, intmax.m4, inttypes.m4, inttypes_h.m4,
	  inttypes-pri.m4, isc-posix.m4, lcmessage.m4, lib-ld.m4,
	  lib-link.m4, lib-prefix.m4, longdouble.m4, longlong.m4, nls.m4,
	  po.m4, printf-posix.m4, progtest.m4, signed.m4, size_max.m4,
	  stdint_h.m4, uintmax_t.m4, ulonglong.m4, wchar_t.m4, wint_t.m4,
	  xsize.m4}: New files, from gettext-0.14.6.
	* po: New directory for translated messages (Portable Object files)
	* po/{Makefile.in.in, boldquot.sed, en@boldquot.header,
	  en@quot.header, insert-header.sin, quot.sed,
	  remove-potcdate.sin, Rules-quot}: New files, from gettext-0.14.6.
	* ABOUT-NLS, config.rpath: New files, from gettext-0.14.6.
	* libbase/gettext.h:  New file, from gettext-0.14.6.
	* server/gnash.h: Include "gettext.h" for NLS.
	* po/Makevars: New file: settings for gnash's message translation.
	* po/POTFILES.in: New file: source files with translatable strings.
	* po/LINGUAS: New file: languages we have translations for.
	* Makefile.am (EXTRA_DIST): Add config.rpath.
	  (STD_DIRS): Add po.
	* configure.ac (AC_OUTPUT): Add po/Makefile.in.
	  (AM_GNU_GETTEXT):  Add, to configure gettext support.
	* cygnal/Makefile.am (localedir, INCLUDES),
	  gui/Makefile.am (localedir, INCLUDES),
	  utilities/Makefile.am (localedir, INCLUDES):  Define LOCALEDIR.
	* cygnal/cygnal.cpp (main), gui/gnash.cpp (main), 
	  utilities/{dumpshm,parser,processor}.cpp (main):
	  Set locale and initialize gettext upon startup.
	* utilities/{dumpshm,parser,processor}.cpp:  Flag strings with _
	  for translation, for testing.
	* po/gnash.pot:  Message string catalog for testing.
	* po/es.po:  Spanish-language message string catalog for testing.

2007-04-05 Zou Lunkai <zoulunkai@gmail.com>

	* server/asobj/Date.cpp
	fix passing parameter to utctime();
	
2007-04-05 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionRemoveClip): properly parse
	  the given argument rather then assuming that it refers to
	  a child of the current target movie. (fixes the softreference
	  tests).
	* testsuite/actionscript.all/MovieClip.as: add softreference
	  test (MovieClip values kept by absolute _target).
	* testsuite/actionscript.all/MovieClip.as: fix couple of stack
	  underruns.
	* server/sprite_instance.{cpp,h} (get_frame_number):
	  Changed signature to report invalid frame specifications;
	  simplified and clened implementation of Zou Lunkai.
	* server/vm/ASHandlers.cpp: updated calls to get_frame_number.
	* testsuite/swfdec/PASSING: gotoframe.swf now passes.

2007-04-05 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: enabled run of
	  reverse_execute_PlaceObject2_test2runner and
	  action_execution_order_test6runner.
	* testsuite/misc-ming.all/ming_utils.c (get_dejagnu_actions):
	  property initialize the xpassed and xfailed counters.

2007-04-05 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/reverse_execute_PlaceObject2_test2.c
	add more tests of MovieClip events
	
2007-04-05 Sandro Santilli <strk@keybit.net>

	* server/timers.{cpp,h}: drop the as_environment member
	  for Timers as we can't ensure it will be kept alive.
	  We'll use a newly created environment for calling
	  the timer function.
	* server/asobj/: LoadVars.cpp, xmlsocket.cpp: update use of
	  timers.
	* server/as_environment.cpp (find_object_dotsyntax): 
	  more verbose debugging for cases in which a dot-syntax
	  path contains non-object members.

2007-04-05 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all: reverse_execute_PlaceObject2_test2.c
	another testcase for reverse execution of frame tags. 
	* testsuite/misc-ming.all/reverse_execute_PlaceObject2_test1.c
	add notes that reverse execution is likely to be deprecated.
	* testsuite/misc-ming.all/action_execution_order_test6.c
	do checks and stop movie at the last frame.
	
2007-04-04 Markus Gothe <nietzsche@lysator.liu.se>

	* server/asobj/TextFormat.{cpp,h} - Added stub for class TextFormat.

2007-04-04 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gui.cpp, backend/render_handler_agg_style.h,
	server/{swf/DefineFontAlignZonesTag.cpp, textformat.cpp}: 
	Comment out unused variables. 
	* libamf/amf.cpp: Remove unneeded casts. Replace some
	C-style casts by C++-style ones. Don't modify const type;
	instead, use a temporary (el->data).
	* server/{movie_root.cpp, shm.cpp, sprite_instance.cpp,
	          vm/ActionExec.cpp, asobj/xmlsocket.cpp}: More
	use of SIZET_FMT.
	* server/{Boolean.cpp, Date.cpp}: Don't assign string
	literals to character pointers, which will soon be
	deprecated by GCC. Instead, use array declarations.
	* server/asobj/{NetStreamFfmpeg.cpp, SoundFfmpeg.cpp}:
	Don't compare unsigned with signed ints.
	* server/asobj/xml.cpp: Comment out include that is used
	by commented out code.
	* server/parser/movie_def_impl.h: Fix typo.

2007-04-04 Sandro Santilli <strk@keybit.net>

	* server/asobj/xml.cpp: fix parsing of text nodes
	* server/asobj/xmlnode.{cpp,h}: use std::string, not
	  C strings for name and value. Add an enum for NodeType.
	* testsuite/actionscript.all/XML.as: more tests for
	  the memory-parsed XML.

2007-04-04 Sandro Santilli <strk@keybit.net>

	* server/asobj/xmlnode.cpp: don't attacy XMLNode interface
	  to XMLNode instances.
	* server/asobj/xml.{h,cpp}: override get_member and set_member
	  to handled non-proper properties 'loaded' and 'status'
	* testsuite/actionscript.all/XMLNode.as: less failures
	* testsuite/actionscript.all/XML.as: more tests !

2007-04-04 Sandro Santilli <strk@keybit.net>

	* server/array.{cpp,h}: const-corrected push and unshift
	  methods.
	* server/asobj/xmlnode.cpp: implement childNodes getter/setter.
	* server/asobj/xml.cpp: cleanups.

2007-04-04 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: enable
	  reverse_execute_PlaceObject2_test1runner in 'check' rule.
	* server/array.cpp: use a getter/setter for the 'length' property.
	* testsuite/actionscript.all/array.as: another success.

2007-04-04 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/reverse_execute_PlaceObject2_test1.c
	ensure that total() is called at the last step.
	
2007-04-04 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/array.as: more tests added.
	* server/asobj/xml.cpp: remove debugging lines, return undefined
	  from getBytesLoaded,getBytesTotal if the XML was not loaded.
	* server/asobj/xmlnode.cpp: remove debugging lines.
	* testsuite/actionscript.all/XML.as: all current tests pass now
	  (but we need more tests);

2007-04-04 Sandro Santilli <strk@keybit.net>

	* server/asobj/xmlnode.cpp (stringify): stop feeding NULL 
	  pointers to output operators !
	* server/asobj/xml.cpp (xml_new): support a string as first
	  argument to constructor.

2007-04-04 Sandro Santilli <strk@keybit.net>

	* server/asobj/xml.{cpp,h}: tu_string => std::string
	* server/asobj/xmlsocket.cpp: provide a builtin onData
	  event handler to XMLSocket instances.
	* testsuite/actionscript.all/XMLSocket.as: more successes.
	* server/URLAccessManager.{cpp,h}: add allowHost interface.
	* server/asobj/xmlsocket.cpp (connect): check host security.

2007-04-04 Zou Lunkai <zoulunkai@gmail.com>

	* server/sprite_instance.cpp
	first attempt to deprecate reverse execution of frame tags
	
2007-04-03 Sandro Santilli <strk@keybit.net>

	* server/edit_text_character.cpp (format_text): handle
	  TAB characters.
	* testsuite/misc-ming.all/ming_utils.c: embed a glyph for 
	  the TAB character in our font.
	* server/vm/ASHandlers.cpp: extend tag is not in testing
	  stage anymore, be more explicit about targetPath() arg
	  not casting to an object.
	* server/movie_root.{cpp,h}: limit the number of interval
	  timers to 255.
	* server/asobj/xmlsocket.{cpp,h}: more cleanups and fix for
	  polling from the socket.
	* libbase/network.{cpp,h}: do not allow assignment, cleanup
	  accessor functions to return by const refs.
	* server/asobj/xmlsocket.{cpp,h}: do not override inherited
	  members and methods. Enable some more debugging and added
	  more assertions.

2007-04-03 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/XMLSocket.as: some more
	  testing.
	* server/sprite_instance.{cpp,h}: split the
	  DisplayList reset code from execute_frame_tags()
	  to a resetDisplayList() method.

2007-04-03 Sandro Santilli <strk@keybit.net>

	* server/asobj/xmlattrs.{cpp,h}: use std::string
	  for name and value, access trough members, initialize
	  trought contructor.
	* server/asobj/xmlnode.{cpp,h}: keep XMLAttr by value,
	  not by pointer; implement the 'attributes' getter.
	* server/asobj/xml.cpp: update XMLAttr uses.
	* testsuite/actionscript.all/XML.as: more tests, less failures.
	* testsuite/media/gnash.xml: add a tag attribute.

2007-04-03 Sandro Santilli <strk@keybit.net>

	* server/asobj/xml.{cpp,h}: have XML be a subclass
	  of XMLNode. Many cleanups.
	* server/asobj/xmlnode.{cpp,h}: many cleanups.
	* testsuite/actionscript.all/XML.as: add more tests.
	* testsuite/actionscript.all/XMLNode.as: fix some bogus
	  existing tests.

2007-04-03 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.h (add_init_action): fix typo.
	* testsuite/actionscript.all/XML.as: a few more tests.
	* testsuite/media/gnash.xml: new data file for testing.
	* server/asobj/xml.{cpp,h}: allow reading XML from
	  a network stream (untested).

2007-04-03 Markus Gothe <nietzsche@lysator.liu.se>

	* server/as_value.h: Include <limits> for NAN.
	* backend/render_ogl.cpp: Fixed memory leak.

2007-04-02 Sandro Santilli <strk@keybit.net>

	* configure.ac: fix a couple of typos.
	* server/button_character_instance.cpp (on_event): queue
	  events, don't execute immediately
	* server/vm/ExecutableCode.h (GlobalCode): take a character
	  as target.
	* server/movie_root.{cpp,h} (pushAction): take a character
	  as target.
	* testsuite/samples/gotoFrameOnKeyEvent-TestRunner.cpp:
	  unexpected success.

2007-04-02 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* Makefile.am, configure.ac, gui/Makefile.am, gui/gnash.cpp, gui/gtk.cpp:
	  Changed the "--enable-sound" option to "--enable-media", and removed
	  the "--with-mp3-decoder" option.
	* server/asobj/NetStreamFfmpeg.cpp: Replaced a few assert(0) with
	  warnings.
	* server/asobj/NetStreamGst.cpp: Only create sound objects if a
	  soundhandler is present.

2007-04-02 Sandro Santilli <strk@keybit.net>

	* server/dlist.{cpp,h} (place_character): call unload()
	  on characters that are replaced.

2007-04-02 Sandro Santilli <strk@keybit.net>

	* gui/sdl.cpp (key_event): update call to notify_key_event.
	* server/vm/ExecutableCode.h: change FunctionCode to take
	  a generic character as target, not necessarely a sprite.
	* server/movie_root.{cpp,h}: update pushAction() for events
	  to take a generic character, add a notify_key_event method
	  for consistency.
	* server/asobj/Key.cpp: notify_key_event moved to movie_root.
	* server/gnash.h: remove notify_key_event prototype, it's now
	  a movie_root method.
	* gui/gtk.cpp: use gui::notify_key_event for key events.
	* gui/gui.{cpp,h}: add notify_key_event method.
	* server/character.{cpp,h}: move queueActionHandler from
	  sprite_instance here.
	* server/sprite_instance.{cpp,h}: cleanups.
	* testsuite/MovieTester.cpp: update call to notify_key_event.

2007-04-02 Sandro Santilli <strk@keybit.net>

	* testsuite/samples/: Makefile.am, gotoFrameOnKeyEvent-TestRunner.cpp:
	  First stub at an automated test runner for gotoFrameOnKeyEvent.
	  TODO item in comments.

2007-04-02 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/as_value{.cpp, .h}: Declare NAN in the header
	(and fix a typo in the declaration. Use that definition
	instead of by using 0.0 / 0.0 to avoid compiler warnings.
	* server/asobj/{Date.cpp, Math.cpp}: Don't redefine NAN.

2007-04-02 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ming_utils.{c,h}: fix compiler warnings.
	* testsuite/samples/: gotoFrameOnKeyEvent.swf, README:
	  Add new tests used to debug keypress listeners and
	  goto_frame. Provided by Dongdong <dedodong@163.com>
	* server/movie_root.cpp (notify_keypress_listeners):
	  Skip event execution for unloaded characters
	  (they will be removed at next ::advance call)

2007-04-02 Sandro Santilli <strk@keybit.net>

	* server/dlist.{cpp,h} (remove_display_object): call
	  unload on removed character.
	* server/: character.h, sprite_instance.{cpp,h}:
	  Moved the isUnloaded()/_unloaded logic from sprite_instance
	  up to character.
	* server/movie_root.{cpp,h}: remove unloaded characters
	  from the keypress_listeners set (run at ::advance time).

2007-04-02 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (goto_frame): remember to call
	  set_invalidated() before running display list tags!
	  (UdoG: is this correct?)

2007-04-02 Zou Lunkai <zoulunkai@gmail.com>

	* server/sprite_instance.cpp, sprite_instance.h
	add is_reverse_execution() to check if is reverse executing frame tags;
	* server/tag_loaders.cpp
	set "replace_if_depth_is_occupied" to true when reverse executing PlaceObject2.
	fixed error messages with playing bombgame.swf, improved implementation of 
	reverse execution.

	  
2007-04-01 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp (define_bits_jpeg_loader,
	  define_bits_jpeg2_loader, define_bits_lossless_2_loader):
	  Handle duplicate character id. "Fixes" bug #19474.

2007-03-31 Sandro Santilli <strk@keybit.net>

	* gui/Makefile.am, testsuite/server/Makefile.am,
	  utilities/Makefile.am: add libgnashparser dependency.
	  Fixes bug #19450.

2007-03-31 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac, gui/gtk_glue_agg.cpp: Add configurable support
	for 16-bit GTK, for use on the OLPC. Simply specifying
	--with-pixelformat=rgb565 will activate this code.

2007-03-30 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStream{Ffmpeg,Gst}.cpp: Fixed the callback
	  to the onStatus eventhandler.

2007-03-30 Sandro Santilli <strk@keybit.net>

	* server/asobj/Mouse.cpp: cleanups.
	* libbase/network.cpp: minor cleanups in debugging lines.
	* server/asobj/xmlsocket.{cpp,h}: first pass at cleanup,
	  fix XMLSocket.connect() to return the correct value.
	* server/asobj/Global.cpp: initialize XMLSocket with the
	  most current interface.
	* testsuite/actionscript.all/: Makefile.am, XMLSocket.as:
	  initial test for XMLSocket (methods availability).

2007-03-30 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/FLVParser.cpp: Fixed a few bugs.
	* libbase/LoadThread.{h,cpp}: Changed to use a cache so we avoid
	  blocking to often when reading and loading at the same time.
	* server/asobj/NetConnection.{h,cpp}: Added loadCompleted().
	* server/asobj/NetStream.{h,cpp}: Added setEnvironment(), and
	  removed the getter/setter for onStatus.
	* server/asobj/NetStreamFfmpeg.{h,cpp}: Fixed a big mem-leak. Added
	  setEnvironment(), and added support for status/error messages.
	* server/asobj/NetStreamGst.{h,cpp}: Added setEnvironment(), and
	  added support for status/error messages.
	* testsuite/actionscript.all/NetStream.as: Corrected expected
	  results for onStatus, and added some for onCuePoint and onMetaData.

2007-03-30 Sandro Santilli <strk@keybit.net>

	* server/dlist.cpp (clear_except): don't copy display list (small
	  typo)
	* server/sprite_instance.cpp (ctor): initialize the _unloaded member.
	* testsuite/actionscript.all/NetStream.as: check that onStatus and
	  onSeek are not special builtin-properties.
	* server/timers.{cpp,h}: add support for passing arguments to
	  setInterval() callbacks.
	* testsuite/misc-ming.all/: intervalTest.as, intervalTestRunner.cpp:
	  All tests pass now.

2007-03-30 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: intervalTest.as, intervalTestRunner.cpp:
	  Add test for setInterval() calls with additinal args (Gnash fails).
	* server/asobj/xmlsocket.cpp: don't attempt to send
	  data when not connected !
	* testsuite/misc-ming.all/Makefile.am: prepared for
	  activation of reverse_execute_PlaceObject2_test1runner
	  (not activated as for Zou request).

2007-03-30 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all: reverse_execute_PlaceObject2_test1.c
	  add a new testcase for reverse execution of frame tags. The next
	  step is to improve it or deprecate it.
	  
2007-03-30 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/: check.as, targetPath.as:
	  Don't use asm { targetPath } when not supported by
	  detected Ming.

2007-03-30 Sandro Santilli <strk@keybit.net>

	* server/as_value.cpp (to_sprite): don't attempt to resolve
	  the path to a sprite if this value is not a MOVIECLIP type.
	* server/swf.h: document ACTION_TARGETPATH
	* server/sprite_instance.{cpp,h}: implement getTarget(), have
	  get_text_value() call getTarget() internally.
	* server/vm/ASHandlers.cpp: Implement ActionTargetPath.
	* testsuite/actionscript.all/: Makefile.am, targetPath.as:
	  Test ACTION_TARGETPATH (0x45).

2007-03-29  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Add --disable-menus since an embedded systems
	probably won't want them.
	* gui/gtk.cpp: Disable most of the menu items if they're
	disabled.
	* packaging/redhat/gnash.spec: Build with --disable-menus for the
	OLPC. 

	* doc/C/sources.xml: Fix mismatched sect tags.
	* doc/C/asspec: new directory to hold the ActionScript
	specification files, so as to not clutter the top level doc
	directory.
	* doc/C/accessibility.xml, array.xml, boolean.xml, button.xml,
	camera.xml, color.xml, contextmenu.xml, customactions.xml, date.xml,
	error.xml, function.xml, key.xml, loadvars.xml, localconnection.xml,
	math.xml, microphone.xml, mouse.xml, movieclip.xml,
	moviecliploader.xml netconnection.xml, netstream.xml, number.xml,
	selection.xml, sharedobject.xml, sound.xml, stage.xml, string.xml,
	system.xml, textfield.xml, textformat.xml, textsnapshot.xml, video.xml,
	xml.xml, xmlnode.xml, xmlsocket.xml: Moved to asspec directory.
	* doc/asspec/asspec.xml: New top level document for free
	ActionScript specification.
	* doc/C/gnash.xml: Remove AS Spec entities, they're now in
	asspec.xml. Use gnash-dev instead of gnash for questions.

2007-03-29 Markus Gothe <nietzsche@lysator.liu.se>

	gui/gtk.cpp: Indent the licensing notes. 

2007-03-29 Deanna Phillips <deanna>

	* server/vm/fn_call.h: include the stuff needed
	  for proper intrusive_ptr composition.

2007-03-29 Sandro Santilli <strk@keybit.net>

	* server/as_object.{cpp,h} add an optional argument
	  to init_property and init_readonly_proprety for setting
	  explicit flags, use same defaults as for init_member.
	* server/vm/ASHandlers.cpp (ActionEnum, ActionEnum2):
	  do not convert values to objects always.
	* testsuite/misc-mtasc.all/: Makefile.am, enum.as: 
	  Add test for ActionEnum2.
	* testsuite/server/Makefile.am: more linking fixes.

2007-03-29 Sandro Santilli <strk@keybit.net>

	* server/asobj/SharedObject.cpp: better stubs (nothing more).

2007-03-29 Sandro Santilli <strk@keybit.net>

	* server/movie_root.{cpp,h}: support for
	  setting scaleMode (allow scaling) and
	  notifying Stage listeners when disabled.
	* server/asobj/Stage.{cpp,h}: rework layout,
	  implement addListener, removeListener and
	  scaleMode.
	* testsuite/actionscript.all/Stage.as: add a few
	  tests for Stage. The notification-based tests
	  are not automatically run yet (will need a MovieTester
	  test runner, with new interfaces to it for resize request)
	* utilities/Makefile.am: add libgnashasobjs, now needed.

2007-03-29 Ann Barcomb <kudra@domaintje.com>

	* devtools/testsuite/tabs.t: added check for hard tabs in 
	  C++ source.

2007-03-29 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{h,cpp} (goto_frame): push target
	  actions to the global list; (unload): set the _unloaded
	  flag; (m_goto_action_list): deprecated !
	* testsuite/misc-ming.all/consecutive_goto_frame_test.c:
	  don't expect a failure.
	* testsuite/swfdec/PASSING: goto3.swf succeeds.

2007-03-29 Sandro Santilli <strk@keybit.net>

	* server/asobj/string.cpp (string_split): fix compiler wanring
	  and handle SWF5 case.
	* testsuite/actionscript.all/String.as: expect less failures.
	* server/sprite_instance.{h,cpp} add queueActions() method.
	* server/swf/tag_loaders.cpp: fix compiler warnings.
	* testsuite/server/Makefile.am: link in libgnashparser for the
	  tests that turn out to need it since rob changed it from
	  noinst_LTLIBRARY to lib_LTLIBRARY.
	* configure.ac: provide MING_SUPPORTS_INIT_ACTIONS conditional.
	* testsuite/misc-ming.all/ming_utils.{h,c}: provide
	  MING_SUPPORTS_INIT_ACTIONS macro and use it to conditinally
	  buil the init acion interface.
	* testsuite/misc-ming.all/Makefile.am: provide MING_VERSION_CODE
	  macro, enable build of init_action_test when
	  MING_SUPPORTS_INIT_ACTIONS.

2007-03-28 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all: init_action_test.c
	  add a new testcase for DoInitAction.
	* testsuite/misc-ming.all/ming_utils.c, ming_utils.h
	  add a interface for adding init actions for sprites.
	  
2007-03-28  Rob Savoye  <rob@bertha.welcomehome.org>

	* autogen.sh: Make config-h.in atfer running libtoolize so
	Darwin builds stop failing.
	* configure.ac: Remove dash after cvs, it confuses rpmbuild.
	* backend/Makefile.am: List AGG headers in noinst_HEADERS.
	* macros/agg.m4: Set ac_cv_path_agg_incl based on agg_include_dir
	to save a few cycles.
	* macros/pthreads.m4: Don't set any flags for pthreads on
	Darwin. Test for the .dylib suffix too.
	* packaging/redhat/gnash.spec: Merge in changes from Redhat.
	* server/Makefile.am: Add BOOST and pthreads libs for cross
	builds.
	* server/asobj/Makefile.am: Make an installable library for
	dynamically linking on Darwin.
	* server/parser/Makefile.am: Make an installable library for
	dynamically linking on Darwin.
	* testsuite/misc-ming.all/Makefile.am: Add intervalTest.as to
	EXTRA_DIST so distcheck passes.
	* testsuite/misc-mtasc.all/Makefile.am: Add all .as files to
	EXTRA_DIST so distcheck passes. Add to CLEANFILES so distcheck
	passes. 
	* testsuite/samples/Makefile.am: Add to CLEANFILES so distcheck
	passes.
	* testsuite/libbase/Makefile.am: Link in libgnashvm too.
	* utilities/Makefile.am: Add CURLS_LIBS. Add sufix rule for for
	build swf from as files.

2007-03-28 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamGst.cpp: Make sure pipeline exists before
	  accessing it, and the same goes for the FLV parser.

2007-03-28 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (add_textfield): return void.
	* testsuite/actionscript.all/MovieClip.as: add tests for
	  createTextField().

2007-03-28 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (add_textfield): use edit_text_character,
	  not simple text_character (the latter has all the ActionScript
	  methods attached to it).
	* server/edit_text_character.{cpp,h}: keep definition
	  by intrusive_ptr.
	* server/edit_text_character.{cpp,h}: add stubs
	  for all known TextField methods.
	* server/asobj/Global.cpp: initialize the global
	  TextField class
	* testsuite/actionscript.all/: Makefile.am, TextField.as:
	  New testcase for TextField class (just checks availability
	  of stuff).

2007-03-28 Sandro Santilli <strk@keybit.net>

	* libbase/GnashException.h: Add ActionLimitException
	* server/as_environment.{cpp,h}: provide callStackDepth()
	  and cleanCallstack() methods, throw an ActionLimitException
	  when reaching 255 call stack depth.
	* server/vm/ActionExec.{cpp,h}: catch ActionLimitException
	  by aborting execution of current code.
	* server/vm/ASHandlers.cpp (ActionCallFunction): pass the
	  environment when converting function name to string.

2007-03-28 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_gst.cpp: Don't calculate the numbers of 
	  buffers to feed to the pipeline, since it makes loaded sound
	  streams stop to early.
	* libbase/FLVParser.{h,cpp}: Made it thread-safe. Fixed a lot of
	  bugs. Added support for extacting size of h.263 video.
	* server/asobj/NetConnection.cpp: Set _loader to NULL after deletion.
	* server/asobj/NetStreamFfmpeg.cpp: Corrected some error messages and
	  error handling.
	* server/asobj/NetStreamGst.{h,cpp}: Use our internal FLVParser
	  when FLV is being played.

2007-03-28 Sandro Santilli <strk@keybit.net>

	* server/array.{cpp,h}: implement Array.splice(),
	  improve toString to actually call the user-provided
	  toString on all elements.
	* testsuite/actionscript.all/array.as: added testcases
	  for Array.splice().
	* testsuite/misc-ming.all/Dejagnu.c: use a larger window for traces.
	* testsuite/misc-ming.all/: FlashVarsTest.as, FlashVarsTest.html,
	  Makefile.am: added a test for querystring and flashparams parsing.
	* server/sprite_instance.cpp (loadMovie):
	  Parse the querystring given in the URL.

2007-03-28 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/as_value.h: Add as_value::to_number<type>(), which will
	cast the result of to_number() to the requested number type.
	* server/as_object{.h, .cpp}: Rename init_property(name, getter)
	to init_readonly_property(name, getter).
	* server/{button_character_instance.cpp, sprite_instance.cpp):
	Update callers to use init_readonly_property.
	* server/asobj/string.cpp: Reimplement the ActionScript String
	class using std::string. Also change the style to Rob's
	preffered one.
	* testsuite/actionscript.all/String.as: Add a few more
	testcases.

2007-03-28 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{cpp,h}: add setVariables()
	  method taking a std::map.
	* gui/Player.cpp (run): parse URL query string
	  after parsing FlashVars, for proper handling precedence.
	  NOTE that this won't work when load starts from an internal
	  call (loadMovie, getUrl with target etc.)

2007-03-27 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_ogl.cpp: Added anti-aliasing for polygons
	  (i.e. fonts and such).

2007-03-27 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{cpp,h}: add isUnloaded()
	  method to properly skip execution of queued
	  actions for unloaded sprites.
	* server/vm/: Makefile.am, ExecutableCode.h:
	  Add definition of a generic Executable Code
	  for use as element of the global Action Queue.
	* server/movie_root.{cpp,h}: add support for
	  a global Action Queue.

2007-03-27 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/as_object.h: Print the passed pointer type
	rather than the intrusive_ptr in which it is contained.

2007-03-27 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Date.as:
	  Commented out a test that also fails with
	  the proprietary player (seems related to
	  DST, started failing when it entered in effect).
	  Anyone willing to fix the test is welcome.
	* server/sprite_instance.cpp (execute_frame_tags):
	  Execute init actions immediately. This might change
	  when we get actions execution order definitively right
	  but it's useful to commit now has a facility for keep
	  tracking youtube missing bits.

2007-03-25 Martin Guy <martinwguy@yahoo.it>

	* configure.ac: reformat all "package not installed" messages
	  to the same layout
	* configure.ac: Fail during configure if AGG libraries not detected;
	  AGG is no longer "experimental"
	* configure.ac: Regularise layout of AC_ARG_*

2007-03-25 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as: print a warning
	  about possible confusion created by bugs in the proprietary
	  players.
	* testsuite/actionscript.all/NetConnection.as:
	  getURL doesn't exist, and connect returns
	  a boolean value.

2007-03-24 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/LoadThread.{cpp,h}: Changed so that it is possible to
	  check if the stream is valid.
	* server/StreamProvider.cpp: Check if local file exists before
	  creating the tu_file.
	* server/asobj/NetConnection.cpp: Changed to work with the
	  LoadThread changes. Added an assert for a valid URL.

2007-03-24 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp (readPlaceActions): gracely handle
	  malformed SWF produced by some old snapshot of Ming CVS.
	* testsuite/misc-ming.all/Makefile.am:
	  Don't try to build tests unsupported by 
	  the installed Ming version.

2007-03-24 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/as_function.cpp: Partially revert changes related to fn_call
	which mysteriously broke the testsuite.
	* server/vm/fn_call.h: Make nargs non-const and add a setter for offset
	so as_function can modify them.

2007-03-23 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamFfmpeg.cpp: Fixed getting time when
	  decoder isn't initialized.

2007-03-23 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Count videos sounds.
	* libbase/FLVParser.{h,cpp}: Added. Our own homegrown FLV parser.
	* libbase/LoadThread.{h,cpp}: Use auto_ptr<tu_file> instead of tu_file,
	  and added the isPositionConfirmed() function.
	* libbase/Makefile.am: Added FLVParser.{h,cpp}.
	* macros/libXML.m4: A fix for when using --with-libxml-incl
	* server/video_stream_instance.cpp: Use Advance to investigate if a new
	  video frame is ready, and decide if the bouds should be invalidated.
	* server/asobj/NetConnection.{h,cpp}: Pass a auto_ptr<tu_file> to 
	  LoadThread. Always check if the loader exists before using it.
	  Added connectParser to make it possible for the parser to access the file.
	* server/asobj/NetStream.{h,cpp}: Implemented setBufferTime and onStatus.
	* server/asobj/NetStreamFfmpeg.{h,cpp}: Use the new FLVParser when we
	  play a FLV. Added more comments. Implemented setBufferTime, and made
	  things ready for onStatus.
	* server/asobj/NetStreamGst.{cpp,h}: Added stubs and small updates to 
	  keep up with NetStreamFfmpeg. Some work on supporting the -r1 switch.
	* server/asobj/SoundGst.cpp: Removed a printf.

2007-03-22 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/PASSING: two more successes.
	* server/stream.{cpp,h} (read_uint): don't force return
	  to fit in a short. Fixes a regression for 3dtris.swf.

2007-03-22 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/as_object.cpp: in set_member_default(), only setValue()
	on properties that aren't read-only. Add an init_property()
	method specifically for read-only properties which takes only
	a setter. Also add a method asPropName() that converts property
	names to lowercase, which is a very common pattern in this
	class.
	* server/button_character_instance.cpp,
	server/character{.cpp, .h}, server/character_instance.cpp:
	Use the new init_property() for read-only properties. Don't
	check if read-only properties are being set in getters.
	* server/vm/fn_call.h: Make fn_call more robust: rename
	first_arg_bottom_index to _stack_offset, which I think is more
	descriptive. Make _stack_offset and _env private properties; add
	accessors for them. Make nargs a const property. Add doxygen
	comments for all members.
	* all over the place: Adjust all users of fn_call members.
	Make sure all callers use the new accessors and that no caller
	tries to set now-const properties.

2007-03-22 Sandro Santilli <strk@keybit.net>

	* server/asobj/Number.cpp: don't attach Number interface
	  to the Number class itself.
	* testsuite/actionscript.all/Number.as: more tests
	  for valueOf,toString (many still fail for SWF5).

2007-03-22 Sandro Santilli <strk@keybit.net>

	* server/font.cpp, server/stream.cpp, server/swf/tag_loaders.cpp:
	  Fixed signedness warnings after stream interface update.

2007-03-22 Sandro Santilli <strk@keybit.net>

	* server/stream.{cpp,h}: fix signedness of integers.
	* server/parser/button_character_def.cpp (read):
	  Survive malformation of button2 events action tags.

2007-03-22 Sandro Santilli <strk@keybit.net>

	* server/as_value.{h,cpp}: drop all methods transparently
	  calling to_number w/out passing an as_environment.
	* server/asobj/Global.cpp, server/asobj/xml.cpp,
	  server/vm/ASHandlers.cpp: properly update to explicitly
	  invoke as_value::to_number() when needed.

2007-03-22 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all: action_execution_order_test6.c, Makefile.am.
	  add a new testcase for passing-by MovieClip events.

	  
2007-03-22 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/PASSING: comparisons-7.swf now passes.
	* testsuite/actionscript.all/Number.as: add tests for
	  comparison operators (unfortunately Ming never outputs
	  ActionGreater, but swfdec testsuite contains it).
	* server/vm/ASHandlers.cpp (ActionNewLessThen, ActionGreater):
	  return undefined if numeric conversion returns NaN.
	* server/as_value.h: drop 'operator<', is not appropriate as
	  it insists in returning a bool, while we might eventually
	  get an undefined value.

2007-03-21 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/check.as: define
	  MING_SUPPORTS_ASM_GETPROPERTY.
	* testsuite/actionscript.all/MovieClip.as: add test for
	  getproperty call w/out an explicit target.
	* server/impl.cpp (create_library_movie): include SWF version info,
	  at least it's now shown with a bare -v.
	* server/vm/ASHandlers.cpp (ActionGetProperty):
	  An empty string as target means we pick the current top
	  of scope stack. (SWFHandlers ctor): add comments for
	  hard-coded numbers properties should have.

2007-03-21 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionSubString): when length argument
	  is negative take it as full string length.
	* testsuite/actionscript.all/String.as: add tests for 'substring'
	  action with negative length parameter.

2007-03-21 Sandro Santilli <strk@keybit.net>

	* server/as_function.cpp (extends): when VM version is > 5
	  set 'prototype.__constructor__'  in addition to
	  'prototype.constructor'
	* server/swf_function.cpp (getSuper): user __proto__.__constructor
	  rather then __proto__.constructor.
	* testsuite/actionscript.all/: Function.as, Inheritance: more
	  successes.

2007-03-21 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/PASSING: new successes: onload-childparent.swf,
	  registerclass-previous.swf.
	* server/vm/ASHandlers.cpp (ActionCallFunction):
	  When function is an object, invoke it's 'constructor';
	  Properly set the 'this' pointer.
	* testsuite/actionscript.all/Function.as: more successes.


2007-03-21 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/action_execution_order_extend_test.c:
	  fix calling _root.note
	  
2007-03-20 Martin Guy <martinwguy@yahoo.it>

	* configure.ac:
	  Remove duplicate of presence tests for JPEG KDE QT.
	  Say what to install for KDE QT MYSQL.
	* configure.ac macros/kde.m4:
	  Fix broken QT detection on Debian.

2007-03-20 Ann Barcomb <kudra@domaintje.com>

	* server/asobj/gen-asclass.pl: Produces exactly the same output
	  as gen-asclass.sh with some extra features.

2007-03-20 Sandro Santilli <strk@keybit.net>

	* server/builtin_function.h (ctor): add a 'constructor'
	  property pointing to self.
	* testsuite/actionscript.all/LocalConnection.as: add tests
	  for existance of functions that somehow slipped into Gnash.
	* server/as_function.{cpp,h}: add getFunctionConstructor()
	  public static method.
	* server/swf_function.cpp: passing Function as the constructor
	  property of user-defined functions.
	* testsuite/actionscript.all/Function.as: more successes.
	* testsuite/actionscript.all/Inheritance.as: more successes.

2007-03-20 Sandro Santilli <strk@keybit.net>

	* server/as_function.{cpp,h}: add a constructInstance()
	  function taking care of proper ActionScript instances
	  initialization.
	* server/asobj/: Boolean.cpp, Number.cpp, string.cpp
	  (init_{boolean,number,string}_instance): use 
	  the new as_function::constructInstance() method
	  to correctly initialize instances.
	* server/vm/ASHandlers.cpp (construct_object): simply
	  forward the call to as_function::constructInstance().
	* testsuite/actionscript.all/Function.as: more successes.

2007-03-20 Antti Ajanki <antti.ajanki@iki.fi>

	* gui/{kde.cpp, kdesup.h}, plugin/klash/klash_part.cpp: When
	embedding a Gnash into Konqueror, skip window creation. This also
	fixes a problem with scaling.	

2007-03-20 Ann Barcomb <kudra@domaintje.com>

	* doc/C/actionscript/new_as_class.xml: Change documentation to
	  intrusive_ptr (see Sandro's previous commits).

2007-03-20 Sandro Santilli <strk@keybit.net>

	* server/as_value.cpp, server/asobj/Boolean.cpp,
	  server/asobj/Boolean.h, server/asobj/Number.cpp,
	  server/asobj/Number.h, server/asobj/gstring.h,
	  server/asobj/string.cpp: Implement init_boolean_instance
	  and change init_{number,string}_instance to return
	  by intrusive_ptr (rather then auto_ptr).
	  Do automatic boolean to Boolean conversion in as_value::to_object.
	* testsuite/actionscript.all/Function.as:
	  Couple of more successes.

2007-03-20 Sandro Santilli <strk@keybit.net>

	* server/array.cpp, server/as_environment.cpp,
	server/as_function.cpp, server/as_object.cpp,
	server/as_object.h, server/as_value.cpp, server/as_value.h,
	server/button_character_instance.cpp, server/character.cpp,
	server/debugger.cpp, server/edit_text_character.cpp,
	server/shm.cpp, server/sprite_instance.cpp,
	server/sprite_instance.h, server/swf_function.cpp,
	server/swf_function.h, server/textformat.cpp, server/timers.cpp,
	server/timers.h, server/video_stream_instance.cpp,
	server/video_stream_instance.h, server/asobj/Boolean.cpp,
	server/asobj/ContextMenu.cpp, server/asobj/Date.cpp,
	server/asobj/Global.cpp, server/asobj/Key.cpp, server/asobj/Key.h,
	server/asobj/LoadVars.cpp, server/asobj/LocalConnection.cpp,
	server/asobj/MovieClipLoader.cpp,
	server/asobj/NetConnection.cpp, server/asobj/NetConnection.h,
	server/asobj/NetStream.cpp, server/asobj/NetStream.h,
	server/asobj/NetStreamGst.cpp, server/asobj/Object.cpp,
	server/asobj/Sound.cpp, server/asobj/string.cpp,
	server/asobj/xml.cpp, server/asobj/xmlnode.cpp,
	server/asobj/xmlsocket.cpp, server/vm/ASHandlers.cpp,
	server/vm/fn_call.h, server/vm/with_stack_entry.h,
	testsuite/server/GetterSetterTest.cpp:
	Reduce use of "dumb" pointers, using intrusive_ptr instead.
	A side-effect is the player2.swf premature deletion assertion
	is not triggered anymore now.

2007-03-20 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/LocalConnection.as: Fix the test to NOT
	  rely on Gnash extensions. Actually check that the extensions are
	  *not* there, as we want to be compatible !!

2007-03-20 Ann Barcomb <kudra@domaintje.com>

	* server/asobj/Key.cpp, MovieClipLoader.cpp, xml.cpp, xmlnode.cpp,
	  xmlsocket.cpp: Change casts and asserts to ensureType.

2007-03-20 Ann Barcomb <kudra@domaintje.com>

	* server/asobj/ContextMenu.cpp, Date.cpp, LoadVars.cpp, string.cpp,
	  NetConnection.cpp, NetStream.cpp, Sound.cpp, gen-asclass.sh:
	  Changed instances of ensureClass to use inherited ensureType.

2007-03-20 Ann Barcomb <kudra@domaintje.com>

	* doc/C/actionscript/new_as_class.xml: syntax of 'ensure'
	  changed to correspond with Bastiaan's last commit.

2007-03-20 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/as_object.h: Add ensureType<classname>, which is intended to
	replace the class-specific ensureClass functions. Suggested by Ann.
	Demangle the object name in the exception message if GCC >= 3 is being
	used.
	* server/asobj/Boolean.cpp: Switch ensureClass to ensureType.
	* server/vm/ASHandlers.cpp: In ActionDelete(), don't pop an object off
	the AS stack in the hopes that it magically has a property which might
	be the object that is to be deleted. Instead, traverse the stack using
	delVariable().
	* server/as_object.h: Remove the ensureType for raw pointers in favour
	of the one for intrusive pointers; the former is now unused.
	* server/asobj/NetStreamFfmpeg.cpp: Update for changes in ensureType.
	* server/asobj/LocalConnection.cpp: Don't initialise Gnash-only methods
	that were intended for debugging.

2007-03-19 Sandro Santilli <strk@keybit.net>

	* server/as_value.{cpp,h}: simplify union by using
	  a single pointer value, toward using a smart pointer
	  there.
	* testsuite/actionscript.all/Function.as: expect a couple
	  of successes I missed on last commit.

2007-03-19 Ann Barcomb <kudra@domaintje.com>

	* server/as_object.h: corrected Doxygen comments about
	  get_member() versus gettersetter methods.

2007-03-19 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Function.as: add more tests
	  for 'constructor', '__constructor__' and super.
	  A lot of them fail and the test is still not complete.

2007-03-19 Ann Barcomb <kudra@domaintje.com>

	* doc/C/actionscript/new_as_class.xml: document the changed syntax
	  for returning a value (see Bastiaan's commit).

2007-03-19 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/vm/fn_call.h: Remove fn_call::result. Instead, all methods and
	functions called by ActionScript must return as_value. Thanks to Ann 
	for the suggestion and for help with regular expressions.
	* all over the place: Switch all ActionScript-called methods over to
	return as_value. Adjust all related methods. Also make fn_call::nargs
	unsigned.
	* server/as_value.h: Add additional constructors taking longs as
	arguments to account for platforms that define size types as longs.

2007-03-19 Ann Barcomb <kudra@domaintje.com>

	* doc/C/actionscript.xml, doc/C/actionscript/*, doc/C/Makefile.am:
	  Split main.xml into multiple files.

2007-03-19 Sandro Santilli <strk@keybit.net>

	* server/timers.cpp (timer_setinterval):
	  Accept call in the form setInterval(obj, methodname, timer);
	  warn about unsupported args (right-most arguments).

2007-03-19 Ann Barcomb <kudra@domaintje.com>

	* doc/C/actionscript.xml, doc/C/gnash.xml, doc/C/actionscript/main.xml,
	  doc/C/Makefile.am: ActionScript has been removed from the Gnash
	  manual.  A new ActionScript manual has been created.  Most of
	  material has been rewritten and incorporates Sandro's
	  feedback on the previous version.

2007-03-19 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ming_utils.h: Add Ming defines available onl
	in CVS; some of the new testcases depend on these. Suggested by
	Benjamin Otte.

2007-03-19 Bastiaan Jacques <bastiaan@bjacques.org>

	* testsuite/actionscript.all/LoadVars.as: Don't assume that the system on
	which testcases are run has a HTTP server running on localhost that meets
	our specifications. Instead, read object property data from a local file
	and update the expected output to match.

2007-03-19 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/action_execution_order_test4.c:
	  add tests about onClipEvent(onConstruct) and user defined onLoad for _root
	  
2007-03-18 Bastiaan Jacques <bastiaan@bjacques.org>

	* testsuite/libamf.all/test_number.cpp: Don't overflow the data buffer.

2007-03-18 Antti Ajanki <antti.ajanki@iki.fi>

	* gui/kde.cpp: Since the GUI callbacks are no longer statics, adjust
	our usage of them to match.

2007-03-17 Sandro Santilli <strk@keybit.net>

	* server/swf_function.cpp (call operator): don't
	  provide 'super' if SWF version is < 6.

2007-03-17 Markus Gothe <nietzsche@lysator.liu.se>

	* libamf/amf.h: Fixed a naming issue on non-GCC.
	* server/asobj/Date.cpp: Fixed namespace-issue for 'trunc'

2007-03-16 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp: more usage of as_value::to_debug_string().
	* server/as_value.{cpp,h}: add to_debug_string(), have output
	  operator use it.
	* server/as_environment.{cpp,h}: use debugging output for as_values
	  when dumping stack,registers and locals.

2007-03-16  Rob Savoye  <rob@bertha.welcomehome.org>

	* testsuite/libamf.all/string-variable.amf:  Binary test case for
	string variables.
	* testsuite/libamf.all/number-variable.amf: Binary test case for
	numeric variables.
	* testsuite/libamf.all/test_variable.cpp: Test case for encoding
	and decoding variable assignments which as used in AMF objects.
	* libamf/amf.cpp, amf.h: Add support for encoding variables. Make
	extractVariables actually set the fields of the element so they
	have some value when returned.
	
	* libamf/amf.cpp, amf.h: Use capitols for enum values. Fix
	encoding and decoding of numbers, strings, and objects.
	* libamf/rtmp.cpp, rtmp.h: Use capitols for enum values. 
	* libamf/Makefile.am: Remove amftest.cpp, it's now in testsuites
	where it belongs.
	* testsuite/Makefile.am: Add libamf.all directory.
	* testsuite/libamf.all/Makefile.am: Build test cases, do "make
	check".
	* testsuite/libamf.all/test_number.cpp: Test case for AMF numbers.
	* testsuite/libamf.all/test_object.cpp: Test case for AMF objects.
	* testsuite/libamf.all/test_string.cpp: Test case for AMF strings.
	* testsuite/libamf.all/f03f.amf: Binary test file for number format.
	* testsuite/libamf.all/connect-object.amf: Binary test file for
	object format. 
	* testsuite/libamf.all/connect-string.amf: Binary test file for
	string format.

2007-03-16 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/: Function.as, Inheritance.as:
	  Some more tests for __constructor__.
	* server/vm/ASHandlers.cpp (construct_object): set up the
	  undocumented and non-standard __constructor__ member.
	* server/asobj/Object.cpp (object_registerClass): don't forget
	  to return a boolean value !
	* server/sprite_instance.cpp: allow overriding the _name property.
	* testsuite/swfdec/PASSING: more successes.

2007-03-16 Sandro Santilli <strk@keybit.net>

	* server/as_value.{cpp,h}: depreciate operator+=, implement valueOf
	  calling.
	* server/vm/ASHandlers.cpp (ActionNewAdd): pass environment over
	  calls to as_value::to_number, for properly calling valueOf.
	* testsuite/actionscript.all/Number.as: more tests for valueOf
	* testsuite/misc-ming.all/: .cvsignore, Makefile.am:
	  Automate run of the new testcases.

2007-03-16 Zou Lunkai <zoulunkai@gmail.com>

	* tesrttsuite/misc-ming.all/action_execution_order_test4.c.
	* testsuite/misc-ming.all/action_execution_order_test5.c.
	  add 2 more testcases to verify actions execution order.
	  
2007-03-13 Sandro Santilli <strk@keybit.net>

	* server/as_value.h (to_number): null and undefined are converted
	  to NaN for SWF7 up; drop is_inf,is_finite and is_nan methods,
	  handle in the caller.
	* server/asobj/Global.cpp: proved _global.NaN and _global.Infinity
	  values; fix isFinite() and isNaN().
	* testsuite/actionscript.all/Number.as: more tests for the NaN and
	  Infinity values.
	* server/as_value.cpp (to_tu_string): both -0.0 and 0.0 number values
	  get converted to the string "0".
	* testsuite/actionscript.all/Boolean.as: do not expect failures for
	  string to boolean conversion for SWF7 up.
	* server/as_value.cpp (to_bool): have NaN numbers evaluate to
	  false; add version-specific versions to_bool_v5(), to_bool_v6() and
	  to_bool_v7(); add to_std_string_versioned.
	* testsuite/server/: DisplayListTest.cpp, GetterSetterTest.cpp,
	  MatrixTest.cpp, PropertyListTest.cpp, as_prop_flagsTest.cpp: 
	  include check.h last, to avoid 'check' macro to clash with boost
	  headers (ptr_container stuff).
	* server/sprite_instance.cpp: add support for MovieClip.loadVariables.
	* server/Makefile.am, server/LoadVariablesThread.{cpp,h},
	  server/asobj/LoadVars.cpp: extracted what was previously called LoadRequest
	  in LoadVars.cpp, for general use, cleanups.
	* server/vm/ASHandlers.cpp (CommonGetUrl): add support for the
	  loadVariables flag.
	* testsuite/misc-mtasc.all/function.as: add more test for
	  the arguments object.
	* server/vm/ASHandlers.cpp (ActionNewAdd, ActionTrace): pass an environment when
	  converting as_value to string, to properly invoke any toString
	  method.
	* server/character.cpp (parent_getset): _parent is undefined (not
	  null) for _root sprite.
	* testsuite/actionscript.all/String.as: add tests for automatic
	  calling of the toString() method.
	* testsuite/actionscript.all/Function.as: add tests for toString
	  method.
	* server/as_function.h: override get_text_value() to properly return
	  '[type Function]'.
	* server/as_value.cpp (convertion to string): Invoke any toString method
	  associated with objects, if caller properly passes an as_environment
	  to use in the call.
	* testsuite/swfdec/PASSING: many more successes.
	* server/as_value.h: add constructor by const std::string ref.
	* server/vm/VM.{h,cpp}: add getPlayerVersion()
	* server/asobj/System.{h,cpp}: cleanups, use getPlayerVersion()
	  for System.capabilities.version
	* server/sprite_instance.cpp (attachMovieClipProperties): initialize
	  the $version member.
	* testsuite/actionscript.all/MovieClip.as: more tests for the '$version'
	  built-in variable; new test for _parent of root being undefined (not
	  null).
	* server/as_object.{cpp,h}: add a third argument for init_member to
	  override protection (can be omitted to use previous default).
	  
2007-03-13 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/System.as: add checks for $version.
	* testsuite/swfdec/PASSING: 3 more tests succeed.
	* server/sprite_instance.cpp (get_text_value): remove the trailing
	  dot from name of top-level movies.

2007-03-12  John Gilmore  <gnu@toad.com>

	* configure.ac:  Suggest agg-2.5 rather than 2.4 if
	agg_gradient_lut.h is missing.
	* configure.ac:  Sandro's fix to "ming version" test that failed if
	ming was not installed.
	
2007-03-12 Sandro Santilli <strk@keybit.net>

	* server/as_object.cpp (init_member): fix typo setting flags
	  for buiting methods all wrong.
	* testsuite/actionscript.all/delete.as: don't expect the failures
	  on function prototype deletion anymore.
	* server/button_character_instance.{cpp,h}: implement
	  ::construct() to postpone characters instance name assignmnet
	  at stage placement time.

2007-03-12 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/character.h: introduce wantsInstanceName() to provide
	  a clean way to tell which objects need an instance name	
	* server/button_character_instance.{h,cpp}: Give childs a name;
	  implement get_relative_target() for buttons; define that
	  buttons should get instance names	
	* server/edit_text_character.h: text fields need instance names
	  too
	* server/sprite_instance.{h,cpp}: implement and use 
	  wantInstancename()
				 

2007-03-12 Sandro Santilli <strk@keybit.net>

	* server/as_prop_flags.h: add equality and inequality operators.
	* testsuite/actionscript.all/delete.as: add test verifying that
	  delete on object references won't affect other references
	  on the same object; add test to check that a user-defined
	  function's prototype is not deletable (fails in Gnash!).
	* server/vm/ASHandlers.cpp (ActionCallFunction, ActionCallMethod,
	  ActionNewMethod): rather then pushing undefined values for
	  missing argument values on the stack, warn about the type of
	  SWF malformation and modify the number of args by using at most
	  what's on the stack.
	* testsuite/swfdec/PASSING: callfunction-stack.swf
	  now succeeds.

2007-03-12 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/Boolean.cpp: Add ensureBoolean() to guard
	  casts.

2007-03-12 Sandro Santilli <strk@keybit.net>
 
	* testsuite/actionscript.all/Global.as: argh, it
	  seems that _global is a non-Object object :!? 
	* testsuite/swfdec/PASSING: 3 newly added swfdec tests
	  succeed in Gnash.
	* testsuite/misc-ming.all/Makefile.am: activated the
	  new action execution order tests.

2007-03-11 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/action_execution_order_test1.c.
	* testsuite/misc-ming.all/action_execution_order_test2.c.
	* testsuite/misc-ming.all/action_execution_order_test3.c.
	  3 new testcases to verify action execution order.
	  
2007-03-11 Deanna Phillips <deanna>

	* cygnal/stream.cpp: Added #include <unistd.h>

2007-03-10  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/boost.m4: Only select one library! So please leave the
	break lines in after the libraries are matched in the file
	system. Check for date_time in the same way to handle the weird
	naming of boost libraries.

2007-03-10 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: 
	  Import Dejagnu.swf from the same dir the SWF is in, to work
	  around player8+ lame security model.
	* server/array.{cpp,h}: provide an override for
	  Object.toString().
	* testsuite/swfdec/PASSING: array.swf now passes.

2007-03-10 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/PASSING: expect 5 more successes.
	* testsuite/swfdec/swfdec_gnash_tester: allow 11 advances rather
	  then 10 (this is likely due to Gnash current additional advance
	  required for proper construction of initial stage). Makes 5 more
	  tests from the swfdec testsuite pass (including gotoframe!!).
	* server/sprite_instance.cpp (add_display_object):
	  Only syntetize instance names for sprite instances
	  (fixes swfdec's names.swf testcase).

2007-03-09 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/LoadThread.h: Documented the class.

2007-03-09 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/swfdec_gnash_tester: 
	  Fixed to allow loopbacks.

2007-03-09 Stuart Anderson <anderson@netsweng.com>

	* testsuite/misc-ming.all/Makefile.am: fix check rule
	  when building with Ming < 0.4.0-beta2.

2007-03-09 Sandro Santilli <strk@keybit.net>

	* configure.ad: Add MAKESWF_SUPPORTS_PREBUILT_CLIPS conditional.
	* extensions/dejagnu/dejagnu.cpp, extensions/fileio/fileio.cpp:
	  Use builtin_function and init_member for members initialization.
	* server/as_value.{cpp,h}, server/vm/ASHandlers.cpp,
	  server/vm/action.cpp: Drop C_FUNCTION as_value type.
	  WARNING: attempts to initialize as_values with
	  a function pointer will now result in BOOLEAN values !!
	  The compiler will warn you about this, but make sure
	  you enable warnings.
	* server/: sprite_instance.cpp, textformat.cpp,
	  video_stream_instance.cpp, edit_text_character.cpp:
	  Use builtin_function for function as_values.

2007-03-09 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/LoadThread.{h,cpp}: Added implementation of a download thread.
	* libbase/Makefile.am: Included LoadThread.{h,cpp}.
	* libbase/curl_adapter.cpp, libbase/noseek_fd_adapter.cpp, 
	  libbase/tu_file.{h,cpp}, libbase/zlib_adapter.cpp: Removed 
	  get_cur_stream_size(), instead used LoadThread::getBytesLoaded().
	* server/asobj/NetConnection.cpp: Use LoadThread.
	* server/asobj/NetStream.{h,cpp}, server/asobj/NetStreamFfmpeg.{h,cpp},
	  server/asobj/Sound.{h,cpp}, server/asobj/SoundFfmpeg.{h,cpp}: Fixed
	  compilation with newer FFMPEG versions.

2007-03-09 Sandro Santilli <strk@keybit.net>

	* server/asobj/xmlsocket.cpp: use call_method() and call_method0()
	  rather then duplicate its implementation.
	* server/asobj/xml.cpp: use call_method() rather then 
	  duplicate its implementation.
	* server/as_environment.cpp: include index in registers dump.
	* server/vm/ASHandlers.cpp (ActionEnumerate, ActionEnumerate2):
	  Make 'for (i in <non-object-value>)' an ASCODING error.
	* server/: sprite_instance.{cpp,h}, character.{cpp,h}:
	  Moved getNextUnnamedInstanceName() from sprite_instance
	  to character, for use withing other character types
	  (like buttons) and use a single counter for the whole
	  application.

2007-03-09 Sandro Santilli <strk@keybit.net>

	* server/asobj/Object.cpp: remove TESTING
	  warnings for getOwnProperty, isPrototypeOf and
	  isPropertyEnumerable. Warn only once about unimplemented
	  watch and unwatch methods.
	* server/vm/ASHandlers.cpp: warn only once about 
	  Enum2 being in TESTING stage.

2007-03-09 Sandro Santilli <strk@keybit.net>

	* server/as_object.{cpp,h}: add getOwnProperty and prototypeOf()
	  public methods.
	* server/asobj/Object.cpp: implement Object.hasOwnProperty(),
	  Object.isPropertyEnumerable() and isPrototypeOf(); stub
	  Object.watch() and Object.unwatch().
	* testsuite/actionscript.all/Object.as: add tests for
	  Object.hasOwnProperty(), Object.isPropertyEnumerable() and
	  isPrototypeOf(); add TODO note for testing Object.watch()
	  and Object.unwatch().

2007-03-08 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/character.h: drop m_enabled since nobody uses it
	* server/button_character_instance.{h,cpp}: add "enabled" property
	  and receive mouse events only when enabled		  

2007-03-08 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gtk.cpp: Fix GTK/AGG redrawing upon expose events by switching
	to the new invalidation interface. In this incarnation, only the area
	which is newly exposed is redrawn.

2007-03-08 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* extensions/fileio/fileio.cpp: Fixed fread() 

2007-03-08 Sandro Santilli <strk@keybit.net>

	* server/as_object.h: new protected clearProperties() method.
	* server/sprite_instance.cpp (restart): clear properties.

2007-03-08 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (construct):
	  Ensure first frame is loaded, to eventually not waiting for
	  ::advance to call ::construct and finally remove the startup
	  lateny we're currently experiencing;
	  (restart): call construct() directly, rather then postponing
	  the call to ::adnvace and relying on the crappy
	  m_onload_event_called flag.

2007-03-08 Sandro Santilli <strk@keybit.net>

	* server/character.h: document set_event_hanlder,
	  get_event_handler (as we're getting it wrong).
	* testsuite/actionscript.all/MovieClip.as:
	  Test that the onLoad member of a MovieClip
	  can be set to any value.
	* server/sprite_instance.{h,cpp}: drop unused
	  m_update_frame variable. (restart): simplify
	  and properly reset the displayList backup.

2007-03-08 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/action_execution_order_extend_test.c:
	  Add a check, seems PlaceObject2 tag should not define any functions
	  
2007-03-07 Sandro Santilli <strk@keybit.net>

	* gui/gtk.cpp: hook restart menu
	* server/sprite_instance.cpp (restart): properly
	  clear the displaylist. Invalidated bounds could
	  likely be more fine-tuned.

2007-03-07 Sandro Santilli <strk@keybit.net>

	* gui/gui.{h,cpp}: add play(), pause() and stop() methods,
	  change implementation to be semantically correct and not
	  mess with sprites playstate; Changed menu_* to non-statics
	  to properly acces state. I'm sure this will break fltk but
	  fixing should be easy with men_fun and bind1st..
	* gui/gtk.cpp: enable stop(), pause() and play() menu items.
	* server/asobj/ContextMenu.cpp: Some more stubs.
	* testsuite/actionscript.all/ContextMenu.as: Some more tests.
	* server/as_value.cpp (to_bool) don't choke
	  when converting a movieclip value to a boolean.
	* testsuite/actionscript.all/Boolean.as:
	  Add tests for convertion to boolean value.

2007-03-07 Robert Millan <rmh@aybabtu.com>

	* plugin/plugin.cpp: Guard the first argument to kill() for previously
	unconsidered values.

2007-03-07 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: fixed segfault #19223; set correct
	  visiblerect; fixed Range2d.width() usage; fixed getMaxY() usage
	* extensions/fileio/fileio.{h,cpp}: implemented an experimental 
	  scandir() function (may move to a separate extension); same story
		for unlink()
	* server/sprite_instance.cpp: Make sure clear_invalidated() is called 
	  for sprites which currently have an empty DisplayList
	* server/button_character_instance.{h,cpp}: Implemented correct behaviour
	  on button state change (invalidate only when needed, restart only
		reappeared characters)		 	

2007-03-07 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/: README, swfdec_gnash_tester:
	  Initial stuff to hook on swfdec testsuite.

2007-03-06  Rob Savoye  <rob@bertha.welcomehome.org>

	* missing: Update to newer version.
	* mkinstalldirs: Update to newer version.
	* Makefile.am: Add new "olpc" target to cross build RPM using a
	non standard config triplet to force rpmbuild to work correctly,
	since it doesn't support the vendor field. Add macros/incllist
	macros/libslist to EXTRA_DIST. 
	* packaging/redhat/gnash.spec: Add support for cross building
	RPMs.
	* packaging/redhat/rpmrc: Config file for rpmbuild to convert non
	standard config for geode-olpc into a standard i386-olpc-linux
	build, but use the correct cross compiler.
	* plugin/plugin.cpp: Cast away the const for MIME_TYPES_DESCRIPTION.
	* plugin/klash/Makefile.am: Don't build klash.moc, it's built in
	gui now.
	* configure.ac: Remove --enable-fork option, it's unused. Get the
	root directory to look for headers and libraries for a cross build
	from GCC, as the path is different when building RPMs.
	* cygnal/Makefile.am: Fix spelling of noinst_HEADERS.
	* cygnal/README: Fix typo.
	* extensions/Makefile.am: Add support for other directories for
	building a distribution.
	* extensions/gtk2/Makefile.am: Include from gui directory
	too. Don't build test program by default for now.
	* gui/Makefile.am: Add XML to include paths.
	* gui/gnash.cpp: Disable network support for now.
	* gui/gtksup.h: Return the GtkWidget handle of a window.
	* libbase/Makefile.am: PTHREAD_LIBS should always be after
	BOOST_LIBS.
	* libbase/network.cpp: Tweak debug messages. Test for priviledged
	ports. Add support for a blocking select when waiting for a
	connection.
	* macros/boost.m4: Break when the right path is found.
	* macros/ffmpeg.m4: Handle multiple directories with -I when
	setting topdir. Print a warning if avcodec.h is found, but
	avformat.h is not.
	* macros/gnashpkgtool.m4: Don't create an enable option for
	everything, it's confusing.
	* macros/kde.m4: Look in incllist as well as libslist for QT
	headers.
	* testsuite/Makefile.am: Add generic-testrunner.sh to dist_noinst_SCRIPTS.
	* testsuite/misc-ming.all/Makefile.am: Add intervalTest.as to
	EXTRA_DIST.

2007-03-06 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/render_handler_agg.cpp: Fix an off-by-one error causing
	invalid memory accesses. Use rint() instead of the missing round()
	on OpenBSD 3.9.
	* gui/fltk{.cpp, sup.h, _glue_agg.cpp, _glue_agg.h}: Reimplement AGG
	clipping using the new interfaces.
	* macros/boost.m4: Fix order of lines so that the value of LIBS is
	properly restored. Fixes bug #19211.
	* server/asobj/Date.cpp: Add an implementation (written by Sandro)
	of trunc for platforms that don't define it, e.g. OpenBSD 3.9.

2007-03-06 Sandro Santilli <strk@keybit.net>

	* server/as_value.cpp (to_to_string): positive Infinity 
	  doesn't have the plus sign prepended (at least for SWF5, didn't
	  check with other targets).
	* server/vm/ASHandlers.cpp (ActionCallMethod): properly
	  setup the 'this' pointer when not specified in the tag
	  itself as the object parameter.
	* server/vm/ActionExec.{h,cpp}:
	  Add a _this_ptr member and a getThisPointer() function
	  for use with function calls.
	* server/swf_function.cpp (operator()): setup the this_ptr
	  in ActionExec instance.
	* testsuite/misc-mtasc.all/function.as: unexpect last failure.
	  Looking for more failures now...

2007-03-06 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-mtasc.all/function.as:
	  Add a (succeeding) test for 'this' pointer being correctly set
	  on ActionCallMethod with *defined* name.

2007-03-06 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* libgeometry/snappingrange2d.h: do not call combine_ranges() too 
	  often	

2007-03-06 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionCallMethod): when method name
	  is undefined, we must use the provided object's constructor.
	* testsuite/misc-mtasc.all/function.as: add (failing) test for
	  'this' pointer being correctly set on ActionCallMethod.

2007-03-06 Ann Barcomb <kudra@domaintje.com>

	* server/asobj/xmlsocket.cpp: convert init_member to new
	syntax.

2007-03-06 Sandro Santilli <strk@keybit.net>

	* server/as_object.cpp (instanceOf): made circular inheritance an
	  aserror. 
	* testsuite/actionscript.all/Inheritance.as: test circular inheritance
	  detection.
	* server/vm/ASHandlers.cpp (ActionWith): survive empty 'with' blocks.
	* testsuite/actionscript.all/with.as: test empty 'with' block.

2007-03-06 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: Round outline edge anchor points to
	  eliminate anti-aliasing blur and to do it the MM way...; draw outlines 	
	  always with at least 1.0 pixels width
	* libgeometry/snappingrange2d.h: Implement growBy()
	* gui/gui.cpp: grow invalidated ranges by 2 pixels to solve anti-aliasing
	  and outline displacement problems 	

2007-03-06 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-mtasc.all/: Makefile.am, TestClass.as, function.as:
	  Testcase for ActionCallMethod showing the 'this' pointer is not
	  correctly set in Gnash when we lack a method name.
	* server/vm/ASHandlers.cpp (ActionCallMethod): use object as a
	  function when method name is undefined. This makes a step
	  forward with laszlo, altough I'm not sure about wheter
	  the 'this' pointer is correctly set to the function itself.
	* server/debugger.{h,cpp}: use unsigned types for register indexes;
	  properly accept *const* string refs.

2007-03-05 Sandro Santilli <strk@keybit.net>

	* utilities/processor.cpp: don't call gnash::clear, I suspect
	  we're unable to properly cancel loading threads, and this
	  being the cause for the occasional segfaults raising on 
	  'make check' (to be confirmed, hopefully).

2007-03-05 Ann Barcomb <kudra@domaintje.com>

	* server/asobj/xmlnode.cpp: convert init_member to new
          interface.

2007-03-05 Sandro Santilli <strk@keybit.net>

	* server/: character.h, sprite_instance.{h,cpp}:
	  Add character::unload() virtual method to properly unload
	  child elements.
	* server/dlist.cpp: call character::unload() rather then
	  directly invoking the UNLOAD event.
	* testsuite/misc-ming.all/action_execution_order_extend_test.c:
	  Do not expect failures of unload event execution.

2007-03-05 Ann Barcomb <kudra@domaintje.com>

	* doc/C/internals.xml: section 'ActionScript Support' was updated
	  in an attempt to describe the current interface.

2007-03-05 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/action_execution_order_extend_test.c:
	  Add onLoad *clip* event and verify that having the clip event
	  defined triggers actual execution of the the onLoad event
	  for it (even the user-defined one!).
	* libgeometry/snappingrange.h: add visit() templated function.
	* server/parser/movie_def_impl.h, server/parser/movie_definition.h:
	  Document movie_definition::get_bytes_total().
	* testsuite/misc-ming.all/Makefile.am: enable run
	  of action_execution_order_extend_test by 'make check'.

2007-03-05 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/action_execution_order_test.c: Comments fix.
	* testsuite/misc-ming.all/action_execution_order_extend_test.c:
	  A new testcase for testing action execution order.
	  
2007-03-04 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/curl_adapter.cpp: Added support for getting the total size
	  of file being downloaded (get_stream_size()), and the current cached 
	  size (get_cur_stream_size()).
	* libbase/tu_file.{cpp,h}: Added get_size() and get_cur_size() which 
	  uses get_stream_size() and get_cur_stream_size().
	* libbase/noseek_fd_adapter.cpp, libbase/zlib_adapter.cpp: Added dummy
	  support for get_stream_size() and get_cur_stream_size()
	* server/asobj/NetConnection.{cpp,h}: Switched to use StreamProvider
	* server/asobj/NetStream.{cpp,h}, server/asobj/NetStreamFfmpeg.{cpp,h},
	  server/asobj/NetStreamGst.{cpp,h}: Added support for the bytesLoaded 
	  and bytesTotal property.

2007-03-03 Sandro Santilli <strk@keybit.net>

	* server/as_value.h: add ALLOW_C_FUNCTION_VALUES to prepare
	  for dropping C_FUNCTION value types as a whole. Undefine
	  it to make finding bogus uses easier and finish the
	  work in asobj/.
	* server/asobj/: MovieClipLoader.cpp, Number.cpp, Object.cpp,
	  Selection.cpp, SharedObject.cpp, Sound.cpp, Stage.cpp,
	  System.cpp, TextSnapshot.cpp, Video.cpp, xml.cpp:
	  Use builtin_function when initializing methods.
	* server/asobj/: Boolean.cpp, Camera.cpp, Color.cpp,
	  ContextMenu.cpp, CustomActions.cpp, Date.cpp, Error.cpp,
	  Global.cpp, Key.cpp, gLoadVars.cpp, LocalConnection.cpp,
	  Math.cpp, Microphone.cpp, Mouse.cpp, NetConnection.cpp,
	  NetStream.cpp:
	  Use builtin_function when initializing methods.

2007-03-03 Sandro Santilli <strk@keybit.net>

	* server/as_value.{cpp,h}: always check for real type
	  of an as_object to properly set type to AS_FUNCTION
	  for actual as_function instances. always check
	  for NULL pointers to properly set type to NULLTYPE.
	  Fixes latest tests in Function.as.
	* server/: as_object.h, as_function.h:
	  Add virtual to_function() method to reduce RTTI use.
	* testsuite/actionscript.all/Function.as:
	  Test using 'this' as a constructor. Doesn't currently
	  work becase the 'this' as value is initialized to be
	  of kind OBJECT rather then AS_FUNCTION (as_value constructor
	  by as_object doesn't check real type).

2007-03-03 Martin Guy <martinwguy@yahoo.it>

	* server/as_value.cpp: More conservative version of NAN fixes.
	* testsuite/actionscript.all/Date.as: Check for Date.UTC() existing
	  and working even before a Date object is instantiated.

2007-03-03 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gtk.cpp: Don't neglect to render the buffer for renderers other
	than AGG.
	* gui/fltk.cpp: Invalidate the whole drawing area, which now appears
	to be a requirement for Agg when we choose not to let the GUI deal with
	clipping.
	* gui/sdl_agg_glue.cpp: Idem dito.

2007-03-03 Martin Guy <martinwguy@yahoo.it>

	* server/as_value.cpp: Revert "NaN" change: it makes all GUI canvasses
	  0-sized (!)
	* server/asobj/XMLNode.cpp: Fix garbled code in {previous,next}Sibling

2007-03-03 Martin Guy <martinwguy@yahoo.it>

	* testsuite/actionscript.all/Number.as: Add test for unary minus
	* testsuite/actionscript.all/Date.as: Turn "date" temp var into "d" 
	* testsuite/actionscript.all/TODO: Check result of call to undefined fn
	* server/as_value.cpp: Return NAN for bad arguments
	* server/asobj/Date.cpp: Fix compiler warning
	* server/asobj/xmlnode.cpp: Remove unused vars, highlight 2 bugs
	* server/asobj/xml.cpp: Remove unused vars, reproduce commentary
	* server/asobj/shape.cpp: Highlight possible bug
	* backend/render_handler_ogl.cpp: Removed unused variables
	* gui/gtk.cpp: Fix compiler warning signed/unsigned

2007-03-02 Sandro Santilli <strk@keybit.net>

	* server/as_environment.{cpp,h}, server/swf_function.cpp:
	  Registers must also be stacked between function calls,
	  like local vars.
	  With this commit I put local registers, local variables
	  and a function pointer into a CallFrame struct
	  and stack that directly. pushCallFrame() and popCallFrame()
	  now replace the add_frame_barrier/set_local_frame_top things.
	  This commit fixes the testcase under misc-mtasc.all !
	* server/vm/ASHandlers.cpp (ActionVar):
	  Ignore local variable declarations in non-function
	  context, and make it an aserror.
	* server/vm/ASHandlers.cpp (ActionNew): add missing
	  premature return on malformed SWF.
	* server/debugger.{cpp,h}: proxy local variables and
	  registers dumping to as_environment funx.

2007-03-02 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/libgeometry/snappingrangetest.cpp: Testcase for snapping 
	  ranges
	* libgeometry/snappingrange.h: drop DSOLOCAL
			
2007-03-02  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/libslist: Add /usr/X11/lib, without the usual R6.
	* macros/incllist: Add /usr/X11/include, without the usual R6.

2007-03-02 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-mtasc.all/inheritance.as:
	  Add more tests, more failing !

2007-03-01 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionNewMethod):
	  Use object parameter as *the* function if method name is
	  undefined; check that the constructor is actually a function;
	  (ActionNew) check that the constructor is actually a function;
	  (constructor_object) assert that the constructor is a function.
	* testsuite/misc-mtasc.all/inheritance.as:
	  Add test provided by P T Withington for debugging
	  problems with OpenLaszlo foundation classes.

2007-03-01 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetConnection.cpp: Added support for relative path.
	* server/asobj/NetStreamFfmpeg.cpp: include sound_handler.h.

2007-03-01 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/video_stream_instance.cpp: simplify add_invalidated_bounds()
	* libgeometry/snappingrange.h: Clarify comment; use initialization list
	  in constructor; some minimal changes
	* backend/render_handler.h, libgeometry/snappingrange.h: fixed some compiler 
	  warnings
	* server/gnash.h, server/types.cpp: introducing cxform::is_invisible()
	* server/sprite_instance.cpp: treat cxform.alpha==0 like !m_visible	 		
	
2007-03-01 Zou Lunkai <zoulunkai@gmail.com>

	* server/dlist.cpp: keep function declaration consistent with the headfile;
	  libamf/amf.cpp: typos, get rid of warnings for vc8 compiler.
	
2007-03-01 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/: array.as, Function.as
	  Don't expect failures when checking for missing
	  apply/call in SWF5.
	* server/as_function.cpp (getFunctionPrototype):
	  Don't register 'apply' and 'call' members if
	  SWF < 6; use builtin_function when registering them.
	* testsuite/actionscript.all/String.as:
	  Add test for 'substring' with base == length;
	  Fix test for SWF5 (no Function.call or Function.apply
	  there)
	* server/vm/ASHandlers.cpp (ActionGotoExpression):
	  Simplified function, reduced emitted warnings;
	  (ActionSubString): fix case in which base is == length.
	* server/asobj/Global.cpp: register Stage object always.
	* server/asobj/Stage.cpp: don't register addListener
	  and removeListener if SWF < 6.
	* testsuite/actionscript.all/Stage.a: update after fix.

2007-02-28 Sandro Santilli <strk@keybit.net>

	* libgeometry/Range2d.h (scale): allow the scaled range to be
	  monodimensional in any direction.
	* gui/gui.cpp: removed extra tokens at end of #include directive.
	* libgeometry/snappingrange.h: strip CRs, fix contains(), copyright
	  notice and doxygen formatting.
	* testsuite/DummyCharacter.h: update to add_invalidated_bounds
	  (would not need if character provided a default implementation :)

2007-02-28 Udo Giacomozzi <udo.gnu@nova-sys.net>

  * backend/render_handler.h, 
    gui/fb.cpp, gui/fbsup.h, gui/gtk.cpp, gui/gtksup.h, gui/gui.cpp, 
		gui/gui.h,
    server/button_character_instance.cpp,  
    server/button_character_instance.h,    
    server/character.cpp,                  
    server/character.h,                    
    server/dlist.cpp,                      
    server/dlist.h,                        
    server/edit_text_character.cpp,        
    server/edit_text_character.h,          
    server/generic_character.cpp,          
    server/generic_character.h,            
    server/movie_root.cpp,                 
    server/movie_root.h,                   
    server/render.cpp,                     
    server/render.h,                       
    server/sprite_instance.cpp,            
    server/sprite_instance.h,              
    server/video_stream_instance.cpp,      
    server/video_stream_instance.h: replace single invalidated bounds
		with new, abstract InvalidatedRanges class and 
		add_invalidated_range() function to support multiple ranges.		    
	* gui/gtk_glue_agg.cpp: corrected calculation of width/height      
  * backend/render_handler_agg.cpp: Redesigned and optimized rendering 
   	engine; avoid re-calculation of edges for sub-shapes; re-use AGG 
		paths; initialize AGG styles only once
	* libgeometry/snappingrange.h, libgeometry/Makefile.am: new class
	  for 2D range lists
	* testsuite/MovieTester.cpp: Adapted to work with multiple ranges
	* testsuite/misc-ming.all/loadMovieTestRunner.cpp: add return value		    
        
  
2007-02-28 Sandro Santilli <strk@keybit.net>
  
	* testsuite/: Makefile.am, DummyCharacter.h:
	  Dummy character instance for use in test cases.
	* testsuite/server/: Makefile.am, DisplayListTest.cpp:
	  Initial test for DisplayList (just tests equality
	  and inequality operators).
	* server/dlist.{cpp,h}: Add equality, inequality
	  and output operators.

2007-02-28 Sandro Santilli <strk@keybit.net>

	* server/array.cpp: use builtin_method for builtin
	  methods :) ensure the 'this' pointer passed
	  to builtin methods is valid.
	* testsuite/actionscript.all/array.as:
	  Add test for calling Array builtin functions 
	  using FUnction.call.

2007-02-28 Sandro Santilli <strk@keybit.net>

	* server/asobj/gen-asclass.sh: updated to
	  use new, more robust and more correct layout.
	* server/asobj/string.cpp: robustness and
	  correctness improvements: use builtin_function,
	  not c_function for buildin methods; make sure
	  methods are applied to a String instance.
	* testsuite/actionscript.all/String.as: add a
	  test for builtin methods being allowed to be
	  called using Function interface
	  (String.prototype.slice.call: just a small example)

2007-02-28 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp: use log_aserror for
	  ActionScript errors; (ActionExtends): check
	  that the thing being extended is a function !!

2007-02-28 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/String.as: add
	  test for read-only nature of 'length' property;
	  fix test for SWF5 target.

2007-02-28 Sandro Santilli <strk@keybit.net>

	* server/swf.h: add reference to ActionConstantPool
	  description
	* server/parser/action_buffer.h (read_int16):
	  Use int16_t type, not 'int'.
	* server/parser/action_buffer.cpp (process_decl_dict):
	  Use int16_t type, not 'int'.
	* server/vm/ActionExec.{cpp,h} (operator()):
	  Additional SWF consistency check for action 'length'
	  field.

2007-02-28 Sandro Santilli <strk@keybit.net>

	* server/vm/ActionExec.{cpp,h}: Survive malformed
	  SWF containing 
	* server/as_function.cpp: fix Function.apply()
	  and Function.call() to correctly fetch  the
	  'this' pointer (ie: not accessing the stack
	  directly).
	* server/swf_function.{h,cpp}: properly setup
	  the 'arguments' variable at dispatch time.
	* testsuite/actionscript.all/Function.as:
	  Test the 'arguments' variable in function context.
	* server/array.{cpp,h}: allow resize trough
	  setting the 'length' property.
	* testsuite/actionscript.all/array.as: test
	  that arrays 'length' is settable.

2007-02-28 Markus Gothe <nietzsche@lysator.liu.se>

	* server/asobj/Date.cpp: #define NAN (0.0/0.0) as this is not comp.
	  with C++98 and non-GCC compilers borks.
	* gui/gtk.cpp: Added '//' before commentary.

2007-02-27 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Date.cpp: Implement Date.UTC(). It is not yet
	  initialised properly (Date.UTC() still gives undefined)
	* testsuite/actionscript.all/Date.cpp: Test Date.UTC()
	* server/asobj/Global.cpp: remove oxbow code.
	* server/asobj/Global.cpp: bugfixen: log_aserror is (now?) printf-like
	* server/asobj/string.cpp: bugfixen: log_aserror is (now?) printf-like

2007-02-27 Sandro Santilli <strk@keybit.net>

	* libgeometry/Range2d.h: add contains(Range2d) method.
	* testsuite/libgeometry/Range2dTest.cpp: Add tests for 'contains'.

2007-02-27 Sandro Santilli <strk@keybit.net>

	* backend/Makefile.am, backend/sound_handler.h,
	  backend/sound_handler.cpp, backend/sound_handler_gst.h,
	  backend/sound_handler_sdl.h, extensions/Makefile.am,
	  gui/Player.cpp, gui/Player.h, gui/gtk.cpp, gui/gui.cpp,
	  server/Makefile.am, server/button_character_instance.h,
	  server/gnash.h, server/impl.cpp, server/impl.h,
	  server/mouse_button_state.h, server/sound.cpp, server/sound.h,
	  server/sprite_instance.cpp, server/asobj/Sound.cpp,
	  server/asobj/SoundFfmpeg.cpp, server/asobj/SoundGst.cpp,
	  server/asobj/SoundMad.cpp, server/parser/Makefile.am,
	  server/parser/button_character_def.cpp,
	  server/parser/button_character_def.h,
	  server/parser/movie_def_impl.cpp,
	  server/parser/sound_definition.cpp,
	  server/parser/sound_definition.h, server/swf/tag_loaders.cpp,
	  server/vm/ASHandlers.cpp, server/vm/action.cpp,
	  testsuite/Makefile.am, testsuite/MovieTester.cpp,
	  testsuite/MovieTester.h, testsuite/sound_handler_test.h,
	  testsuite/actionscript.all/LoadVars.as,
	  testsuite/misc-ming.all/Makefile.am,
	  testsuite/misc-mtasc.all/hello.as,
	  testsuite/movies.all/Makefile.am, testsuite/samples/Makefile.am:
	  Files scramble. sound_handler has now it's own header, sound.{cpp,h}
	  has been moved to parser/sound_definition.{cpp,h}.

2007-02-26 Markus Gothe <nietzsche@lysator.liu.se>

	* extensions/fileio/Makefile.am: Added {PTHREAD,BOOST}_CFLAGS

2007-02-26 Sandro Santilli <strk@keybit.net>

	* server/impl.cpp, server/swf/tag_loaders.{cpp,h}:
	  Add support for IMPORTASSETS2 (an SWF8 tag).

2007-02-26 Sandro Santilli <strk@keybit.net>

	* server/parser/sprite_definition.h: don't check 
	  for movie definition being NULL as we're not allowing
	  this anymore.
	* server/parser/sprite_definition.cpp (ctor) *require*
	  a movie_definition as we'll need it for a few things,
	  including getVersion..
	* server/generic_character.h: store character_def
	  by intrusive_ptr !
	* server/sprite_instance.{cpp,h}: new add_textfield method;
	  fix add_empty_movieclip to provide a movie_definition to
	  sprite-definition constructor; handle dynamic sprites
	  when calling getBytestLoaded/getBytesTotal.

2007-02-26 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Inheritance.as:
	  a couple of additional tests for accessing
	  a function's prototype after a call to
	  'extends'.
	* testsuite/misc-ming.all/RollOverOutTest.c: don't
	  use Ming-specific 'gotoFrame' ActionScript syntax.
	* testsuite/misc-ming.all/gotoFrame2Test.as: don't
	  use Ming-specific 'gotoFrame' ActionScript construct.
	  With newer Ming versions (0.4.0.beta4 up) the gotoAndPlay()
	  call will be converted to GOTOFRAME2 nonetheless.
	* server/vm/ASHandlers.cpp (ActionGotoExpression:
	  Frame are 1-based when referred to by Flash coders.
	* testsuite/samples/Makefile.am: 
	  Enabled run of GotoAndPlayTest.swf self-contained
	  testcase.

2007-02-26 Sandro Santilli <strk@keybit.net>

	* server/parser/morph2_character_def.cpp (display):
	  survive malformed SWF (mismatching number of paths
	  or edges in start and end shape); (read): warn
	  about malformed swf. Fixes bug #19085.

2007-02-26 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-mtasc.all/: Makefile.am, inheritance.as:
	  Test inheritance using MTASC.
	* server/swf_function.cpp: 'super' in function2 register is now
	  tested, don't warn anymore.

2007-02-25 Sandro Santilli <strk@keybit.net>

	* libbase/URL.cpp (encode,decode): support ' ' <=> '+' conversion.
	* server/asobj/LoadVars.cpp: add support for LoadVars.sendAndLoad().

2007-02-25 Sandro Santilli <strk@keybit.net>

	* libbase/curl_adapter.cpp: implemented seek_to_end 
	  for curl-based stream.
	* server/as_object.cpp (enumerateProperties):
	  Fix wrong 'this_ptr' send to PropertyList::enumerateKeyValue()

2007-02-25 Sandro Santilli <strk@keybit.net>

	* libbase/URL.{cpp,h}: add encode() and decode()
	  public static functions.
	* server/asobj/Global.cpp (escape/unescape):
	  Use URL::encode and URL::decode.

2007-02-25 Sandro Santilli <strk@keybit.net>

	* server/PropertyList.{cpp,h}: add
	  enumerateKeyValue() method; renamed
	  enumerateValues to enumerateKeys (makes more sense).
	* server/as_object.{cpp,h}:
	  add enumerateProperty() overloaded function to 
	  write properties to a std::map
	* testsuite/server/PropertyListTest.cpp: add
	  test for enumerateKeyValue().

2007-02-25 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetConnection.{cpp,h}:
	  Allow build w/out libcurl.
	* extensions/fileio/Makefile.am: fix
	  'make check' and 'make dist' rules.
	* server/asobj/LoadVars.cpp: implemented
	  LoadVars.loaded property.
	* testsuite/actionscript.all/LoadVars.as:
	  Test LoadVars.loaded.

2007-02-25 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/libslist: Check in lib32 before lib64.
	* utilities/processor.cpp: Fixed optopt as extern ifndef _GNUC_
	* macros/boost.m4: Generic approach to test date-time.
	* testsuite/libbase/Makefile.am: Fixed $(NULL)-bug.
	* server/asobj/Date.cpp: Removed extra ; thus letting gcc compile
	  it with -pedantic.
	* libbase/embedVideoDecoder.h: Removed errornous ','.
	* server/asobj/LoadVars.cpp: Fixed "LoadVars.cpp:160: error: ISO C++ 
	  forbids variable-size array 'buf'"
	* server/asobj/Number.cpp: \%s -> %s.

2007-02-24 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Math.as:
	  Fix testcase to reflect actual behaviour when SWF target
	  version is < 7.
	* server/asobj/LoadVars.cpp: 
	  Made code more robust, and hopefully also cleaner.
	* utilities/processor.cpp:
	  Fix waitforadvance handling. Wait 5 seconds before
	  kicking movie to next frame. This allows for testing
	  intervals and similar time-dependent features.
	* testsuite/actionscript.all/LoadVars.as:
	  Add test for LoadVars.load, LoadVars.getBytesTotal,
	  LoadVars.getBytesLoaded and LoadVars.onLoad.

2007-02-23 Sandro Santilli <strk@keybit.net>

	* server/asobj/LoadVars.cpp: 
	  Use Timers to avoid premature deletion
	  of the LoadVars object while it's loading
	  threads are still alive.

2007-02-23 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* configure.ac: Fix some minor typos

2007-02-23  Rob Savoye  <rob@ute.welcomehome.org>

	* configure.ac: Add --with-pixelformat=option to set the AGG pixel
	format via the command line to override the defaults if
	desired. Exit if one of the values for --with-pixelformat is
	bogus.

2007-02-23 Sandro Santilli <strk@keybit.net>

	* testsuite/media/: vars.txt, vars2.txt: data
	  files for use with LoadVars and loadVariables
	  tests.
	* server/as_function.h: add a call() function
	  to make operator() calls nicer when having
	  an as_function pointer.
	* server/asobj/LoadVars.cpp: implement getBytesLoaded,
	  getBytesTotal, onLoad and onData events, load() method.
	* server/StreamProvider.{cpp,h}: turn into
	  a singleton, add getStream() version taking
	  post data.
	* server/impl.cpp: use the StreamProvider singleton.

2007-02-23 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: Use PIXELFORMAT_xxx defines
	  introduced by Rob		  

2007-02-22  Rob Savoye  <rob@ute.welcomehome.org>

	* configure.ac: Set the pixel type when using AGG for better
	efficiency by looking at the GUI type. Print out MySQL paths if
	extensions are enabled. Don't build klash if KDE isn't found.

2007-02-22 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/sprite_instance.cpp: Respect m_old_invalidated_bounds even 
	  when invisible. 	

2007-02-22 Sandro Santilli <strk@keybit.net>

	* libbase/curl_adapter.cpp:
	  Use a member to store post data, as it
	  needs a longer lifetime for libcurl to work.
	* testsuite/libbase/Makefile.am:
	  Don't run CurlStreamTest by 'make check'
	  as it's not ready for automatic testing.
	* testsuite/libbase/CurlStreamTest.cpp: 
	  Turn the test into a tool supporting POST
	  operations (for manual testing it).

2007-02-22 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_gst.cpp: Removed the use of ffdec_mp3 since
	  it isn't recommended by gstreamer. Added warnings if the used
	  version of the fluendo-mp3-plugin is too low.

2007-02-22 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp, backend/render_handler_agg_style.h:
	  Switched to pre-multiplied pixel values. Fixes some anti-aliasing
	  issues and improves rendering performance, especially for gradients.
	* backend/render_handler_agg.cpp:
	  Avoid re-initialisation of AGG path class inside for-loop.
	* extensions/fileio/fileio.cpp: Fixed fgets() to avoid segfaults;
	  call fclose() in destructor to close file descriptor in any case.
	* server/movie_root.h: Provided write access for m_timer
	* gui/fb.cpp: Update global timer to make getTimer() work
	  at least with the FB GUI        

2007-02-22 Sandro Santilli <strk@keybit.net>

	* libbase/curl_adapter.{cpp,h}:
	  Add support for http POST (untested).

2007-02-21 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am:
	  Define MEDIADIR
	* testsuite/actionscript.all/check.as:
	  Provide MEDIA() macro to easy access to
	  paths in testsuite/media directory.

2007-02-21 Sandro Santilli <strk@keybit.net>

	* libbase/log.{cpp,h}: add log_debug and used
	  for GNASH_REPORT_FUNCTION.
	* server/asobj/Global.cpp, server/vm/ASHandlers.cpp:
	  Changed trace() function to use log_trace.

2007-02-21 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_{gst,sdl}.cpp: Removed newline from warnings, and 
	  added more user help.
	* macros/ffmpeg.m4: Yet another go at bug #16663.

2007-02-21 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* configure.ac, macros/ffmpeg.m4: Another go at bug #16663.
	* backend/sound_handler_gst.cpp: Added warnings when using fluendos
	  mp3 plugin for gstreamer, since it doesn't support soundstreams.

2007-02-21 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (do_actions): report actions
	  execution with -va.
	* server/vm/ASHandlers.cpp: Store number of arguments
	  into an unsigned integer. Fixes an abort with a malformed
	  SWF.
	* testsuite/misc-ming.all/eventSoundTest1-Runner.cpp:
	  Don't expect failures anymore !

2007-02-21 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* configure.ac, macros/ffmpeg.m4: Output warning when old ffmpeg-version
	  detected. Will hopefully fix bug #16663.
	* gui/Player.cpp: Set the soundhandler to NULL when shutting down, Will
	  hopefully fix bug #18545.
	* server/asobj/NetStreamFfmpeg.cpp, server/asobj/SoundFfmpeg.cpp,
	  server/asobj/SoundMad.cpp: Disconnect cleanly from the soundhandler,
	  if it exists.
	* server/sound.{cpp,h}: Made sound_stream_tag into a state tag.
	* testsuite/sound_handler_test.cpp: Increment the counting variables
	  stopped_all and started_all.

2007-02-21 Sandro Santilli <strk@keybit.net>

	* server/Makefile.am,
	  server/swf/DefineFontAlignZonesTag.{cpp,h}:
	  Initial implementation of DefineFontAlignZones
	  tag loader (unfinished).
	* server/impl.cpp: use unfinished loader for
	  DEFINEFONTALIGNZONES.
	* server/stream.h: add skip_to_tag_end() method.

2007-02-21 Sandro Santilli <strk@keybit.net>

	* server/font.{cpp,h}, server/impl.cpp,
	  server/swf/tag_loaders.{cpp,h}:
	  Add support for DEFINEFONT3 tag (not much done,
	  as Alexis report it to be equal to DEFINEFONT2 
	  in definition - needs support of DEFINEALIGNZONES
	  tag to be fully supported.

2007-02-21 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, gotoFrame2Test.as:
	  Stubbed Udo's test as Ming source and build rule and test runner.

2007-02-21 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/samples/GotoAndPlayTest.{as,swf}: Testcase for
	  gotoAndPlay() bug  

2007-02-21 Sandro Santilli <strk@keybit.net>

	* server/sound.{h,cpp}: made start_sound_tag a "state"
	  tag. This seems to fixes eventSoundTest1.swf, altoguth
	  it's runner still fails (a bug in the tester, most likely).
	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp:
	  Fixed input filename (sorry guys).

2007-02-20 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (get_topmost_mouse_entity):
	  Check also drawable bounds !
	* testsuite/misc-ming.all/DrawingApiTestRunner.cpp: 
	  Don't expect failure with filled shapes making 
	  the MovieClip grab mouse envets. Add another test
	  showing that non-filled shapes (simple lines) still
	  fail in this.

2007-02-20 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (get_invalidated_bounds):
	  Include bounds of drawable instance.
	* server/vm/with_stack_entry.h: add non-const
	  version of object() accessor.
	* server/vm/ActionExec.{cpp,h}: add getTarget()
	  method to properly set "this" pointer for function
	  calls.
	* server/vm/ASHandlers.cpp (ActionCallFunction):
	  Properly set the "this" pointer by fetching it
	  from ActionExec "thread" (looks in 'with' stack).

2007-02-20 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/with.as: add test for function
	  call in 'with' context (fails!).
	* testsuite/misc-ming.all/eventSoundTest1-Runner.cpp:
	  Fix input filename; expect the failures (we'll be happy
	  to see XPASS messages :)

2007-02-20 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/gnash.h: Added support for the new test-soundhandler.
	* testsuite/sound_handler_test.{h,cpp}: Added. A soundhandler for 
	  testing gnash.
	* testsuite/Makefile.am: Added the new test-soundhandler.
	* testsuite/MovieTester.{cpp,h}:  Added support for the new 
	  test-soundhandler.
	* testsuite/misc-ming.all/{eventSoundTest1.c,eventSoundTest1-Runner.cpp}:
	  Added. Tests simple event sounds.
	* testsuite/misc-ming.all/Makefile.am: Added the eventSoundTest1 
	  testcase and its runner.
	* testsuite/media/sound1.mp3: Added. Used in the eventSoundTest1
	  testcase.

2007-02-20 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: DrawingApi.as => DrawingApiTest.as,
	  DrawingApiTestRunner.cpp, Makefile.am:
	  Add a runner for DrawingApi test (failing).

2007-02-20 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am,
	  RollOverOutTest-Runner.cpp, root_stop_testrunner.cpp:
	  Allow run of test runners from external dirs.
	* configure.ac: report failign gstreamer detection
	  to refer to failign 0.10 or higher gstreamer 
	  detection.
	* testsuite/simple.exp: have CR also break lines.
	* testsuite/misc-ming.all/attachMovieTestRunner.cpp:
	  Oops, SWF6 is converting stuff to lowercase, so
	  we need to get_member( "mousedown"/"mouseup" )
	  rather then "mouseDown"/"mouseUp".
	  Don't expect a failure anymor ! :)

2007-02-20 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/attachMovieTest.c:
	  print instance name on mouse down/up events.
	* server/button_character_instance.cpp (on_button_event):
	  survive on unhandled event handler. 
	* server/character.{cpp,h}: add getter_setter for
	  onMouseDown, onMouseUp and onMouseMove; add has_mouse_event()
	  method.
	* server/movie_root.{cpp,h}: 
	  Add mouse listeners. Change key listeners to use std::set
	  (more appropriate) and to use intrusive_ptr (safer);
	  Notify mouse listeners on move and click events, don't
	  duplicate notification on *active* entity as these events
	  (mouse up,down,move) are not restricted to entity under the
	  mouse.
	* server/sprite_instance.{cpp,h}: (on_event): if a builtin
	  handler is invoked, don't go look for functions; register
	  as a mouse listener if have mouse event handlers.

2007-02-20 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* extensions/fileio/fileio.cpp: Fixed some compiler warnings 

2007-02-19 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: attachMovieTest.c,
	  attachMovieTestRunner.cpp:
	  Add onMouseDown and onMouseUp handlers to
	  exported symbol. Confirms bug #19040.

2007-02-19  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/boost.m4: Tweak patch for bug #18788 to work when cross
	configuring.

2007-02-19 Wil Mahan <wmahan+gnu@gmail.com>

	* configure.ac, macros/boost.m4: add check for libboost-date-time
	  (see bug #18788).

2007-02-19 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* macros/ffmpeg.m4: The minimum LIBAVCODEC_VERSION is now 51.11.0.
	  Also we can now handle if VP6 (FFMPEG_VP6) or avcodec_decode_audio2() 
	  (FFMPEG_AUDIO2) is not supported by the used version of ffmpeg.
	* backend/sound_handler_sdl.cpp: Added support for FFMPEG_AUDIO2
	* libbase/embedVideoDecoderFfmpeg.cpp: Made use of the constructor and
	  deconstructor. Added support for FFMPEG_VP6.
	* libbase/embedVideoDecoderGst.cpp: Made use of the constructor and
	  deconstructor.
	* server/asobj/NetStreamFfmpeg.cpp: Added support for FFMPEG_AUDIO2.
 	* server/asobj/Sound.cpp: Use the supplied name when searching for exports.
	* server/asobj/SoundFfmpeg.cpp: Added support for FFMPEG_AUDIO2.
	  Made the deconstructor work better.
	* server/asobj/SoundGst.cpp: Made the deconstructor work better.

2007-02-19 Sandro Santilli <strk@keybit.net>

	* server/: DynamicShape.{cpp,h}, sprite_instance.{cpp,h}:
	  Implement beginFill() and endFill()
	* testsuite/misc-ming.all/DrawingApi.as: non-automatic
	  source for testing the drawing api. Feel free to add
	  calls there :)

2007-02-19 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/fill_style.h: add missing return type
	* gui/fb.cpp: add support for eGalax/eTurbotouch touchscreens;
	  use persistent buffer for PS/2 mice also     

2007-02-19 Sandro Santilli <strk@keybit.net>

	* server/fill_style.{cpp,h}: add setSolid() method.

2007-02-19 Sandro Santilli <strk@keybit.net>

	* server/parser/shape_character_def.{h,cpp}: removed calls
	  for dynamic drawing. Use DynamicShape instead.
	* server/: Makefile.am, DynamicShape.{cpp,h}:
	  New subclass of shape_character_def to abstract dynami drawing
	* server/sprite_instance.{cpp,h}:
	  Implement lineStyle, moveTo, lineTo methods of MovieClip
	  class. This works by maintaining a DynamicShape member.
	* server/parser/BitmapMovieDefinition.{cpp,h}: use
	  a DynamicShape rather then a shape_character_def.

2007-02-19 Sandro Santilli <strk@keybit.net>

	* server/shape.{cpp,h}: new empty() and close()
	  methods.

2007-02-18  Rob Savoye  <rob@bertha.welcomehome.org>

	* plugin/.klash/Makefile.am: Install klashpartui.rc,
	klash_part.desktop, and pluginsinfo in their correct
	directories. bug #190821.

2007-02-17 Sandro Santilli <strk@keybit.net>

	* server/parser/shape_character_def.{cpp,h}:
	  Changed signature of add_fill_style and
	  add_line_style to take into account reuse
	  of existing styles and to abstract offset
	  semantic (1-based).
	* server/parser/BitmapMovieDefinition.cpp:
	  Update call to add_fill_stle; don't make
	  assumption about offset of the newly added
	  style.

2007-02-16 Martin Guy <martinwguy@yahoo.it>

	* doc/C/sources.xml: Correct Debian dev package names.
	* server/asobj/Date.cpp: Remove commentary copied from sephiroth;
	  it was lifted straight from MacroMedia copyright material
	  (see http://www.brajeshwar.com/reference/as2)
	* server/asobj/Date.cpp: Document incompatabilities with FlashPlayer.
	* server/asobj/Math.cpp: Remove unused and duplicate code.
	* server/asobj/Math.cpp: Don't abort on missing args; return NAN
	* testsuite/actionscript.all/Math.as: Add test suite for Math methods.
	* testsuite/actionscript.all/Makefile.am: Add Math.as to tests to run.

2007-02-16 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/consecutive_goto_frame_test.c:
	  Visually trace action execution, use C-style comments.
	* server/sprite_instance.cpp (advance_sprite):
	  always update oldDisplayList, not only when in PLAY state !
	* testsuite/misc-ming.all/action_execution_order_test.c:
	  Check UNLOAD being called only *once* (proper management
	  of oldDisplayList).

2007-02-16 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/consecutive_goto_frame_test.c:
	  reduce frame rate to 1 frame per second.
	  Shows that all actions (up to the final stop) are
	  executed at the first advancement (are *supposed* to work like that)
	* server/sprite_instance.cpp (add_display_object):
	  don't check for "events" match when comparing existing
	  char at given depth. Fixes move_object_test.swf.
	* testsuite/misc-ming.all/: Makefile.am, move_object_test.c:
	  Test unnamed instances handling on restart, and also test
	  for syntetized instance names.

2007-02-16 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/sprite_instance.cpp: Removed name check to get sprites
	  moved to their correct position after a loop  

2007-02-16 Sandro Santilli <strk@keybit.net>

	* server/dlist.{h,cpp}: don't dispatch UNLOAD event
	  unless explicitly requested by caller. 
	* server/sprite_instance.cpp: properly dispatch
	  UNLOAD event on just-removed chars.
	* testsuite/misc-ming.all/action_execution_order_test.c:
	  Added an additional test for order of onLoad event call.

2007-02-16 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: 
	  Warn only once about unsupported stuff; Provide
	  the *unimplemented* MovieClip.moveTo method.
	* testsuite/actionscript.all/MovieClip.as: don't
	  expect failure in checking moveTo.

2007-02-16 Sandro Santilli <strk@keybit.net>


	* server/asobj/: Color.cpp, Sound.cpp:
	  Warn only once about unsupported stuff; don't terminate
	  log_<whatever> with a newline (will be added); properly
	  tag ActionScript errors (log_aserror, and protect by
	  IF_VERBOSE_ASCODING_ERRORS).
	* server/sprite_instance.{cpp,h}: Fixed (hopefully)
	  the action execution order. Implementation is far
	  from elegant, but gives the idea of how it should work,
	  and actually passed our test for it, w/out breaking
	  anything else.
	* testsuite/misc-ming.all/action_execution_order_test.c:
	  Add an additional test to verify that function definitions
	  are not specially handled as it comes to action execution
	  order. Don't expect failures anymore.
	* server/dlist.{cpp,h}: add clear_except() override taking
	  a DisplayList as argument. Add a call_unload argument
	  for both clear_except() methods; add empty() method;
	  add clear() override taking a DisplayList as argument.
	* utilities/processor.cpp: add -f <frames> switch to control
	  the number of "advance" calls on the top movie.

2007-02-15 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_definition.h: documented get_frame_size().
	* server/parser/BitmapMovieDefinition.h (get_{width,height}_pixels):
	  use TWIPS_TO_PIXELS for consistency with movie_definition.
	* server/parser/BitmapMovieDefinition.cpp (getShapeDef): use 1 twip
	  per image pixel while drawing.

2007-02-15  Rob Savoye  <rob@bertha.welcomehome.org>

	* doc/C/gtkext.xml: Chapter on the Gtk extension.
	* doc/C/mysqlext.xml: Chapter on the MySQL extension.
	* doc/C/fileext.xml: Chapter on the File I/O extension.
	* doc/C/Makefile.am: Add new files to dependencies.
	
	* doc/C/extensions.xml: New file on the extension mechanism, and
	on writing extensions.
	* doc/C/gnash.xml: Add extensions chapter.
	
	* extensions/gtk2: New directory for Gtk2 API extension.
	* extensions/gtk2/hello.as: The well known Gtk "Hello" example
	program written in ActionScript.
	* extensions/gtk2/gtkext.{cpp,h}: Wrappers for the Gtk2 API to
	export it into Gnash.

2007-02-14 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/BitmapMovieInstance.cpp, server/parser/BitmapMovieDefinition.cpp:
	Corrected JPG scale	 

2007-02-14 Sandro Santilli <strk@keybit.net>

	* server/: movie_instance.cpp, movie_root.cpp: move
	  tu_random reset from movie_instance to movie_root
	  (random number generation should be taken care at global level);
	  Have movie_instance::advance call ::construct() rather
	  then manually executing frame tags.
	* testsuite/misc-ming.all/action_execution_order_test.c:
	  Add an additional complexity to the test, checking
	  for proper DisplayList construction to happen *before*
	  actions execution.
	* server/asobj/xmlnode.cpp: fix getter-setters for read-only
	  properties to survive attempts to set (logging the aserror).

2007-02-14  Rob Savoye  <rob@bertha.welcomehome.org>

	* testsuite/actionscript.all/XMLNode.as: Fix tests for newly work
	XLNode class.
	* server/asobj/xmlnode.{cpp,h}: Make nextSibling, previousSibling,
	firstChild, and lastChild work correctly.

2007-02-14 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.{cpp,h}: implement serialnumber_loader.
	* server/impl.cpp: register SERIALNUMBER loader.
	* server/stream.{h,cpp}: add read_string_with_lenght() function
	  taking length as argument; add get_tag_length() function
	  returning length of current tag.

2007-02-14 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp, server/asobj/NetStreamFfmpeg.{h,cpp},
	  server/gnash.h: Changed the aux_streamer_ptr callback to return bool.
	* libbase/gstgnashsrc.h, server/asobj/NetStreamGst.cpp: Moved definition
	  of gnash_plugin_desc to registering file to avoid multiple definitions.
	* server/asobj/SoundGst.{cpp,h}, server/asobj/SoundFfmpeg.{cpp,h},
	  server/asobj/SoundMad.{cpp,h} Added FFMPEG, Gstreamer and libmad 
	  backends for the Sound class.
	* server/asobj/Sound.{cpp,h}: Added support for the new backends.
	* server/asobj/Makefile.am: Added SoundGst.{h,cpp}, SoundFfmpeg.{h,cpp},
	  and SoundMad.{h,cpp},
	* server/asobj/NetConnection.{cpp,h}: Made accept as_object as argument 
	  instead of NetStream, to allow Sound to use NetConnection.

2007-02-14 Sandro Santilli <strk@keybit.net>

	* server/shape.h: add more public functions for
	  manipulation.
	* server/parser/morph2_character_def.cpp: try to
	  avoid direct access to shape private wonnabes;
	  simplified code, hopefully more readable now.
	* server/parser/shape_character_def.cpp: try
	  to avoid direct access to shape pritave wonnabes.

2007-02-14 Sandro Santilli <strk@keybit.net>

	* server/shape.{cpp,h}: added primitives for
	  drawing API: drawLineTo, drawCurveTo.
	  Method names track Ming interface.
	* server/parser/BitmapMovieDefinition.cpp: 
	  Use the path drawing api, draw a thicker outline
	  (outline works, fill not).

2007-02-14 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (goto_frame):
	  Don't trash actions following gotoFrame() calls
	  (fixes multiple_doactions_and_goto_frame_test.c).
	  Added comments about problems with consecutive_goto_frame_test.
	* testsuite/misc-ming.all/multi_doactions_and_goto_frame_test.c:
	  Don't expect the failure anymore :)

2007-02-14 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/ASSound.{cpp,h}: Renamed to Sound.{h,cpp}.
	* server/asobj/Global.cpp, server/asobj/Makefile.am, win32/VC8/gnash.vcproj, 
	  win32/VC8/npgnash.vcproj: Updated to use Sound.{h,cpp} instead of
	  ASSound.{h,cpp}.

2007-02-14 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: run the multi_doactions
	  gotoframe test.
	* testsuite/misc-ming.all/multi_doactions_and_goto_frame_test.c:
	  expect the failure.
	* server/BitmapMovieInstance.{cpp,h}: use sprite_instance::display,
	  don't override it. instead, place the bitmap shape in the
	  displaylist.
	* server/parser/BitmapMovieDefinition.{cpp,h}: change
	  constructor to take an image rather then a bitmap_character_def
	  (the latter has a poor interface).
	* server/impl.cpp: updated construction of BitmapMovieDefinition.
	* server/parser/shape_character_def.h: new add_line_style()
	  method, for programmatic definition of shapes.

2007-02-14 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/multi_doactions_and_goto_frame_test.c
	another testcase for goto_frame.
	
2007-02-13  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Disable dmalloc check for now. Configure
	extension/fileio directory.
	* extensions/Makefile.am: Build in the fileio directory.
	
	* server/asobj/xmlnode.cpp: Implement toString(). Make appendChild
	actually work.
	* server/asobj/xml.cpp: Re-implement toString(). Make
	createElement() and createTextNode() actually work.
	* server/asobj/xmlnode.h, xml.h: Include stringstream, and add to
	stringify() prototype.
	* server/asobj/xml.cpp: 
	* server/vm/ActionExec.cpp: Renable the stack dump messages for
	-va.
	* testsuite/actionscript.all/XML.as: Replace all the create* and
	appendChild() tests now that this functionality actually works.
	* server/Makefile.am: Add boost and pthread libs for cross compiling.
	* server/asobj/Makefile.am: Add glib and gstreamer cflags, needed
	when cross compiling with Gstreamer support.
	

2007-02-13 Sandro Santilli <strk@keybit.net>

	* server/parser/shape_character_def.h: new add_path() and
	  add_fill_style() methods, to allow for programmatic
	  definition of shape chars (will likely need more of these
	  for implementing the Drawing API).
	* server/sprite_instance.h: add a protected place_character
	  method, to fiddle with displaylist w/out character *ids*.
	* server/shape.h (class path): add setLeftFill, setRightFill
	  and setStartPoint methods; document some more.
	* server/sprite_instance.{cpp,h}:
	  Drop unused registeredClass arg in constructor.
	* server/parser/sprite_definition.cpp:
	  update call to sprite_instance constructor.

2007-02-13 Sandro Santilli <strk@keybit.net>

	* server/: Makefile.am, fill_style.{cpp,h},
	  styles.{cpp,h}: moved fill_style class in its
	  own file. Removeod unused code, provided 
	  a fill_style constructor for creating clipped
	  bitmap fills.
	* server/render.h: had doxygen comments point
	  to the correct place (render_handler).

2007-02-13 Sandro Santilli <strk@keybit.net>

	* server/parser/: Makefile.am, BitmapMovieDefinition.h:
	  Class used to return a movie_definition from load of a JPEG.
	* server/: Makefile.am, BitmapMovieInstance.{cpp,h}: 
	  Instance of a BitmapMovieDefinition (a movie_instance).
	* server/impl.cpp: move the unimplemented stuff over
	  to the new BitmapMovie classes.
	* testsuite/misc-ming.all/loadMovieTestRunner.cpp:
	  Don't expect a failure in loading the external JPEG
	  (it loads, just doesn't display).

2007-02-13 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-mtasc.all/.cvsignore: new file.
	* testsuite/misc-ming.all/consecutive_goto_frame_test.c:
	  expect the current failures, just to allow 'make check'
	  to continue working (known bugs need be 'expected', if
	  they unexpectedly pass 'make check' will exit with a
	  FAILURE code so we can joy and remove the expectance).
	* testsuite/misc-mtasc.all/: Makefile.am, hello.as:
	  Generalized Makefile, stuff Dejagnu.swf in first frame
	  and dejagnu_so_fini.as in last frame using 'makeswf'.
	  Ready to start with mtasc tests.

2007-02-13 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* gui/gui.cpp: Make full redraw on ENABLE_REGION_UPDATES_DEBUGGING 
	  configurable
	* gui/fb.cpp, gui/fbsup.h: Initial support for mouse
	* server/character.h: Avoid redrawing when matrix did not change	
	* backend/render_handler_agg.cpp: Correctly handling NULL clipping 
	  rectangle  	
	* server/character.cpp, server/character.h, 
    server/sprite_instance.cpp: distinguish between own and child's 
    invalidation state to avoid useless redrawing (should be a big
    performance gain in certain cases)
 
2007-02-13  Rob Savoye  <rob@bertha.welcomehome.org>

	* extensions/fileio/Makefile.am, fileio.cpp, fileio.h, test.as:
	New files for direct File I/O extension for Gnash.

2007-02-12 Sandro Santilli <strk@keybit.net>

	* macros/mtasc.m4: provide some detection for mtasc
	  (CLASSPATH detection needs more work).
	* configure.ac: detect mtasc availability.
	* Makefile.am: dump MTASC info on 'make dumpconfig'.
	* testsuite/Makefile.am: descend in misc-mtasc.all
	* testsuite/misc-mtasc.all/Makefile.am: initial Makefile
	  for mtasc.
	* testsuite/misc-mtasc.all/hello.as: simple test 
	  (build with 'make hello.swf').

2007-02-12 Sandro Santilli <strk@keybit.net>

	* server/button_character_instance.cpp (on_button_event):
	  Survive MOUSE_DOWN and MOUSE_UP events.
	* server/movie_root.cpp: (generate_mouse_button_events):
	  Dispatch events MOUSE_DOWN and MOUSE_UP togheter with PRESS 
	  and RELEASE (see bug #19040).
	* server/sprite_instance.cpp (can_hanle_mouse_envent):
	  Consider MOUSE_DOWN and MOUSE_UP events (see bug #19040).

2007-02-12 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/ASSound.{cpp,h}, server/asobj/Global.cpp: Updated the
	  AS Sound class to the new init method.

2007-02-12 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{cpp,h}: reverted
	  goto_frame patch introducing regression failures.
	  See bug #19020.

2007-02-12 Sandro Santilli <strk@keybit.net>

	* server/tesselate.cpp: std::fabsf => std::abs.
	* server/execute_tag.h: doxygen documentation,
	  add new execute_action() function.
	* server/sprite_instance.{cpp,h}: changed signature
	  of execute_frame_tags() to allow executions of
	  action tags only.

2007-02-12 Markus Gothe <nietzsche@lysator.liu.se>

	* server/debugger.h: &val, &val -> &var, &val
	* server/matrix.cpp: Using namespace std; 

2007-02-12 Sandro Santilli <strk@keybit.net>

	* server/character.h: documented ::advance() method.
	* testsuite/misc-ming.all/action_execution_order_test.c: made
	  more verbose, reduced frame rate to better see what goes on,
	  don't use C++ comments.
	* testsuite/misc-ming.all/Makefile.am: add consecutive_goto_frame_test
	  to the 'make check' loop.
	* libbase/utility.h: std::logf => std::log.

2007-02-12 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/consecutive_goto_frame_test.c
	add a new testcase for testing consecutive ActionGotoAndStop.

	
2007-02-12 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/utility.h: Added note on log2	

2007-02-11 Deanna Phillips <deanna>

	* server/asobj/Number.cpp: Removed use of fpclassify.

2007-02-11 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: stubbed unloadMovie ActionScript
	  function.
	* server/asobj/MovieClipLoader.cpp: properly register
	  the MovieClipLoader global class (use builtin_function,
	  not a "dumb" c_function.
	* testsuite/actionscript.all/: Makefile.am, MovieClipLoader.as:
	  simple test for MovieClipLoader (just inheritance and functions
	  availability).

2007-02-11 Markus Gothe <nietzsche@lysator.liu.se>

	* server/asobj/Number.cpp: Reverted stupid mistake.

2007-02-11 Sandro Santilli <strk@keybit.net>

	* macros/pthreads.m4: use -pthread for linux, as suggested by boost
	error.

2007-02-11 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Date.cpp: Disable use of tzset/timezone that does not
	  compile on BSD, contrary to the GNU glibc manual.

2007-02-11 Sandro Santilli <strk@keybit.net>

	* server/: impl.cpp, swf.h: renamed IMPORT2 as IMPORTASSETS2, tracking
	  Ming naming convention; add ENABLEDEBUGGER2 definition (and null
	  loader).
	* server/asobj/Number.cpp: don't redefine fpclassify: _fpclassify
	  won't build on an ubuntu dapper; fpclassify is defined in math.h,
	  already included.

2007-02-10  Rob Savoye  <rob@bertha.welcomehome.org>

	* libbase/Makefile.am: Add glib and gstreamer cflags, needed when
	cross compiling with Gstreamer support.
	* macros/gnashpkgtool.m4: Search_libs after a directory search. 
	* macros/pkg.m4: Use pathlist to find pkg-config.
	* server/Makefile.am:  Add glib and gstreamer cflags, needed when
	cross compiling with Gstreamer support.
	* server/debugger.cpp,: Tweak usage 
	* server/parser/Makefile.am: Add libxml, glib, and gstreamer
	cflags, needed when cross compiling with Gstreamer support.
	* server/vm/Makefile.am: Add glib and gstreamer cflags, needed
	when cross compiling with Gstreamer support.
	* utilities/Makefile.am: With GST for sound, include glib and
	gstreamer libraries.

2007-02-10 Markus Gothe <nietzsche@lysator.liu.se>

	* server/asobj/Math.cpp: using namespace std;
	* server/asobj/Number.cpp: using namespace std; Fixes for C99->C++.
	* libbase/postscript.cpp: using namespace std;
	* libbase/tu_file.cpp: namespacing.

2007-02-10 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* gui/fb.cpp: fixed some compilation problems when DOUBLE_BUFFER is 
	disabled; fixed _validbounds so that the movie is visible again; 
	added 2 pixel border to invalidated bounds to fix anti-aliasing
	problems; set scaling to view movie full-screen; added/fixed 
	support for 24 and 32 bit modes
	* render_handler_agg.cpp: added pixel format BGRA32          

2007-02-10 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: remove characters
	  not in current DisplayList from _frame0_chars when
	  looping back. See patch #5620.
	* testsuite/misc-ming.all/Makefile.am:
	  fixed typo in loadMovieTestRunner dependency.

2007-02-10 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/place_and_remove_object_insane_test.c
	add a new check that fails current Gnash and some comments. Only 
	xchecks	are supposed to be insane.

2007-02-09  Rob Savoye  <rob@bertha.welcomehome.org>

	* doc/C/debugger.xml: New file about the Flash debugger.
	* doc/C/sources.xml: Add --disable-debugger option.
	* doc/C/gnash.xml: Add info about the -g option. Add an entity for
	the new debugger chapter.
	* doc/C/gnash-man.xml: Add info about the -g option.

	* server/debugger.{cpp, h}: Implement breakpoint functions. Add a
	call stack.
	* server/vm/ASHandlers.cpp: Break and watch point here.
	* server/vm/ActionExec.cpp: Don't watchpoint here anymore.

	* macros/ffmpeg.m4: Check for the version of ffmpeg and print a
	warning if it's too old to use.
	* configure.ac: Print warning if you have ffmpeg, but it's a
	version older than 5.29.0. #18663.

2007-02-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/tu_types.h: Add the BYTE_ORDER name used on Mac OSX.

2007-02-09 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/Makefile.am: Added embedVideoDecoderGst.{cpp,h}.
	* libbase/embedVideoDecoderGst.{cpp,h}: Added. Use Gstreamer to decode 
	  embedded video.
	* libbase/embedVideoDecoder.h, libbase/embedVideoDecoderFfmpeg.cpp:
	  Added support for more codecs.
	* server/parser/Makefile.am, server/parser/video_stream_def.cpp,
	  server/parser/video_stream_def.h: Added support for using Gstreamer
	  to decode embedded video.

2007-02-09 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/dejagnu_so_init.as: made use
	  of frame loop a compile-time define for having another way
	  to test setInterval.
	* testsuite/misc-ming.all/: Makefile.am, intervalTest.as,
	  intervalTestRunner.cpp: add test *runner* for intervalTest.swf

2007-02-09 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.cpp: advance the movie_root, not
	  the topmost sprite ! This properly run interval timers.
	* server/movie_root.{cpp,h}: Store Timer objects
	  by value, not by pointer (make memory management easier);
	  I might change this in the future, but for now it works
	  fine. Possible future changes include: reserving a number
	  of slots for timers (possibly setting a limit), reusing
	  slots of expired timers (needs a testcase to see if that's
	  allowed).
	* server/timers.{cpp,h}: Big cleanup; got rid of timer_as_object;
	  use integer values for times, reduced function calls (store timeouts
	  in microseconds directly); documented.
	* server/asobj/xmlsocket.cpp: fix use of Timer class.
	* testsuite/misc-ming.all/: Makefile.am, intervalTest.as: new
	  test for setInterval() and clearInterval(). Lacks a test *runner*
	  but the manually running it clearly shows it works with this commit
	  (and not before). Note that self-contained tests are already
	  present, but a MovieTester based runner is required for proper
	  testing.

2007-02-09 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Math.cpp: Methods for constants have uppercase names

2007-02-09 Sandro Santilli <strk@keybit.net>

	* server/parser/: movie_def_impl.h, movie_definition.h:
	  Don't include timers.h.
	* server/asobj/Global.cpp: add setInterval and clearInterval
	  global functions.
	* testsuite/actionscript.all/Global.as: test existance of
	  setInterval and clearInterval function.

2007-02-08  Rob Savoye  <rob@bertha.welcomehome.org>

	* server/debugger.cpp: Dump the name of as_objects on the stack
	too. Some objects are created internally, so don't have a symbol
	table entry.
	* server/as_object.h: Return the raw properties handle so the
	debugger can use it. Add set_std_string method to let one add
	standard STL strings. 
	* server/debugger.cpp, debugger.h: Add support for setting
	variables or registers from the debugger console. Fix the symbol
	table to actually work, so now function names are displayed when
	doing a stack frame dump instead of just the address. Add minimal
	support for dumping information about the movie.
	* server/vm/ASHandlers.cpp: Grab the correct address when adding
	symbols to the debugger.

2007-02-08 Sandro Santilli <strk@keybit.net>

	* server/timers.{h,cpp}: add execution operator.
	* server/movie_root.{h,cpp}: removed do_something method,
	  replaced by Timer's execution operator. Changed add_interval_timer
	  to take a Timer& rather then a void*. Fixed clear_interval_timer
	  to avoid modifying the Timer list consequently making interval
	  ids invalid (all commented, check out for details).
	* server/sprite_instance.{h,cpp}: removed {add,clear}_interval_timer
	  and do_somthing methods. Callers should use the ones in movie_root.
	* server/asobj/xmlsocket.cpp: don't register setInterval and
	  clearInterval functions as they should be globals !

2007-02-08 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/video_stream_instance.cpp, server/parser/video_stream_def.cpp:
	  Make sure current video really is from a VideoFrame tag, before trying to
	  decode.

2007-02-08 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, loadMovieTestRunner.cpp:
	  Test runner for loadMovie.swf.

2007-02-08 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/debugger.cpp: Simple cleanup: remove unneeded casts.

2007-02-08 Sandro Santilli <strk@keybit.net>

	* server/asobj/MovieClipLoader.cpp (loadClip): use the new
	  sprite_instance::loadMovie() method.
	* server/movie_root.cpp: keep root sprite alive during actions
	  execution.
	* server/sprite_instance.{cpp,h}: complete implementation of
	  MovieClip.loadMovie(). 

2007-02-08 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Number.cpp: Only do string-to-number conversion when
	  text value is required, not on every math operation; moved text
	  conversion code out of class definition into its own function.
	* server/asobj/Number.cpp: Added text conversion of NaN and Infinities.

2007-02-08 Sandro Santilli <strk@keybit.net>

	* server/event_id.h: add id() accessor, properly use the id_code enum.
	* server/sprite_instance.cpp (can_handle_mouse_event): handle
	  case insensitiveness for SWF<7 fixing bug exposed by
	  loadMovieTest.swf; (sprite_load_movie): add
	  a few more checks, needs more work.
	* testsuite/misc-ming.all/: Makefile.am, loadMovieTest.c:
	  simple testcase for MovieClip.loadMovie(); exposes a bug
	  in event handling too. No runner for it (yet).

2007-02-08 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/embedVideoDecoder.h, libbase/embedVideoDecoderFfmpeg.cpp:
	  Added more video codecs.
	* server/asobj/NetStreamFfmpeg.cpp: Check if url is readable.
	* server/asobj/NetStreamGst.cpp: Check if a NetConnection object exists.
	* server/parser/video_stream_def.cpp: Fixed a warning.
	* testsuite/actionscript.all/rtmp.as: Made it actually test something.

2007-02-08 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/Makefile.am: Added embedVideoDecoder.h, 
	  embedVideoDecoderFfmpeg.{h,cpp}
	* libbase/embedVideoDecoderFfmpeg.{h,cpp}: Added. Decoder for embedded video
	  using ffmpeg.
	* server/impl.cpp: Added support for parsing swf embedded in a player (.exe)
	* server/asobj/NetStreamFfmpeg.{cpp,h}: Fixed some warnings.
	* server/parser/movie_def_impl.h: Removed unused soundstream list.
	* server/video_stream_instance.{cpp,h}, 
	  server/parser/video_stream_def.{cpp,h}, server/swf/tag_loaders.cpp:
	  Added support for embedded video.

2007-02-08 Sandro Santilli <strk@keybit.net>

	* server/character.{h,cpp} (get_relative_target_common):
	  support "_parent".
	* testsuite/actionscript.all/MovieClip.as: add test for _parent
	  member of actionscript created movieclips.

2007-02-07 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Global.as: expect failures with
	  'unescape'... anyone confirming the results with other players
	  is welcome.
	* testsuite/MovieTester.{cpp,h}: add pressKey() and releaseKey()
	  methods.
	* testsuite/misc-ming.all/: KeyTest-Runner.cpp, KeyTest.as,
	  Makefile.am: test for Key events.
	* testsuite/actionscript.all/Object.as: add test for overriding
	  addProperty() member of an object.

2007-02-07 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Data.cpp: Completed reverse engineering of get/set
	  methods
	* configure.ac: Added check for ftime()
	* testsuite/actionscript.all/Date.as: Add tests for get/set methods

2007-02-07 Sandro Santilli <strk@keybit.net>

	* server/debugger.h: const-correctness fixes.
	* server/parser/action_buffer.h: buffer accessor return by const
	  pointer.
	* server/asobj/Key.cpp (notify_key_event): fix update
	  of the _global.Key object, properly handle case of function names
	  (TODO: produce an automated testcase for this!).
	* server/sprite_instance.cpp (movieclip_ctor): don't attach MovieClip
	  properties, as those are only good for real sprites.
	* server/swf/tag_loaders.cpp: use log_swferror where appropriate,
	  (swf_event::read): tolerate malformed header.

2007-02-07 Sandro Santilli <strk@keybit.net>

	* server/types.cpp (rgba::read): made more readable.
	* server/vm/fn_call.h: add dump_args() method.
	* server/asobj/Object.cpp: use log_aserror() where appropriate,
	  dump function args when invalid. Don't giveup when number of 
	  args is greater then required.

2007-02-07 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Object.as: add tests for invalid calls
	  to addProperty() [ found in hello.swf from Laszlo ]
	* server/asobj/Object.{cpp,h}: export getObjectInterface()
	* server/asobj/as_object.{cpp,h} (get_prototype): return
	  Object class interface when hit top of inheritance chain;
	  make sure to never access m_prototype directly but always
	  use get_prototype() instead. This ensures that *every* object
	  ends up being an Object instance.
	* testsuite/actionscript.all/Function.as: a few more tests to
	  ensure that functions are instance of Object.
	* testsuite/actionscript.all/: MovieClip.as, Inheritance.as:
	  Don't expect failures while checking for objects being
	  instance of Object class.

2007-02-07 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp (define_shape_loader): neater parse
	  print.
	* server/types.{cpp,h}: add output operator and toString
	  method for rgba class.
	* server/styles.cpp (fill_stle::read): neater color print.
	* server/parser/shape_character_def.cpp (read):
	  neater parse print.

2007-02-06  Rob Savoye  <rob@bertha.welcomehome.org>

	* server/as_value.h: Add is_as_function() .
	* server/debugger.cpp: Try to lookup a symbol name for each
	address when dumping the stack. Add support for a symbol table for
	all functions and "new" objects and an "i s" command to dump the
	symbol table. "i f" now dumps the stack frame, it was "i s"
	before. 
	* server/parser/action_buffer.h: Add accessors for the code
	buffer.
	* server/vm/ASHandlers.cpp: Don't need std:: since we're using the
	std namespace. Add a symbol for function definitions.
	* server/vm/ActionExec.cpp: Stash the pc pointer for later instead
	of passing it in on the command line.
	* utilities/parser.cpp, processor.cpp: Add support for the debugger.

2007-02-06 Sandro Santilli <strk@keybit.net>

	* server/debugger.{h,cpp}: (disassemble): first argument
	  can safely be passed as a 'const' pointer.
	* server/parser/action_buffer.h: added get_buffer() to
	  return an unsugned char.
	* server/vm/ActionExec.cpp (operator()): use
	  action_buffer::get_buffer() to fetch an appropriate argument
	  for Debugger::disassemble.

2007-02-06 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Data.cpp: Fixed bug in setUTCHours(),
	  make utc/localtime specification compulsory in inner workings.
	* server/asobj/Number.cpp: Convert numbers to strings the same way as a
	  certain commercial Flash Player does.
	* configure.ac: Add check for memmove, used in Number.cpp

2007-02-06  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Add --disable-debugger option.
	* server/debugger.h, debugger.cpp: New files for Flash debugger
	support.
	* gui/gnash.cpp: Add -g option to start the debugger console.
	* server/as_environment.h: Add methods to set registers.
	* server/parser/action_buffer.cpp: Add to existing string value,
	don't replace it.
	* server/vm/ActionExec.cpp: Add support for the Flash
	debugger. Simplify the methods where case conversion is done.

2007-02-06 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp (get_variable_raw):
	  Don't provide "_global" when SWF version is < 6.
	* testsuite/actionscript.all/getvariable.as: don't expect
	  failures in SWF5 mode (_global related)
	* testsuite/actionscript.all/Global.as: use check_equals
	  when possible, fix for missing SWF5 _global, remove
	  escape() tests with SWF > 5 as I can't confirm correct
	  result.
	* testsuite/actionscript.all/delete.as: fix for SWF5 run
	  (_global related).

2007-02-05 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetConnection.cpp: Make sure we don't setup a connection
	  that already exists.
	* server/asobj/NetStreamFfmpeg.{cpp,h}: Fixed a potential hanging thread.
	* server/asobj/NetStreamGst.{cpp,h}: Switched from pthreads to boost.
	  Fixed a potential hanging thread.

2007-02-05 Sandro Santilli <strk@keybit.net>

	* server/PropertyList.cpp: delete overridden properties in import();
	  properly clear current container on assignment operator (also fixed
	  it's signature). Properly delete Property in delProperty().
	* server/PropertyList.h: Properly document Property ownership.

2007-02-05 Zou Lunkai <zoulunkai@gmail.com>

	* server/movie_root.cpp, server/asobj/xml.cpp,
	  server/asobj/xmlnode.cpp.
	  typos, get rid of unnecessary warnings with vc8 compiler 
	  
2007-02-05 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/pthreads.m4: Fixed a quirky LIBS/CFLAGS-bug.
	* libbase/log.cpp: Removed BOOST_HAS_THREADS.
	* cygnal/cygnal.cpp: Removed implicit include.
	* cygnal/statistics.h: Removed unsed include.

2007-02-03 Sandro Santilli <strk@keybit.net>

	* server/GetterSetter.{cpp,h}: fixed assignment operator (a bad typo!).
	* server/dlist.cpp: call character::construct() everytime an object
	  is placed on stage, making the code much more readable and clean
	  (IMHO).
	* server/sprite_instance.{h,cpp}: implement 'construct' method
	  to take care of properly handling user-defined registered
	  classes for sprites and to execute tags in frame0; attach
	  properties to *instances* rather then to the MovieClip
	  exported interface.
	* server/character.h: add a 'construct' method.
	* testsuite/misc-ming.all/: registerClassTest.c,
	  registerClassTestRunner.cpp: add new tests, a fix
	  for gnash will follow shortly.
	* server/parser/sprite_definition.h: add getRegisteredClass()
	  method.

2007-02-03 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Data.cpp: Fixed fmod issues.

2007-02-03 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Data.cpp: Pretty much complete rewrite of nonworking
	  module forced by change of internal representation from many little
	  date fields to milliseconds since epoch. Not fully working yet.
	* configure.ac: include tests for localtime_r and tzset.

2007-02-02 Markus Gothe <nietzsche@lysator.liu.se>

	* server/asobj/Data.cpp: Fixed fmod issue.

2007-02-02 Martin Guy <martinwguy@yahoo.it>

	* testsuite/actionscript.all/Global.as: add checks for malformed
	  encoded URLs

2007-02-02 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamFfmpeg.cpp: Fixed a deadlock when deleting
	  netstream before playback started.

2007-02-02  Rob Savoye  <rob@bertha.welcomehome.org>

	* plugin/klash/Makefile.am: Simplify heavily as most of the KDE
	settings we don't need for a simple kpart.

2007-02-02 Sandro Santilli <strk@keybit.net>

	* server/as_object.h (set_prototype): made public, as any
	  protection is useless as long as set_member("__proto__")
	  still changes the prototype.

2007-02-02 Martin Guy <martinwguy@yahoo.it>

	* server/Date.cpp: Eliminate Date class; port to date_as_object

2007-02-02 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as: add a few more checks
	  for properties.
	* testsuite/actionscript.all/Inheritance.as: don't expect
	  failures with Date object; add a test about constructors
	  calling order.
	* server/asobj/: Date.{cpp,h}, Global.cpp:
	  Ported Date object to new layout; make Date.UTC a not-exported
	  class-static
	* testsuite/actionscript.all/Date.as: don't expect a failure
	  for Date.UTC.
	* server/: character.h, sprite_instance.h: get_current_frame()
	  and has_looped() removed from character class (meaningless).
	  Added some comments about restart().
	* plugin/klash/Makefile.am: defined kde_moduledir
	  and kde_servicesdir as required by automake 1.9.6.
	  Used KDE_MODULESDIR and KDE_SERVICESDIR, which are
	  currently *not* defined - at least it builds though.

2007-02-01 Martin Guy <martinwguy@yahoo.it>

	* server/Date.cpp: Add date_utc unimplemenrted stub for
	  ActionScript Date.UTC method

2007-02-01  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Use the new KDE and QT macros.
	* macros/kde.m4: Rewrite completely to be more standard with how
	all the other tests work.

2007-02-01 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Date.cpp: #if 0 out unused function stubs
	  and implement missing setDate method

2007-02-01 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/{Date,Global,string}.cpp: Convert all assert()s that
	  triggered by illegal number of args in runtime ActionScript
	  to IF_VERBOSE_ASCODING_ERRORS() warnings with and keep going,
	  giving safe default return values.

2007-02-01 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/NetStreamFfmpeg.h: Switch multithread_queue over to
	using boost threads. Add a comment about some strange code in
	push()...

2007-02-01 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Global.cpp: Implement ActionScript 5 "escape" method
	* testsuite/actionscript.all/Global.as: Add test case for "escape"

2007-02-01 Bernhard Rosenkraenzer <bero@arklinux.org>

	* Makefile.am: Add the plugin directory to our SUBDIRS when we don't
	have GTK but when we do want Klash.
	* plugin/klash/klash_part.cpp: Move visibility annotations to from 
	the class implementation into the declaration.

2007-02-01 Martin Guy <martinwguy@yahoo.it>

	* server/asobj/Global.cpp: Rewrite lame code in string conversions:
	  remove insane case statement and avoid unnecessary use of floating
	  point

2007-02-01 Martin Guy <martinwguy@yahoo.it>

	* testsuite/actionscript.all/Global.as: fix bug in parseInt octal test
	  (now succeeds)

2007-02-01 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: registerClassTest.c,
	  registerClassTestRunner.cpp: made test more
	  complex, showing that the *constructor* of
	  the registered classes is called !
	  This currently fails.

2007-02-01 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.cpp (read_all_swf):
	  Perform a last check for "orphaned" actions, which are
	  action blocks NOT followed by a SHOWFRAME.
	* doc/C/internals.xml (Writing self-contained SWF tests):
	  Document new optional argument for check() and xcheck().
	* testsuite/misc-ming.all/ming_utils.c (get_dejagnu_actions):
	  Allow second argument to check() and xcheck() for an explicit
	  label.

2007-02-01 Sandro Santilli <strk@keybit.net>

	* server/as_object.h (get_primitive_value): return
	  an OBJECT value by default (not a number).
	* server/as_value.cpp (operator==): avoid infinite
	  recursion now that get_primitive_value is allowed
	  to return an OBJECT again.
	* server/asobj/Numbec.cpp: override get_primitive_value
	  to return a NUMBER value.
	* testsuite/actionscript.all/Object.as: don't expect
	  failures for valueOf tests.

2007-02-01 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Object.as: add tests for toString
	  and valueOf. The latter doesn't work yet.
	* server/asobj/Object.cpp: add valueOf and toString methods,
	  make addProperty availability version-dependent (only if SWF > 5)
	* server/as_object.{cpp,h}: add generic and reusable
	  actionscript method handlers for toString() and
	  valueOf().
	* server/asobj/Number.cpp (attachNumberInterface):
	  define toString() and valueOf() methods.
	* testsuite/actionscript.all/Number.as: test toString()
	  and valueOf().

2007-01-31 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (sprite_attach_movie):
	  tolerate bogus third argument to attachMovie().
	  Fixes bug #18920.

2007-01-31 Martin Guy <martinwguy@yahoo.it>

	* configure.ac: Remove check for png.h; it is not a Gnash dependency.
	  It is a sub-dependency of gtk and pango, not required for gtk-less
	  builds.

2007-01-31 Sandro Santilli <strk@keybit.net>

	* server/mouse_button_state.h: symbolic button states.
	* server/movie_root.cpp (generate_mouse_button_events):
	  use symbolic names for button states.
	* server/as_object.cpp (set_member_default): more verbose warning
	  for invalid properties found in the inheritance chain.

2007-01-31 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/render_handler_agg.cpp, gui/{gui.cpp, gtk.cpp}: Do not
	subtract 1 from	the rendering width and height (fixes bug #18904).
	* gui/README: update to current status.
	* gui: Rename Gui::set_invalidated_region to setInvalidatedRegion to
	match naming style.
	* gui/fltk{.cpp, sup.h, _glue_agg.cpp, _glue_agg.h}: Add a menu bar
	to the FLTK window. Make the AGG glue inherit from fltk::Widget, so
	it can be added to the FLTK window without interfering with menu
	drawing. Since the same hasn't yet been done for the Cairo glue,
	disable Cairo/FLTK for now. Account for the menu height when passing
	the mouse position to the rest of Gnash. Delay initialisation of the
	Glue until we are ready to add it to the FLTK window. Until we can
	solve rendering issues, disable region based clipping for AGG.
	Note that some FLTK menu items are not yet implemented.
	* gui/gtk{.cpp, _glue_agg.cpp}: Remove the unused valid_coord method.
	* gui/gui{.cpp, .h}: Declarations in the header, implementation in
	the .cpp file. Shuffle the order of declarations so they are grouped
	by type.
	* server/movie_root.h: set_invalidated_region is used across libraries,
	so visibility should be DSO_EXPORT.
	* server/sprite_instance.cpp: Assert that our pointer is non-NULL
	before attempting to dereference it.

2007-01-31 Sandro Santilli <strk@keybit.net>

	* server/button_character_instance.{h,cpp}:
	  Use getter-setter properties, and avoid override
	  of get_member/set_member methods.
	* server/character.{cpp,h}: define more generic
	  getter-setters.
	* server/sprite_instance.cpp: use character class
	  statics for onload and onrollout events
	* testsuite/misc-ming.all/ButtonEventsTest-Runner.cpp:
	  expect less failures :)

2007-01-31 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (goto_frame): fix
	  check for target frame being already loaded.
	* server/button_character_instance.cpp (on_event):
	  added verbose output for unsupported button events.
	* testsuite/misc-ming.all/: ButtonEventTest.c,
	  ButtonEventTest-Runner.cpp: added some (failing)
	  tests for user defined event handlers.

2007-01-30 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/goto_frame_test.c:
	  add test for consecutive goto
	  
2007-01-30 Ann Barcomb <kudra@domaintje.com>

	* Added: devtools/lib/Gnash/Distribution.pm and
	  devtools/lib/Gnash/Utils.pm
	  These libraries will be used to support the devtools/testsuite
	  tests, which are tests intended to increase conformance with
	  coding standards.
	* Added devtools/testsuite/uncuddled_else.t
	  It is a test which searches for instances of uncuddled elses
	  in C++ source files.

2007-01-30 Martin Guy <martinwguy@yahoo.it>

	* config.mk.in, compatibility_include.h: Remove unused GAMESWF defines

2007-01-30 Sandro Santilli <strk@keybit.net>

	* server/: character.{h,cpp}, sprite_instance.cpp:
	  Made generic gettersetter definitions statics
	  in the 'character' class. Ready for reuse in button
	  instances and whichever other ActionScript class
	  associated with a character (_x,_y,_width...).

2007-01-25 Martin Guy <martinwguy@yahoo.it>

	* configure.ac: Make libjpeg presence mandatory and fail otherwise;
	  otherwise compilation fails.

2007-01-25 Martin Guy <martinwguy@yahoo.it>

	* configure.ac: Fix message about Debian packages required for boost

2007-01-30 Sandro Santilli <strk@keybit.net>

	* server/: video_stream_instance.{h,cpp},
	  server/asobj/: NetConnection.cpp, NetConnection.h, NetStream.cpp,
	  NetStream.h, NetStreamFfmpeg.cpp, NetStreamFfmpeg.h, NetStreamGst.cpp,
	  NetStreamGst.h:
	  Refactored NetStream inheritance model, got rid of
	  netstream_as_object and netconnection_as_object wrappers.

2007-01-30 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.cpp (incrementLoadedFrames):
	  handle malformed SWF containing more SHOWFRAME then expected;
	  (readHeader): allocate more slots for actions to make malformed
	  SWF handling easier.
	* server/asobj/: NetConnection.cpp, NetStream.cpp:
	  Cleanups and robustness improvements.
	* server/parser/movie_def_impl.cpp (read_all_swf):
	  Don't discard anything past the last SHOWFRAME,
	  as Ming seems to still put EXPORTASSETS after it
	  (possibly bogus, but we want to accept it).

2007-01-30 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamGst.cpp: Fixed wrong return type.

2007-01-30 Sandro Santilli <strk@keybit.net>

	* server/asobj/xml.cpp: removed stale #endif.

2007-01-29  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Remove --disable option. Bug #18905:
	* libamf/amftest.cpp:  Remove HAVE_LIBXML ifdefs, we always
	want XML support.
	* libbase/log.h, log.cpp: Remove HAVE_LIBXML ifdefs, we always
	want XML support.
	* server/asobj/xmlsocket.h: Remove HAVE_LIBXML ifdefs, we always
	want XML support.
	* server/vm/action.cpp: Remove HAVE_LIBXML ifdefs, we always want
	XML support.
	* utilities/parser.cpp, processor.cpp: Remove HAVE_LIBXML ifdefs,
	we always want XML support.

2007-01-25 Martin Guy <martinwguy@yahoo.it>

	* configure.ac, README: Remove code and documentation for
	  --disable-xml

2007-01-25 Martin Guy <martinwguy@yahoo.it>

	* configure.ac, server/asobj/xml.cpp: Remove broken
	  --enable-xmlreader and --enable-dom leaving only dom.

2007-01-29 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.cpp (read_all_swf): when last
	  expected SHOWFRAME tag is hit, discard the rest and warn
	  user if next tag is not an END. This happens when Ming users
	  forget to call SWFMovie_nextFrame() as last thing before output.

2007-01-29 Ann Barcomb <kudra@domaintje.com>

	* Removed reference to '--disable-xml' option in doc/C/sources.xml.
	  It is required now.

2007-01-29 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.h (add_execute_tag, add_init_action):
	  Add an assertion to catch out-of-bounds accesses.

2007-01-29 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/goto_frame_test.c:
	  add checks about the _currentframe property before
	  and after goto_frame actions; change xcheck to check.
	* server/sprite_instance.cpp sprite_instance.h:
	  fixed goto_frame_test(bug #18845). the next step is to
	  make testcase more complicated

2007-01-27 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/Global.cpp: NetConnection switched to the new init method.
	* server/asobj/NetConnection.{cpp,h}: Switched to the new init method.
	  Moved URL checking to NetConnection, and added support for different ways
	  to setup the URL.
	* server/asobj/NetStreamFfmpeg.{cpp,h}, server/asobj/NetStreamGst.cpp:
	  Removed the URL checking, and moved it to NetConnection. Added "support"
	  for the "mp3:" prefix (untested).

2007-01-26  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Look for libexpat too to resolve a stupid library
	dependency on some systems.
	* gui/Makefile.am: Add EXPAT_LIBS for GTK builds. Add XFT and X11
	libs for FLTK2 builds
	* macros/x11.m4: New file for X11. The default one from aclocal
	doesn't support cross configuration very well, so now we have our
	own. Also look for Xinerama to keep Debian Etch happy.
	* macros/firefox.m4: Add an --with-gnashexe to specify an optional
	path to find the gnash executable if it's not in $prefix/bin.
	* plugin/Makefile.am: 
	* plugin/plugin.cpp: Use GNASHBINDIR instead of PREFIX to be clearer.

2007-01-25 Sandro Santilli <strk@keybit.net>

	* backend/render_handler.h (Detection of regions update page):
	  note that set_invalidated() must be called *prior* actual
	  modifications; minor typos and rewordings.
	* server/sprite_instance.cpp (on_event): don't attempt to call
	  event handlers functions when they are simply *undefined*.
	* testsuite/MovieTester.cpp: call display() before advancing
	  to make invalidated bounds computation properly work.
	* testsuite/misc-ming.all/simple_loop_testrunner.cpp:
	  don't expect a failure about invalidated bounds at loopback.
	* server/character.h: more info about invalidated bounds
	  methods and members.

2007-01-25 Martin Guy <martinwguy@yahoo.it>

	* configure.ac: Regularize indentation, reorder things

2007-01-25  Rob Savoye  <rob@bertha.welcomehome.org>

	* plugin/Makefile.am: Add more header paths so we can be cross
	compiled.

2007-01-25 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (goto_frame):
	  hopefully made code more readable; added warning
	  for gotoFrame invoking a yet-to-be-loaded frame;
	  added comments submitted by Zou Lunkai;
	  undefined OLD_GET_MEMBER accidentally defined by
	  some of the previous commits.

2007-01-25 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/simple_loop_test.c: anchor
	  the characters at 0,0 and fix compiler warnings.
	* testsuite/misc-ming.all/simple_loop_testrunner.cpp:
	  fix invalidated bounds checking (but still fails
	  with both bogus and correct version of
	  sprite_instance::execute_frame_tags - odd!)
	* server/character.h: more info about set_invalidated()
	* server/sprite_instance.cpp (execute_frame_tags): properly
	  call set_invalidated() when resetting DisplayList.

2007-01-24 Martin Guy <martinwguy@yahoo.it>

	* Makefile.am: fltk cares about Xft; gtk doesn't.
	* configure.ac: Move fltk gui test for Xft outside if(gui-gtk) clause
	* configure.ac: Also accept "none" as alias for "no" for --enable-sound
	  and --with-mp3-decoder to match values reported by --version.
	  Mention "none", not "no", in --help.
	* gui/gtk.cpp: Shorten About text to remove comments about other Flash
	  players; add main compile-time configurations to About box.
	* gui/gtk.cpp: Extend About dialog copyright to 2007
	* gui/gnash.cpp: Update copyright in --version to 2007
	* gui/gnash.cpp: Remove unimplemented options -e and -f
	  (klash stubs never implemented)
	* gui/Player.cpp: Remove old version of Player::run, #if 0'ed out and
	  mostly the same as the new implementation

2007-01-24 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, simple_loop_test.c,
	  Simple_loop_testrunner.cpp: new test for simple loop.
	  Seems to work internally, but reveals a bug in invalidated
	  bounds computation !!

2007-01-24 Ann Barcomb <kudra@domaintje.com>

	* Replaced outdated references to -a in the manual (doc/C)
	  with current usage.

2007-01-24 Sandro Santilli <strk@keybit.net>

	* server/character.h: add isDynamic() and setDynamic()
	  function to tag actionscript-created characters;
	  have accept_anim_moves return false for dynamic chars.
	* server/dlist.{cpp,h}: new add() and addAll() helper methods.
	* server/sprite_instance.cpp (execute_frame_tags): 
	  keep script objects when reinitializing DisplayList
	  on loop-back; (sprite_attach_movie, sprite_duplicate_movieclip,
	  add_empty_movieclip): mark created characters as dynamic.
	* testsuite/misc-ming.all/: Makefile.am, attachMovieLoopingTest.c,
	  attachMovieLoopingTestRunner.cpp: test for DisplayList reset
	  on loopback when dynamic characters are present.
	* testsuite/misc-ming.all/action_execution_order_test.c:
	  expect failure of the only test in there...

2007-01-24 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am,
	  action_execution_order_test.c, attachMovieLoopingTest.c,
	  attachMovieLoopingTestRunner.cpp:
	  More tests, with failures (didnt' bother using xcheck as
	  I'm working on them).

2007-01-24 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/place_and_remove_object_insane_test.c:
	  Last commit fixed a couple of tests in this testcase.
	* server/: character.h, sprite_instance.{cpp,h}:
	  Understood, documented and cleaned up the concept of
	  "ActionScript-transformed" characters; Fix property handlers
	  to properly register having been transformed by script.
	  Fixes elvis.swf and bitmap.swf.
	* testsuite/misc-ming.all/: Makefile.am, attachMovieTestRunner.cpp,
	  loop_test-Runner.cpp, registerClassTestRunner.cpp:
	  Allow running tests from any directory.

2007-01-23 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (ctor): fix handlign of registerClass
	  (at least for the new testcase).
	* testsuite/misc-ming.all/: Makefile.am, registerClassTest.c,
	  registerClassTestRunner.cpp: new testcase for registerClass.

2007-01-23 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStream.{h,cpp}, server/asobj/NetStreamFfmpeg.{cpp.h}:
	  Use int64_t instead of long.
	* server/asobj/NetStreamGst.{cpp,h}: Use int64_t instead of long.
	  Switched to use gst_element_seek() for seeking, which is supported by
	  older version of gstreamer.

2007-01-23 Sandro Santilli <strk@keybit.net>

	* server/as_object.cpp ({get,set}_member_default):
	  handle ActionExceptions.
	* testsuite/generic-testrunner.sh: be more verbose about
	  exit failures.

2007-01-23 Sandro Santilli <strk@keybit.net>

	* libbase/GnashException.h: add ActionException class.
	* server/sprite_instance.cpp, server/asobj/Date.cpp:
	  throw an ActionException if methods or gettersetter properties are invoked
	  against the wrong instance type.
	* server/vm/action.cpp (call_method): catch ActionException
	  so return for invalid calls is always undefined.
	* testsuite/actionscript.all/Date.as: don't expect a failure
	  on dateInstance.UTC being undefined.
	* testsuite/actionscript.all/Inheritance.as: Test access of
	  builtin methods or gettersetter properties from user defined
	  objects.

2007-01-23 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Also resample if samplerate is correct
	  but number of channels is not (mono => stereo).
	* server/asobj/Global.cpp: Initialize NetStream using the new method.
	* server/asobj/NetConnection.h: Now compiles without Curl.
	* server/asobj/NetStream.{cpp,h}: Initialize NetStream using the new method.
	  Implemented the time-property.
	* server/asobj/NetStreamFfmpeg.{cpp,h}: Switched from pthreads to boost.
	  Hopefully fixed a thread-join-bug (#18571).
	  Use ffmpeg/libavcodec's audio resampler since gnashs own resampler only
	  supports a limited samplerates.
	  Implemented seek() and time().
	* server/asobj/NetStreamGst.{cpp,h}: Implemented seek() and time().

2007-01-23 Sandro Santilli <strk@keybit.net>

	* server/as_object.cpp (copyProperties): use set_member
	  while importing properties to properly scan the
	  inheritance chain.
	* server/PropertyList.h: add visitValues() templated function.
	* server/sprite_instance.cpp (sprite_attach_movie):
	  Copy properties from initialization object *after*
	  placement to ensure matrix is properly updated.
	* testsuite/misc-ming.all/: attachMovieTest.c,
	  attachMovieTestRunner.cpp:
	  Made dejagnu-enabled, test for actual position
	  of attached movieclips.

2007-01-22 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Inheritance.as: add a new test triggering
	  an assertion failure due to 'extends' modifying inheritance chains
	  and importing a getter_setter not meant for non-sprite objects.
	* testsuite/actionscript.all/: Inheritance.as, MovieClip.as: expect
	  failures on 'any instanceOf Object' after fix to
	  'as_object::instanceOf'.
	* server/as_object.h: add const version of get_prototype.
	* server/as_function.cpp (getPrototype): use get_member to access
	  the prototype, in case it was set by ActionScript.
	* server/as_object.cpp (instanceOf): fix broken implementation always
	  returning true :/

2007-01-22 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Inheritance.as: additional 
	  test for 'new Function' construct.
	* server/sprite_instance.cpp (attachMovieClipInterface, get_member):
	  handled most standard properties by means of calls to the new
	  'init_property' call. Fixes run of the new attachMovieTest testcase
	  and makes code easier and more reusable (next step is to reuse
	  the getter-setter for other builtin classes like TextField, Button
	  or the like).
	* testsuite/misc-ming.all/: attachMovieTest.c,
	  attachMovieTestRunner.cpp:
	  test 3rd argument to attachMovie (initObject).
	  Fixed by change in sprite_instance above.
	* testsuite/misc-ming.all/place_and_remove_object_insane_test.c:
	  Expect a failure accessing '_x' property of a clip, not sure
	  about importance of it being the test insane.

2007-01-22 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/: Makefile.am, goto_frame_test.c:
	  Failing test for gotoFrame action.

2007-01-22 Ann Barcomb <kudra@domaintje.com>

	* Partially merged branch 'testing-documentation-refactor' for
	  files doc/C/sources.xml and doc/C/internals.xml.  The change
	  involved moving 'running tests' from the test-writing section
	  into the user's installation section. 

2007-01-21  Rob Savoye  <rob@bertha.welcomehome.org>

	* Makefile.am: Organize the output of dumpconfig somewhat. Make
	some lines optional based on the configuration to save space.
	* NEWS: Add that cross compiling is now supported.
	* README: Mention trying cvs Head befor bug reporting.
	* configure.ac: Check for the build and host systems. We don't
	have to hack cross_compile. it works correctly now. Use
	$host_alias instead $target_alias for the directory search
	paths. Look for PNG, OLPC needs it. Define a restricted path for
	cross configuring and export it for the other m4 scripts.
	* doc/C/sources.xml: Clarify cross configuring based on current
	technique.
	* gui/Makefile.am: PTHREAD_LIBS must be after BOOST_LIBS.
	* libamf/Makefile.am: Remove unused libraries from LDFLAGS.
	* macros/curl.m4: Only look for curl-config in the pathlist
	variable.
	* macros/glib.m4: Look for glibconfig.h in the right place.
	* macros/gtk2.m4: Add -lgobject and -lgmodule for cross
	compiling.
	* macros/incllist, libslist: Look in $host_alias, not
	$target_alias.
	* macros/libXML.m4: Only look for xml2-config in the pathlist
	variable.
	* macros/ming.m4: Only look for ming-config in the pathlist
	variable.
	* macros/pthreads.m4: Use correct comment syntax. Also look for
	pthread.h and libpthread so we cross configure correctly.
	* macros/sdl.m4: Only look for sdl-config in the pathlist
	variable.
	* plugin/klash/Makefile.am: Don't build klash here anymore.
	* utilities/Makefile.am: Link in XML2 libs.

2007-01-19 Sandro Santilli <strk@keybit.net>

	* server/asobj/xmlnode.cpp (attachXMLNodeInterface): 
	  add_property -> init_property. 
	* server/sprite_instance.{h,cpp}: MovieClip.attachMovie() implemented.
	* testsuite/misc-ming.all/: Makefile.am, attachMovieTest.c,
	  attachMovieTestRunner.cpp: testcase and runner for
	  MovieClip.attachMovie().

2007-01-19 Sandro Santilli <strk@keybit.net>

	* server/asobj/xmlnode.cpp (xmlnode_new): cast double to int
	  before casting to an enum [ fix for gcc-3.3.5 ]
	* server/sprite_instance.cpp: cleanups, including use
	  of log_aserror when appropriate.
	* server/as_object.cpp: commented out debugging output.

2007-01-18 Sandro Santilli <strk@keybit.net>

	* extensions/mysql/mysql_table.cpp, server/array.cpp,
	server/array.h, server/as_function.cpp, server/as_object.cpp,
	server/as_object.h, server/button_character_instance.cpp,
	server/button_character_instance.h,
	server/edit_text_character.cpp, server/edit_text_character.h,
	server/event_id.h, server/gnash.h, server/movie_root.h,
	server/sprite_instance.cpp, server/sprite_instance.h,
	server/swf_function.cpp, server/video_stream_instance.cpp,
	server/video_stream_instance.h, server/asobj/ASSound.cpp,
	server/asobj/Boolean.cpp, server/asobj/Camera.cpp,
	server/asobj/Color.cpp, server/asobj/ContextMenu.cpp,
	server/asobj/CustomActions.cpp, server/asobj/Date.cpp,
	server/asobj/Error.cpp, server/asobj/Global.cpp,
	server/asobj/Key.cpp, server/asobj/Key.h,
	server/asobj/LoadVars.cpp, server/asobj/LocalConnection.cpp,
	server/asobj/Math.cpp, server/asobj/Microphone.cpp,
	server/asobj/Mouse.cpp, server/asobj/MovieClipLoader.cpp,
	server/asobj/NetConnection.cpp, server/asobj/NetStream.cpp,
	server/asobj/NetStream.h, server/asobj/NetStreamFfmpeg.cpp,
	server/asobj/NetStreamGst.cpp, server/asobj/Number.cpp,
	server/asobj/Object.cpp, server/asobj/Selection.cpp,
	server/asobj/SharedObject.cpp, server/asobj/Stage.cpp,
	server/asobj/System.cpp, server/asobj/TextSnapshot.cpp,
	server/asobj/Video.cpp, server/asobj/gen-asclass.sh,
	server/asobj/string.cpp, server/asobj/xml.cpp,
	server/asobj/xmlnode.cpp, server/asobj/xmlsocket.cpp,
	server/vm/ASHandlers.cpp, server/vm/ActionExec.cpp,
	server/vm/ActionExec.h, server/vm/action.cpp,
	server/vm/action.h, testsuite/actionscript.all/XML.as,
	testsuite/server/GetterSetterTest.cpp: 
	(1) Change {get,set}_member{,_default} as_object members
	to take a std::string rather then a tu_string and to avoid
	case conversion of key based on target SWF version
	(2) Provide init_{member,property} as_obejct members to initialize
	AS class methods/props and take care of SWF#-based case-conversion;
	use where appropriate.
	(3) Provide {get,set}ObjectMember methods in ActionExec to take
	care of SWF#-based case conversion when called from AS handlers.

2007-01-18 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/xml.cpp: Make sure we actually have an XMLNode pointer
	before attempting to clone it. Do not attempt to setup a frame unless
	XML parsing succeeded. Fixes bug #18746.

2007-01-18 Sandro Santilli <strk@keybit.net>

	* server/asobj/xml.{cpp,h}: third pass of new layout port:
	  don't override get_member, rely on getter/setters instead.

2007-01-18 Sandro Santilli <strk@keybit.net>

	* server/asobj/: Global.cpp, xml.{cpp,h}: second pass of new layout
	  port: use xml_class_init and hide method functions.

2007-01-18 Sandro Santilli <strk@keybit.net>

	* server/asobj/xml.{cpp,h}: first pass of new layout port.
	* testsuite/actionscript.all/XML.as: first unexpected success.

2007-01-18 Sandro Santilli <strk@keybit.net>

	* server/asobj/: xml.cpp, xmlnode.{cpp,h}: drop xmlnode_as_object,
	  making XMLNode a direct subclass of as_object; Implement or stub
	  many properties as actual *properties* (new layout).
	* testsuite/actionscript.all/XMLNode.as: other unexpected successes.

2007-01-18 Sandro Santilli <strk@keybit.net>

	* server/asobj/xmlnode.{cpp,h}: (nodeValueSet): always replace
	  previous value. (xmlnode_nodevalue, xmlnode_nodename): act
	  both as a setter and a getter.
	* testsuite/actionscript.all/XMLNode.as: another unexpected success.

2007-01-18 Sandro Santilli <strk@keybit.net>

	* server/asobj/: Global.cpp, xml.cpp, xmlnode.{cpp,h}:
	  Port XMLNode class to current correct architecture.
	* testsuite/actionscript.all/XML.as: unexpected pass ;)

2007-01-18 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Fixed a bug for 8=>16 bit conversion.
	* server/asobj/NetConnection.cpp: Removed a printf.
	* server/asobj/NetStreamFfmpeg.cpp: Stop the decoding thread properly,
	  hopefully fixes bug #18571.
	* misc: Tried adding some cvs id tags (again)...

2007-01-18 Sandro Santilli <strk@keybit.net>

	* server/asobj/xml.cpp: use fn_call interface for
	  function arguments access rather then as_environment one.

2007-01-17 Sandro Santilli <strk@keybit.net>

	* macros/gnashpkgtool.m4: accept pkg-config finding for CFLAGS
	  (the bug was introduced by last commit of this file)
	* testsuite/actionscript.all/Makefile.am: don't distribute
	  prebuilt test cases.
	* missing: fix stub for missing 'makeinfo'
	* macros/ming.m4: prepend MING_PATH to PATH when
	  scanning for 'makeswf'.

2007-01-17 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/Makefile.am: Stop calling the KDE GUI executable Klash; use
	gnash instead.
	* gui/kde{.cpp, sup.h}: Make a new class named qwidget derived from
	QGLWidget. This allows us to create the QApplication before
	instantiating an object derived from QWidget, thereby fulfilling
	QT requirements. And, this way, we can also pass it argv and argc.
	* plugin/klash/Makefile.am: Stop building the klash binary. The klash
	code is obsolete and hasn't compiled for a while.
	* plugin/klash/klash_part.cpp: Use the gnash binary instead of klash.
	* backend/render_handler.h: Add get_scale() method, to retrieve the
	renderer's current scaling.
	* backend/render_handler_agg.cpp: Add a better trunc() implementation
	from Sandro. Implement drawVideoFrame(); scaling is not yet supported.
	Implement get_scale().
	* server/render{.h,.cpp}: initialise s_render_handler to NULL so as to
	avoid reading uninitialised memory. Add and implement 
	render::get_scale().

2007-01-17 Sandro Santilli <strk@keybit.net>

	* backend/Makefile.am, libbase/Makefile.am:
	  ZLIB_CFLAGS => Z_CFLAGS, ZLIB_LIBS => Z_LIBS
	* configure.ac: include ZLIB vars in summary.
	* macros/gnashpkgtool.m4: make sure to define HAVE_header when
	  a package header is found.
	* testsuite/samples/clip_as_button2-TestRunner.cpp: enable
	  verbosity *before* attempting to load the movie, to know
	  more about why the movie could not be loaded.
	* .cvsignore, cygnal/.cvsignore, extensions/mysql/.cvsignore,
	  testsuite/actionscript.all/.cvsignore,
	  testsuite/misc-ming.all/.cvsignore,
	  testsuite/movies.all/.cvsignore, testsuite/samples/.cvsignore,
	  testsuite/server/.cvsignore: 
	  Ignore generated files.
	* testsuite/libbase/Makefile.am: don't attempt to run Curl test
	  if no curl is enabled.
	* libbase/zlib_adapter.cpp: fix build for !TU_CONFIG_LINK_TO_ZLIB.

2007-01-16 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac, Makefile.am, gui/Makefile.am: Stop abusing
	gnashpkgtool.m4 and use GNASH_PKG_FIND. Update the users of the FLTK
	compiler and linker flags to use FLTK2_flag.
	* gui/fltk.cpp: Code cleanups. Fix the menu rendering bug by moving
	drawing calls into draw(). Actually enable the region rendering code.
	Redraw the whole window when it is moved.
	* gui/{fltk_glue_agg.h, fltk_glue_agg.cpp, fltksup.h}: Trivial code
	cleanups.
	* gui/fltksup.h: Remove the Mozilla exception.
	* macros/sdl.m4: Fix typos.

2007-01-15 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/gstgnashsrc.{c,h}: Fixed some warnings.
	* server/asobj/NetStreamGst.{cpp,h}: Fixed some warnings, and removed
	  some unused code.
	* server/video_yuv.cpp: Removed since it function has been moved to 
	  image::yuv.
	* testsuite/movies.all/yapc2006.swf: Removed since it's just too big!

2007-01-15 Sandro Santilli <strk@keybit.net>

	* server/font.h: proper include to avoid undefined
	  references to drop_ref().

2007-01-15 Sandro Santilli <strk@keybit.net>

	* server/asobj/TextSnapshot.cpp: fixed methods
	  casing.
	* testsuite/actionscript.all/TextSnapshot.as:
	  fixed checks taking SWF version into account.

2007-01-15 Zou Lunkai <zoulunkai@gmail.com>

	* server/vm/ASHandlers.cpp (ActionDefineFunction,
	ActionDefineFunction2): don't push named function literals
	on the stack (do it only for anonymous functions).
	See patch #5685.

2007-01-15 Sandro Santilli <strk@keybit.net>

	* testsuite/server/Makefile.am: explicitly link to libgnashvm.

2007-01-15 Sandro Santilli <strk@keybit.net>

	* server/as_environment.{cpp,h}: added padStack
	  method to help stack underrun fixes.
	* server/vm/: ASHandlers.{cpp,h}, ActionExec.{cpp,h}:
	  Moved stack underrun handling from ASHandlers to
	  ActionExec, taking "stack frame" in consideration.
	  The fix for stack underron will now insert undefined
	  variables in *front* of the stack frame, not at the
	  end. The effect is that *final* arguments of tags are
	  undefined, not *initial*.
	* testsuite/actionscript.all/Makefile.am:
	  Enabled build of swap.as testcase.

2007-01-15 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/actionscript.all/swap.as: new test for
	  stack underrun handling.

2007-01-14 Sandro Santilli <strk@keybit.net>

	* server/vm/ActionExec.{cpp,h} (getVariable, setVariable,
	  setLocalVariable): convert variable name to
	  lowercase if SWF version is < 7. This should relief us
	  from doing it in as_object::get_member_default (TODO: check it out).
	* server/sprite_instance.cpp (get_member):
	  handle '_root', '_level0' and 'this' references.
	* server/vm/ASHandlers.cpp (CommonSetTarget): use
	  as_environment::get_variable() rather then find_target()
	  to resolve target name (more hiding, automatic use of the
	  new implementaion).
	* server/as_environment.{cpp,h}: (get_variable):
	  allow objects to be used as path components, scan _global for
	  first element of path.  Uses a newly added find_object_slashsyntax
	  and find_object_dotsyntax methods, with interface similar to find_target,
	  but w/out insisting on getting a sprite_instance.
	  (find_target): return NULL on invalid paths.
	* testsuite/actionscript.all/getvariable.as: some new tests.

2007-01-13 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: don't attempt to
	  build "quickcheck" runners with 'make all'.

2007-01-13 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/render_handler_ogl.cpp: No need to flip the frame twice.
	* libbase/Makefile.am, libbase/gstgnashsrc.{c,h}: Added gstgnashsrc.{c,h}
	  for feeding gstreamer through callbacks.
	* server/Makefile.am, server/asobj/Makefile.am, 
	  server/asobj/NetStream.h, server/asobj/NetStreamGst.{cpp,h}: Added 
	  NetStreamGst for decoding of external videofiles using Gstreamer.
	* server/asobj/NetConnection.{cpp,h}: Rewritten to use curl (based on 
	  curl_adapter)
	* server/asobj/NetStreamFfmpeg.cpp: Use NetConnection instead of 
	  StreamProvider. Fixed a 100%-CPU-use-bug. Stopped fliping the videoframe.

2007-01-12 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/place_and_remove_object_insane_test.c:
	  simplified testcase to show actual Gnash problem.

2007-01-12 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionPushData): include 
	  dictionary offset when printing actions.
	* testsuite/misc-ming.all/ming_utils.h: cleanup documentation
	  for dejagnu-like macros, fix check_equals and xcheck_equals
	  macros so they actually print the "obtained" result.
	* testsuite/misc-ming.all/Makefile.am: enable run of
	  the insane testcase.

2007-01-12 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/place_and_remove_object_insane_test.c:
	  new insane testcase (surprisingly works though).

2007-01-12 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/NetStreamFfmpeg.cpp: Don't delete the RGB video data
	buffer until we've actually finished using it. Doh!

2007-01-12 Sandro Santilli <strk@keybit.net>

	* server/vm/ActionExec.{h,cpp}: don't really
	  limit the size of 'with' stack. Only use the
	  limit information to warn user when ActionScript errors
	  verbosity is enabled.
	* testsuite/actionscript.all/with.as: don't assume 'with'
	  stack limits are driven by SWF# (it will depend on the player
	  version instead).
	* testsuite/actionscript.all/Color.as: 
	  Use typeof() for stricter checking, fix case of methods.
	* server/asobj/Color.cpp: fix case of methods.
	* testsuite/actionscript.all/System.as: _global.System is
	  an object, not a class. Use typeof() for stricter checking.
	* server/asobj/System.cpp: fix case of methods, make System
	  an object, not a class.
	* testsuite/actionscript.all/Selection.as: _global.Seleciton is
	  an object, not a class. Use typeof() for stricter checking.
	* server/asobj/Selection.cpp: fix case of methods, make Selection
	  an object, not a class.
	* testsuite/actionscript.all/NetStream.as: don't check unavailability
	  of the class based on SWF version as the player is allowed to
	  provide new classes reguardless of it. Use typeof to strictly check
	  methods existance, check case-sensitiveness of methods.
	* server/asobj/NetStream.cpp: fix case of methods.
	* testsuite/actionscript.all/Makefile.am: add 'quickcheck'
	  rule, running *one* gnash process for each version.
	  Currently some tests fail, but that's likely due to
	  persistance of variable set in previous testcases
	  (they are compiled in separate frames of the same movie).
	* testsuite/actionscript.all/check.as: include filename
	  in test result report (easier to see what goes on, altought
	  bigger output); make dump of rcsid hushable.

2007-01-11 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp (get_variable_raw): accept
	  slashes in variable names (see getvariable.as).
	* testsuite/actionscript.all/: Makefile.am, getvariable.as
	  New testcase for GetVariable action type. Gnash aborts
	  against it. 

2007-01-11 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp (get_variable): revert patch
	  forcing use of 'with' stack as it breaks other testcases.
	  Will need further analisys.

2007-01-11 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{cpp,h}: (ctor) optionally take
	  an additional argument for giving the instance an arbitrary
	  interface (rather then MovieClip).
	* server/parser/sprite_definition.{cpp,h}: add registerClass()
	  method to request all subsequent instances of the sprite 
	  get a specified interface.
	* server/asobj/Object.cpp: complete registerClass() [ testing ].

2007-01-11 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp (get_variable): use 'with' stack when
	  finding path component of a path.to.variable (seems to fix
	  a use case in player2.swf).
	* server/styles.cpp: warn only once about 1st gradient fill
	  style position != 0. Use log_swferror when appropriate.

2007-01-11 Sandro Santilli <strk@keybit.net>

	* server/asobj/Global.cpp: always provide the Function
	  and System classes. Add a note about possibly bogus
	  approach of making classes available based on SWF
	  version.
	* testsuite/actionscript.all/Camera.as: expect
	  a failure on availability of Camera class for
	  old version (will likely change again in the future
	  if we confirm that availability of classes doesn't
	  depend on SWF version).

2007-01-11 Sandro Santilli <strk@keybit.net>

	* server/asobj/Stage.cpp: Stage is not a class, but
	  just an object!
	* testsuite/actionscript.all/Stage.as: fix taking
	  SWF version into account.
	* server/asobj/ContextMenu.cpp: fixed method cases
	* testsuite/actionscript.all/ContextMenu.as: fix taking
	  SWF version into account.
	* server/asobj/SharedObject.cpp: fixed method cases
	* testsuite/actionscript.all/SharedObject.as: fix taking
	  SWF version into account.
	* testsuite/actionscript.all/: Error.as, LoadVars.as:
	  fix tests taking SWF version and case into account.
	* server/asobj/LoadVars.cpp: fix method case.
	* server/asobj/Error.cpp: tostring => toString
	* server/asobj/Global.cpp: moved most classes to appropriate
	  versioned SWF section.
	* configure.ac: reverted a change in FLTK lib detection
	  committed by accident.

2007-01-10 Sandro Santilli <strk@keybit.net>

	* configure.ac: fltk gui requested and fltk2 dev package not found
	  is a nogo.

2007-01-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/{fltk.cpp, fltksup.h}: Initial FLTK GUI implementation.
	* gui/{fltk_glue_agg.cpp, fltk_glue_agg.h}: Agg glue for the FLTK GUI.
	* gui/{fltk_glue_cairo.cpp, fltk_glue_cairo.h}: Cairo glue for the
	FLTK GUI.
	* configure.ac: Allow the FLTK/Agg combination. Detect the FLTK
	library when the FLTK GUI was selected. Don't allow OpenGL/FLTK.
	* gui/Makefile.am: Build the FLTK GUI when requested.
	* gui/Player.cpp: Enable the FLTK GUI.
	* gui/gtk.cpp: Use an anonymous namespace for dbglogfile to avoid
	symbol collisions.
	* gui/gtk.cpp, gui/gui{.h, .cpp}: Move GtkGui::menuitem_sound_callback
	to class Gui so other GUIs can use it.
	* gui/fltk*: Update to the new license header sans Firefox exception.

2007-01-10 Sandro Santilli <strk@keybit.net>

	* gui/Player.cpp, libbase/zlib_adapter.cpp, libbase/zlib_adapter.h,
	  server/gnash.h, server/impl.cpp, server/parser/movie_def_impl.cpp,
	  server/parser/movie_def_impl.h, utilities/parser.cpp,
	  testsuite/MovieTester.cpp:
	  Use std::auto_ptr to have input tu_file ownership transferred up to
	  the point where it belongs (a parser unit, or an adapter).

2007-01-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gtk{.cpp, sup.h}: Reimplement the open file dialog, and
	this time include support for legacy GTK versions. It doesn't
	yet actually open the selected file.

2007-01-10 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Video.as: xcheck => check
	  (not available when swfversion<6)
	* server/dlist.{h,cpp}: added sort() method to resort
	  when depth of characters is externally changed.
	* server/sprite_instance.{h,cpp}: simplified state save
	  of frame0 displaylist, with the side-effect of properly
	  keeping ref-counting of frame0 character instances.

2007-01-10 Sandro Santilli <strk@keybit.net>

	* libbase/: extension.cpp, sharedlib.cpp: hush compiler warnings
	  about unused parameters.
	* server/asobj/Global.cpp (ctor): stubbed organization of
	  ActionScript classes in SWF target versions (volunteers
	  to filling it up?).
	* testsuite/actionscript.all/: LocalConnection.as, Camera.as,
	  NetStream.as, System.as, NetConnection:
	  test that the class are unavailable when target version
	  is < their entry point.

2007-01-10 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_tri.cpp, server/array.cpp,
	  server/sprite_instance.cpp, server/text.cpp,
	  server/swf/tag_loaders.cpp: House cleaning
	  (compiler warnings..)

2007-01-10 Sandro Santilli <strk@keybit.net>

	* server/styles.cpp (sample_gradient): fix interpolation.

2007-01-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Fix typo. Comment out configure output regarding
	the Agg compatibility layer, as it appears to be unused.
	* macros/agg.m4: `test' Can have only one instance of the -a
	argument, so add a separate test and match indentation.
	* macros/kde.m4: Stop trying to use the undefined GNASH_PATH_ZLIB
	and instead rely on the ZLIB macro which configure executes.

2007-01-10 Sandro Santilli <strk@keybit.net>

	* server/Makefile.am, server/bitmap_info.h, server/gnash.h,
	  server/parser/bitmap_character_def.h,
	  server/parser/movie_definition.h:
	  Put 'bitmap_info' clases in its own header.

2007-01-09  Rob Savoye  <rob@bertha.welcomehome.org>

	* server/asobj/Global.cpp: Always add XML support. Include
	config.h.
	* server/asobj/xml.cpp, xml.h, xmlattrs.h, xmlattrs.cpp,
	xmlnode.h, xmlnode.cpp, xmlsocket.h, xmlsocket.cpp: Don't make
	building XML optional, it's part of the Flash spec.
	
2007-01-09 Sandro Santilli <strk@keybit.net>

	* server/swf_function.{cpp,h}: use symbolic
	  names for Function2 flags.

2007-01-09 Sandro Santilli <strk@keybit.net>

	* server/swf_function.cpp (operator()):
	  Fix 'this' reference in function2 (both register and local var,
	  only the latter tested but I'd assume the former would also work).
	  Remove "UNTESTED" notice for super in function2 local var as it's
	  now tested using latest Ming.

2007-01-09 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionSetRegister, ActionPushData):
	  when setting/getting registers in function2 context and local
	  registers are not available, fallback to using global register.

2007-01-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* macros/agg.m4: When pkg-config is available and it knows Agg,
	  check for the agg-2.5 header in case we're dealing with an
	  improperly named Agg package.

2007-01-08 Sandro Santilli <strk@keybit.net>

	* server/as_environment.h: add num_local_registers() and
	  resize_local_registers() methods.
	* libbase/log.{cpp,h}: added log_swferror and log_aserror
	  functions.

2007-01-08  Rob Savoye  <rob@bertha.welcomehome.org>

	* Makefile.am: Change ZLIB_ to Z_, so it works with
	gnashpkgtool.
	* configure.ac: Autoconf isn't correctly determining when we
	are cross compiling, so do our own test. Set $incllist and
	$libslist to the output of a text file listing all the paths. Use
	GNASH_PATH_JPEG, GNASH_PATH_SDL, and GNASH_PATH_GLIB again.Use
	GNASH_PATH_LIBXML again so we can be cross configured.
	* macros/jpeg.m4: Add this back in as the name munging leaves
	gnashpktool with the wrong setting.
	* macros/sdl.m4: Add this back in so we correctly determine the
	SDL version regardless of the format.
	* cygnal/Makefile.am: Add LIBLTDL to LDFLAGS.
	* gui/Makefile.am: Add GTK_ for GTK specific CFLAGS and
	LDFLAGS. Link in libgnashamf too.
	* gnash/libamf/Makefile.am: Remove a bunch of libraries we don't
	actually need.
	* macros/agg.m4: Use global incllist and libslist. Drop test for
	version 2.3.
	* macros/boost.m4: Use global incllist instead of pathlist. Move
	AC_CHECK_HEADERS and AC_CHECK_LIB to after directory search.
	* macros/curl.m4: Don't use pkg-config when cross compiling. Use
	global incllist and libslist.
	* macros/ffmpeg.m4: Use global incllist instead of pathlist. Move
	AC_CHECK_HEADERS and AC_CHECK_LIB to after directory search. Don't
	use pkg-config when cross compiling.
	* gnashpkgtool.m4: Don't use pkg-config when cross compiling. Use
	global incllist and libslist. Add additional test for header file
	without the package name as the top level directory.
	* macros/gtk2.m4, pango.m4: Don't use pkg-config when cross
	compiling. Use global incllist and libslist.
	* macros/gtkglext.m4, mysql.m4, opengl.m4: Use global incllist and
	libslist.
	* macros/libXML.m4: Change --with option names to incl and libs to
	match everything else. Only traverse header paths once.
	* macros/ming.m4: If we don't have ming-config, find stuff our
	usual way.
	* macros/mysql.m4: Use global incllist and libslist.
	* macros/opengl.m4: Use global incllist and libslist.
	* utilities/Makefile.am: Add Boost and PTHREAD libs, along with
	gnashamf. These are needed when cross compiling.
	* macros/incllist: List of directories to use for header file searches.
	* macros/libslist: List of directories to use for library searches.

2007-01-08 Bastiaan Jacques <bastiaan@bjacques.org>

	* macros/ffmpeg.m4: Fix a rather unfortunate typo that was causing
	  configure to look for liblibavformat rather than libavformat.

2007-01-08 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionDefineFunction2):
	  check consistency of code_size, handling bogus SWF.

2007-01-08 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Inheritance.as: added a couple more
	  tests to the 'extends' section, curtesy of Zou Lunkai.
	* testsuite/actionscript.all/Function.as: added test for 'this'
	  reference in Object's context. By Zou Lunkai.

2007-01-06 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp: removed unused code.
	* server/vm/ActionExec.cpp: made action verbosity a bit more compact;
	  cleanup the stack after block execution.
	* testsuite/actionscript.all/MovieClip.as: new test for MovieClip
	  being an Object instance.

2007-01-04 Markus Gothe <nietzsche@lysator.liu.se>

	* Fixed bug #18694 + added extra info.

2007-01-04 Sandro Santilli <strk@keybit.net>

	* server/asobj/Object.cpp: stubbed registerClass().
	* server/sprite_instance.cpp (movieclip_ctor): allow 'new MovieClip'.
	* testsuite/actionscript.all/MovieClip.as: test 'new MovieClip'.
	* server/impl.cpp, server/swf/tag_loaders.{h,cpp}:
	  Implemented parsing (not use) of FILEATTRIBUTES (69)
	  and METADATA (77) tags.

2007-01-04 Sandro Santilli <strk@keybit.net>

	* server/parser/shape_character_def.cpp (read):
	  use symbolic names for tags (not yet for flags: TODO);
	  (read_fill_styles): don't choke on malformed SWF.
	* server/styles.{h,cpp} (sample_gradient): made private,
	  changed arg type to be stricter, cleaned up;
	  (fill_style::read) don't choke on malformed SWF.
	* testsuite/actionscript.all/check.as: Ming can compile 'asm'
	  blocks since 0.4.0.beta3, not beta2 (as of Ming's NEWS file).

2007-01-03 Ann Barcomb <kudra@domaintje.com>

	* Removed 'Level of Conformance' from doc/C/internals.xml.
	  This information will go in the wiki.  Temporarily created
	  conformance.xml in the same directory which contains the
	  removed material.

2007-01-03 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/tu_opengl_includes.h: Make building against X11/OpenGL work
	  even when we're using MACH, i.e. on OSX, but only when the GTK GUI
	  is used. (Because there's a good chance we're using X11 when GTK is
	  involved; however, there is an experimental GTK/Cocoa port, so this
	  is not a definitive fix and we may have to revisit this issue some
	  day.) To do this, all we have to do is to make sure GL/glx.h is
	  included.

2007-01-03 Ann Barcomb <kudra@domaintje.com>

	* Corrected Firefox version and canvas information 
	  in doc/C/internals.xml

2002-01-03 Markus Gothe <nietzsche@lysator.liu.se>

	* cygnal/http.cpp: removed extra ';'.
	* cygnal/alloc.cpp: throw stuff.

2007-01-02 Markus Gothe <nietzsche@lysator.liu.se>

	* utilities/processor.cpp if not GCC define optarg as extern.
	* server/asobjs/NetStreamFfmpeg.cpp: Fixed static_cast of
	  AV_NOPTS_VALUE. Dynamic allocation of the buffer, since it's wasn't
	  valid ISO C++ before.

2007-01-02 Ann Barcomb <kudra@domaintje.com>

	* Created directory devtools, which will contain
	  things like editor styles, tests for style conformity,
	  server-side CVS hooks, etc.

2007-01-02 Ann Barcomb <kudra@domaintje.com>
 
	* Removed zoomhenge.mbox; information abstracted to
	  README.

2007-01-02 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: provide
	  MING_VERSION_CODE define.
	* testsuite/actionscript.all/check.as: toggle define
	  MING_SUPPORTS_ASM and MING_SUPPORT_ASM_EXTEND based
	  on MING_VERSION_CODE
	* testsuite/actionscript.all/String.as: don't assume
	  that ming supports ASM, rely on the define set in
	  check.as instead.
	* testsuite/actionscript.all/Inheritance.as:
	  Add test for ActionExtend (optionally enabled
	  based on MING_SUPPORTS_ASM_EXTENDS define)

2007-01-02 Sandro Santilli <strk@keybit.net>

	* macros/ming.m4: synced with the version in Ming repository.
	  Basically add MING_VERSION and MING_VERSION_CODE variable,
	  we'll use them to detect wheter 'asm' or specific features
	  are supported.
	* Makefile.am: show Ming stuff on 'make dumpconfig'
	* configure.ac: print Ming stuff on summary, properly invoke
	  the Ming macro (renamed from GNASH_PATH_MING to AC_PATH_MING).

2007-01-02 Sandro Santilli <strk@keybit.net>

	* server/as_function.{h,cpp}: _properties member kept by
	  intrusive_ptr to simplify implementation (never
	  directly call add_ref/drop_ref); added private
	  setPrototype() method for possible future use
	  to keep "prototype" AS member in sync with
	  _properties class member; Added extends() method.
	* server/as_object.{h,cpp}: m_prototype member kept
	  by intrusive_ptr to simplify implementation (never
	  directly call add_ref/drop_ref) and made private;
	  provided get_prototype() accessor to it.
	* server/swf_function.cpp: updated accesses
	  of as_object::m_prototype.
	* server/vm/ASHandlers.cpp (ActionExtends): implemented
	  (needs more testcases).

2007-01-02 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gtk.cpp: I've commented out the GTK file chooser code because:
	  - It doesn't actually make Gnash open the file.
	  - It requires GTK >= 2.4, and we want to preserve compatibility
	  - with GTK 2.2 for embedded, old and thin systems.

2007-01-01 Sandro Santilli <strk@keybit.net>

	* server/dlist.{h,cpp}: added clear_except() function
	  to remove all but a specified set of character
	  instances from the list; deprecated clear_unaffected()
	  method.
	* server/sprite_instance.{h,cpp}: take note of which
	  character instances are created by execution of first
	  frame tags and exclude them from the DisplayList cleanup 
	  performed at each restart. Simplifies the advance_sprite
	  pretty much.
	* testsuite/misc-ming.all/place_and_remove_object_test.c:
	  don't expect any failure.

2007-01-01 Sandro Santilli <strk@keybit.net>

	* server/as_function.cpp (getPrototype):
	  added check for 'prototype' member overwrite (debugging).
	* server/swf_function.{h,cpp}: provide variable 'super' in
	  function1 and 2 contexts (local variable or register);
	  fixed the 'this' variable-or-register in function2 contexts
	  to point 
	* testsuite/actionscript.all/Inheritance.as: don't expect
	  a failure in using the 'super' variable (not function2!)

2006-12-31 Sandro Santilli <strk@keybit.net>

	* server/as_function.cpp: allow Function construction
	  using 'new'
	* testsuite/actionscript.all/Inheritance.as: don't expect
	  'new Function' to fail. Fix for SWF<6
	* server/vm/ActionExec.{h,cpp}: simplified constructor for 
	  function calls.
	* server/swf_function.{h,cpp}: updated calls to ActionExec 
	  constructor.
	* testsuite/actionscript.all/Inheritance.as: added test
	  for using 'super' from within a function (failing).
	* testsuite/misc-ming.all/ming_utils.h:
	  Include filename in test result messages.
	* testsuite/misc-ming.all/: Makefile.am, place_object_test.c,
	  place_object_testrunner.cpp: Test turned into a self-contained
	  one.

2006-12-30 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am,
	  place_and_remove_object_test.c: 
	  turned last testcase into a self-contained
	  one.
	* doc/C/internals.xml: updated section about writing Ming-based
	  self-contained tests and using the generic-testrunner.sh script.
	* testsuite/misc-ming.all/ming_utils.{h,c}:
	  Added compile_actions() method, removed check/check_equals
	  function and substituted with
	  check/check_equals/xcheck/xcheck_equals macros (so you
	  get the source file line number of failing cases).
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c:
	  updated calls to check/check_equals 
	* server/as_object.h (get_numeric_value): return 0 if
	  get_text_value() returns NULL.
	* testsuite/generic-testrunner.sh: accept -r switch
	  for passing it to gprocessor (useful when you are testing
	  restart conditions).
	* utilities/processor.cpp: add -r switch to control
	  allowed number of runs (restarts).

2006-12-30 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am,
	  place_and_remove_object_test.c:
	  Added new test from Zou (missing a testrunner).

2006-12-30 Bastiaan Jacques <bastiaan@bjacques.org>

	* macros/boost.m4: When the --with-boost-lib configure
	flag is specified, don't forget to append the library
	name to the specified path.

2006-12-29 Sandro Santilli <strk@keybit.net>

	* cygnal/cygnal.cpp: removed compiler warnings.

2006-12-29 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gtk.cpp: Don't add the drawing area to a container
	twice. This eliminates a GTK warning.

2006-12-29 Sandro Santilli <strk@keybit.net>

	* autogen.sh: check return from libtoolize call,
	  giving up if non-zero (excessive zeal?).

2006-12-28 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am,
	  testsuite/misc-ming.all/Makefile.am,
	  extensions/Makefile.am, extensions/dejagnu/Makefile.am:
	  Some fixes for 'distcheck' rule.

2006-12-28 Sandro Santilli <strk@keybit.net>

	* testsuite/samples/Makefile.am: removed references
	  to loop_test.swf, generated in misc-ming.all lately.

2006-12-28 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{h,cpp}: cleanup and document
	  add_display_object method reintroducing use of
	  the replace_if_depth_is_occupied parameter.
	* server/swf/tag_loaders.cpp (place_object_2::execute): don't
	  let new characters replace existing ones at same depth
	  when placing them. This fixes all existing testcases
	  in misc-ming.all.
	* testsuite/misc-ming.all/: loop_test-Runner.cpp,
	  place_object_testrunner.cpp: don't expect failures.

2006-12-28 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, place_object_test.c,
	  place_object_testrunner.cpp: new test by Zou Lunkai for
	  depth replacement and automatic runner for it (by myself).

2006-12-28 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/root_stop_testrunner.cpp:
	  carriage returns removed; fixed wrong assumption,
	  added more tests (no more expected failures).

2006-12-26 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, loop_test-Runner.cpp,
	  loop_test.c: added source of loop_test testcase, updated
	  tester.
	* testsuite/samples/: Makefile.am, loop_test-Runner.cpp,
	  loop_test.swf: removed code moved to misc-ming.all.

2006-12-25 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/render_handler_ogl.cpp: Made the OpenGl backend
	  actually use RGB for video...

2006-12-24 Sandro Santilli <strk@keybit.net>

	* server/swf.h: add name for tag 777 (from a contribution to Ming).
	* server/sprite_instance.cpp,
	  testsuite/misc-ming.all/root_stop_testrunner.cpp,
	  testsuite/samples/loop_test-Runner.cpp:
	  temporary hack to fix elvis.swf, breaking other
	  stuff... just a shuffle to let elvis be with us 
	  for Christmas :)

2006-12-24 Sandro Santilli <strk@keybit.net>

	* testsuite/check.h: always use the stub replacement of Dejagnu
	  as we need 'xpass' and 'xfail' which are not available in
	  latest distributed version of dejagnu.h ...
	* testsuite/misc-ming.all/root_stop_testrunner.cpp:
	  marked failures as expected.
	* server/sprite_instance.cpp: debug messages hopefully
	  made a bit less confusing.

2006-12-23 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/render_handler_ogl.cpp: Changed the OpenGL render,
	  so that it uses RGB frames for video instead of YUV, since 
	  there's some color issues with YUV->RGB convertion.

2006-12-22 Sandro Santilli <strk@keybit.net>

	* server/: execute_tag.h, sprite_instance.cpp, swf/tag_loaders.cpp:
	  Simplified get_depth_id_of_replace_or_add_tag() interface to NOT
	  use negative numbers (return 0 for non-place-or-replace-chars).

2006-12-22 Zou Lunkai <zoulunkai@gmail.com>

	* gui/sdl_agg_glue.cpp (render): fix black 
	  display - see bug #18425.

2006-12-22 Sandro Santilli <strk@keybit.net>

	* gui/sdl.cpp: don't report run of renderBuffer() - too much noise.
	* testsuite/misc-ming.all/Makefile.am: enabled run of
	  root_stop_testrunner by 'make check'

2006-12-22 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/root_stop_test.c: updated
	  testcase.
	* testsuite/misc-ming.all/root_stop_testrunner.cpp:
	  test runner for root_stop_test.swf

2006-12-21 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: added rules
	  to build root_stop_test.swf

2006-12-21 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/root_stop_test.c: new testcase
	  for bug #18549.

2006-12-21  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/ffmpeg.m4: Also check for the dc1394_control library,
	needed on Ubuntu with ffmpeg.

2006-12-21 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Fixed bug #18244: Forgot to
	  write to the correct index, and to set a variabel to 0 in a loop.
	* server/asobj/NetStreamFfmpeg.cpp: Removed the use of
	  AVFormatParameters, since it doesn't seem to be needed, and might
	  make older versions of ffmpeg useable.

2006-12-21 Sandro Santilli <strk@keybit.net>

	* server/as_value.h (set_null): return a reference to self,
	  to make building a null as_value cleaner.
	* server/asobj/xml.cpp, testsuite/actionscript.all/XML.as:
	  fix a couple of existing tests (minor thing).
	* server/as_value.h: fixed extra qualification
	  'gnash::as_value::' on member 'typeOf'.

2006-12-21 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.h: add a static integer keeping
	  number of unnamed character placements and a function
	  to return a syntetized name for them.
	* server/sprite_instance.cpp (add_display_object): always
	  provide a name for placed object, syntetizing it if 
	  not provided. This is needed for MOVIECLIP as_values,
	  now that they basically store a clip's target.
	  This is experimental, Zou should have a testcase for
	  this, which would help making it stable.

2006-12-21 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/String.as: check that no automatic
	  converstion to String object is performed on a string literal
	  when instanceOf is called on it.
	* server/as_value.{cpp,h}: made get_type() private, provided new
	  is_number(), is_string(), strictly_equals() and typeOf() methods;
	  automatically convert string and number primitive values
	  to String and Number objects from to_object() function.
	* server/array.cpp, server/as_environment.cpp,
	  server/as_function.cpp, server/as_object.cpp,
	  server/sprite_instance.cpp, server/asobj/Key.cpp,
	  server/asobj/MovieClipLoader.cpp, server/asobj/xml.cpp,
	  server/vm/ASHandlers.cpp:
	  replaced calls to as_value::get_type() with as_value::is_<what>(),
	  cleaned up some functions to delegate to as_value or to rely
	  on implicit cast.

2006-12-21 Sandro Santilli <strk@keybit.net>

	* server/as_value.h: m_type, m_string_value and values union
	  made private.
	* testsuite/misc-ming.all/VarAndCharClashTest.as:
	  added new tests checking integrity of a *reference*
	  to the movieclip.

2006-12-20 Sandro Santilli <strk@keybit.net>

	* server/as_value.cpp (to_sprite): don't segfault if the
	  sprite path doesn't reference an existing target.
	* testsuite/samples/clip_as_button2-TestRunner.cpp:
	  handled failures of MovieTester initialization
	  (see bug #18567).
	* server/as_value.{cpp,h}: add MOVIECLIP primitive type.
	* server/vm/ASHandlers.cpp (ActionTypeOf):
	  do the right thing for MOVIECLIP values.

2006-12-20 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (sprite_swap_depths):
	  Use as_value::is_object() rather then comparing get_type().
	  This helps when as_value will support MOVIECLIP types.
	* server/as_environment.cpp (find_target(const as_value&)):
	  Use as_value::is_object() rather then comparing get_type().
	  This helps when as_value will support MOVIECLIP types.
	* server/sprite_instance.cpp (get_member): fixed 
	  CHECK_FOR_NAME_CLASHES block.
	* testsuite/movies.all/README: filled 'origin' field
	  for gravity.swf and gravity-embed.swf.

2006-12-19 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as: added test for
	  timeline-variable (thanks to Zou Lunkai).
	* server/as_environment.cpp (set_variable_raw, get_variable_raw):
	  give local vars precedence.
	* server/vm/ASHandlers.cpp: use ActionExec methods for variables
	  manipulation.
	* server/vm/ActionExec.{cpp,h}: added variable manipulation
	  functions.
	* testsuite/misc-ming.all/timeline_var_test.c: added
	  additional check for timeline variables.

2006-12-19 Ann Barcomb <kudra@domaintje.com>

	* removed testsuite/movies.all/elvis.swf due to license uncertainty.

2006-12-19 Sandro Santilli <strk@keybit.net>

	* server/vm/with_stack_entry.h: made all data members private.
	* server/as_environment.{cpp,h}: ScopeStack typedef, improved
	  dox on variable setters/getters.
	* server/asobj/Makefile.am: added libltdl include dir.
	* server/as_environment.{cpp,h} (get_version):
	  simplified and clarified dox.

2006-12-18  Rob Savoye  <rob@bertha.welcomehome.org>

	* gui/Player.h, Player.cpp: Start adding support for playing
	movies from the menu item. From patch #5640.
	* gui/gtk.cpp: If running standalone, add a menu bar (task #6124),
	and a Preferences box (task #6125). Use Submenus instead of menu
	items for right-click menu. Based on (patch #5640 by Sebasti
	Matas) Use separete functions to create each menu so they can be
	shared between the MenuBar and the Popup Menu.

2006-12-18 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (execute_action): don't reset 
	  local frame top as there's nothing like a 'movie-frame' local
	  scope. See bug #18523.
	* testsuite/misc-ming.all/timeline_var_test.c: don't expect failures.
	* server/as_environment.cpp (get_variable_raw): target members take
	  precedence over local variables.
	* testsuite/misc-ming.all/: Makefile.am, timeline_var_test.c:
	  added Dejagnu.swf capabilities (for visual debugging).

2006-12-18 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/dejagnu_so_init.as: fix removal
	  of onEnterFrame callback (don't use 'this').
	* testsuite/misc-ming.all/Makefile.am: enabled
	  timeline_var_test-Runner
	* testsuite/check.h: added stubs for xpass/xfail and defined
	  xcheck/xcheck_equals/xcheck_equals_label (unfortunately 
	  xfail/xpass are not in latest dejagnu release so we'll either
	  have to force dejagnu upgrade or always use the stubs instead...
	  latter being not a bad idea IMHO).
	* server/vm/ASHandlers.cpp (ActionPushData): cleanups, including
	  verbose actions output and symbolic names for push types.
	* server/sprite_instance.cpp: use 1-based frame numbers in
	  action executions reports (VERBOSE ACTION).
	* testsuite/misc-ming.all/timeline_var_test.c: turn into
	  a self-contained test (still not Dejagnu.swf based).
	* utilities/processor.cpp: allow 10 loop backs before
	  kicking to one-after latest frame processed.
	* utilities/Makefile.am, testsuite/server/Makefile.am:
	  link to libgnashvm.la.

2006-12-18 Markus Gothe <nietzsche@lysator.liu.se>

	cygnal/cygnal.cpp: Added getopt.h etc.

2006-12-17  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: USe new GNASH_PATH_MYSQL instead of
	GNASH_PKG_FIND. Fix debug display. Don't build extensions by
	default. Don't build extensions by default.
	* server/asobjs/Global.cpp: If extensions are enabled, scan the
	plugin directories and load them.
	* Makefile.am: Only build in the extensions or cygnal directories
	if enabled. Add MYSQL to dumpconfig. Dump $SUBDIRS list too.
	* libbase/network.cpp: Change from log_msg() to
	GNASH_REPORT_FUNCTION.
	* gui/Makefile.am: Add MYSQL_LIBS if extensions are enabled.
	* utilities/Makefile.am: Add MYSQL_LIBS if extensions are enabled.
	* macros/mysql.m4: New file to find MySQL dependancies. Uses
	mysql-config, and then a path search if that fails.
	* extensions/Makefile.am: Don't try to build MySQL extension if
	MySQL isn't installed.
	* extensions/mysql/Makefile.am: Use new MYSQL_* flags from new
	macro.
	* extensions/mysql/mysql_db.cpp: Attach the Interfaces when
	initializing.
	* extensions/mysql/test.as: Don't try to run if extensions are
	disabled.
	* extensions/dejagnu/test.as: Don't try to run if extensions are
	disabled.
	* extensions/dejagnu/Makefile.am: Add libgnashvm.
	* extensions/dejagnu/dejagnu.cpp: Attach the Interfaces when
	initializing. 
	* libbase/log.cpp: Only check for verbose not being zero when tracing.
	* server/vm/Makefile.am: Install the gnashvm library, so
	extensions work again.

2006-12-17 Markus Gothe <nietzsche@lysator.liu.se>

	* libamf/amf.cpp: reinterive cast.
	* libgeometry/Range2D.h: static_cast + using namespace std (for wicked
	   compilers, like MIPSPRO ;)).
	* libbase/hash_wrapper: fixed namespace for find().
	* macros/gtk2.m4: Typos, fixed lib-finding.

2006-12-16  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Add tests for MySQL. Print MYSQL flags from
	configure tests. Drop enable testing option. Add mysql and cygnal
	configure output directories. Remove unused options for http
	server. Add option to disable building cygnal. Add option to
	disable building extensions.
	
	* cygnal: New directory for media server.
	* cygnal/cygnal.cpp: Main entry for server.
	* cygnal/Makefile.am: Makefile for media server.
	* cygnal/README: Server specific info file for developers.
	* cygnal/stream.cpp, stream.h: Streaming data class.
	* cygnal/netstats.cpp, netstats.h:  Collect statistics on
	network performance.
	* cygnal/statistics.cpp, statistics.h: Collect statistics on each
	movie being played for performance tweaking and bandwidth shaping.
	* cygnal/http.c, http.h: Support for a simple subset of HTTP,
	enough to respond to GET requests.
	* cygnal/alloc.cpp: Threadsafe new & delete to keep STL containers
	working in a multi-threaded application.
	
	* gui/Makefile.am: Switch from the rectangular gnash_128_96.ico to
	the square "Gnashing G" icon. It looks better in the toolbar.
	* gui/gtksup.h: Add about box callback prototype.
	* gui/gui.h: Add menu_about().
	* gui/gtk.cpp: Switch from the rectangular gnash_128_96.ico to
	the square "Gnashing G" icon. Add about box, patch by Sebasti
	Matas, #5640.

2006-12-15  Rob Savoye  <rob@bertha.welcomehome.org>

	* extensions/Makefile.am: Build MySQL extension.
	* libbase/extension.cpp: Don't continue if the search directory
	doesn't exist.
	
	* server/array.cpp: Add the size operator, which wasn't being added
	as a member.
	* extensions/mysql/mysql_table.h: Remove.
	* extensions/mysql/mysql_db.cpp, mysql_db.h: Tottally
	rewritten. Work as a Gnash extension. Add methods for MySQL API,
	as well as a generic getData() method for simple queries.
	* extensions/mysql/test.as: Test the MySQL extension.
	* extensions/mysql/test.sql: MySQL schema for test case.
	* extensions/dejagnu/Makefile.am: Use libdir instead of
        prefix. Include from asobjs too, and also link in
        libgnashvm. Don't build Sharedtest.
	* extensions/dejagnu/dejagnu.cpp: Setup the members
        correctly. Don't attach twice for this class.
	* extensions/dejagnu/test.as: Use pass and fail.

2006-12-14 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am:
	  rules for building timeline variable scope
	  test (missing a test runner!)

2006-12-14 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/timeline_var_test.c:
	  testcase for timeline variables scope
	  (could be turned into a self-contained test!)

2006-12-14 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Function.as: fixed for SWF5 target.

2006-12-14 Sandro Santilli <strk@keybit.net>

	* server/as_environment.{cpp,h}: add dump_local_variables
	  method.
	* server/vm/ActionExec.cpp: include dump of local variables
	  IF_VERBOSE_ACTION.

2006-12-14 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Function.as: re-enabled
	  lots of tests that were commented out with previous
	  commit of this file (Oops).
	* server/vm/ActionExec (operator()):
	  handle stack smashing and warn about elements left on
	  the stack after a function call.

2006-12-14 Sandro Santilli <strk@keybit.net>

	* server/as_environment.{h,cpp}: add an additional
	  argument to findLocal() to specify wheter the seek
	  should descend in upper frames; descend when getting,
	  deleting and setting variables; don't descend when
	  setting or declaring a *local* variable (set_local,
	  declare_local).
	* testsuite/actionscript.all/Function.as: added tests
	  for timeline-local variable access from within a function
	  (see bug #18523).

2006-12-13 Sandro Santilli <strk@keybit.net>

	* server/parser/action_buffer.cpp: neater output
	  for constant pool (-va).

2006-12-13 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (sprite_create_empty_movieclip):
	  accept more then 2 args, just discarding the one in excess.
	* testsuite/actionscript.all/MovieClip.as: don't expect
	  failures when createEmptyMovieClip is called with more then
	  2 args.

2006-12-13 Sandro Santilli <strk@keybit.net>

	* testsuite/Makefile.am: don't attempt to build Dejagnu.swf
	  if Ming isn't enabled.
	* testsuite/actionscript.all/Makefile.am: don't attempt
	  to run tests if Ming isn't installed, that support is
	  currently broken, this is a quick fix to enable users
	  to run some test even w/out Ming.
	* testsuite/: movies.all/Makefile.am, samples/Makefile.am:
	  don't require Ming to run tests in these dirs; add
	  required BOOST cflags.

2006-12-13 Sandro Santilli <strk@keybit.net>

	* doc/C/gnashrc.xml, libbase/log.h, libbase/rc.cpp, libbase/rc.h:
	  Add 'ASCodingErrorsVerbosity' and 'MalformedSWFVerbosity'
	  settings in gnashrc, IF_VERBOSE_MALFORMED_SWF() and
	  IF_VERBOSE_ASCODING_ERRORS() now use these settings
	  (not overridable from command line).
	* server/character.cpp (get_relative_target_commont):
	  don't warn about refenrecing on-up from root movie
	  unless verbose ascoding errors are requested.

2006-12-13 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp: added debugging lines for
	  find_target (compile-time enablable).
	* server/vm/ASHandlers.{h,cpp}: added CommonSetTarget().
	* server/font.cpp (font::read_font_info): warn only once
	  about DefineFontInfo2 being partially implemented...
	* server/swf/tag_loaders.cpp: removed additional newlines in log
	  messages; (define_sound_loader) raise a warning when no sound
	  handler is set, becasue characters will be missing from the
	  Dictionary; (export_loader): turn export error into a warning.

2006-12-13 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (set_member): don't attempt to set the
	  value of a character in the DisplayList, see VarAndCharClashTest.swf
	  testcase; (get_member): give object members precedence over
	  characters in DisplayList -- should be tested what happens with
	  "inherited" members..
	* testsuite/misc-ming.all/VarAndCharClashTest.as: don't expect
	  any failure.

2006-12-13 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/VarAndCharClashTest.as:
	  added more tests, dissipating some of the cloud...

2006-12-12 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: Makefile.am, VarAndCharClashTest.as:
	  Code and Makefile rule generating a self-contained testcase for
	  variables and characters name clashes (failing in Gnash).
	  Note how powerful 'makeswf' is :D

2006-12-12 Sandro Santilli <strk@keybit.net>

	* server/: button_character_instance.cpp, sprite_instance.cpp:
	  introduce button actions execution IF_VERBOSE_ACTION; include
	  total frame count in sprite's frame action executions.

2006-12-12 Sandro Santilli <strk@keybit.net>

	* server/: button_character_instance.h, character.h,
	  edit_text_character.h, generic_character.h, sprite_instance.cpp,
	  sprite_instance.h, video_stream_instance.h:
	  const-corrected can_handle_mouse_event() and get_event_handler().

2006-12-12 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as: some more
	  (verified) tests for MovieClip.useHandCursor.

2006-12-12 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: stubbed all interfaces
	  tested for existance in MovieClip.as (drawing api, mainly).
	* testsuite/actionscript.all/MovieClip.as: don't expect
	  failures while testing existance of newly added stubs;
	  Move globalToLocal test in SWF5 section (verified).

2006-12-12 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: stubbed MovieClip.getBounds().
	* testsuite/actionscript.all/MovieClip.as: added incomplete
	  test for MovieClip.getBounds().

2006-12-12 Sandro Santilli <strk@keybit.net>

	* server/as_object.h: added get_primitive_value() virtual
	  functions.
	* server/as_value.{cpp,h}: added to_primitive().
	* server/character.h: made set_name virtual to allow handling
	  from subclasses. For the same reason _name is now protected
	  (from private).
	* server/sprite_instance.{h,cpp}: override get_text_name()
	  and set_name().
	* server/asobj/string.cpp: override get_primitive_value().
	* testsuite/actionscript.all/MovieClip.as: add test for
	  cast to primitive.

2006-12-12 Sandro Santilli <strk@keybit.net>

	* server/asobj/string.cpp: added get_text_value 
	  override.

2006-12-12 Ann Barcomb <kudra@domaintje.com>

	* The Dejagnu format--as described in the test section of the
	  Docbook documentation--is now fully explained.

2006-12-11 Sandro Santilli <strk@keybit.net>

	* testsuite/movies.all/: ORIGIN merged into README.

2006-12-11 Ann Barcomb <kudra@domaintje.com>

	* Added test movie 'testsuite/movies.all/yapc2006.swf', a
	  large movie which does not currently play very well.

2006-12-11 Sandro Santilli <strk@keybit.net>

	* testsuite/samples/: Makefile.am, README, loop_test-Runner.cpp,
	  loop_test.swf: Added contributed SWF test and associated test runner.
	  See patch #5620.

2006-12-11 Ann Barcomb <kudra@domaintje.com>

	* Modified plugin list in documentation,
	  based upon comments from Bastiaan.

2006-12-11 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp (place_object_2):
	  some cleanup of class definition.

2006-12-10 Sandro Santilli <strk@keybit.net>

	* server/PropertyList.{h,cpp} (delProperty):
	  changed return type to std::pair<bool,bool>
	  to let caller know wheter delete failed because
	  the property was not found OR because it was
	  protected from deletion.
	* server/as_object.{h,cpp} (delProperty): same
	  as with PropertyList: return std::pair<bool,bool>
	  with same semantic.
	* server/as_environment.cpp (del_variable_raw):
	  don't keep scanning the 'with' stack if any object
	  actually had the given property defined, even if
	  protected from deletion.
	* server/vm/ASHandlers.cpp: updated calls to
	  as_object::delProperty().
	* testsuite/server/PropertyListTest.cpp: updated
	  calls to PropertyList::delProperty.
	* testsuite/actionscript.all/delete.as: added test for
	  protected member deletion.

2006-12-09 Sandro Santilli <strk@keybit.net>

	* server/button_character_instance.{cpp,h}: added missing
	  get_width() and get_height() overrides.
	* server/button_character_instance.cpp, server/dlist.cpp,
	  server/parser/action_buffer.cpp: cleanup debugging lines.

2006-12-09 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp (del_variable_raw): try to delete from
	  _global if anything else fails.
	* testsuite/actionscript.all/delete.as: xcheck => check as delete
	  from _global now works fine.

2006-12-09 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/delete.as: added "scoped delete" as of
	  bug #18482, but using ActionDelete rather then ActionDelete2 which
	  is used in the bug item testcase. Gnash is currently failing to
	  delete a variable in _global.

2006-12-09 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionDelete): be more robust
	  on malformed SWF (actually not sure about correctness,
	  but at least our testcase behave as the official
	  player does).
	* testsuite/actionscript.all/delete.as: xcheck => check.

2006-12-09 Timothy Lee <timothy.lee@siriushk.com>

	* configure.ac: Detect the Cairo library when the Cairo backend is 
	  enabled (and also when GTK GUI is being used).
	* backend/render_handler_cairo.cpp:
	  Removes Xlib-specific header and test code.
	  Fixes viewport clipping problem.
	  Removes offscreen buffer and renders directly through Cairo. 
	  This opens the possibility of using OpenGL/Glitz acceleration in Cairo
	  by calling set_handle() with different types of handles.
	  An added benefit of this change is that the bitmap created by the
	  SDL glue now becomes the direct target of Cairo's rendering,
	  without the redundant offscreen buffer in-between.
	* gui/gtk_glue_cairo.{cpp,h}:
	  The GTK glue now manages an offscreen bitmap for the backend to render on.
	  Window resizes now causes the offscreen bitmap to be resized as well.

2006-12-08 Sandro Santilli <strk@keybit.net>

	* testsuite/simple.exp: raised timeout to 4 minutes.
	* server/as_environment.cpp (findLocal): it seems I missed something.
	  bring back the crappy code while keeping the external interface
	  cleaner (will check later what's the difference there..).

2006-12-08 Sandro Santilli <strk@keybit.net>

	* server/: swf.h, vm/ASHandlers.{cpp,h}:
	  Renamed ACTION_DELETE to ACTION_DELETE2
	  and ACTION_DELETEVAR to ACTION_DELETE, to reflect
	  official nomenclature (Ming's listswf also uses
	  this names)

2006-12-08 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionDelete): use the new
	  ActionExec::delVariable() method. Fixes bug #18482. 
	  (ActionDeleteVar) use the new as_object::delProperty()
	  method, but no testcases for it...

2006-12-08 Sandro Santilli <strk@keybit.net>

	* server/as_environment.{cpp,h}: obsoleted crappy find_local function,
	  substituted with iterators-based equivalent; typedef'd
	  LocalFrames; added del_variable_raw method.
	* server/vm/ActionExec.{cpp,h}: added delVariable() method, invoking
	  as_environment::del_variable_raw with current 'with' stack.

2006-12-08 Sandro Santilli <strk@keybit.net>

	* server/as_object.{cpp,h}: added delProperty() member.
	* server/PropertyList.{cpp,h}: added delProperty() member.
	* testsuite/server/PropertyListTest.cpp: added test for delProperty().

2006-12-08 Sandro Santilli <strk@keybit.net>

	* server/as_prop_flags.h: added methods for
	  clearing flags, encoded bit values in an enum,
	  better documentation and implementation cleanup.
	* testsuite/server/: Makefile.am, as_prop_flagsTest.cpp:
	  Added testcase for as_prop_flags class.

2006-12-08 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.cpp (getInvalidatedBounds):
	  use a float factor for scale (1/20 was being converted
	  to 0). Don't clear invalidated bounds (or a NULL
	  range would always be returned).

2006-12-08 zoulunkai <zoulunkai@gmail.com>,

	* server/sprite_instance.cpp (advance_sprite):
	  don't re-execute tags in first frame when looping.

2006-12-08 Sandro Santilli <strk@keybit.net>

	* libbase/log.{cpp,h}: add a templated operator << for
	  printing *any* class that has an output operator defined.
	  It could replace most operator<< methods, but I won't go
	  there for now... just happy with derived Range2d printing facility.
	* testsuite/{samples,movies.all,misc-ming.all}/Makefile.am:
	  add libtestsuite.la to DEPENDENCIES of test runners.
	* libgeometry/Range2d.h: properly inlined specialized
	  round{Min,Max} functions.
	* testsuite/MovieTester.{h,cpp}: changed getInvalidatedBounds
	  to return bounds in PIXELS rather then TWIPS (to
	  conform with mouse movement notification)

2006-12-08 Sandro Santilli <strk@keybit.net>

	* libgeometry/Range2d.h: implemented cast between range types,
	  with float=>{int,unsigned int} cast ensuring resulting range
	  is not smaller then original.
	* testsuite/libgeometry/Range2dTest.cpp: added tests for
	  Range2d type cast.

2006-12-08 Sandro Santilli <strk@keybit.net>

	* libgeometry/Range2d.h: changed scale() functions to take a float,
	  to allow for fractional scales; implemented specializations
	  for int and unsigned int types to ensure rounding doesn't make
	  the range smaller.
	  Fixed many functions erroneously returning *this by value rather
	  then by reference.
	* testsuite/libgeometry/Range2dTest.cpp: added tests for scale()
	  function verifying the rounding for integer types.

2006-12-08 Sandro Santilli <strk@keybit.net>

	* libgeometry/Range2d.h: added scale() functions to scale both
	  horizontally and vertically in a single call.

2006-12-07 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/String.as: more
	  tests for ActionSubString (invalid calls...)
	* server/vm/ASHandlers.cpp (ActionSubString):
	  do the right thing on invalid calls.

2006-12-07 Sandro Santilli <strk@keybit.net>

	* server/asobj/string.cpp (string_set_length),
	  server/sprite_instance.cpp (sprite_hit_test):
	  fixed IF_VERBOSE_ASCODING_ERRORS macro use syntax.
	* server/parser/: movie_def_impl.{h,cpp}, sprite_definition.cpp
	  (add_frame_name): don't inline it.
	* server/vm/action.cpp (attach_extern_movie): 
	  store sprites in intrusive pointers (fixes some
	  testInvariant failures).
	* server/as_environment.cpp (dump_global_registers):
	  don't print anything if none of the registers are defined.
	* testsuite/actionscript.all/String.as:
	  Added test for SUBSTRIN tag, but only
	  enabled if MING_SUPPORTS_ASM is defined
	  (which never happens atm.. should add that).
	* server/vm/ASHandlers.cpp (ActionSubString):
	  when size argument is too big fix it rather
	  then returning undefined.
	* server/as_environment.cpp (find_target):
	  fixed handling of paths ending with a slash
	  (example: '../').
	* server/vm/ASHandlers.cpp (ActionGetProperty):
	  raise a warning if the target is not found
	  (ASCODING ERROR)
	* server/as_environment.{cpp,h}: registers 
	  debugging functions moved to implementation
	  file, don't print local registers if empty.
	* server/asobj/NetStream.cpp (ctor): don't
	  abort on ActionScript coding errors.

2006-12-06  Rob Savoye  <rob@ute.welcomehome.org>

	* libbase/sharedlib.cpp: Don't call lt_dlexit when destructing. 
	* server/asobj/Global.cpp: Look for extensions.
	* extensions/dejagnu/Makefile.am: Use libdir instead of
	prefix. Include from asobjs too, and also link in
	libgnashvm. Don't build Sharedtest.
	* extensions/dejagnu/dejagnu.cpp: Setup the members
	correctly. Don't attach twice for this class.
	* extensions/dejagnu/test.as: Use pass and fail.
	* libbase/extension.cpp: Remove the plugin suffix. 
	* libbase/sharedlib.cpp: Don't exit libltdl in the destructor.

2006-12-07 Ann Barcomb <kudra@domaintje.com>

	* doc/C/internals.xml, gnashrc.xml:
	  Explicitly documented that there are two sound support 
	  settings. Addresses documentation task #6129.

2006-12-07 Sandro Santilli <strk@keybit.net>

	* server/: movie_root.cpp, sprite_instance.cpp:
	  Added debugging output.
	* utilities/processor.cpp: don't always kick
	  a STOPPED movie, wait for a specified number
	  of seconds before kicking it (defaults to 5).
	  Fixes bug #18475.

2006-12-07 Sandro Santilli <strk@keybit.net>

	* server/: edit_text_character.cpp, movie_root.cpp,
 	  movie_root.h: streamlined headers inclusions.

2006-12-06 Sandro Santilli <strk@keybit.net>

	* testsuite/server/PropertyListTest.cpp: updated test
	  to reflect the new case-sensitive implementation
	  of PropertyList class.

2006-12-06 Sandro Santilli <strk@keybit.net>

	* gui/gui.cpp (advance_movie): add support for sequentially
	  displaying all frames of a movie (compile-time define).
	* gui/gui.cpp (display): when debugging invalidated bounds
	  show only the last invalidated region. this slows the
	  rendering, but when debugging you probably don't care.
	  BTW, this commit also makes NO debugging the default.

2006-12-06 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (get_invalidated_bounds):
	  cleaned up debugging output to use rect::toString.
	* server/movie_root.cpp (get_invalidated_bounds): remove
	  the dirty workaround to invalidated bounds bug.
	* server/character.{h,cpp} (set_invalidated_bounds): propagate
	  invalidity to parent (seems to fix the invalidated bounds
	  bug introduced by last big refactoring).
	* server/rect.{cpp,h}: added toString() method.

2006-12-06 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_d3d.cpp, gui/Player.cpp, gui/fbsup.h,
	  gui/gtk_glue_cairo.h, gui/kdesup.h, gui/sdl_ogl_glue.h,
	  libbase/URL.cpp, libbase/log.cpp, libbase/rc.cpp,
	  libbase/sharedlib.cpp, plugin/plugin.cpp, server/as_object.h,
	  server/font.h, server/gnash.h, server/render.cpp,
	  server/sprite_instance.h, server/swf.h, server/timers.cpp,
	  server/asobj/NetConnection.cpp, server/parser/action_buffer.h,
	  server/swf/tag_loaders.cpp, server/vm/ASHandlers.cpp,
	  server/vm/ASHandlers.h, server/vm/ActionExec.h:
	  Minor cleanups to reduce Doxygen warnings.

2006-12-06 Sandro Santilli <strk@keybit.net>

	* testsuite/server/GetterSetterTest.cpp: fix segfault
	  by initializing the VM with a dummy v6 movie definition.

2006-12-06 Sandro Santilli <strk@keybit.net>

	* server/Makefile.am, server/drag_state.h, gui/Player.cpp,
	  gui/gui.cpp, gui/gui.h, server/button_character_instance.cpp,
	  server/character.cpp, server/character.h,
	  server/edit_text_character.cpp, server/impl.cpp, server/impl.h,
	  server/movie_instance.cpp, server/movie_instance.h,
	  server/movie_root.cpp, server/movie_root.h,
	  server/sprite_instance.cpp, server/sprite_instance.h,
	  server/asobj/Key.cpp, server/parser/movie_def_impl.cpp,
	  server/parser/movie_def_impl.h,
	  server/parser/movie_definition.h,
	  server/vm/ASHandlers.cpp, server/vm/VM.cpp, server/vm/VM.h,
	  server/vm/action.cpp, utilities/processor.cpp:
	  Redesigned movie_root so that it doesn't derive from sprite_instance
	  anymore, but it is rather a wrapper around the *single* *absolute*
	  root movie for a specific run. Changed VM to return that single
	  movie_root by ref using the getRoot() method; 
	  Sorry if this changelog is too short, but was a lot of work, and
	  tried my best at keeping doxygen comments in sync.
	  Also, note that invalidated bounds seems broken now,
	  movie_root::get_invalidated_bounds() always return the WORLD rect
	  as a quick fix, but we have to fix that.
	* testsuite/MovieTester.cpp, testsuite/server/PropertyListTest.cpp, 
	  testsuite/server/Makefile.am, testsuite/DummyMovieDefinition.h:
	  Added a dummy movie definition for use in unit tests,
	  PropertyListTest still fails because we handle case sensitiveness
	  in as_object, not in PropertyList..


2006-12-06 Sandro Santilli <strk@keybit.net>

	* server/movie_root.h (get_invalidated_bounds): use rect::set_world()
	  rather then using a custom value for big bounds.
	* testsuite/MovieTester.{cpp,h}: add getInvalidatedBounds function.
	* libgeometry/Range2d.h (Intersect): removed spurious code.
	* server/rect.h: added getRange() method.


2006-12-05 Sandro Santilli <strk@keybit.net>

	* server/rect.cpp (expand_to_rect): handled world rects.
	* server/asobj/MovieClipLoader.cpp (loadClip): use smart
	  pointers (to avoid testInvariant failures in sprite_instance).
	* server/types.{cpp,h} (rgba::print): made a const method.
	* .cvsignore, extensions/.cvsignore, plugin/klash/.cvsignore,
	  testsuite/libgeometry/.cvsignore, utilities/.cvsignore,
	  testsuite/.cvsignore, testsuite/libbase/.cvsignore,
	  testsuite/libgeometry/.cvsignore, testsuite/misc-ming.all/.cvsignore,
	  testsuite/server/.cvsignore,
	  New/updated cvs ignore files.
	* plugin/klash/Makefile.am: added libgeometry
	  directory in include list.
	* server/rect.h: added output operator.
	* backend/render_handler_agg.cpp (ctor):
	  properly initialized m_drawing_mask member.

2006-12-05 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/render_handler.h, backend/render_handler_agg.cpp,
	  backend/render_handler_cairo.cpp, server/render.h,
	  backend/render_handler_ogl.cpp, server/render.cpp: Removed 
	  YUV_video, and added videoFrameFormat() and drawVideoFrame().
	* libbase/image.cpp, libbase/image.h: Added yuv.
	* server/Makefile.am: Removed video_yuv.cpp
	* server/gnash.h: Removed YUV_video.
	* server/video_stream_instance.cpp: Changed to use the new 
	  videoframe rendering method.
	* server/asobj/Makefile.am: Added NetStreamFfmpeg.{cpp|h}
	* server/asobj/NetStream.{cpp|h}: Removed the ffmpeg code, 
	  and made a non-decoding class (NetStreamBase).
	* server/asobj/NetStreamFfmpeg.{cpp|h}: Created the files, 
	  which contains the ffmpeg specific code, moved from 
	  NetStream.{cpp|h}. Now uses StreamProvider to handle files,
	  and connects in a seperate thread to avoid blocking.

2006-12-05 Sandro Santilli <strk@keybit.net>

	* server/movie_root.h: Added more information for the
	  class (using repository for planning, let me know if
	  you find this disturbing).
	* server/parser/movie_definition.h: Added more information
	  for the class (Doxygen class description).

2006-12-04 Sandro Santilli <strk@keybit.net>

	* server/parser/: movie_def_impl.h, movie_definition.h,
	  sprite_definition.h: provided a default implementation
	  for most movie_definition methods, to make deriving
	  from it easier. Removed some unneeded overload from
	  sprite_definition (the new default implementations are
	  good enough). Cleaned up and improved doxygen comments.

2006-12-03 Sandro Santilli <strk@keybit.net>

	* testsuite/libgeometry/Range2dTest.cpp: add tests for
	  growBy().
	* libgeometry/Range2d.h: fix growBy() to properly handle
	  numerical overflows ( see relative tests ).

2006-12-02 Sandro Santilli <strk@keybit.net>

	* libgeometry/Range2d.h: Add growBy() and shrinkBy() methods.
	  Make all mutators return a reference to *this (nicer use sytax).
	* backend/render_handler_agg.cpp, gui/gtk.cpp: set back the
	  drawn bounds 2 pixel grow needed for antialiasing.

2006-12-02 John Franklin <zzfranklin@mac.com>

	* backend/render_handler_agg.cpp (render_handler_agg ctor):
	  initialize x/y scale to 1/20 by default.

2006-12-02 Sandro Santilli <strk@keybit.net>

	* gui/fb.cpp, gui/gtk.cpp: don't render anything
	  if _drawbounds.isNull() - we should make sure
	  that _drawbounds is expanded to cover 'newly' exposed
	  regions, and that it is reset to NULL after each
	  call to renderBuffer.

2006-12-02 Sandro Santilli <strk@keybit.net>

	* backend/render_handler.h, backend/render_handler_agg.cpp
	  backend/render_handler_tri.cpp, backend/render_handler_tri.h
	  gui/gtk.cpp, gui/gtksup.h, gui/gui.cpp, gui/gui.h, gui/fbsup.h,
	  gui/fb.cpp:
	  Use Range2d<int> rather then 4 integers for clip bounds,
	  keep trac of *valid* range for pixel values, add some questions
	  as comments in the code. Please forgive me if this will break
	  something but we're in a stage we'll have to break things
	  for making them better ...

2006-12-02 Sandro Santilli <strk@keybit.net>

	* server/rect.h: added is_world() and get_world() methods.

2006-12-01 Sandro Santilli <strk@keybit.net>

	* testsuite/: actionscript.all/swf_exists.exp, libbase/libbase.exp,
	  server/server.exp: removed, ../simple.exp is better !
	* testsuite/: libbase/Makefile.am, server/Makefile.am:
	  use ../simple.exp for testing.

2006-12-01 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_agg.cpp (set_invalidated_region):
	  Temporary hack to fix bug #18416, and a way to 
	  show Udo a usage case. The real solution is use
	  Range2d<int> instead of m_clip_{x,y}{max,min}.

2006-12-01 Sandro Santilli <strk@keybit.net>

	* server/Makefile.am, server/rect.cpp, server/rect.h,
	  server/asobj/Makefile.am, server/parser/Makefile.am,
          server/parser/movie_definition.h, server/parser/video_stream_def.h,
	  server/vm/Makefile.am, utilities/Makefile.am, testsuite/Makefile.am:
	  Rewritten gnash::rect class to use Range2d<float>.

2006-12-01 Sandro Santilli <strk@keybit.net>

	* backend/render_handler.h, server/render.h:
	  some doxygen notes for bounds_in_clipping_area.

2006-12-01 Sandro Santilli <strk@keybit.net>

	* configure.ac, libgeometry/Makefile.am, libgeometry/Range2d.h,
	  testsuite/Makefile.am, testsuite/libgeometry/Makefile.am,
	  testsuite/libgeometry/Range2dTest.cpp, testsuite/server/Makefile.am:
	  New Range2d template class and associated unit test.

2006-12-01 Sandro Santilli <strk@keybit.net>

	* configure.ac: make missing BOOST_LIBS
	  a nogo (we need threads now).

2006-12-01 Vitaly Alexeev <tishka92@yahoo.com>

	* backend/render_handler_ogl.cpp,
	* libbase/image_filters.cpp,
	* libbase/tu_config.h,
	* libbase/log.cpp,
	* libbase/network.cpp,
	* libbase/container.cpp,
	* server/sprite_instance.cpp,
	* server/movie_instance.cpp,
	* server/dlist.cpp,
	* server/dlist.h,
	* server/parser/movie_def_impl.cpp,
	* server/vm/ASHandlers.cpp
	Cleaning of Vitaly dust from comments
	
2006-11-30 Sandro Santilli <strk@keybit.net>

	* libbase/: Makefile.am, sharedlib.cpp:
	  boost::lightweight_mutex => boost::mutex
	* backend/render_handler_agg.{cpp,h}: 
	  some cleanups (including a missing virtual destructor)
	  and some assertions checking, to make reproducing
	  bug #18416 easier.

2006-11-30 Patrice Dumas <pertusus@free.fr>

	* autogen.sh: add libltdl once.

2006-11-30 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/sound_handler_sdl.{h,cpp}: hash<> to hash_wrapper<> change.
	* fontlib.h: Don't include "container.h".

2006-11-30 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.cpp (resolve_import):
	  remove unneeded round-trip with static casts.
	* server/edit_text_character.{h,cpp},
	  server/parser/edit_text_character_def.h:
	  use unsigned integers for curosr and max text length.
	* server/parser/movie_def_impl.{h,cpp}: implement
	  a thread-safe get_bytes_loaded taking seek-backs
	  into account.

2006-11-30 Sandro Santilli <strk@keybit.net>

	* server/parser/Makefile.am: added BOOST_LIBS as
	  we now use boost threads.
	* server/parser/movie_def_impl.{h,cpp}: be less
	  lock-intensive in load. Note that this exposes
	  a problem with get_bytes_loaded, play elvis.swf
	  to see. I'm committing anyway as a mileston,
	  will fix get_bytes_loaded later.

2006-11-30 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/gen-index-wiki.sh:
	  include a link to the source code.
	* server/parser/movie_def_impl.cpp (read_all_swf):
	  catch std exceptions (including parsing exceptions).
	* server/styles.cpp (read): throw ParserException when
	  an unsupported fill style type is read.
	* libbase/GnashException.h: add a ParserException class.
	* backend/Makefile.am: add BOOST_CFLAGS (see bug #18398)

2006-11-29 Patrice Dumas <pertusus@free.fr>

	* macros/kde.m4: Remove plies of useless code we don't need.

2006-11-29  Rob Savoye  <rob@bertha.welcomehome.org>

	* config.sub, config.guess: Let autogen.sh install these.
	* libltdl: Remove directory and let libtoolize install this
	instead.
	* autogen.sh: Add --ltdl to libtoolize.

2006-11-29 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/: Makefile.am, gen-index.sh,
	  gen-index-wiki.sh: fix index.wiki generation rule.
	* testsuite/analyse-results.sh: sort directories, to make
	  cross-systems comparison easier.
	* testsuite/simple.exp: handle deadlocks or infinite loops 
	  in testcases.
	* testsuite/simple.exp: handle premature death and non-zero
	  return of testcases.
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c:
	  Add tests for dynamically changing a TextField's variable name.
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest-Runner.cpp
	  Updated and simplified (the most part is done in the sefl-contained
	  testcase anyway).
	* server/edit_text_character.{cpp,h}:
	  Allow programmatically setting a TextField's
	  variable name.

2006-11-29 Sandro Santilli <strk@keybit.net>

	* server/edit_text_character.cpp: properly set
	  TextField interface (to finish); implement 'variable'
	  propery.
	* updated .cvsignore files, moved binary only swf
	  from testsuite/actionscript.all to testsuite/samples.
	* server/movie_root.cpp (advance):
	  Don't check delta_time, rather always call advance of
	  current_root. My plan is to have movie_root be just a
	  wrapper around movie_instance.
	* testsuite/MovieTester.cpp:
	  Activate verbosity to allow for self-contained testcases
	  to be taken into account; give initial kick to movie.
	* testsuite/misc-ming.all/: ButtonEventsTest-Runner.cpp,
	  DefineEditTextVariableNameTest-Runner.cpp,
	  RollOverOutTest-Runner.cpp:
	  Omit the initial ::advance(), MovieTester will take
	  care of that.

2006-11-28 Sandro Santilli <strk@keybit.net>

	* testsuite/Makefile.am: added -Iserver/vm
	  needed for MovieTester.cpp
	* testsuite/MovieTester.cpp (ctor): fixed
	  reference to root movie (it's still pretty
	  confusing)

2006-11-28 Markus Gothe <nietzsche@lysator.liu.se>

	* server/shape.cpp: hash<> -> hash_wrapper<>.

2006-11-28 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.cpp (ctor): properly initialize
	  the virtual machine.
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c:
	  test TextField.variable.
	* testsuite/misc-ming.all/ming_utils.c (add_xtrace_function):
	  register 'xtrace' on the _root movie.
	* gui/Player.cpp: fix handling of the -d switch.

2006-11-28 Sandro Santilli <strk@keybit.net>

	* server/character.cpp (do_mouse_drag): indentation
	* server/character.h (drag_state): documented
	  coordinate space for drag bounds.
	* server/vm/ASHandlers.cpp (ActionStartDragMovie):
	  convert pixels to twips when reading drag boundaries.

2006-11-28 Sandro Santilli <strk@keybit.net>

	* server/button_character_instance.{cpp,h}:
	  Don't override get_mouse_state with an equivalent
	  implementation.
	* server/rect.{cpp,h}: Add clamp(point) method.
	* server/: character.{cpp,h}, movie_root.{cpp,h},
	  sprite_instance.{h,cpp}:
	  Change signature of get_mouse_state() and get_drag_state()
	  to use references rather then pointers; Improve
	  definition of drag_state class to use our rect
	  class for bounds and to store character in a smart pointer.
	* server/vm/ASHandlers.cpp (ActionStartDragMovie):
	  flip drag boundaries coordinates if given in the wrong
	  order (fixes bug #18394).

2006-11-28 Sandro Santilli <strk@keybit.net>

	* gui/Player.cpp (load_movie) : don't start loader thread
	  also for stdin reads. Fixes bug #18393.
	* server/: impl.{cpp,h}, parser/movie_def_impl.{cpp,h},
	  parser/sprite_definition.cpp, swf/TagLoadersTable.{cpp,h}:
	  Another global removed: 's_tag_loaders', replaced
	  with TagLoadersTable turned into a singleton.

2006-11-28 Markus Gothe <nietzsche@lysator.liu.se>

	* Applied a bunch of RiscOS-patches.

2006-11-28 Sandro Santilli <strk@keybit.net>

	* macros/libtool.m4: removed so that ltmain.sh
	  always matches the one found in system.
	  (libtoolize --force --copy will replace ltmain.sh)

2006-11-28 Patrice Dumas <pertusus@free.fr>

	* remove or conditionalize CPPFLAGS and LIBS
	* add distributed files or dirs
	* use AC_PROG_LIBTOOL instead of AM_PROG_LIBTOOL in autogen.sh
	* add dependencies on libs for gnash, to avoid parallel make error
	* change <..> to ".." for includes from source

2006-11-28 Sandro Santilli <strk@keybit.net>

	* server/impl.cpp (globals): base_url auto_ptr made
	  module-static.
	* autogen.sh: make 'Running' messages show all args.
	* server/sprite_instance.cpp (ctor): initialize
	  all members (m_sound_stream_id in particular
	  needed it).

2006-11-27 Markus Gothe <nietzsche@lysator.liu.se>

	* Reverted naming-changes.
	* libgeometry/kd_tree_dynamic.cpp: hash_wrapper().
	* utilities/parser.cpp: hash_wrapper();
	* libbase/hash_wrapper.h: template-wrapper for add() and get() to 
	  replacing hash()-code with <map>.

2006-11-27 Sandro Santilli <strk@keybit.net>

	* server/parser/sprite_definition.cpp (read):
	  don't choke if DEFINESPRITE tag contains more
	  SHOWFRAME then expected.
	* server/: gnash.h, impl.cpp: export the movie creation
	  functions taking additional argument to control
	  start of the loader thread.
	* server/parser/movie_definition.h: completeLoad()
	  definition moved in base class.
	* server/parser/movie_def_impl.cpp (create_instance):
	  don't execute actions of frame 0, delegate that
	  to movie_instance::advance.
	* server/movie_instance.cpp (advance): execute
	  actions in frame 0 on first call.
	* gui/Player.cpp (run), utilities/processor.cpp (play_move):
	  complete root movie load *after* the VM is initialized.

2006-11-27 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (get_member):
	  clean up _name and _droptarget handling.
	  (btw, we should use addProperty for these).
	* testsuite/actionscript.all/MovieClip.as:
	  fixed tests for SWF5 target.
	* testsuite/actionscript.all/dejagnu_so_init.as:
	  implement dejagnu initialization checker function
	  with setInterval (in addition to onEnterFrame).
	  This makes SWF5 targets work fine.
	* server/parser/movie_def_impl.cpp (create_instance):
	  don't force the instance name to be _root !
	* server/sprite_instance.{h,cpp}: added support
	  for the _target property; report execution of
	  frame tags when in verbose action mode.
	* testsuite/actionscript.all/MovieClip.as: added
	  tests for the _target property.
	* server/asobj/Video.cpp: attachvideo => attachVideo.
	* server/asobj/string.cpp: lastindexof => lastIndexOf.
	* testsuite/actionscript.all/: XMLNode.as, MovieClip.as:
	  fixed tests to match reality.

2006-11-26 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (attachMovieClipInterface):
	  only activate the methods available for the target SWF
	  version. Added stubs for getURL, startDrag, stopDrag
	  and attachAudio.
	* testsuite/misc-ming.all/ming_utils.c (get_dejagnu_actions):
	  don't "visualize" expected successes.
	* server/vm/ASHandlers.cpp (ActionTypeOf):
	  return "movieclip" when object is a sprite_instance.
	* testsuite/actionscript.all/MovieClip.as:
	  typeof(mc) == "movieclip" succeeds.
	* testsuite/actionscript.all/: Object.as, XML.as:
	  don't expect case-based failure.
	* server/as_object.{h,cpp}: added getVM() function,
	  store a reference to the VM in class definition.
	* testsuite/misc-ming.all/ming_utils.c: add a note 
	  function to dejagnu module interface.
	* doc/C/internals.xml: cleanups in the 'writing testcases'
	  sections, new section about using Dejagnu.swf for writing
	  testcases using non-Ming compilers.

2006-11-26 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp (draw_glyph):
	  allow glyphs to be used for drawing masks.
	  Fixes bug #18242.

2006-11-26 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_agg_style.h (agg_style_base):
	  add missing virtual destructor. Fixes bug #18309.

2006-11-26 dolphinling <lists@dolphinling.net>

	* server/edit_text_character.cpp:
	  code cleanups.

2006-11-26 Markus Gothe <nietzsche@lysator.liu.se>

	* server/rect.h DSOEXPORT expand_to_transformed_rect().
	* libbase/smart_ptr.h: Removed TU's rights since we don't use his 
	code.

2006-11-25 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler.h, backend/render_handler_agg.cpp:
	Don't start drawing a character when it's outside the clipping
	rectangle.
	* server/render.h, server/render.cpp:
	Added interface to bounds_in_clipping_area()
	* server/sprite_instance.cpp: Don't draw sprites (and their
	childs) outside the clipping rectangle.


2006-11-25 Sandro Santilli <strk@keybit.net>

	* server/asobj/Global.cpp, testsuite/actionscript.all/Global.as:
	  isNan => isNaN.
	* testsuite/actionscript.all/Boolean.as:
	  fix method names capitalization.
	* server/asobj/gen-asclass.sh: keep method names
	  capitalization.
	* server/asobj/Boolean.cpp (attachBooleanInterface):
	  fix method name capitalization.
	* server/as_object.{h,cpp} (setPropFlags, set_member_flags):
	  fix property case handling, documented it.
	* testsuite/simple.exp: show NOTES with verbosity
	  level == 1.

2006-11-25 Michael Meier <meiermic@ee.ethz.ch>

	* testsuite/actionscript.all/String.as: fixed to match
	  expected behaviour.
	* server/asobj/string.cpp: implement 'length' with the
	  add_property() interface.

2006-11-25 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_ogl.cpp: #ifdef'd VITALY to get OGL working.
	* configure.ac: List FLTK and RISCOS as params to --enable-gui.
	* libbase/rc.h: DSOLOCAL -> DSOEXPORT.
	* configure.ac: Try-out of finding zlib with generic macro.
	* macros/: major clean-up...

2006-11-24  Rob Savoye  <rob@bertha.welcomehome.org>

	* config.guess: Update so it recognizes
	armv5tel-unknown-linux-gnu for embedded arm targets when building
	natively.

2006-11-24 Sandro Santilli <strk@keybit.net>

	* plugin/plugin.cpp: wait for gdb if GNASH_OPTIONS
	  environment variable contains the substring 'waitforgdb';
	  cleanups.
	* testsuite/actionscript.all/Date.as:
	  case-sensitiveness tests pass now.

2006-11-24 Patrice Dumas <pertusus@free.fr>

	* Makefile.am, backend/Makefile.am, gui/Makefile.am,
	  libamf/Makefile.am, libbase/Makefile.am, libgeometry/Makefile.am,
	  packaging/redhat/gnash.spec, plugin/Makefile.am,
	  plugin/klash/Makefile.am, plugin/mozilla-sdk/Makefile.am,
	  server/Makefile.am, server/asobj/Makefile.am,
	  server/parser/Makefile.am, server/vm/Makefile.am,
	  testsuite/actionscript.all/Makefile.am,
	  testsuite/libbase/Makefile.am,
	  testsuite/misc-ming.all/Makefile.am,
	  testsuite/movies.all/Makefile.am, testsuite/samples/Makefile.am,
	  testsuite/server/Makefile.am, utilities/Makefile.am:
	Use AM_CPPFLAGS instead of INCLUDES at most as possible,
	try to be more selective in linking,
	remove unused KLASH_DIRS in top-level Makefile.am,
	remove one $(LIBADD_DL) since this variable is not set,
	remove some redundancy, bring the spec file in sync with 0.7.2 branch,
	avoid protecting everything in testsuite/movies.all/Makefile.am,
	only what is dependent on ming.

2006-11-24 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionDelete):
	  don't force 2 elements on stack, since only one is needed. See
	  bug #18365.

2006-11-24  Rob Savoye  <rob@bertha.welcomehome.org>

	* libbase/sharedlib.cpp: Use & instead of a pointer to an
	as_object. const_cast basename.
	* configure.ac: Test for libgen.h.
	* extensions/dejagnu/Makefile.am: Add libgnashvm to ldflags.
	* extensions/dejagnu/dejagnu.cpp, dejagnu.h: Use & instead of a
	pointer to an as_object.
	* libbase/extension.h, extension.cpp: Use & instead of a pointer
	to an as_object. 
	
2006-11-24 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/sharedlib.cpp: Fixed include for basename and casting to
	  const char *.

2006-11-24 Sandro Santilli <strk@keybit.net>

	* server/vm/VM.{cpp,h}: added isInitialized() method.
	* gui/gui.cpp (resize_view): don't abort :)
	* server/asobj/Date.cpp: use proper case when registering class
	  interface.
	* server/PropertyList.h: be case sensitive !
	* server/as_object.cpp (set_member_default, get_member_default):
	  convert memer names to lowercase when VM is targetted at
	  SWF version < 7.

2006-11-24 Sandro Santilli <strk@keybit.net>

	* server: as_environment.cpp, as_function.cpp, as_function.h,
	  impl.cpp, swf_function.cpp, asobj/GMath.h, asobj/Global.cpp,
	  asobj/Global.h, asobj/Key.cpp, asobj/Key.h, asobj/Makefile.am,
	  asobj/Math.cpp, asobj/MovieClip.cpp, asobj/MovieClip.h,
	  asobj/System.cpp, asobj/System.h, vm/ActionExec.cpp,
	  vm/VM.cpp, vm/VM.h, vm/action.cpp, vm/action.h:
	  Got rid of another global: 's_global'; various cleanups for
	  ActionScript classes.. Whooo!

2006-11-24 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase\sharelib.cpp: fixed VC++ compiler errors
	* libbase\extension.cpp: fixed VC++ compiler errors
	* libltdl\ltdl.c: fixed VC++ compiler errors

2006-11-24 Sandro Santilli <strk@keybit.net>

	* server/Global.h = server/asobj/Global.h
	* server/as_object.{cpp,h}: off-lined constructors and
	  destructor, with constructor asserting the presence
	  of an unitialized VM; made set_prototype() a protected member
	  to allow sprite_instance to attach a MovieClip prototype.
	* server/sprite_instance.{cpp,h}: conform to the ActionScript
	  classes API, wipe the as_builtins crap; assert the presence
	  of an initialized VM in constructor.
	* server/asobj/Global.cpp: invoke movieclip_class_init() 
	* testsuite/actionscript.all/MovieClip.as: added check
	  for MovieClip class.
	* gui/: Makefile.am, Player.cpp:
	  use the new VM interface for initialization.
	* server/impl.cpp: deprecate set_current_root(), implement
	  get_current_root() with a call to the VM singleton.
	* server/sprite_instance.cpp (ctor): assert that a VM has
	  been initialized (for debugging)
	* utilities/: Makefile.am, processor.cpp
	  use the new VM interface for initialization.
	* server/vm/: Makefile.am, VM.{cpp,h}: new class aimed at
	  holding VM-related globals.

2006-11-24 Vitaly Alexeev <tishka92@yahoo.com>

	* backend\render_handler_ogl.cpp: added "class YUV_video_ogl_NV"
	that uses opengl extensions for fast video rendering
	* server\swf\tag_loaders.cpp: fixed case of "sound_id < 0"
	* server\button_character_instance.cpp: fixed case of "sound_id < 0"
	* backend\sound_handler_sdl.cpp: sound is stereo now
	* server\asobj\NetStream (cpp, h): added "pause" & fixed bugs, 
	video is tested on FC4
	* win32\VC8\gnash.vcproj: added server\am dir
	* testsuite\samples\player.swf: added pause
	
2006-11-24 Sandro Santilli <strk@keybit.net>

	* server/gnash.h: ok, include as_value, but document what's needed
	* server: {xmlattres,xmlnode,xmlsocket}.{h,cpp} => asobj

2006-11-24 Sandro Santilli <strk@keybit.net>

	* configure.ac, server/ActionExec.cpp, server/ActionExec.h,
	  server/Makefile.am, server/action.cpp, server/action.h,
	  server/array.h, server/button_character_instance.cpp,
	  server/edit_text_character.cpp, server/fn_call.h, server/gnash.h,
	  server/sprite_instance.cpp, server/sprite_instance.h,
	  server/swf_function.cpp, server/with_stack_entry.h,
	  server/asobj/Makefile.am, server/asobj/MovieClipLoader.cpp,
	  server/parser/Makefile.am, server/parser/action_buffer.cpp,
	  server/parser/action_buffer.h, server/swf/ASHandlers.cpp,
	  server/swf/ASHandlers.h, server/vm/.cvsignore,
	  server/vm/ASHandlers.cpp, server/vm/ASHandlers.h,
	  server/vm/ActionExec.cpp, server/vm/ActionExec.h,
	  server/vm/Makefile.am, server/vm/action.cpp,
	  server/vm/action.h, server/vm/fn_call.h,
	  server/vm/with_stack_entry.h, testsuite/server/Makefile.am:
	  New vm/ dir and libgnashvm.so convenience library;
	  Obsoleted as_environment::execute (use ActionExec instead).

2006-11-24 Sandro Santilli <strk@keybit.net>

	* configure.ac: comment out extension dir (no Makefile.am
	  in there atm)
	* testsuite/actionscript.all/: Object.as, Date.as:
	  expect failures on case sensitiveness.
	* gui/Makefile.am: don't directly link convenience
	  libaries.
	* server/: as_environment.cpp, swf_function.cpp:
	  fixed includes

2006-11-23  Rob Savoye  <rob@bertha.welcomehome.org>

	* libbase/Makefile.am: Add new extension files. Pass a directory
	based on $prefix as a constant for Gnash extensions.
	* libbase/sharedlib.h: Add as_object typed entry point. Optionally
	pass in the search path for most methods. Find as_object typed
	entry point differently than a generic symbol.
	* libbase/sharedlib.cpp: Many changes, it basically works
	now. Don't do in SharedLib class what should be done in the
	Extension class. Initialize libltdl in the constructor, so it's
	done before anything else. Support a path as a parameter, or use
	GNASH_PLUGINS for a colon seperate path.
	* libbase/extension.h, extension.cpp: New files for Gnash
	extension plugins.
	* extensions/Makefile.am: New file. Recurse into extension
	directories.
	* extensions/dejagnu/Makefile.am: Build DejaGnu extension for
	Gnash.
	* extensions/dejagnu/dejagnu.cpp, dejagnu.h: New files for DejaGnu
	extension. This is mostly just a template on creating custom
	ActionScript extensions for Gnash.
	* Makefile.am: Add extension directory, but don't build for now
	from the top level.

	* configure.ac: Look for 64 bit OpenBSD systems, and set
	WORDSIZE. Configure extension directory.

2006-11-23 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: removed compiler warnings.
	* server/: timers.{h,cpp}, sprite_instance.h: includes cleanup.
	  (shouldn't this be under asobj, btw ?)
	* server/parser/: movie_def_impl.h, movie_definition.h:
	  forward declarations.

2006-11-23 Sandro Santilli <strk@keybit.net>

	* server/parser/bitmap_character_def.h: removed action.h include
	* Makefile.am: fix 'make dumpconfig' output when using GST sound.
	* server/parser/movie_def_impl.cpp: removed compiler warnings.
	* libbase/sharedlib.h: removed unneeded includes
	* server/character.h: removed action.h include
	* server/asobj/MovieClipLoader.h: removed all includes
	* server/impl.cpp (set_current_root): don't allow multiple calls
	  to this function, we're not read for it yet.
	* testsuite/actionscript.all/Object.as: object members are
	  case-sensitive starting at SWF7 !
	* testsuite/actionscript.all/Date.as: method names are case-sensitive
	  starting at SWF7 !
	* testsuite/actionscript.all/CustomActions.as: disabled all
	  tests as the class is only intended for use in the Flash
	  authoring tool, see http://sephiroth.it/reference.php?id=156&cat=1
	* testsuite/actionscript.all/Camera.as: updated after run reports.
	* testsuite/actionscript.all/dejagnu.as: don't override rcsid
	  set in testcases.
	* testsuite/actionscript.all/check.as: make all traces
	  visual (trace == info).

2006-11-22  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Check for powerpc Darwin, and set __powerpc64__ so
	the Mozilla headers still work to do a gtk build. Fixes #18353.
	* plugin/mozilla-sdk/include/prcpucfg.h: Include config.h.

2006-11-22 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am:
	  fixed some typos, use the same relative
	  path to Dejagnu.swf for both offline and
	  online testcases.
	* testsuite/generic-testrunner.sh: made more 
	  verbose
	* testsuite/Makefile.am: add rule to build
	  Dejagnu.swf "on-dir-up" (so we don't need
	  two different versions of actionscript
	  testcases with different path to it.

2006-11-22 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/gen-index.sh: use
	  first argument as name of the 'all-inclusive'
	  test.
	* testsuite/actionscript.all/Makefile.am: isolate
	  unit tests to avoid a broken support to influence
	  results of other units; changed online-tests rule
	  to avoid unneeded rebuilds and use version-specific
	  filenames.
	* testsuite/generic-testrunner.sh: allow for multiple
	  SWF files to be tested.
	* server/: xmlattrs.h, xmlnode.cpp, xmlnode.h:
	  use delete [] when allocating with new [].
	  (why aren't we using std::string, btw ?)

2006-11-22 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Function.as: tweaked
	  tests to take into account differences in numerical
	  computations between SWF target version.
	* testsuite/actionscript.all/XML.as: fixed test.
	* testsuite/actionscript.all/Video.as:
	  attach => attachVideo, expect Video
	  class to non exist with SWF < 6

2006-11-22 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/sharedlib.cpp: getcwd() should be passed a buffer of 
	size at least equal to PATH_MAX. Fix an invalid dereference of 
	the buffer pointer, too.

2006-11-22 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ButtonEventsTest-Runner.cpp: updated
	  to perform the tests in all frames.
	* testsuite/misc-ming.all/ButtonEventsTest.c: added two more
	  frames to the testcase adding shapes at lower (frame1) and
	  higher (frame2) depth then the button. The aim is debugging
	  what I think VV tried to fix in DisplayList::visitBackward.
	* testsuite/check.h: add an 'info' macro as a proxy to dejagnu's
	  note() function, with a fallback stub.
	* testsuite/actionscript.all/MovieClip.as: fix some expected
	  values to match the defaults.
	* testsuite/actionscript.all/Mouse.as: instantiation
	  should not be allowed (probably).
	* testsuite/actionscript.all/Microphone.as: updated to
	  properly check the get() method.
	* testsuite/actionscript.all/Date.as: check UTC to be
	  a method of the Date class, not inherited by instances.
	* testsuite/actionscript.all/ContextMenu.as: check that
	  support starts with SWF7.
	* testsuite/actionscript.all/Camera.as: updated to
	  properly check the get() method.

2006-11-22 Michael Meier <meiermic@ee.ethz.ch>

	* server/asobj/string.cpp: implemented string methods
	  slice, concat, slice, lastindexof; added String
	  property length
	* testsuite/actionscript.all/String.as: tests for the
	  newly implemented features.

2006-11-21 Sandro Santilli <strk@keybit.net>

	* server/asobj/Makefile.am: added missing FFMPEG_LIBS dependency.
	* plugin/klash/klash.cpp: fixed after movie_interface and
	  movie deprecation.
	* testsuite/actionscript.all/dejagnu_so_init.as:
	  fix information about *which* version of Ming contains
	  the bug preventing proper load of Dejagnu.swf lib.
	* Makefile.am: fix 'make dump' output.
	* testsuite/actionscript.all/Makefile.am: fixed dependencies
	  for explicitly generated SWF  (ASTESTS_OUT).
	* configure.ac: suggest 'texinfo' package for building dox
	  (contains 'makeinfo')
	* server/array.h: documented ::slice function
	* server/array.cpp: more fixes. 
	* testsuite/actionscript.all/array.as: added some tests for
	  invalid calls to Array.slice()
	* server/array.cpp (slice): handled some unexpected user input.
	* testsuite/actionscript.all/Makefile.am (make check):
	  run the all-inclusive testcases (one for each target version).
	* server/mouse_button_state.h: added missing
	  character.h include.

2006-11-20 Sandro Santilli <strk@keybit.net>

	* server/: Makefile.am, movie.h, movie_interface.h,
	  server/parser/bitmap_character_def.h: removed
	  obsoleted movie.h and movie_interface.h files.

2006-11-20 Sandro Santilli <strk@keybit.net>

	* gui/Player.cpp, gui/Player.h, gui/gui.cpp,
	  gui/gui.h, server/action.cpp, server/action.h,
	  server/as_object.h, server/button_character_instance.cpp,
	  server/button_character_instance.h, server/character.h,
	  server/dlist.cpp, server/dlist.h, server/edit_text_character.cpp,
	  server/edit_text_character.h, server/execute_tag.h,
	  server/generic_character.cpp, server/generic_character.h,
	  server/gnash.h, server/impl.cpp, server/impl.h,
	  server/mouse_button_state.h, server/movie.h,
	  server/movie_interface.h, server/movie_root.cpp,
	  server/movie_root.h, server/sound.cpp, server/sound.h,
	  server/sprite_instance.cpp, server/sprite_instance.h,
	  server/timers.cpp, server/xmlsocket.cpp,
	  server/asobj/MovieClipLoader.cpp,
	  server/parser/movie_def_impl.cpp,
	  server/parser/movie_def_impl.h, server/parser/movie_definition.h,
	  server/parser/sprite_definition.h, server/swf/ASHandlers.cpp,
	  server/swf/tag_loaders.cpp, testsuite/MovieTester.cpp,
	  testsuite/misc-ming.all/DefineEditTextVariableNameTest-Runner.cpp,
	  testsuite/misc-ming.all/RollOverOutTest-Runner.cpp,
	  utilities/processor.cpp:
	  Got rid of 'movie' and 'movie_interface' classes.
	  Feel much better now.
	  Make check succeeds, but I'm sure we lost something...
	  please anyone help checking in the next days.

2006-11-20 Sandro Santilli <strk@keybit.net>

	* server/event_id.h: include gnash.h for gnash::key def.
	* server/shm.h: streamlined header inclusion.

2006-11-20 Sandro Santilli <strk@keybit.net>

	* server/xml.{h,cpp}: changed signatures taking event_id
	  so to take it by const ref; reduced headers inclusion.
	* server/xmlattrs.h: reduced headers inclusion.

2006-11-20 Sandro Santilli <strk@keybit.net>

	* server/parser/button_character_def.h: added missing rect.h
	  include.
	* server/asobj/: NetConnection.h, System.h:
	  streamlined headers inclusion.
	* server/asobj: Global.cpp, SharedObject.{h,cpp}, Stage.{h,cpp},
	  Video.{h,cpp}, TextSnapshot.{cpp,h}:
	  ported ActionScript class stubs to new layout.

2006-11-20 Sandro Santilli <strk@keybit.net>

	* server/asobj/: Key.h, LocalConnection.h:
	  streamlined headers inclusion.
	* server/asobj: Global.cpp, Error.{h,cpp}, LoadVars.{h,cpp},
	  Microphone.{h,cpp}, Mouse.{cpp,h}, Selection.{cpp,h}:
	  ported ActionScript class stubs to new layout.

2006-11-20 Sandro Santilli <strk@keybit.net>

	* server/asobj/Date.h: streamlined headers inclusion.
	* server/asobj: Global.cpp, Camera.{h,cpp}, Color.{cpp,h},
	  ContextMenu.{h,cpp}, CustomActions.{cpp,h}:
	  ported ActionScript class stubs to new layout.
	* doc/C/gnashrc.xml: fixed description of whitelist/blacklist 
	  settings.

2006-11-20 Vitaly Alexeev <tishka92@yahoo.com>

	* plugin\win32\plugin.cpp: reanimated
	* win32\VC8\npgnash.vcproj: reanimated

2006-11-20 Vitaly Alexeev <tishka92@yahoo.com>

	* server\parser\movie_def_impl.cpp:
	  usleep(x) ==> Sleep(x/1000) for win32;
	  'return _thread == 0' is invalid in win32 that 'pthread_t'
	  is typedef struct {
	      void * p;         /* Pointer to actual object */
	      unsigned int x;   /* Extra information - reuse count etc */
	  } ptw32_handle_t;
	* server\video_stream_instance.h: typo
	* gui\gui.cpp: typo
	* backend\render_handler_ogl.cpp: GL/glx.h is absent in win32
	* backend\sound_handler_sdl.cpp: sdl_audio_callback() is switched
	  off for win32 because of segmentation fault
	* server\video_stream_instance.cpp: typo
	* reconfigured win32 dir
	
2006-11-20 Sandro Santilli <strk@keybit.net>

	* gui/gnash.cpp (parseCommandLine): don't remove log file !
	* server/URLAccessManager.cpp (host_check_blackwhite_lists):
	  if whitelist is non-empty and host is not listed there, forbid
	  access.
	* libbase/rc.cpp (dump): typo fixed
	* testsuite/actionscript.all/gen-index.sh: add more info
	  in the versioned SWF index page.
	* testsuite/actionscript.all/Boolean.as: don't expect
	  failures anymore, it works now.
	* server/parser/movie_def_impl.cpp (get_exported_resource):
	  tweak timeouts to give thread switching a chance; more
	  debugging.

2006-11-20 Michael Meier <meiermic@ee.ethz.ch>

	* server/asobj: Global.cpp, Boolean.cpp, Boolean.h:
	  implemented Boolean ActionScript class.

2006-11-19  Rob Savoye  <rob@bertha.welcomehome.org>

	* backend/render_handler_ogl.cpp: Include glx.h so
	glXGetCurrentContext is defined on Darwin.

2006-11-18 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/smart_ptr.h: Fixed "error: extra ';'".

2006-11-18 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac: Applied patches for RISC OS support. Fixed gui 
	  ro->riscos.
	* gui/Makefile.am gui/Player.cpp gui/sdl_agg_glue.cpp libbase/Thread.cpp 
	libltdl/ltdl.c macros/pkg.m4 server/shm.cpp server/shm.h
	server/parser/button_character_def.h utilities/Makefile.am
	utilities/dumpshm.cpp: Applied patches for RISC OS support.
	* gui/ro.cpp, gui/ro_glue_agg.cpp, gui/ro_glue_agg.h, gui/ro_glue.h,
	  gui/rosup.h: Added RISC OS support.
	
2006-11-18 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ming_utils.c: fixed xfail
	  to increment expected failures rather then 'unexpected' ones.
	* server/asobj/gen-asclass.sh: typos fixed; added
	  missing constructor for target objects;
	  'unimplemented' messages printed with log_warning

2006-11-18 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/movie.h, server/sound.cpp, server/sprite_instance.{cpp,h}, 
	  server/swf/ASHandlers.cpp: Instead of stopping all sounds when
	  framejumping or on sprite-stop, now only stop soundstreams. The
	  id of the current playing stream is stored in the sprite.

2006-11-17 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: fixed
	  'online-tests' rule.

2006-11-17 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/Makefile.am, backend/sound_handler_gst.{cpp,h}: Split
	  the gstreamer backend into a .cpp-file and a .h-file. Also 
	  applied Hiroyuki Ikezoe patches, and did a bit of cleanup.
	* backend/sound_handler_sdl.cpp: More cleanups.

2006-11-17 Sandro Santilli <strk@keybit.net>

  	* server/asobj/gen-asclass.sh: typo fixed.

2006-11-17 Sandro Santilli <strk@keybit.net>
  
	* server/shm.cpp (Shm::attach): don't use PROT_EXEC to 
	  mmap call (permission denied on some systems)
  	* server/parser/movie_def_impl.{cpp,h}:

2006-11-17 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.cpp (get_exported_resource) :
	  fixed use of timeout.

2006-11-17 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.cpp (get_exported_resource) :
	  use a timeout to handle circular IMPORT chains.
	* server/parser/movie_def_impl.{cpp,h}:
	  Added MovieLoader::isSelfThread() method, more assertion
	  checking, made LOAD_MOVIES_IN_A_SEPARATE_THREAD work again.
	* server/swf/tag_loaders.cpp (import_loader): updated messages
	  to be less confusing.

2006-11-17 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.{h,cpp}: Re-structured the code a bit 
	  to make pointer handling safer, and changed from structs to
	  classes. General cleanups... Added doxygen comments.

2006-11-17 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp (import_loader): don't allow
	  a movie to import it's own exported symbols.
	* server/impl.cpp (create_library_movie): normalize real url
	  when using it as a cache label.
	* server/impl.cpp (create_library_movie): don't start loader
	  thread before the created movie is added to the library.
	  This is to handle a parser that tries to load again the
	  same stream being parsed (self-import)
	* gui/gui.cpp (ctor): properly initialize members, in particular
	  the _renderer one, to ensure delete is not called on an undefined
	  pointer at destruction time.
	* server/parser/movie_def_impl.{cpp,h}: decomposed
	  read() method in readHeader() and completeLoad();
	  added a MovieLoader::started() method.

2006-11-17 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* plugin/plugin.cpp: Remove Mozilla license exemption.

2006-11-17 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/dejagnu_so_init.as: raise
	  timeout to 5 seconds, assuming 20FPS.
	* testsuite/actionscript.all/Makefile.am: simplified
	  rules for online-tests creation
	* testsuite/actionscript.all/gen-index.sh: assume
	  we have an 'alltests.swf' file containing *all* tests.

2006-11-17 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Dejagnu.c: make xtrace window larger
	  toller, and set SWF size accordingly.
	* testsuite/actionscript.all/rtmp.as: don't add a custom
	  xtrace function, rather use the one provided with the framework.
	* testsuite/misc-ming.all/ming_utils.c (add_xtrace_function):
	  make the textfield selectable (for copy 'n paste).

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: more cleanups,
	  initial rules for all-inclusive SWF testcases (try it out!
	  rule names: astests-v{5,6,7,8}.swf)

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/dejagnu_so_init.as: add
	  totals() in fallback implementation (when load of Dejagnu.swf
	  fails)
	* testsuite/actionscript.all/dejagnu.as: be compatible with
	  DEJAGNU shared lib.

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/: check.as, dejagnu_so_init.as:
	  if USE_DEJAGNU_MODULE is defined have dejagnu_so_init.as
	  print SWF and Player version (so we can print once for a 
	  set of testcases compiled on multiple frames)
	* testsuite/actionscript.all/: LocalConnection.as, XML.as, XMLNode.as:
	  added rcsid.

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: fixed dependencies
	  for SWF targets, cleanups.

2006-11-16 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.{cpp,h}:
	  get_exported_resource() changed to take incremental
	  loading into account, by making sure the whole
	  stream has been parsed before returning a failure
	  (the EXPORT tag might be at the end of the stream!)

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/check.as: moved most dejagnu_so
	  specific code.
	* testsuite/actionscript.all/dejagnu_so_init.as:
	  take slowness of loading into account by using a frameloop
	  waiting for dejagnu module to be initialized, with a timeout
	  to fallback to 'trace' mode.

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ming_utils.c
	  (add_xtrace_function):
	  don't duplicate visual traces to trace channel;
	  (get_dejagnu_actions) :
	  export (x)pass()/(x)fail()/report() on the _root, don't
	  visually print expected successes.
	* testsuite/actionscript.all/check.as:
	  when USE_DEJAGNU_MODULE is defined, really use the
	  module's *dejagnu*-like interface (includes printing summary).

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/: dejagnu_so_init.as, check.as:
	  check for initialized Dejagnu module moved from init.as to
	  check.as (we know it will NOT be initialized in first frame)
	  and made warning message much more verbose.
	* testsuite/misc-ming.all/ming_utils.c (get_dejagnu_actions):
	  Set the 'dejagnu_module_initialized' variable on the _root movie.

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ming_utils.c (get_dejagnu_actions):
	  Set a 'dejagnu_module_initialized' variable to one after
	  initialization; it can then be used by loaders for consistency
	  checks.
	* testsuite/actionscript.all/dejagnu_so_init.as:
	  Add consistency checks: complain if __shared_assets is
	  undefined (using makeswf with wrong switches?),
	  and if __shared_assets.dejagnu_module_initialiezed evaluates
	  to false (using bogus Ming version?).

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: build Dejagnu.swf
	  on 'make check'
	* testsuite/actionscript.all/: dejagnu_so_fini.as,
	  dejagnu_so_init.as:
	  New wrappers around Dejagnu.swf shared library to make
	  it's use effective.
	* testsuite/actionscript.all/check.as: use Dejagnu.swf
	  shared library if USE_DEJAGNU_MODULE is defined, provide
	  fallback to bare 'trace' if it is not-working (due to bogus
	  'makeswf' found in Ming-0.4.0beta22. Obsolete USE_XTRACE.
	* testsuite/actionscript.all/Makefile.am: change *.swf rule
	  to use the Dejagnu.swf module (includes defining USE_DEJAGNU_MODULE
	  and wrapping source in dejagnu_so_init.as and dejagnu_so_fini.as.

2006-11-16 Sandro Santilli <strk@keybit.net>

	* macros/agg.m4: don't assume AGG is installed
	  if agg_gradient_lut.h is not found.

2006-11-15  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/agg.m4: Look in the agg2 subdirectory for
	agg_gradient_lut.h.

2006-11-16 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all: ming_utils.{c.h}: add
	  a get_dejagnu_clip() function.
	* testsuite/misc-ming.all: Makefile.am, Dejagnu.c:
	  initial version of a loadable Dejagnu module for SWF
	  (needs more work)

2006-11-15 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ming_utils.{c,h}:
	  removed add_xtrace_function from header,
	  changed add_dejagnu_functions to take a font object and
	  to create the xtrace window w/out the drawing api (so
	  that gnash is able to use it); added get_default_font function.
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c:
	  use pixel coordinates, use get_default_font function, 
	  cleanups.

2006-11-15 Sandro Santilli <strk@keybit.net>

        * backend/render_handler_agg.cpp: comment out unneeded
	  assertion (see https://savannah.gnu.org/bugs/?18119#comment2)

2006-11-15 Sandro Santilli <strk@keybit.net>

	* server/edit_text_character.cpp: warn only once
	  about missing 'no word wrap' implementation.

2006-11-15 Sandro Santilli <strk@keybit.net>

	* server/movie_root.cpp (goto_labeled_frame): print
	  an error asking users to report url of movie triggering
	  the call (I plan to change implementation of it).
	* server/sprite_instance.cpp (goto_labeled_frame): 
	  make invalid label a "malformed swf" warning.

2006-11-15 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{h.cpp}: use a std::list
	  for ActionList (now typedef'd) as it's more appropriate
	  since we execute it from the start and execution can
	  append items to it; typdef both PlayList and ActionList.
	  This seems to fix bug #17793.
	* server/parser/: movie_definition.h, movie_def_impl.h,
	  sprite_definition.h: typedef PlayList and use that.

2006-11-14 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Make sure the decoded data is
	  always able to fill the return buffer.

2006-11-14 Sandro Santilli <strk@keybit.net>

	* libbase/container.h: don't redefine _LIB_PTHREAD_TYPES_H.

2006-11-14 Patrice Dumas <pertusus@free.fr>

	* server/Makefile.am, server/asobj/Makefile.am,
	  testsuite/Makefile.am, testsuite/server/Makefile.am:
	  other missing BOOST_CFLAGS

2006-11-14 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: ming_utils.{c,h},
	  DefineEditTextVariableNameTest.c: 
	  Moved general testcase generator facilities to ming_utils
	  lib.
	* doc/C/internals.xml: new sections about writing Ming-based
	  self-contained SWF testcases and MovieTester-based testcases.
	  (Ann, help!)

2006-11-14 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/parser/Makefile.am: parser uses Boost, so add BOOST_CFLAGS
	to INCLUDES.
	* backend/render_handler_agg.cpp: add a not quite correct trunc()
	implementation (which nevertheless serves our purposes) for
	platforms which don't define it.

2006-11-14 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ming_utils.c (add_dejagnu_functions):
	  improved functions to use a TestState class, including
	  a totals() function.
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c:
	  added checks for sprites size and final call to runtest.totals().
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest-Runner.cpp, 
	  Makefile.am:
	  reintroduced DefineEditTextVariableNameTest-Runner to also test
	  frame advancements (removed every test already checked by
	  self-containsd SWF testcase)

2006-11-14 Sandro Santilli <strk@keybit.net>

        * plugin/klash/klash.cpp: fetch dbglogfile before use
          (fixes bug #18290)

2006-11-13 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/gtkglext.m4: Fixed bug #18286.
	
2006-11-13 Patrice Dumas <pertusus@free.fr>

        * server/: Makefile.am, StreamProvider.cpp, impl.cpp, movie_root.h,
          asobj/Makefile.am, parser/Makefile.am, swf/tag_loaders.cpp:
          remove lot of CFLAGS, some LIBS and #include.

2006-11-13 Sandro Santilli <strk@keybit.net>

	* server/edit_text_character.cpp (registerTextVariable): 
	  update warning about VariableName referencing an unknown character.
	* server/edit_text_character.cpp: have M_TEXT member getter
	  use get_text_value (so to get a chance of registering
	  variable name)
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c:
	  change last expected failures to successes.

2006-11-13 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am:
	  make sure DefineEditTextVariableNameTest-Runner is created prior
	  to use.
	* server/edit_text_character.{h,cpp}: added primitive support
	  for VariableName targets referring to yet-to-be-instantiated
	  characters.
	* testsuite/generic-testrunner.sh: new file to generate runners
	  for self-contained SWF testfiles.
	* testsuite/misc-ming.all/Makefile.am: run DefineEditTextVariableName
	  test again (uses the generic-testrunner.sh file)

2006-11-13 Sandro Santilli <strk@keybit.net>

	* testsuite/simple.exp: check for XPASSED before PASSED.
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c:
	  make the DefineEditTextVariableNameTest.swf file a self-contained
	  testcase.
	* testsuite/misc-ming.all/: Makefile.am,
	  DefineEditTextVariableNameTest-Runner.cpp:
	  removed unneeded test runner for DefineEditTextVarible
	  (the SWF is now a self-contained test)
	* testsuite/simple.exp: fix handling of XPASSED/XFAILED results.
	* testsuite/misc-ming.all/ming_utils.{c,h}:
	  added add_dejagnu_functions() method and fixed
	  xtrace() function to *append* rather then replace
	  the trace lines.

2006-11-13 Hiroyuki Ikezoe <poincare@ikezoe.net>

	* utilities/Makefile.am: add missing BOOST include flags.

2006-11-13 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/swf/ASHandlers.cpp: Remove old comment and unneeded const
	keyword.

2006-11-13 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp (find_target): more informative
	  message about failure.
	* server/edit_text_character.cpp (registerTextVariable): 
	  don't abort if VariableName references an unknown character,
	  instead print an error calling for help interpreting this
	  case in the correct way :)
	* server/sprite_instance.{cpp,h}: drop all self-assignments
	  to intrusive_ptr used as a mean to keep ourselves alive
	  (sounds dangerous and confusing); added a testInvariant()
	  inline method and called from all function modified in such
	  a way.

2006-11-12 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_ogl.cpp: sprintf -> snprintf.

2006-11-12 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/swf/ASHandlers.cpp: Fix compilation errors by initialising
	the singleton on the stack. 

2006-11-11 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp (SWFHandlers::instance): store
	  the allocated singleton in a std::auto_ptr<>, so to avoid
	  leaks report (gprocessor w/out args is now leak-free).

2006-11-11 Sandro Santilli <strk@keybit.net>

	* libbase/smart_ptr.h: removed smart_ptr definition, added
	  function helpers and include for boost::intrusive_ptr
	* backend/render_handler_tri.cpp, server/action.cpp, server/action.h,
	  server/array.cpp, server/as_environment.cpp, server/as_function.cpp,
	  server/button_character_instance.cpp,
	  server/button_character_instance.h, server/character.h,
	  server/dlist.cpp, server/dlist.h, server/font.cpp, server/font.h,
	  server/fontlib.cpp, server/gnash.h, server/impl.cpp,
	  server/mouse_button_state.h, server/movie_root.cpp,
	  server/movie_root.h, server/sprite_instance.cpp,
	  server/sprite_instance.h, server/styles.cpp, server/styles.h,
	  server/swf_function.cpp, server/with_stack_entry.h, server/xml.cpp,
	  server/asobj/ASSound.cpp, server/asobj/Key.cpp, server/asobj/Key.h,
	  server/asobj/MovieClipLoader.cpp, server/asobj/Number.cpp,
	  server/asobj/Object.cpp, server/asobj/System.cpp,
	  server/asobj/string.cpp, server/parser/bitmap_character_def.h,
	  server/parser/button_character_def.cpp, server/parser/character_def.h,
	  server/parser/movie_def_impl.cpp, server/parser/movie_def_impl.h,
	  server/parser/movie_definition.h, server/parser/sprite_definition.h,
	  server/swf/ASHandlers.cpp, server/swf/tag_loaders.cpp:
	  Updated to use boost::intrusive_ptr instead of tu's smart_ptr
	* testsuite/libbase/Makefile.am, testsuite/libbase/smart_ptrTest.cpp:
	  removed unit test for smart_ptr (obsoleted)
	* server/asobj/gen-asclass.sh: stub generator for ActionScript classes.

2006-11-11 Sandro Santilli <strk@keybit.net>

	* Makefile.am (mudflap and mudlfap-check rules):
	  use mudflapth as gnash's a threaded application.
	* testsuite/libbase/TCXXRc.cpp: use "check.h" if dejagnu
	  isn't found.

2006-11-11 Sandro Santilli <strk@keybit.net>

	* gui/Player.cpp, gui/gnash.cpp, gui/gtk.cpp,
	  gui/gtk_glue_gtkglext.cpp, gui/sdl_agg_glue.cpp,
	  libamf/amf.cpp, libamf/rtmp.cpp, libbase/network.cpp,
	  libbase/rc.h, server/as_function.cpp, server/dlist.cpp,
	  server/movie_root.cpp, server/asobj/NetConnection.cpp,
	  server/swf/ASHandlers.cpp, utilities/parser.cpp,
	  utilities/processor.cpp:
	  removed extra semicolons

2006-11-11 Sandro Santilli <strk@keybit.net>

	* gui/Player.cpp, gui/gnash.cpp, gui/gtk.cpp,
	  gui/gtk_glue_gtkglext.cpp, gui/sdl_agg_glue.cpp, libamf/amf.cpp,
	  libamf/rtmp.cpp, libbase/log.cpp, libbase/log.h, libbase/network.cpp,
	  libbase/rc.cpp, libbase/rc.h, libbase/sharedlib.cpp,
	  server/as_function.cpp, server/dlist.cpp, server/movie_root.cpp,
	  server/asobj/NetConnection.cpp, server/parser/action_buffer.cpp,
	  server/swf/ASHandlers.cpp, testsuite/libbase/TCXXRc.cpp,
	  testsuite/misc-ming.all/ButtonEventsTest-Runner.cpp,
	  testsuite/misc-ming.all/DefineEditTextVariableNameTest-Runner.cpp,
	  testsuite/misc-ming.all/RollOverOutTest-Runner.cpp,
	  testsuite/movies.all/gravity_embedded-TestRunner.cpp,
	  testsuite/samples/clip_as_button2-TestRunner.cpp,
	  testsuite/server/GetterSetterTest.cpp,
	  testsuite/server/PropertyListTest.cpp,
	  utilities/parser.cpp,
	  utilities/processor.cpp:
	  global rcfile hidden as function-static of the new
	  static RcInitFile::getDefaultInstance() method.

2006-11-11 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/Makefile.am: Applied patch from Hiroyuki Ikezoe.

2006-11-11 Sandro Santilli <strk@keybit.net>

	* Makefile.am: added mudflap-check rule (make check
	  won't work after make mudflap)
	* libbase/rc.{cpp,h}: made static initialization
	  of default RcInitFile predictable, by having
	  it happen at first call to a newly introduced
	  getDefaultInstance() static function. This
	  fixes one of many invalid accesses reported by
	  mudflap (see bug #18100)
	* gui/: Player.cpp, gnash.cpp, plugin/klash/klash.cpp,
	  server/URLAccessManager.cpp, utilities/: parser.cpp,
	  processor.cpp:
	  fetch global RcInitFile by using the new
	  RcInitFile::getDefaultInstance()

2006-11-10 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/Makefile.am, gui/Makefile.am, libamf/Makefile.am, 
	libbase/Makefile.am, libgeometry/Makefile.am, server/Makefile.am,
	server/asobj/Makefile.am, server/parser/Makefile.am,
	utilities/Makefile.am: Added _la_LDFLAGS = -avoid-version.
	Closed bug: #18235.
	
	* libbase/sharedlib.cpp: Fixed  
	"error: ISO C++ forbids comparison between pointer of type 'void *' 
	 and pointer-to-function"

	* macros/agg.m4: Check for agg_gradient_lut.h.	 

2006-11-09 Sandro Santilli <strk@keybit.net>

	* utilities/processor.cpp: call gnash::clear() as last step to help
	  finding leaks.
	* server/asobj/Number.cpp: hush warnings.
	* gui/gnash.cpp (parseCommandLine): fixed sound setting.

2006-11-09 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/atk.m4, macros/boost.m4, macros/cairo.m4, 
	macros/gnashpkgtool.m4, macros/gtk2.m4 macros/gtkglext.m4,
	macros/pango.m4, macros/sdl.m4 macros/xft.m4: Bugs, typos, indentation.
	
2006-11-09 Sandro Santilli <strk@keybit.net>

	* testsuite/libbase/: TCXXRc.cpp, gnashrc.in:
	  add test for 'sound' and 'soundPlugin' directives
	  (and test for case-insensitive matching).

2006-11-09 Sandro Santilli <strk@keybit.net>

	* gui/gnash.cpp, libbase/rc.h, plugin/klash/klash.cpp,
	  utilities/parser.cpp, utilities/processor.cpp:
	  Reverted privatization of RcFile.loadFiles().
	  We actually want to keep control of that call, at
	  least for the unit testing...

2006-11-09 Sandro Santilli <strk@keybit.net>

	* plugin/klash/klash.cpp, utilities/: parser.cpp, processor.cpp:
	  remove explicit rcfile.loadFiles() call.
	* libbase/rc.cpp: set pluginSound on by default

2006-11-09 Sandro Santilli <strk@keybit.net>

	* libbase/rc.h: loadFiles() made private
	* libbase/rc.cpp: call loadFiles from  constructor
	* gui/Player.cpp (init_sound): don't call rcfile.loadFile();
	  don't use rcfile for setting sound config, trust class user
	  for that.
	* gui/gnash.cpp (parseCommandLine): use rcfile for sound
	  setting only if no -r switch is given
	* plugin/plugin.cpp: don't use any -r switch so that config
	  file completely drive the run.

2006-11-09 Sandro Santilli <strk@keybit.net>

	* libbase/rc.cpp: rc file parsing made case-insensitive.
	* server/font.cpp (readDefineFont2): allow seek-back in stream
	  while reading shape glyphs (fixes bug #16311).

2006-11-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/curl_adapter.cpp: Allow libcurl to follow HTTP redirects.
	Don't forget to store curl_easy_setopt()'s return value, in addition
	to checking it.

2006-11-09 Sandro Santilli <strk@keybit.net>

	* server/URLAccessManager.cpp (host_check): use log_security()
	  and (IMHO) clearer messages; use standard algorithms for
	  whitelist/blacklist query.
        * libbase/log.{cpp,h}: added log_security() for security-related
          messages.

2006-11-09 Markus Gothe <nietzsche@lysator.liu.se>

	* server/URLAccessManager.cpp: <errno.h> -> <cerrno> for C++ ;).

2006-11-09 Hiroyuki Ikezoe <poincare@ikezoe.net>

	* backend/render_handler_cairo.cpp: stub required
	  video interface.

2006-11-09 Sandro Santilli <strk@keybit.net>

	* server/URLAccessManager.cpp: added missing <errno.h> include.

2006-11-08 Sandro Santilli <strk@keybit.net>

	* server/URLAccessManager.cpp: fixed segfault in host_check,
	  cleaned up and made more robust (hopefully)

2006-11-08 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/sound_handler_gst.cpp: Applied patch from Hiroyuki Ikezoe.

2006-11-08 Vitaly Alexeev <tishka92@yahoo.com>

	* backend\render_handler_ogl.cpp: hack for glRasterPos2f()
	* server\asobj\NetStream.cpp: pthread_join() should be caused
	  in only case when video streamer is started
	  
2006-11-08 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Made ffmpeg error handling
	  more robust. Fixed a deadlock. Added a notice that upgrading 
	  ffmpeg might fix mp3-errror. Made stop_all_sounds() thread safe.
	  Make mp3-decoding with mad work when the stream is not fully 
	  loaded when playback starts.

2006-11-08 Sandro Santilli <strk@keybit.net>

	* libbase/smart_ptr.h: *fixed* invariant testing (well, at
	  least we know that it works fine)

2006-11-08 Vitaly Alexeev <tishka92@yahoo.com>

	* backend\render_handler_ogl.cpp:  The elementary yuv-video opengl
	render which should work on all platform (very slow).
	The second attempt to commit
	
2006-11-08 Sandro Santilli <strk@keybit.net>

	* testsuite/libbase/smart_ptrTest.cpp: test static initialization
	  of smart_ptr (segfaults!!)
	* libbase/smart_ptr.h: added invariant testing 
	* testsuite/libbase/CurlStreamTest.cpp: added missing
	  config.h include.
	* testsuite/libbase/: Makefile.am, smart_ptrTest.cpp:
	  added unit test for smart_ptr<>. 
	* configure.ac: move the AC_DEFINE([GUI_*]) calls *after*
	  the possible fallback to SDL (see bug #15540)
	* server/: array.cpp, as_function.cpp, asobj/: MovieClip.cpp,
	  MovieClipLoader.cpp, Number.cpp, Object.cpp, System.cpp,
	  string.cpp: change static pointers to static *smart* pointers
	  so we're sure they don't get deleted due to assignment to
	  some other short-lived smart_ptr and that they are released
	  at exit.

2006-11-08 Sandro Santilli <strk@keybit.net>

	* server/text.cpp, server/parser/text_character_def.cpp:
	  resolve style fonts at parse time (not use time) - reduce
	  number of warnings given.
	* backend/render_handler_ogl.cpp: revert last commit, which
	  made this a binary file !!!
	* gui/Makefile.am, utilities/Makefile.am: don't list
	  LIBLTDL as a *dependency* (it's in LIBADD already)
	* server/parser/movie_def_impl.cpp: issue a warning
	  when version of SWF being read is > 7.

2006-11-07 Sandro Santilli <strk@keybit.net>
	
        * libbase/ref_counted.h: drop support for weak proxies.
        * libbase/smart_ptr.h: drop all but smart_ptr
        * server/button_character_instance.cpp (on_button_event):
          simplify access to our environment.
        * server/: character.{h,cpp}, generic_character.h, sprite_instance.cpp:
          store our parent in a smart_ptr<> (rather then a dumb one)
        * server/impl.cpp: don't force refcount increment on newly
          created movies (or we'll never get rid of them)
        * server/mouse_button_state.h: store active and topmost
          entities in a smart_ptr<> (rather then weak_ptr<>); it
          might introduce minor behavioural bugs, but it's safer.
        * server/movie_root.cpp: minor assertion checking
        * server/asobj/Key.{h,cpp}: store smart_ptr<> elements
          in listeners vector (rather then weak_ptr<>).

2006-11-07 Sandro Santilli <strk@keybit.net>

	* libbase/log.h: don't warn about ASCODING errors by default
	* server/sprite_instance.cpp (sprite_hit_test): warn
	  only once about hitTest not being implemented.

2006-11-07 Vitaly Alexeev <tishka92@yahoo.com>

	* backend\render_handler_ogl.cpp:  The elementary yuv-video opengl
	render which should work on all platform (very slow)
	* libbase\URL.cpp: #include <sys/param.h> removed for win32
	* server\asobj\NetStream.cpp: a bit cleunup


2006-11-07 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler.h, gui/gui.cpp, gui/gui.h:
	Further described invalidated bounds

2006-11-07 Sandro Santilli <strk@keybit.net>

	* server/action.cpp, server/swf/ASHandlers.cpp: turn
	  more actionscript coding errors into warning and
	  wrap them in IF_VERBOSE_ASCODING_ERRORS.

2006-11-07 Sandro Santilli <strk@keybit.net>

	* server/parser/movie_def_impl.cpp: fix support
	  for completely disabling using a separate
	  thread for loading (just undef the
	  LOAD_MOVIES_IN_A_SEPARATE_THREAD macro)

2006-11-06  Rob Savoye  <rob@bertha.welcomehome.org>

	* libltdl: New directory for libtool library, which is supposed to
	be included with the source of the application, although in our
	case it only gets build of libltdl is already installed in the
	system.
	* utilities/parser.cpp: Fix typo of executable name.
	* Makefile.am: Add libltdl as a SUB_DIR. Don't build plugin
	in KDE or GTK isn't found. Print out the proper KDE flags. Display
	build options as determined by configure.
	* configure.ac: Run configure in libltdl too. Autochange to SDL
	gui if GTK or KDE isn't found. Don't build klash unless QT and KDE
	are installed.
	* gui/Makefile.am: Add LIBLTDL support to AM_LDFLAGS. Define
	constants for build options so we can print them from Gnash. Add
	-export-dynamic (now required) to gnash and klash executables.
	* gui/gnash.cpp: Display build options from configure with
	--version or --help.
	* libbase/Makefile.am: Add LIBLTDL support. Add new files for
	shared libraries. Add LIBLTDL support to AM_LDFLAGS.
	* utilities/Makefile.am:  Add -export-dynamic (now required) to
	gparser and gprocessor executables. 
	* libbase/sharedlib.h, sharedlib.cpp: New files for loading of
	shared libraries into Gnash so we can support our own plugins.
	* libbase/URL.cpp: Include sys/param.h to get PATH_MAX for
	arm-linux.
	* macros/cairo.m4: Look in $prefix too so we can be cross
	configured.
	* macros/curl.m4: Don't use curl-config when cross-compiling.
	* plugin/klash/Makefile.am: Use the more standard KDE_CFLAGS and
	KDE_LIBS. Build klash here again, the version on gui is totally
	broken.
	* plugin/Makefile.am: Put back in the KLASH conditional so klash
	actually gets built.
	* utilities/parser.cpp: Fix the wrong name of the executable in
	the debug message.
	
2006-11-06 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (sprite_create_text_field):
	  don't abort on "invalid?" calls. Warn if requested.
	* testsuite/actionscript.all/Function.as: fixed test for
	  SWF >= version 7.
	* server/as_function.cpp (function_apply): don't abort
	  on invalid calls, warn about them if requested.
	* testsuite/actionscript.all/Function.as: added tests for
	  invalid Function.apply() calls.
	* server/parser/sprite_definition.h: dirty patch for dirtier
	  programmatically-created MovieClip implementation.
	* testsuite/actionscript.all/MovieClip.as: expect failures.
        * testsuite/actionscript.all/MovieClip.as: added more tests
          for createEmtyMovieClip - expose the segfault bug in it.
	* testsuite/misc-ming.all/: DefineEditTextVariableNameTest-Runner.cpp,
	  DefineEditTextVariableNameTest.c: added test for assigning
	  an empty string to a textfield.
	* server/edit_text_character (format_text): properly
	  handle empty-text.
	* backend/render_handler_agg_style.h: comment-out
	  add_bitmap with NULL input warning.
	* server/styles.{h,cpp}: warn about bitmap fills with
	  invalid character_id.

2006-11-06 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: Protected clear_framebuffer() 
	against negative width and height arguments

2006-11-05  Rob Savoye  <rob@bertha.welcomehome.org>

	* gui/gui.h: Add stuff for Emacs mode.
	* gui/gtk.cpp: Handle control keys better, so Gnash doesn't core
	dump. Work around #18207.

2006-11-05 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/String.as:
	  added testcases for automatic string => String casts.
	* server/asobj/: Number.{h,cpp}: expose
	  Number instance constructor.
	* server/asobj/: gstring.h, string.cpp:
	  expose String instance constructor.
	* server/swf/ASHandlers.c (call_method):
	  implicitly cast STRING values to String
	  objects and NUMBER values to Number objects
	  (to be possibly moved in as_value::to_object)

2006-11-05 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: stubbed attachMovie, added
	  comment about possible improvement of sprite_duplicate_movieclip,
	  added some use of the new IF_VERBOSE_ASCODING_ERRORS macro
	* libbase/log.h: added IF_VERBOSE_MALFORMED_SWF and
	  IF_VERBOSE_ASCODING_ERRORS macros.
	* server/swf/ASHandlers.cpp (ActionSubstring): early
	  return if input string is undefined or null, base
	  is out of range, size is negative or invalid (overflow
	  input length when added to base); attempt
	  to support negative base args (untested: ming unable
	  to output such opcode). See bug #18204.

2006-11-05 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/mad.m4: Fixed bogus test-case...
	* macros/pthreads.m4: Added -D_SGI_MP_SOURCE (for IRIX).
	* plugin/klash/klash.cpp: bool do_sound = true.
	
2006-11-04  Rob Savoye  <rob@bertha.welcomehome.org>

	* testsuite/check.h: Include config.h. Optionally include
	dejagnu.h. Add stubs if it's not found.
	* testsuite/libbase/NoSeekFileTest.cpp: Include
	config.h. Optionally include either dejagnu.h or check.h.
	* testsuite/libbase/URLTest.cpp: Include
	config.h. Optionally include either dejagnu.h or check.h.
	* testsuite/server/GetterSetterTest.cpp: Include
	config.h. Optionally include either dejagnu.h or check.h.
	* testsuite/server/MatrixTest.cpp: Include
	config.h. Optionally include either dejagnu.h or check.h.
	* testsuite/server/PropertyListTest.cpp: Include
	config.h. Optionally include either dejagnu.h or check.h.

q2006-11-04 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (ctor): code cleanup.
        * testsuite/libbase/NoSeekFileTest.cpp: added missing unistd.h
	  include.

2006-11-04 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase\noseek_fd_adapter.cpp: size_t ==> int
	(Thanks Sandro)

2006-11-04 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: removed compatibility include as
	it is not enough anyway; optimized screen and mask clearing
	* server/parser/edit_text_character_def.h: added read method for
	m_no-select
	* server/edit_text_character.cpp: don't catch mouse events when
	text feld is not selectable
	* server/button_character_instance.cpp,
	server/parser/button_character_def.cpp,
	server/parser/button_character_def.h: Character depths are now 
	respected while drawing

2006-11-04 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_ogl.cpp: Added matrix for YUV->RGB-conversion.
	* macros/gnashpkgtool.m4: Look in the $prefix path for includes and
	libraries. This lets specifying --prefix become the default path to
	search in for cross compiling.
	* macros/zlib.h: Fixed typo, corrected output.
	* macros/pkg.m4, macros/libXML.m4: Typo: 
	cross_compling -> cross_compiling.
	* server/impl.cpp: moved register_tag_loader() to the right place...
	* macros/ffmpeg.m4: Clean-ups and fixed linking...
	  
2006-11-03 Sandro Santilli <strk@keybit.net>

	* server/parser/button_character_def.{cpp,h}: fixed last
	  fix attempting to still properly read the stream even
	  in case of an error.

2006-11-03 Sandro Santilli <strk@keybit.net>

	* server/impl.cpp, server/swf.h: register "fixme" loaders
	  for known SWF8 opcodes; fix a typo in previous commit of swf.h.
	* server/parser/movie_def_impl.cpp: be more quiet when not
	  in verbose parse mode.
	* server/button_character_instance.cpp (ctor): don't resolve
	  characters associated to button records, that is now done
	  by button_record read function.
	* server/parser/button_character_def.{h,cpp} (button_record::read):
	  resolve characters immediately, returning false if impossible.

2006-11-03  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/curl.m4: Don't use curl-config when cross
	compiling. Break when the header is found, and don't forget to
	actually add the library to LDFLAGS.
	* autogen.sh: Don't pass -I macro if the directory doesn't
	exist. This is useful for nested configure scripts.
	* macros/agg.m4, atk.m4, boost.m4, curl.m4, glib.m4, gtk2.m4,
	gtkglext.m4, jpeg.m4, kde.m4, libXML.m4, pango.m4, png.m4, sdl.m4:
	Look in the $prefix path for includes and libraries. This lets
	specifying --prefix become the default path to search in for cross
	compiling.
	* macros/pkg.m4: When cross compiling, don't use pkg-config, as it
	only gets host values.

2006-11-03 Sandro Santilli <strk@keybit.net>

	* server/swf.h: added some new SWF8 opcodes.
	* server/as_function.cpp (ctor): always increment refcount on
	  prototype object.

2006-11-03 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: Removed debug output

2006-11-03 Vitaly Alexeev <tishka92@yahoo.com>

	* server\asobj\NetStream.cpp: processing of 
	  the end of video is added
	
2006-11-03 Vitaly Alexeev <tishka92@yahoo.com>

	* server\video_stream_instance.(h,cpp): added
	  get_invalidated_bounds() method
	* gui\gui.cpp: removed win32 hack
	
2006-11-03 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase\noseek_fd_adapter.cpp: ssize_t ==> size_t
	* libbase\container.h: Has forgotten to clean marks
	* server\asobj\NetStream.cpp: Has forgotten to clean marks
	* server\gnash.h: Has forgotten to clean marks
	
2006-11-03 Markus Gothe <nietzsche@lysator.liu.se>

	* server/asobj/Math.cpp, server/as_value.h: Added #include <string>.
	* server/asobj/NetStream.h: #ifdef USE_FFMPEG.
	* backend/render_handler_ogg.h: Removed unused include...

2006-11-03 Vitaly Alexeev <tishka92@yahoo.com>

	* server\asobj\NetStream.h, cpp: updated video timing
	* testsuite\sample\player.swf: 4 video simultaneously
	* win32\gnash\gnash.vcproj: added new files
	
2006-11-03 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/swf_exists.exp: use 'gnash'
	  rather then 'gprocessor' (gprocessor is currently broken, btw)

2006-11-03 Sandro Santilli <strk@keybit.net>

	* server/: [too many files]
	  Changed some 'tu' containers to 'std' ones...
	* server/: action.h, event_id.h, Makefile.am: extracted event_id
	  class from action.h header.
	* server/StringPredicates.h: added StringNoCaseEqual.
	* server/as_value.{h,cpp}: to_std_string method added.
	* libbase/noseek_fd_adapter.cpp: signed vs. unsigned warnings
	  fixes.

2006-11-03 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: When using ffmpeg for 
	  mp3-decoding, keep trying until error or something has been
	  decoded.
	  
2006-11-03 Sandro Santilli <strk@keybit.net>

	* server/: Makefile.am, PropertyList.h, StringPredicates.h:
	  Move std::string comparator in a separate file.
	* server/as_environment.{h,cpp}: use a std::map for variables
	  rather then a stringi_hash; made _variables private.

2006-11-03 Sandro Santilli <strk@keybit.net>

	* server/as_function.{h,cpp}: properly update refcount
	  of function prototype object; improved documentation.

2006-11-03 Sandro Santilli <strk@keybit.net>

	* utilities/processor.cpp: drop support for multiple
	  input files (due to weakness of libserver due to 
	  unwrapped globals - namely base_url); properly
	  set base url.

2006-11-03 Hiroyuki Ikezoe <poincare@ikezoe.net>

        * backend/sound_handler_gst.cpp: fix to critical error
	  exposed by playing samples/sound1.swf

2006-11-02 Sandro Santilli <strk@keybit.net>

	* server/movie_interface.h: adde constructor for proper
	  initialization of invalidated bounds staff; added TODO
	  labels for moving the whole API to character class.

2006-11-02 Sandro Santilli <strk@keybit.net>

	* configure.ac, testsuite/Makefile.am,
	  testsuite/movies.all/Makefile.am,
	  testsuite/movies.all/gravity_embedded-TestRunner.cpp:
	  New automated testing for gravity_embedded.swf

2006-11-02 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.cpp: properly set base_url to
	  allow movies being tested to load other movies.

2006-11-02 Sandro Santilli <strk@keybit.net>

        * testsuite/simple.exp: new file being a copy
          of the equal ming.exp and samples.exp files.
        * testsuite: misc-ming.all/ming.exp, samples/samples.exp:
          replaced by simple.exp above
        * testsuite/: misc-ming.all/Makefile.am, samples/Makefile.am:
          use unified expect script.

2006-11-02 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/samples/gradients-test.swf: Added a extensive
	  test for gradient rendering.
	* backend/render_handler_agg_style.h: correct and faster
	  implementation of radial fills
	* backend/render_handler.h: New function to receive scale
	  change notifications
	* backend/render_handler_agg.cpp: Properly handle rescaling
	* gui/gtk_glue_agg.cpp, gui/gtk_glue_agg.h: Implemented
	  proper rescaling
	* gui/gtksup.h, gui/gui.cpp, gui/gui.h: Redraw on rescale
	* server/matrix.cpp, server/matrix.h: Added function to
	  scale with different x/y values

2006-11-02 Hiroyuki Ikezoe <poincare@ikezoe.net>

        * backend/sound_handler_gst.cpp: segfault fix (bug #18167)

2006-11-01 Sandro Santilli <strk@keybit.net>

	* backend/sound_handler_sdl.{h,cpp}:
	  use more unsigned types (remove compiler warnings);
	  properly check sdl_audio_callback 'length' argument;
	  minor style nits.

2006-11-01 Vitaly Alexeev <tishka92@yahoo.com>

	* server\asobj\NetStream.h, cpp: clean up

2006-11-01 Vitaly Alexeev <tishka92@yahoo.com>

	* backend\sound_handler_sdl.cpp: open audio if it is closed
	
2006-11-01 Hiroyuki Ikezoe <poincare@ikezoe.net>

	* backend/sound_handler_gst.cpp: 
 	  Fixed some memory leaks and proper use of
	  integers (signed/unsigned)
	* doc/C/gnashrc.xml:
	  typo fix (pluginSound => pluginsound)

2006-11-01 Markus Gothe <nietzsche@lysator.liu.se>

	* TODO: Added note on GTK1-support for the plugin.
	
2006-10-31 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_ogl.cpp: Clean up and added comments to 
	  understand what the combiner registers do.

2006-10-31 Sandro Santilli <strk@keybit.net>

	* server/asobj/MovieClipLoader.cpp: fixed event handlers calls
	  so that they include the target_mc argument.

2006-10-31 Sandro Santilli <strk@keybit.net>

	* server/asobj/MovieClipLoader.cpp: lots of cleanup, implemented
	  generic handling for event handlers (addListener, removeListener,
	  dispatchEvent); added dispatch of onLoadInit event.
	* server/asobj/MovieClipLoader.cpp: lots of cleanup, implemented
	  generic handling for event handlers (addListener, removeListener,
	  dispatchEvent); added dispatch of onLoadInit event.
	* server/swf_function.cpp: make quiet (in sync with 0.7.2)
	* server/asobj/: Global.cpp, MovieClipLoader.cpp, MovieClipLoader.h:
	  a bit of cleanup for the MovieClipLoader class, to use the
	  new ActionScript builtin classes architecture. Stubbed addListener
	  and removeListener methods.

2006-10-31 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as: added test
	  for getNextHighestDepth().
	* server/:sprite_instance.{h,cpp}:
	  implemented getNextHighestDepth() ActionScript method;
	  changed init_builtins() to take a version number; called	
	  init_builtins only when really needed, as in constructor
	  the as_environment get_version() method will fail as 
	  the top-level movie_root would not have an associated
	  root movie yet (complex, yes... )
	  Made the getNextHighestDepth() AS method only available
	  when target movie is SWF7 or higher.
	* server/: dlist.{h,cpp}:
	  added getNextHighestDepth() method.
	* server/as_environment.cpp (get_version): more assertions
	  (we have an initialization problem there)
	* testsuite/movies.all/README: updated info about gravity-embed.swf
	  (after last modification)

2006-10-31 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/movies.all/gravity-embed.swf: improved by providing
	  explicit size control buttons and debugging textfield.
	* backend/render_handler_agg.cpp: Outline sizes now respect the
	  transformation matrix

2006-10-31 Sandro Santilli <strk@keybit.net>

	* testsuite/movies.all/README: updated info about gravity.swf
	  (after last fix)

2006-10-31 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/movies.all/gravity.swf: fixed actionscript
	  referencing undefined variable.
	* testsuite/movies.all/gravity-embed.swf: new testcase

2006-10-31 Sandro Santilli <strk@keybit.net>

	* testsuite/movies.all/README: some info about the movies
	* libbase/noseek_fd_adapter.cpp (fill_cache): fixed compiler
	  warnings, plugged leaks, throw an exception on errro.

2006-10-31 Markus Gothe <nietzsche@lysator.liu.se>

	* server/shm.h DSOEXPORT ctor and dtor.
	* server/gnash.h: DSOEXPORT get_sound_handler.
	* server/shape.cpp: DSOEXPORT edge::is_straight.
	
2006-10-31 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp, 
	  backend/render_handler_agg_style.h: Implemented masks for 
	  AGG renderer

2006-10-31 Sandro Santilli <strk@keybit.net>

	* backend/sound_handler_gst.cpp (stop_all_sounds): fixed infinite
	  loop due to comparison being always true.

2006-10-30 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Fixed starting soundstreams
	  from any frame when using libmad.

2006-10-30 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* testsuite/samples/: subshapes.swf, README:
	  added new test file for multiple shape layer
	  combination.

2006-10-30 Markus Gothe <nietzsche@lysator.liu.se>

        * AUTHORS: added Hannes.
	* configure.ac: Removed 0.7.1 from the version info, let's stick with
	  cvs+BUILDDATE.
	* macros/boost.m4: Applied patch from Bernhard Rosenkraenzer.
	* macros/glib.m4, macros/pango.m4: Fixed output.
	* macros/atk.m4: fixed issue due to typo (lack of '$').
	* backend/sound_handler_gst.cpp: Added stubs for aux-streaming.
	* server/rect.h: DSOEXPORT rect()/is_bool() for visibility.

2006-10-30 Hannes Mayr <hannes.mayr@indunet.it>
	* server/asobj/NetStream.cpp: added <unistd.h> include for sleep()

2006-10-30 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/swf_exists.exp: added more debugging
	  lines on -v -v : dunno why but seems broken again on my debian
	  stable :-( 
	* server/PropertyList.h: added <cctype> include for toupper.

2006-10-29 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/tu_opengl_includes.h: Fixed bug #18145.

2006-10-29  Rob Savoye  <rob@bertha.welcomehome.org>

	* All GPL'd files: Remove Mozilla exemption. Maybe someday
	they'll not be so scared of the GPL.
	* server/gnash.h, server/asobjs/NetStream.h, NetStream.cpp: Use
	uint8, not Uint8 as it's defined within Gnash, and Uint8 isn't
	defined at all.
	* libamf/protocol.h: Add private data for accumulating byte
	counts.
	* libamf/rtmp.cpp: Accumulate byte counts.

2006-10-29 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase\container.h: added hash::erase()
	* server\gnash.h: added attach_aux_streamer & detach_aux_streamer 
	* server\asobj\NetStream.h, cpp: added audio streamer for video
	* backend\sound_handler_sdl.h, cpp: added attach_aux_streamer & detach_aux_streamer 
	* win32\gnash\gnash.vcproj: added new files

2006-10-29 Vitaly Alexeev <tishka92@yahoo.com>

	* backend/render_handler_ogl.cpp: GL_NEAREST ==> GL_LINEAR
	
2006-10-28  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/ffmpeg.m4: Also look for libavformat, which is needed on
	some systems to support the new video code.

2006-10-28 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: added bogus YUV_video to make
	  it compile again; fixed some warnings
	* backend/render_handler_ogl.cpp, server/Makefile.am, 
	  server/video_stream_instance.cpp, server/parser/Makefile.am:
	  Extended makefiles, moved YUV_video to it's own file so that
	  Gnash compiles again for other backends

2006-10-28 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/gnashpkgtool.m4: Typo.
	* backend/render_handler_ogl.cpp, libbase/ogl.h: Replaced TU-wrapper 
	  code with the real stuff.

2006-10-27 Sandro Santilli <strk@keybit.net>

	* server/asobj/Makefile.am: added includes from backend
	  (NetStream uses renderer - should be avoided ?)

2006-10-27 Markus Gothe <nietzsche@lysator.liu.se>

	* server/asobj/NetStream.{h,cpp}: Uint8 -> uint8_t. #ifdef USE_FFMPEG.
	  Fixed typo of StreamProvider.h for case-sensitive-compilers.
	  Sleep -> sleep. #ifndef __GNUC__ fmod = std::fmod.
	* backend/render_handler_ogl.cpp: Don't use GLew since it useless...
	  TODO: rewrite NV-ext to generic OGL so it works. Removed ';' to
	  conform to -pedantic -Werror. Changed name on quad to iquad to avoid
	  "cc-1101 CC: ERROR File = render_handler_ogl.cpp, Line = 150
  	  "quad" has already been declared in the current scope."

2006-10-27 Vitaly Alexeev <tishka92@yahoo.com>

	porting to win32:		
	* server\as_function.cpp
	* server\array.cpp
	* server\asobj\Global.cpp
	* libbase\noseek_fd_adapter.cpp
	* backend\sound_handler_sdl.h

2006-10-27 Vitaly Alexeev <tishka92@yahoo.com>

	opengl videostream implementation (4-7 ms per frame)
	requirements: NVIDIA card with aux buffers, glew library
	
	updated:
	* server\parser\button_character_def.h,
	* server\gnash.h,
	* server\asobj\LocalConnection.h,
	* server\asobj\LocalConnection.cpp,
	* server\parser\movie_def_impl.h,
	* server\movie_root.h,
	* server\asobj\NetStream.h,
	* server\asobj\NetStream.cpp,
	* libbase\network.h,
	* libbase\network.cpp
	* server\render.h
	* server\parser\sprite_definition.h
	* server\swf\tag_loaders.h
	* libbase\tu_types.h
	* gui\gui.cpp
	* server\impl.cpp
	* libbase\log.cpp
	* server\movie_root.cpp
	* server\render.cpp
	* backend\render_handler.h
	* backend\render_handler_ogl.cpp
	* server\swf\tag_loaders.cpp
	* win32\gnash\gnash.vcproj
	
	added:
	* server\parser\video_stream_def.h
	* server\parser\video_stream_def.cpp
	* server\video_stream_instance.h
	* server\video_stream_instance.cpp
	* testsuite\sample\player.swf

2006-10-27 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_ogl.cpp: Revived code for OGL antialiasing,
	  albeit #if 0 until I've got the time to work on this. Added ctor stub.

2006-10-27 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Date.as: fixed testcase
	  (get => getDate, set => setDate, getUTC => getUTCDate,
	   setUTC => setUTCDate)

2006-10-27 Sandro Santilli <strk@keybit.net>

	* server/Property.h: improved documentation, added isGetterSetter,
	  modified other methods to take as_object by *reference* (not
	  pointer, as we dont' accept NULLs).
	* testsuite/server/PropertyListTest.cpp: updated to match new
	  interface.
        * server/PropertyList.{h,cpp}: added getProperty(key) method;
	  removed "as_object" member and accepted it as an argument of
	  setValue/getValue: this allow for inherited properties (the "owner"
	  is not the object containing the property list when this is just
	  a prototype); fixed copy constructor to clone container elements,
	  implemented assigment operator, fixed clear() method to delete
	  container elements; tried to handle some const-correcness.
	  Will need a final cleanup and simplification pass.
        * server/as_object.{h,cpp}: added private findProperty() and
	  findGetterSetter() methods, for crawling the inheritance chain;
	  fixed set_member_default() to look for getter/setters in
	  the inheritance chain before falling back to "override" mode;
	  added doxygen comments.
	* testsuite/actionscript.all/Object.as: added Property inheritance
	  tests.

2006-10-27 Hannes Mayr <hannes.mayr@indunet.it>

	* gtk_glue_agg.cpp: Fixed rendering for screens with 8-bit and
	  16-bit color depth.

2006-10-26 Sandro Santilli <strk@keybit.net>

	* server/as_object.h: new add_property() method
	* server/asobj/Object.cpp (object_addproperty): completed.
	* testsuite/actionscript.all/Object.as: xcheck => check :)

2006-10-26 Sandro Santilli <strk@keybit.net>

	* server/GetterSetter.{cpp,h}: getValue/setValue method made const
	  (problems with const-correctness of as_function are handled in
	  the implementation file with use of const_cast<>)
	* server/: Makefile.am, Property.h: new class for properties, 
	  obsoletes as_member.
	* server/PropertyList.{cpp,h}: changed container to store
	  pointers to the new polymorphic Property class; added pointer
	  to as_object owner for calls to getter/setter properties.
	* testsuite/server/PropertyListTest.cpp: fixed test to work
	  with new interface (requirement for an as_object in ctor)
	* server/as_object.h: fix constructors to properly initialize
	  the PropertyList.
	* server/as_member.h: removed, as obsoleted 
	* server/Makefile.am: removed obsoleted reference to as_member.h

2006-10-26 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/gnashpkgtool.m4: Added GNASH_PKG_LIBS. Added GNASH_PKG_FIND.
	* macros/boost.m4: Added "2>/dev/null".

2006-10-26 Sandro Santilli <strk@keybit.net>

	* server/textformat.h: added missing forward declarations.
	* server/asobj/Global.cpp: added missing header.
	* server/builtin_function.h (constructor): added default value of
	  NULL for exported interface.
	* server/: GetterSetter.{h,cpp}, Makefile.am: added new class for
	  getter-setter properties.
	* testsuite/server/: GetterSetterTest.cpp, Makefile.am: unit test
	  for the new class.

2006-10-26 Sandro Santilli <strk@keybit.net>

	* server/: Makefile.am, as_object.{cpp,h}: use the PropertyList class 
	  rather then the simple stringi_hash<> (replaces TU things
	  with standard things, btw)
	* server/PropertyList.{cpp,h}, testsuite/server/Makefile.am,
	  testsuite/server/PropertyListTest.cpp: new class for use
	  by as objects + associated test.
	* server/as_value.h: added output operator.
	* server/as_member.h: added is_read_only() method; changed
	  get_member_flags() to return a reference (+added a const
	  and non-const version).

2006-10-26 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/gnash.h, server/styles.cpp, server/styles.h,
	  server/types.cpp: Added new methods for read access to 
	  some members and for faster color transform.
	* backend/render_handler_agg.cpp, 
	  backend/render_handler_agg_bitmap.h, 
	  backend/render_handler_agg_style.h: Fully implemented
	  bitmap and gradient fill styles and split main AGG
	  renderer file for better readability.
	* backend/render_handler.h, backend/render_handler_agg.cpp,
	  gui/gtk.cpp, gui/gtk_glue.h, gui/gtk_glue_agg.cpp,
	  gui/gtk_glue_agg.h, gui/gtksup.h, gui/gui.cpp,
	  gui/gui.h, gui/sdl_agg_glue.cpp, gui/sdl_agg_glue.h:
	  Reverted Bastiaan's changes (set_invalidated_region)
	* server/dlist.cpp: Improved invalidated bounds method
	* server/button_character_instance.cpp: Fixed invalidated 
	  bounds detection on button state change

2006-10-25 Sandro Santilli <strk@keybit.net>

	* server/as_object.h: get_member() method taking
	  an as_member pointer made private (toward getter/setter
	  properties).
	* configure.ac: don't check for cairo if not required
	  (and a minor typo fix)
	* server/as_prop_flags.h (set_flags): changed interface
	  to return bool, documented and simplified implementation.

2006-10-25 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/jpeg.m4: Fixed double -I-bug.

2006-10-25 Sandro Santilli <strk@keybit.net>

	* server/as_object.{h,cpp}: added enumProperties() and
	  copyProperties() public methods, m_members member made
	  private (toward getter/setter properties).
	* server/sprite_instance.cpp (sprite_duplicate_movieclip):
	  use the as_object::copyProperties() to avoid direct access
	  to object members (lacks a testcase for validation)
	* server/swf/ASHandlers.cpp (enumerateOjbect): call the
	  as_object::enumerateProperties() to avoid direct access
	  to object members (validated with existing testcase);
	  dropped the not-more-needed enumerateObjectRecursive
	  function (the one provided by as_object uses a stack
	  rather then recurs, btw).

2006-10-24 Sandro Santilli <strk@keybit.net>

	* server/asobj/Object.cpp: hide Object.addProperty member.

2006-10-24 Sandro Santilli <strk@keybit.net>

	* server/asobj/Object.cpp: added stub for addProperty() AS function.
	* server/asobj/Object.{cpp,h}: added init_object_instance() function
	  to create an instance of the Object as class.
	* server/swf/ASHandlers.cpp (ActionInitObject): use the new
	  init_object_instance() function.
	* testsuite/actionscript.all/Inheritance.as: one more expected success
	  becomes an actual success.
	* testsuite/actionscript.all/Object.as: add a few more tests for
	  inheritance.

2006-10-24 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/: merged inheritance.as into
	  Inheritance.as
	* server/asobj/: Global.cpp, Makefile.am, Object.{cpp,h}:
	  added Object class.

2006-10-24 Sandro Santilli <strk@keybit.net>

	* testsuite/samples/samples.exp: dejagnu driver for
	  tests in sample dir (actually a copy of ming.exp)
	* configure.ac, testsuite/Makefile.am,
	  testsuite/samples/Makefile.am: enable Makefile 
	  under testsuite/samples dir.
	* testsuite/samples/clip_as_button2-TestRunner.cpp:
	  added test runner for clip_as_button2.swf

2006-10-24 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: Fix typos.

2006-10-24 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.{cpp,h}: added findDisplayItemByDepth()
	* server/dlist.h: added const version of get_character_at_depth().
	* server/dlist.cpp (dump): added character type (using RTTI).
	* gui/gtk.cpp, gui/gui.h: added 'INPUT' cursor type (to be used
	  in input text fields)
	* server/: Makefile.am, generic_character.cpp, generic_character.h:
	  added a new implementation file for generic_character, fixed
	  can_handle_mouse_events to delegate to parent,
	  had get_topmost_mouse_entity check for can_handle_mouse_events
	  to completely skip hit test if that returns false (fixes #17935)
	* server/movie_root.{h,cpp}: moved isMouseOverActiveEntity() from
	  header to implementation file.
	* server/smart_ptr.h: made conversion from weak_ptr to smart_ptr
	  a const method, added operator* for smart_ptr
	* server/parser/movie_def_impl.cpp (create_instance): minor cleanups.

2006-10-24 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac: Fixed finding correct X11-ABI and X11-lib-path on IRIX.
	* macros/gnashpkgtool.m4: Implemented GNASH_PKG_INCLUDES.

2006-10-23 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp (ActionTypeOf): add support
	  for C_FUNCTION values.
	* server/server/edit_text_character.cpp (registerTextVariable):
	  don't assume our parent is a sprite, use the new get_environment()
	  function to get to a variable scope instead.
	* server/character.h: added get_environment virtual function
	  (every character should have an associated variable scope)
	* testsuite/misc-ming.all/ButtonEventsTest-Runner.cpp: add checks
	  for MouseOverMouseEntity.
	* testsuite/MovieTester.{cpp,h}: added isMouseOverMouseEntity() method.
	* server/action.{cpp,h} (event_id class): added is_mouse_event() 
	  method.
	* testsuite/actionscript.all/with.as: add a few more tests
	  for access of variable in higher-level scopes.
	* server/: movie_interface.h, movie_root.h: added
	  isMouseOverActiveEntity interface and implementation.
	* gui/gui.cpp (notify_mouse_moved): call isMouseOverActiveEntity
	  to switch cursor type.
	* libbase/smart_ptr.h (weak_ptr): made equality operator an inspector,
	  added inequality operator.

2006-10-2 Markus Gothe <nietzsche@lysator.liu.se>
	
	* configure.ac: Fixed finding correct X11-ABI and X11-lib-path on IRIX.
	* macro/jpeg.m4: Fixed a bug.
	* macro/kde.m4: Fixed typos.
	* macro/opengl.m4: Fixed typo (I wonder how we got away with this one?).

2006-10-23 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Number.as: removed expected failures
	  (all we have passes now, there are a lots of other tests to
	   add for that class, anyway)
	* server/as_value.cpp: (operator==): handle comparison of C_FUNCTION
	  types
	* server/as_value.cpp: (operator==): fix handling of object/non-object
	  comparison (when object is first operand).
	* server/asobj/Number.cpp: override get_numeric_value().
	* server/as_object.h: added get_numeric_value() virtual
	  method (convert to number).
	* server/as_value.h: added is_object() method (abstracts
	  difference between AS_FUNCTION and OBJECT types.
	* server/swf.h: comment on semantic of ACTION_NEWEQUALS.

2006-10-22 Sandro Santilli <strk@keybit.net>

	* server/asobj/: Global.cpp, Makefile.am, Number.cpp, Number.h:
	new Number ActionScript class (to be finished)

2006-10-22 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/log.h: size_t cannot be long long, so don't check for it.
	* configure.ac: Don't check for long long as it's unused.
	* gui/gui{.h,.cpp}: Add setCursor() to be used to set the mouse cursor.
	* gui/{gtk.cpp, gtksup.h}: Implement setCursor() for GtkGui.
	* configure.ac: Have the description of --enable-write make sense.
	* gui/{gui.h, sdl.cpp}: Gui::init() should return true on success.
	Document this in gui.h and implement it in sdl.cpp.
	* gui/Player.cpp: Remove obsolete comment.
	* backend/render_handler.h: Add get_invalidated_region().
	* backend/render_handler_agg.cpp: Implement get_invalidated_region().
	* gui/{gtk.cpp, gtk_glue_agg.cpp, gtk_glue_agg.h, gtksup.h, gui.cpp,
	gui.h}: Remove duplicate implementation of set_invalidated_region();
	instead, call get_invalidate_region() from the relevant glue. Call
	render_handler::set_invalidated_region() directly instead of the Gui
	implementation.
	* gui/sdl_agg_glue{.cpp, .h}: Implement region clipping based
	rendering.

2006-10-22  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Group --disable-klash and --enable-plugin
	together. Reverse the test to run KDE tests.
	
	* gui/Makefile.am: Don't link with -no-undefined to reduce
	dependancy problems.
	* plugin/Makefile.am, klash/Makefile.am: Don't link with
	-no-undefined to reduce dependancy problems.
	* backend/Makefile.am: List additional headers in
	noinst_HEADERS. 
	* libbase/Makefile.am: Add ref_counted.h.
	* macros/agg.m4: Look in $includedir instead of $prefix.
	* macros/libXML.m4: Use double quotes when setting LIBXML_CFLAGS.
	
2006-10-22 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac: Don't look for KDE if not --enable-plugin.
	  Wrong amount of args to 'test'. AC_DEFINE(KLASH...).
	  Added checking and setting HAVE_SHM_UNLINK. Added check for
	  shmdt.
	* utilities/dumpshm.cpp: Fixed !__GNUC__ stuff.
	  Look at server/shm.cpp and implement it likewise.
	* server/shm.cpp: Actually HAVE_SHM_UNLINK is appriate here.
	* plugin/mozplugger/mozpluggerrc.patch: added -j -k and 'stream'.

2006-10-21  Rob Savoye  <rob@bertha.welcomehome.org>

	* gnash/NEWS: Update with new fetures.
	* server/shm.cpp: Don't core dump anymore by not trying to open
	the same memory segment twice.
	* utilities/dumpshm.cpp: Shared memory utility. Lists, deletes,
	and dumps internal data from Gnash shared memory segments.
	* server/shm.h: Add more accessors for private data.
	* server/asobj/LocalConnection.cpp: Dump all the networking crap,
	that's for NetConnection.
	* server/asobj/LocalConnection.h: Derive class from Shm base class 
	instead of Network base class.
	* testsuite/actionscript.all/LocalConnection.as: Use dejagnu.as.
	* utilities/Makefile.am: Add dumpshm program.
	
	* configure.ac: Build klash if the plugin is enabled, and KDE is
	found. Use --disable-klash with --enable-plugin to change this
	behaviour.

2006-10-21 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/gnash.h: Declare sound_handler::is_muted().
	* backend/{sound_handler_gst.cpp, sound_handler_sdl.cpp,
	sound_handler_sdl.h}: Implement is_muted().
	* gui/gtk.cpp: Use is_muted() instead of a static Gui variable to
	determine whether or not sound is muted.

2006-10-21 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/ffmpeg.m4: Fixed AC_MSG_*-style.
	* macros/mad.m4: Added pkg-config support...

2006-10-20  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/ffmpeg.m4: If we find ffmpeg, it has dependancies on
	other libraries, so find libvorbisenc and libgsm or Gnash won't
	link on Ubuntu with sound enabled. Use pkg-config also for libdts,
	vorbisenc, and theora, all dependancies on Ubuntu.
	* macros/boost.m4: Don't let the boost lib get added to LIBS, we
	want to handle it seperately.

2006-10-20 Markus Gothe <nietzsche@lysator.liu.se>
	
	* server/as_enviroment.cpp: Removed MIPSPRO #pragma. CC will fail
	  due to a fundamental template-instantiation error. *Fixed*!

2006-10-20 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/rtrace.as: fixed typo, make sure
	  to have 1 second (not a tenth of it) of inactivity before
	  sending the report.
	* server/movie_root.{cpp,h} (notify_mouse_moved, notify_mouse_clicked): 
	  delegate return code to fire_mouse_events, changed to return bool;
	  (fire_mouse_events): delegate return to generate_mouse_events, 
	  changed to return bool. Ok, final effect is we *sometime* return
	  false (when NO event is actually triggered). Still partial as an
	  implementation but a little step forward.
	* testsuite/actionscript.all/swf_exists.exp: strip PASSED/FAILED
	  from test output labels.

2006-10-20 Sandro Santilli <strk@keybit.net>

	* doc/C/sources.xml: Update configure option behaviour.
	* testsuite/actionscript.all/swf_exists.exp: catch errors
	  in 'makeswf' call.
	* testsuite/actionscript.all/swf_exists.exp: made it work
	  again with tcl versions in debian stable :D
	  Also, reintroduced test id labels in pass/fail messages.
	* libbase/log.{cpp,h}: LogFile operator << for 'std::endl' (?) fixed
	  to return LogFile (not std::ostream).
	* testsuite/actionscript.all/Makefile.am: added 'check.as' and
	  'xtrace.as' dependencies.

2006-10-19 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Number.as: use OUTPUT_VERSION,
	  not SWFVERSION (the former is set by Makefile rule, the
	  latter will be available in upcoming Ming releases)
	* testsuite/actionscript.all/Makefile.am: add with.as to
	  GENERATED variable, and a comment about why we need that.
	* testsuite/actionscript.all/with.as: deeply test just the
	  'with' action.
	* server/swf/ASHandlers.cpp (ActionSetVariable, ActionGetVariable):
	  pass the with_stack to get_variable/set_variable calls.
	* server/as_environment.h: made set_variable and get_variable
	  methods taking a with_stack back to public.

2006-10-19 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp (unsupported_action_handler): more 
	  verbosity; (ActionWith): cleaned up; (ActionGetVariable): added
	  note about probable reason for 'with' failing (will work on
	  that next)

2006-10-19 Sandro Santilli <strk@keybit.net>

	* server/ActioExec.{cpp,h}: added getWithStackLimit() method,
	  fixed pushWithStackEntry() to use the limit (documented why
	  in comments); fixed initialization list ordering.

2006-10-19 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp: fix ActionExec use after privatization
	  of some members.
	* server/ActionExec.{cpp,h}: more doxygen comments, with_stack
	  made private and provided interfaces for pushing entries 
	  and getting a const ref to it. made _is_function2 data member
	  private.

2006-10-19 Sandro Santilli <strk@keybit.net>

	* gui/gui.cpp: use return value of mouse move and click events
	  notifier to decide wheter to trigger redisplay.
	* server/gnash.h: added note in key event handler about the
	  need to conform to the event handling described in the new
	  doxygen page.
	* server/movie.h, server/movie_root.cpp, server/movie_root.h:
	  switched mouse movement and click event notification functions
	  to the new interface (note: they always return true currently)
	* server/movie_interface.h: added a doxygen page about events
	  handling, changed notify_mouse_moved() and notify_mouse_clicked()
	  to return a bool as to wheter redisplay is needed.

2006-10-18 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* gui/gui.h, gui/gui.cpp: Immediate redraw after mouse click

2006-10-18  Rob Savoye  <rob@bertha.welcomehome.org>

	* gui/gtk.cpp: Include rc.h, to get the default sound
	setting. Toggle the sound using mute() & unmute() via the menu
	item. Add static variable for the sound toggle. Don't add the
	"Toggle Sound" item if sound is disabled on the command line with
	-r 1.

2006-10-18 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* gnash/server/button_character_instance.cpp, 
	gnash/server/character.h, gnash/server/dlist.cpp,
	gnash/server/edit_text_character.cpp,
	gnash/server/generic_character.h,
	gnash/server/movie_interface.h,	
	gnash/server/sprite_instance.cpp: Invalidated region 
	detection reviewed

2006-10-18 Sandro Santilli <strk@keybit.net>

	* macros/agg.m4: make sure agg_include_dir is an absolute path.

2006-10-18 Stefan Schweizer <genstef@gentoo.org>

	* gui/Makefile.am: klash_DEPENDENCIES += libgnashplayer.la.

2006-10-18 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_cairo.cpp:
	  don't directly access rect private members.
	* gui/fb.cpp, backend/render_handler_agg.cpp:
	  don't directly access rect private members.
	* gui/gui.cpp: let initial _last_invalidated_rect be null;
	  don't directly access rect private members.
	* server/rect.h: added constructor taking all coordinates.
	* backend/render_handler_ogl.cpp: don't directly access rect
	  "to-be" private members.
	* server/: fontlib.cpp, movie_root.cpp: don't directly access
	  rect "to-be" private members.
	* gui/gtk.cpp: don't directly access rect "to-be" private members.
	* server/rect.h: added shift_x, shift_y, scale_x and scale_x
	  methods (toward making data members private).
	* server/rect.h: added getters for all ordinates (toward making
	  them private).
	* server/as_environment.h: minor cleanups.
	* server/as_environment.cpp: fix signed/unsigned comparison warning,
	  fixed a small typo in debugging message.
	* libbase/log.: always check for SIZEOF_SIZE_T == SIZEOF_INT
	  before comparing against SIZEOF_LONG and SIZEOF_SHORT.
	* configure.ac: print an error on invalid --enable-sound value.

2006-10-18 Markus Gothe <nietzsche@lysator.liu.se>

	* gui/gnash.cpp, gui/sdl.cpp, utilities/parser.cpp, 
	  utilities/processor.cpp: #ifndef __GNUC__ keeps the bisons away.
	* utilities/Makefile.am: Removed unnecessary linkage (which even
	  make the binaries break on IRIX).

2006-10-18 Sandro Santilli <strk@keybit.net>

	* server/xml.cpp (setupFrame): static cast pointer arg for %p to
	  void * (fixes compiler warning)
	* macros/sdl.m4: fix handling of --with-sdl-incl (add the missing -I
	  switch).
	* configure.ac: check for getopt.h
	* gui/: gnash.cpp, sdl.cpp,
	  utilities/: parser.cpp, processor.cpp:
	  don't redeclare geopt stuff is getopt.h is available.
	* macros/sdl.m4: fixed typo ("$/" => "$i/")

2006-10-18 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Have configure export SIZEOF defines for various
	integer types.
	* libbase/log.h: Define SIZEOF_SIZE_T based on the size of its
	integer type definition, so as to avoid warnings caused by integer
	size difference variations in platforms.
	* gui/kde_glue.h: Remove OpenGL include.
	* gui/kde_opengl_glue.cpp: Add OpenGL include.

2006-10-18 Sandro Santilli <strk@keybit.net>

	* Makefile.am: @CC => $(CC)
	* server/rect.cpp (expand_to_transformed_rect): do nothing
	  when rect to expand to is null.

2006-10-18 Hannes Mayr <hannes.mayr@indunet.it>

	* configure.ac: Added Option 'no' to --enable-sound's help output.

2006-10-18 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac, libbase/tu_types.h: Check for endian.h.
	* macros/libtool.m4,
	  config.guess, config.sub, ltmain.sh: Updated to latest version from 
	  2005 / serial 48.
	* macros/pthreads.m4: added check for pth-config.

2006-10-17 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Removed call to GCC specific STL 
	vector function.
	* server/swf/ASHandlers.cpp: Removed redundant soundstop in 
	ActionGotoFrame().


2006-10-17 Markus Gothe <nietzsche@lysator.liu.se>

	* server/as_enviroment.cpp: If MIPSPRO #pragma do_not_instantiate.
	* libbase/tu_types.h: Fixed endian.h-includness for max. portability.
	* backend/sound_handler_sdl.h: <SDL/SDL_audio.h> -> <SDL_audio.h>
	* backend/sound_handler_sdl.cpp: <SDL.h> -> <SDL.h>
	* macros/sdl.m4: Fixed wrong search-path.
	* gui/Player.cpp: Removed getopt_win32.h include.
	* gui/gnash.cpp: Added declaration of getopt, optind and optarg.
	* gui/sdl.cpp, gui/gnash.cpp, utilities/parser.cpp, 
	  utilities/processor.cpp: extern "C" {getopt()}.

2006-10-17  Rob Savoye  <rob@bertha.welcomehome.org>

	* testsuite/actionscript.all/with.as: Minor changes.
	* macros/kde.m4: Remove test for vsnprintf, as this breaks on
	Ubuntu, and this is tested for elsewhere anyway, so it's
	redundant.

2006-10-17 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp (ActionGetVariable): optimizations:
	  avoid pop/push; avoid unneeded as_value copies.
	* server: Makefile.am, rect.cpp rect.h: put rect class in it's own
	  files, fixed width() and height() to return 0 when rect is
	  null.
	* gui/gui.h, server: font.h, gnash.h, movie_interface.h, types.cpp,
	  parser/: character_def.h, edit_text_character_def.h,
	  shape_character_def.h, text_character_def.h: updated all includes
	  to use new rect.h file.
	* gui/gui.cpp (display): added missing return (doesn't tell much
	  actually)
	* server/gnash.h, server/types.cpp (rect class): added is_null(),
	  set_null() methods and check for it in all public functions;
	  added enclose_point() method; added some TODO items.
	* server/edit_text_character.h (reset_bounding_box): avoid
	  directly accessin rect class data members.
	* server/movie_root.h (get_invalidated_bounds): use set_null()
	  to reset bounds when browsing for invalidated rectangle,
	  avoid directly accessing rect class data members.
	* server/parser/shape_character_def.cpp (compute_bound):
	  avoid directly accessin rect class data members, use
	  rect::set_null() to initialize bounds.

2006-10-17 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/Makefile.am: when we are building the KDE GUI, build
	target klash.moc before anything else.
	* gui/sdl_ogl_glue.cpp: variable depth is now called _bpp.

2006-10-17 Sandro Santilli <strk@keybit.net>

	* gui/gui.{cpp,h}: notify_mouse_moved made non-static; call
	  display() after mouse move notification to immediately
	  show changed triggered by any event handler. This is an
	  overkill and needs better architecture, but at least it is
	  correct now.
	* gui/gui.{cpp,h}: extracted a display() function out of
	  advance_movie(), for possible reuse from event notifiers.
	* server/edit_text_character.cpp: commented out debugging line
	* testsuite/misc-ming.all/ButtonEventsTest.c: set movie rate
	  to 0.2 frames per second, to test redraw-on-event (not working
	  as it should).
	* gui/Player.cpp (run): exit with an error if gui initialization
	  failed.
	* gui/fb.cpp (init): return false if pixel format is not
	  supported.

2006-10-17 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac: Added use of AC_LANG{PUSH,POP}(C++).
	* Makefile.am: Install doc/gnash.1 as man page.
	* doc/gnash.1: Imported www-version.
	
2006-10-16  Rob Savoye  <rob@bertha.welcomehome.org>

	* server/xml.cpp: Fix parseXML so it takes a string, and properly
	sets up the stack with the values parsed from the XML.
	* testsuite/actionscript.all/XML.as: Tests pass now, no expected
	failures anymore.
	* testsuite/actionscript.all/with.as: New test case for making
	sure the 'with' Flash keyword works, which currently it doesn't.

2006-10-16 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_gst.cpp, backend/sound_handler_sdl.cpp,
	backend/sound_handler_sdl.h, server/gnash.h: Added support for
	muting and unmuting soundhandlers.

2006-10-16 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Fixed stop_all_sounds() and
	stop_sound().
	* server/sprite_instance.cpp: When a movie is stopped/paused
	or jumps to a new frame the audio playback now stops.

2006-10-16 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/ButtonEventsTest-Runner.cpp:
	  expect immediate execution of mouse event handlers.
	* server/button_character_instance.cpp (on_button_event):
	  execute events handler immediately, not at next 'advance'
	* configure.ac: comment out unused OGG and PNG checks
	* testsuite/server/Makefile.amadd libgnashbase explicit
	  linking as the one deduced by libgnashserver seems
	  to be bogus (points to the installed one).
	* testsuite/misc-ming.all/ming_utils.c: include ming_utils.h
	* configure.ac: don't complain if mp3_decoder is set but no
	  sdl sound was requested (since mp3_decoder=ffmpeg by default).
	  Just set it to none instead..

2006-10-16 Hannes Mayr <hannes.mayr@indunet.it>

	* gui/gtk.cpp: Use set_invalidated_region() only with AGG renderer
	until world_to_pixel() is implemented for triangle-based renders.

2006-10-16  Rob Savoye  <rob@bertha.welcomehome.org>

	* doc/C/gnashrc.xml: New section on the Gnash configuration file
	and it's settings.
	* doc/C/gnash.xml: Add section on the Gnash configuration file.
	
	* gui/gtksup.h: Add prototype for menuitem_sound_callback.
	* gui/gtk.cpp: Add menuitem_sound_callback, and a "Toggle Sound"
	menu item.
	* gui/Player.cpp: Enable sound by default, but also check the
	$HOME/.gnashrc file.
	* libbase/rc.cpp, rc.h: Add support for "sound" and "pluginsound"
	config settings.
	* configure.ac: Enable the SDL-ffmpeg sound system by default.

2006-10-16 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* gui/gui.h, gui/gui.cpp: Added want_redraw() function
	* backend/render_handler.h, backend/render_handler_agg.cpp: 
	Added get_pixel() function

2006-10-16 Hannes Mayr <hannes.mayr@indunet.it>

	* gui/gtk_glue_agg.cpp, gui/gtk.cpp, gui/gtksup.h: Added regions support
	to the GTK-AGG GUI.

2006-10-16 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* doc/C/internals.xml: Updated the docs about the SDL soundhandler
	* backend/sound_handler_gst.cpp: Dummy support for sound envelopes
	* backend/sound_handler_sdl.cpp, backend/sound_handler_sdl.h,
	server/button_character_instance.cpp, server/gnash.h, 
	server/sound.cpp, server/sound.h, server/asobj/ASSound.cpp, 
	server/parser/button_character_def.cpp, 
	server/parser/button_character_def.h: Added support for volume 
	control using sound envelopes.

2006-10-16 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/: ButtonEventsTest-Runner.cpp,
	  ButtonEventsTest.c, Makefile.am: new test for button
	  events.
	* testsuite/MovieTester.{cpp,h}: added call to set_current_root 
	  (seems needed by notify_mouse_clicked) and new pressMouseButton()
	  and depressMouseButton() methods.
	* server/movie_root.cpp (generate_mouse_button_events): use
	  C++ style casts, assert that a "current root" has been set.
	* server/: action.cpp, action.h: added ROLLOVER and ROLLOUT standard
	  members.
	* server/sprite_instance.cpp: set and get ROLLOVER and ROLLOUT
	  events within get_member and set_member (fixes RollOverOutTest)
	* testsuite/misc-ming.all/Makefile.am: enable RollOverOutTest-Runner
	  on 'make check'
	* testsuite/misc-ming.all/: Makefile.am, RollOverOutTest-Runner.cpp,
	  RollOverOutTest.c: new test for RollOver and RollOut events
	* testsuite/misc-ming.all/ming_utils.{c,h}: added make_fill_square()
	  function.
	* testsuite/MovieTester.{cpp,h}: added movePointerTo() method
	  to generate mouse events.
	* server/types.cpp, server/matrix.cpp: don't check IF_VERBOSE_PARSE
	  in types' ::print method, have that checked by caller.

2006-10-16 Hannes Mayr <hannes.mayr@indunet.it>

	* gui/gtk_glue_agg.cpp, gui/gtk_glue.h: Code cleanup, fixed unused
	  parameter warnings.
		
2006-10-16 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* gui/fbsup.h, gui/fb.cpp: Implemented clean exit for FB GUI

2006-10-16 Bastiaan Jacques <bastiaan@bjacques.org>

	* plugin/klash/klash.cpp: Fix compilation issues by ensuring that
	`windowid' is actually defined.
	* macros/docbook.m4: Make an invalid directory passing message refer
	to the relevant directory.
	* configure.ac: Permit only the KDE GUI when klash is requested. KDE
	is not a renderer, so don't test for it.
	* gui/{kde_glue.h, kde_glue_opengl.cpp, kde_glue_opengl.h,
	gui/kdesup.h}: Remove OpenGL-specific code from KdeGlue, so as to
	allow glues other than OpenGL to inherit from KdeGlue; propagate this
	change to subclasses. Also fix some typos.
	* plugin/klash/Makefile.am: Deprecate the klash binary from
	plugins/klash in favour of gui/klash.
	* configure.ac: Allow SDL-GUI to be built with Agg. Fix typo.
	* gui: Implement the Agg renderer for SDL-GUI. This does not yet
	include region updating.
	* gui/README: Update to reflect recent changes.
	* gui/gnash.cpp: Remove assertion for invalid bit depths. Renderer
	glues must decide if a bit depths is appriopriate and signal the user
	if necessary.
	* gui/sdl_cairo_glue{.cpp, .h}: Remove OpenGL code.
	* gui/sdl_agg_glue.cpp: Don't call free() on a operator new-allocated
	buffer.

2006-10-16 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_agg.cpp: Added log_error on unknown 
	  pixelformat. Added RGBA16/RGBA32 pixel-formats.
	* gui/gtk_glue_agg.cpp: Added RGBA16/RGBA32 pixel-formats.
	* plugin/klash/klash.cpp: Fixed windowid in accordance to Bastiaan's
	  code clean-up in action.cpp
	
2006-10-15 Patrice Dumas <pertusus@free.fr>

	* testsuite/Makefile.am: Add analyse-results.sh to the
	distibution.
	* testsuite/analyse-results.sh: Make sure the test log exists
	before trying to parse it.
	* testsuite/actionscript.all/Makefile.am: Also clean the out.swf
	file.
	* testsuite/libbase/Makefile.am: Also clean the site.exp.bak
	file.
	* testsuite/misc-ming.all/Makefile.am: Clean the debug log, and
	testing log files.
	* testsuite/misc-ming.all/PlaceObject2Test.c: Deal with the
	warning, and don't comment out argc and argv.
	* testsuite/server/Makefile.am: Clean the debug log, and testing
	log files.


2006-10-15 Rob Savoye <rob@bertha.welcomehome.org>

	* testsuite/actionscript.all/swf_exists.exp: Use local_exec()
	instead of spawn/expect. This works better with batch tests.
	* testsuite/actionscript.all/check.as: Add xcheck and
	xcheck_equals to handle expected failures.
	* testsuite/actionscript.all/dejagnu.as: Add xpass and xfail to
	handle expect failures.
	* testsuite/actionscript.all/Boolean.as, Date.as, Global.as,
	Inheritance.as, MovieClip.as, NetConnection.as, Number.as,
	Object.as, Selection.as, array.as, delete.as, inheritance.as: Use
	xcheck and xcheck_equals for tests expected to not work yet.
	* testsuite/actionscript.all/XML.as, XMLNode.as: Use xpass and
	xfail for tests expected to not work yet.

2006-10-15 Sandro Santilli <strk@keybit.net>

	* gui/sdl_ogl_glue.cpp: fixed unused parameters warning.

2006-10-15 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Print KDE configuration flags when using KDE.
	* gui/Makefile.am: Correct the order of KDE linker flags.
	* gui/gui.cpp: Fix a typo.
	* macros/docbook.m4: Substitute variables used in Makefiles, so they
	can be used by `make'.
	* server/action.cpp: Remove unused GUI code.
	* configure.ac, macros: Implement all configuration option
	descriptions using AC_HELP_STRING for a pretty alignment.

2006-10-15 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/render_handler_agg.h: Chmod -x.
	* AUTHORS: Updated in accordance with the www.
	* doc/C/sources.xml, win32/npgnash/npgnash.vcproj, plugin/klash/README,
	  backend/sound_handler_mp3.cpp, backend/sound_handler_sdl.cpp,
	  win32/gnash/gnash.vcproj, backend/sound_handler_sdl.h,config.mk.in,
	  doc/C/internals.xml, gui/Makefile.am, libamf/Makefile.am, Makefile.am,
	  plugin/klash/Makefile.am, plugin/Makefile.am,server/asobj/Makefile.am,
	  server/Makefile.am, server/parser/Makefile.am, 
	  testsuite/actionscript.all/Makefile.am:
	  Removed references to SDL-mixer.

2006-10-14 Sandro Santilli <strk@keybit.net>

	* server/movie_root.h, server/movie_interface.h, server/movie.h:
	  notif_mouse_moved() function documentation improved and
	  moved only in movie_interface (parent class).

2006-10-14 Markus Gothe <nietzsche@lysator.liu.se>

	* libgeometry/Makefile.am, server/asobj/Makefile.am, server/Makefile.am,
	  server/parser/Makefile.am: Removed unused $(ENGINE_INCLUDE).

2006-10-14 Markus Gothe <nietzsche@lysator.liu.se>

	* server/shape.h: DSOEXPORT  class mesh_set
	* server/styles.h: DSOEXPORT class fill_style.
	* server/gnash.h: DSOEXPORT void  expand_to_rect(const rect& r);
	  DSOEXPORT movie_definition* create_movie(tu_file* in, 
	  const std::string& url);
	* gui/gui/gtk_glue_cairo.h: Fixing undef'd virtual.
	* backend/render_handler_cairo.{cpp, h}: DSOEXPORT void 
	  set_handle(cairo_t* handle); DSOEXPORT gnash::render_handler* 
	  create_handler();
	* macros/gnashpkgtool.m4: Initial import.

2006-10-13  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/boost.m4: Do stupid and complex searching for the Boost
	  version number, followed by digging around via 'ls' to find the
	  right Boost thread library no matter what it's called. For now,
	  the results of this test are unused by current code.

2006-10-13 Markus Gothe <nietzsche@lysator.liu.se>

	* gui/sdl.cpp, gui/sdl_ogl_glue.cpp: Fixed some #defines that were 
	  reverted. Removed basename().
	* macros/ogg.m4: Typo.
	* macros/boost.m4: Clean up and fixed missing AC_LANG{PUSH,POP}(C++).
	* gui/gtk_glue_gtkglext.h: Fixed non-def'd virtual.
	* libbase/container.h: Adding namespace gnash{}. Avoiding confusion.
	* libgeometry/kd_tree_dynamic.cpp: hash -> gnash::hash.

2006-10-13 Udo Giacomozzi

	* testuite/movies.all/gravity.swf: Added test movie
	
2006-10-13 Hannes Mayr <hannes.mayr@indunet.it>

	* configure.ac: AGG is now supported by GTK GUI too.

2006-10-13 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/{sdl_*, Makefile.am}: Add OpenGL and Cairo glues for SDL.
	  Clean up sdl.cpp.

2006-10-13 Hannes Mayr <hannes.mayr@indunet.it>
	* gui/gtk.cpp, gui/gtksup.h, gui/gtk_glue.h, gui/gtk_glue_agg.cpp,
	  gtk_glue_agg.h, Makefile.am: Added support for GTK with AGG renderer.

2006-10-13 Sandro Santilli <strk@keybit.net>

	* gui/sdl.cpp, gui/sdlsup.h: added support for expose and
	  resize events. (resize does nothing, just logs it).
	* backend/render_handler_cairo.cpp (line_style_width): handle
	  "hairline" width.
	* backend/render_handler_ogl.cpp (line_style_width): handle "hairline"
	  width.
	* gui/gui.cpp (resize_view): set _width and _height.
	* testsuite/libbase/Makefile.am, testsuite/misc-ming.all/Makefile.am,
	  testsuite/server/Makefile.am: update dejagnu rule to use
	  check_PROGRAMS rather then noinst_PROGRAMS.
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c: 
	  add border to the textfield (to test for bug# 17992).
	* testsuite/libbase/Makefile.am, testsuite/misc-ming.all/Makefile.am,
	  testsuite/server/Makefile.am: only build tests on 'make check'

2006-10-13 Markus Gothe <nietzsche@lysator.liu.se>

	* autogen.sh: avoid using the '-path' primary to find(1) as it's an 
	  extension to posix.2 and is not supported on some operating systems 
	  such as Solaris and IRIX.
	* configure.ac: Die on --enable-strict && --enable-renderer=agg.

2006-10-13 Sandro Santilli <strk@keybit.net>

	* gui/gui.h, gui/fbsup.h, gui/fb.cpp: changed set_invalidated_region
	  to take rect by const reference (a const value didn't make sense)
	* gui/gtk.cpp: redraw buffer on expose events.
	* backend/render_handler.h (draw_poly): documented the fact
	  that the polygon's corner need not be closed (am I right?)
	* macros/atk.m4: fixed missing -I switches in include, cleaned
	  up verbosity.
	* backend/render_handler.h, backend/render_handler_tri.h:
	  added links new pages, cleaned up doxygen comments.
	* doc/Doxyfile.in: exclude mozilla-sdk and win32 paths from
	  doxygen parsing

2006-10-13 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler.h: Added documentation
	* backend/render_handler.h, backend/render_handler_agg.cpp, 
	  backend/render_handler_tri.h: code cleanup
	* backend/render_handler.h, backend/render_handler_agg.cpp, fb.cpp: 
	  split AGG buffer initialization from constructor   	

2006-10-13 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/png.m4: Added pkg-config support.
	
2006-10-12 Udo Giacomozzi <udo.gnu@nova-sys.net>
  
	* render_handler_agg.cpp, gui/fb.cpp: Implemented clipping for
	  AGG backend 

2006-10-12  Rob Savoye  <rob@bertha.welcomehome.org>

	* testsuite/libbase/Makefile.am: Redefine the check-DEJAGNU target
	  to execute the testcase directly if DejaGnu isn't installed.
	* testsuite/libbase/libbase.exp: New test driver for libbase test
	  cases.
	* testsuite/server/Makefile.am:  Redefine the check-DEJAGNU target
	  to execute the testcase directly if DejaGnu isn't installed.
	* testsuite/server/server.exp: New test driver for server tests.
	* testsuite/misc-ming/Makefile.am:  Redefine the check-DEJAGNU target
	  to execute the testcase directly if DejaGnu isn't installed.
	* testsuite/misc-ming/ming.exp: New test driver for Ming tests.
	

2006-10-10  Rob Savoye  <rob@bertha.welcomehome.org>

	* gui/images/gnash_G_v3.ico: Updatedb "Gnashing 'G'" square
	  icon in color.
	* gui/gtk.cpp: Use updated icon image used when minimized.

2006-10-13 Sandro Santilli <strk@keybit.net>

	* server/character.h: clarified semantic of get_width() and
	  get_height().
	* server/generic_character.h: fixed get_width() and get_height()
	  to return "local untransformed" size.
	* server/sprite_instance.cpp (get_member): fixed M_WIDTH and
	  M_HEIGHT members fetch using a plain call to get_width() and
	  get_height() [ only additionally adding twips_to_pixel transform]
	* gui/gui.cpp: added IF_DEBUG_REGION_UPDATES and
	  ENABLE_REGION_UPDATES_DEBUGGIN macros, for future
	  compiletime + runtime conditional support.
	* gui/gui.{cpp,h}: advance_movie reverted to a static, to make
	  current gtk gui work fine (there's no point of being non-static
	  *and* take a 'this' argument).
	* macros/ogg.m4: added missing -I, -L and -l (!);
	  quoted 'test' args.

2006-10-12 Markus Gothe <nietzsche@lysator.liu.se>

	* gui/sdl.cpp: fixed includes for getopt() and basename().
	  include tu_opengl_includes.h
	* macros/agg.m4: Added pkg-config support :D.

2006-10-12 Udo Giacomozzi <udo.gnu@nova-sys.net>
  
	* gui/fb.cpp, gui/fbsup.h, gui/gui.cpp, gui/gui.h,
	server/button_character_instance.cpp, server/button_character_instance.h,
	server/character.c, server/character.h, server/dlist.cpp,
	server/dlist.h, server/edit_text_character.cpp,
	server/edit_text_character.h, server/generic_character.h,
	server/gnash.h, server/movie_interface.h, server/movie_root.cpp,              
	server/movie_root.h, server/sprite_instance.cpp,
	server/sprite_instance.h, gnash/server/types.cpp, 
	server/parser/button_character_def.h, erver/parser/character_def.h, 
	server/parser/edit_text_character_def.h, server/parser/movie_def_impl.h,
	server/parser/sprite_definition.h, server/parser/text_character_def.h:
	Enhanced "rect" class and implemented a method to detect updated regions
	on the stage.
      
                     
2006-10-12 Sandro Santilli <strk@keybit.net>
                     
	* configure.ac: don't check for GLEXT unless gtk/opengl combination
	  is requested.     
	* macros/atk.m4: added missing switches in lib detection;
	  always look for atk version and topdir as those might eventually
	  be needed by subsequent library seeking; removed bogus if/else/fi
	  blocks; added some # }{ labels to help debugging.
	* server/gnash.h: document enclose_transformed_rect() function.
                     
2006-10-12 Markus Gothe <nietzsche@lysator.liu.se>
                     
	* libbase/postscript.cpp, libbase/triangulate_impl.h, libbase/tu_math.h
	  libbase/utility.h, libgeometry/collision.cpp, libgeometry/cull.cpp,
	  libgeometry/geometry.cpp, libgeometry/kd_tree_dynamic.cpp, 
	  libgeometry/kd_tree_packed.cpp: Removed special-SGI std-declareation.
	  std::math_function in-code instead.
	* server/asobj/Math.cpp, libbase/tu_math.h: Fix for !__GNUC__.

2006-10-12 Sandro Santilli <strk@keybit.net>

	* server/dlist.{h,cpp}: dump() inpsector correctly made const.

2006-10-12 Patrice Dumas <pertusus@free.fr>

	* testsuite/Makefile.am: only build libgnashtestsuite.la
	  on 'make check'.

2006-10-12 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: made .swf testfiles
	  dependencies for the corresponding runners.
	* testsuite/misc-ming.all/Makefile.am,
	  testsuite/misc-ming.all/PlaceObject2Test.c,
	  testsuite/misc-ming.all/ming_utils.c,
	  testsuite/misc-ming.all/ming_utils.h:
	  moved ming utility function from test file to ming_utils.

2006-10-12 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac: Check if strlcpy and strlcat already is defined.
	  Fixes problems with redefinition on systems where they exists.

2006-10-12 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_agg.cpp: added missing config.h include,
	  fixed mispelled HAVE_AGG_SCANLINES_COMPOUND_LAYERED
	* gui/fbsup.h, gui/fb.cpp: moved class documentation from
	  implementation to header file, for better doxygen consumption.

2006-10-12 Patrice Dumas <pertusus@free.fr>

	* configure.ac: check for KDE stuff if klash build is
	  requested.

2006-10-12 Sandro Santilli <strk@keybit.net>

	* gui/Makefile.am, libbase/Makefile.am,
	  testsuite/libbase/Makefile.am, utilities/Makefile.am:
	  removed BOOST_LIBS as we're not using them anymore.
	* macros/curl.m4: define USE_CURL if curl libs are found
	* server/StreamProvider.cpp: rely on USE_CURL from config.h
	  so we're sure we won't end up with undefined references.
	* plugin/plugin.cpp: raise maxargc to 16, split -r3
	  into two arguments (-r) and (3).

2006-10-11 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac: Check for __FUNCTION__, __PRETTY__FUNCTION and 
	  __func__.
	* libbase/tu_types.h, plugin.h: Redefine __FUNCTION__.

2006-10-11 Sandro Santilli <strk@keybit.net>

	* testsuite/Makefile.am: descend in actionscript.all last
	  (quick hack to avoid premature failure of check run)
	* testsuite/libbase/Makefile.am: use $(top_builddir) to find
	  .la files, don't use -I for libs!

2006-10-11 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/Makefile.am: added the new files,
	  fixed yet another $(top_srcdir) misuse.
	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c,
	  testsuite/misc-ming.all/ming_utils.c,
	  testsuite/misc-ming.all/ming_utils.h:
	  extracted useful Ming functions from a single test, for reuse.

2006-10-11 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_agg.cpp: fixed typo in compatibility
	  layer inclusion.
	* configure.ac, Makefile.am, macros/agg.m4: report need for
	  AGG compatibility layer.

2006-10-11 Sandro Santilli <strk@keybit.net>

	* macros/gtkglext.m4: added missing -L to GLEXT_LIBS when
	  --with-glext-lib is given.
	* backend/render_handler_agg.cpp:
	  use HAVE_AGG_SCANLINES_COMPOUND_LAYERED define to toggle inclusion
	  of compatibility header.
	* macros/agg.m4: check availability of the
	  render_scanlines_coumpound_layered function and set
	  HAVE_AGG_SCANLINES_COMPOUND_LAYERED accordingly.
	* configure.ac: exit with error on invalid gui/renderer selection
	  combination.

2006-10-11 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/Makefile.am, testsuite/Makefile.am, gui/Makefile.am,
	  libamf/Makefile.am, libgeometry/Makefile.am, plugin/Makefile.am,
	  plugin/klash/Makefile.am, server/Makefile.am, utilities/Makefile.am,
	  server/asobj/Makefile.am, server/parser/Makefile.am:
	  Added $(top_builddir).

2006-10-11 Sandro Santilli <strk@keybit.net>

	* server/asobj/Global.cpp (as_global_parseint): fixed invalid
	  free.

2006-10-11 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/DefineEditTextVariableNameTest-Runner.cpp,
	  testsuite/misc-ming.all/Makefile.am: first movie tester.
	* testsuite/Makefile.am, testsuite/MovieTester.cpp,
	  testsuite/MovieTester.h: initial implementation of
	  a movie tester class.

2006-10-11 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.h: added getDisplayList() method usefull
	  for testing.
	* server/edit_text_character.{cpp,h}: implemented get_width() and
	  get_height().
	* server/character.h: added comment to get_width() and get_height()
	  virtual function (return in TWIPS). added a warning log when
	  a subclass did not override these.
	* macros/gtk2.m4: fix handling of --with-gtk2-libs (and commented-out
	  the caching call due to ignorance about it :)
	* configure.ac: print GTK, PANGO and GLIB and ATK variables if gtk
	  gui is requested (even if not with opengl renderer)
	* configure.ac, testsuite/Makefile.am, testsuite/server/Makefile.am,
	  testsuite/server/MatrixTest.cpp: added initial unit test for
	  matrix class.
	* server/matrix.{cpp,h}: added equality and output operators.
	* server/Makefile.am, server/gnash.h, server/matrix.cpp,
	  server/matrix.h, server/movie.h, server/types.cpp:
	  moved matrix class in its own files and added/fixed
	  documentation.

2006-10-11 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/agg.m4: Added /usr/pkg/include.
	* testsuite/server/Makefile.am: Fixed bug.
	* libbase/log.cpp: Fixed lightweight locking.

2006-10-10 Sandro Santilli <strk@keybit.net>

	* server/character.h, server/generic_character.h,
	  server/sprite_instance.cpp, server/sprite_instance.h,
	  server/parser/character_def.h, server/parser/shape_character_def.cpp,
	  server/parser/shape_character_def.h:
	  const-corrected get_height(), get_height_local(), get_width() and
	  get_width_local()

2006-10-10 Sandro Santilli <strk@keybit.net>

	* testsuite/check.h: added check() macro
	* testsuite/misc-ming.all/DefineEditTextVariableNameText.c:
	  added traces of some _width and _height proprieties.
	* server/dlist.h: added const version of get_character_by_name
	  and size() methods.

2006-10-10 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/sdl.m4: Removed AC_DEFUN([GNASH_PATH_SDL_MIXER]. Added
	  AC_MSG_RESULT(VERSION).
	* macros/zlib.m4: Added AC_MSG_RESULT.
	* macros/atk.m4: Added AC_MSG_RESULT. Fixed detection 
	  (I love pkg-config).
	* macros/sdl.m4: Added pkg-config-support.
	* macros/ogg.m4: Pkg-config tweaks.
	* macros/boost.m4: AM_CONDITIONAL should be set IFF headers are found.
	  Added /usr/pkg/include to paths.
	* macros/curl.m4: Added id-tag.
	* macros/glibmm.m4,  macros/libXML++.m4: Removed!
	* macros/glib.m4: Extended pkg-config support.
	* macros/gtk2.m4: Extended pkg-config support.
	* macros/cairo.m4: Extended pkg-config support.
	* macros/gtkglext.m4: Extended pkg-config support.
	* configure.ac: #define HAVE_STRINGCASECMP 1, Fixed BOOST.

2006-10-10 Sandro Santilli <strk@keybit.net>

	* testsuite/Makefile.am, testsuite/check.h,
	  testsuite/libbase/URLTest.cpp, testsuite/libbase/Makefile.am:
	  Moved dejagnu utility macros into a separate header file
	  (check.h) and updated URLTest so to use that.

2006-10-10 Sandro Santilli <strk@keybit.net>

	* server/parser/edit_text_character_def.h: specified coordinate space
	  for get_width and get_height return values.
	* backend/render_handler.h: doxygen comments cleanup (ensure briefs)
	* server/text.cpp: added some debugging labels, you can enable
	  them defining GNASH_DEBUG_TEXT_RENDERING (just a placeholder
	  as we'll eventually need to fix the text antialiasing problem)

2006-10-10 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: Added asserts for parameters and
	  fixed draw_poly() which was always filling the polygon.

2006-10-10 Sandro Santilli <strk@keybit.net>

	* configure.ac: fix USE_FFMPEG and USE_MAD defines.
	* gui/Makefile.am: refer to the ico file in CVS...
	* macros/agg.m4: added missing result of headers check; add a
	  a check for need of a compatibility layer (testing)
	* macros/ffmpeg.m4: use libdts and libavutil if found. don't look
	  for any of them if pkg-config could find out by himself.
	* configure.ac: added --with-mp3-decoder, only check for mp3 decoder
	  if needed.
	* backend/Makefile.am: HAVE_FFMPEG => USE_FFMPEG_ENGINE,
	  HAVE_MAD => USE_MAD_ENGINE
	* doc/C/sources.xml: documented --with-mp3-decoder (replaces the
	  missing --enable-engine)

2006-10-09 Sandro Santilli <strk@keybit.net>

	* gui/gtk.cpp, gui/gtksup.h: fixed run() method to honour
	  gui.h interface (removed argument, unused anyway)

2006-10-09  Rob Savoye  <rob@bertha.welcomehome.org>

	* doc/C/internals.xml: Add libgui mention.
	* doc/C/sources.xml: Add info about agg, ffmpeg, and boost
	  dependancies and configure options.
	* doc/C/gnash.xml: Update out of date version number.
	
	* plugin/plugin.cpp: Pass -r 3 to the player so we have sound when
	  using the plugin.
	* utilities/Makefile.am: Optionally add the sound engine flags to
	  the link list.
	* gui/Makefile.am: Optionally add the sound engine flags to the
	  link list.	
	* macros/ffmpeg.m4: Rewrite to support new --enable-engine
	  option. Look for libavcodec, libavutil, and libdts seperately,
	  they aren't necessarily in the same package
	* macros/mad.m4: Remove --enable-mad option, use
	  --enable-engine=mad now instead. Don't define USE_MAD here.
	* configure.ac: Add --enable-engine to select the decoding engine
	  to use for sound support. use sound_engine in addition to
	  sound_handler.

	* macros/zlib.m4: Update test to use AC_CHECK_HEADER and
	AC_CHECK_LIB correctly. For bug #17954.

2006-10-09 Rob Savoye <rob@bertha.welcomehome.org>

	* macros/agg.m4, boost.m4, cairo.m4, curl.m, ffmpeg.m4,
	  gstreamer.m4, gtkglext.m4, libXML.m4, mad.m4, 
	  pango.m4, png.m4, sdl.m4, zlib.m4: Add /opt/local/include to all
	  include paths, and /opt/local/lib for opendarwin.
	* macros/atk.m4, gtk2.m4, ogg.m4: Add /opt/local/include to all
	  include paths, and /opt/local/lib for opendarwin. Use pkg-config
	  if it exists. 

2006-10-09 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_agg_compat.h: added compatibility
	  header for agg package found in debian testing.
	* gui/fb.cpp: implemented correct timing

2006-10-09 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.h, gui/fb.cpp: Added header file
	  for create_render_handler()

2006-10-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui: Some more cleanup. Work KdeGui in a usable state.

2006-10-09 Sandro Santilli <strk@keybit.net>

	* gui/fb.cpp, gui/fbsup.h: fixed createWindow() function to reflect
	  new Gui interface. Removed unused parameters warnings.
	* macros/gstreamer.m4: fix invocation of pkg-config (use it IFF
	  PKG_CONFIG is set, not if it is NOT set :/)
	* gui/gui.h: forced generation of brief description for doxygen.
	* backend/sound_handler_sdl.h: removed unused <ffmpeg/avformat.h>
	  include.
	* configure.ac: add some package names for required ffmpeg libs.
	  (names for yum are missing).

2006-10-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui: First attempt at a cleanup of Gui and friends; document
	  class Gui. Adjust related classes to match the changes to Gui.
	* gui/sdl.cpp: Fix the flipped OpenGL rendering bug.

2006-10-09 Sandro Santilli <strk@keybit.net>

	* macros/ffmpeg.m4: check for libdts too (required); always run
	  the standard AC_CHECK_LIB.
	* macros/ffmpeg.m4: don't force linking of libavutil, don't trash
	  results of a previous detection.
	* configure.ac: don't check for gstreamer unless gst sound
	  was requested.

2006-10-09 Markus Gothe <nietzsche@lysator.liu.se>

	* macros/ogg.m4, macros/ffmpeg.m4: Removed $pkg.

2006-10-09 Sandro Santilli <strk@keybit.net>

	* backend_render_handler_agg.cpp: commented out unused
	  get_cache_of() method (relies on uncommitted changes to
	  character class); fixed draw_shape_character_old to allow
	  build.
	* backend/render_handler_agg.cpp (line_style_width):
	  log unimplemented (current code assigned to undefined variable).
	* configure.ac: don't complain about GtkGLExt unless GTK/opengl
	  setup is requested.
	* configure.ac: use better warning messages about SDL sound handling
	  and ffmpeg/mad choices.
	* configure.ac: fixed refs to the obsoleted --enable-mp3 switch
	  and $mp3 variable.
	* configure.ac: GLIB is needed also for GST sound, not only
	  for GTK gui (anything else?)
	* macros/ogg.m4: use PKG_CONFIG *after* having manually looked.
	  this prevents the checks for actual existance of the lib from
	  confusing an LDFLAG with a path, resulting in an error (LDFLAGS
	  contain spaces).
	* backend/render_handler.h, backend/render_handler_agg.cpp,
	  backend/render_handler_tri.cpp, backend/render_handler_tri.h:
	  Changed corner_count argument of draw_poly() method to an
	  unsigned type (fixes some compiler warnings, and seems more 
	  correct to me).

2006-10-08 Markus Gothe <nietzsche@lysator.liu.se>

	* server/parser/shape_character_def.cpp: removed unused include.
	* server/parser/shape_character_def.h: Added ID-tag. removed unused 
	  include.
	* backend/render_handler_tri.cpp: added id-tag. static_cast from float
	  to short int. Mem-fixes + Scoping.
	* backend/render_handler_agg.cpp: added id-tag, static_cast to int16*.
	* backend/render_handler_tri.h: added id-tag.
	* backend/render_handler.h: added virtual desctror and id-tag.
	* server/asobj/string.cpp, server/fontlib.cpp: static_cast<int>().
	* server/edit_text_character.cpp: static_cast<uint16_t>().
	* libbase/image_filters.cpp: static_cast<int>() + C++-mem-handling.
	
2006-10-07 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/sound_handler_sdl{.cpp, .h}: Code cleanup: move declarations
	  into a seperate header file.

2006-10-07 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_tri.{h,cpp}: moved initialization
	  of static const float from header to implementation (required
	  by ISO C++ for non-integral types).

2006-10-07 Udo Giacomozzi <udo.gnash@nova-sys.net>

	* server/render.h, server/shape.h, server/styles.h, 
	  server/parser/character_def.h, backend/render_handler.h, 
	  server/edit_text_character.cpp, server/render.cpp, 
	  server/shape.cpp, server/styles.cpp, server/text.cpp,
	  server/parser/morph2_character_def.cpp,
	  server/shape_character_def.cpp:
	  Changed to support new renderer design

2006-10-07 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* Makefile.am, configure.ac, backend/Makefile.am, 
	  backend/sound_handler_gst.cpp, backend/sound_handler_sdl.cpp,
	  macros/ffmpeg.m4, macros/mad.m4, plugin/Makefile.am, 
	  server/gnash.h, server/swf/tag_loaders.cpp, 
	  utilities/Makefile.am: Commited the new soundbackend, based
	  on SDL and optionally ffmpeg or libmad. Also changed the
	  buildsystem to reflect the change.

2006-10-07 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Replace --enable-lotsa-warnings with --enable-strict,
	  because strict is a more descriptive name for what lotsa-warnings
	  actually does.

2006-10-07 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac: Fixed typo. '!=' -> '='.
	* macros/ffmpeg.m4, macros/gstreamer.m4: check if pkg --exists.
	* macros/sdl.m4: Fixed finding libpath.
	* macros/atk.m4: Typo.
	* plugin/plugin.h: Define __FUNCTION__ and __PRETTY_FUNCTION__ if not.
	* configure.ac: Check and set #SIZEOF_SIZE_T.
	* backend/Makefile.am: Include XML_{CFLAGS,LIBS} for GST.

2006-10-07 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* configure.ac: Fixed typo, so that we check for OpenGL when 
	  it is the selected renderer.
	* backend/Makefile.am: Fixed type, so that the OpenGL libs 
	  are linked.

2006-10-06  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Make config tests for gui or rendered enabled or
	  disabled based on the selected ones. Define all conditional
	  variables here, since the tests may not get executed now. This
	  makes configuring faster.
	* backend/Makefile.am: Add AGG support.
	* gui/Makefile.am: Add AGG support.
	* gui/README: Add Framebuffer and AGG notes.
	* macros/cairo.m4, ffmpeg.m4:, gtkglext.m4, kde.m4, opengl.m4:
	  Don't define conditional variables here.

2006-10-06 Sandro Santilli <strk@keybit.net>

	* server/render.cpp: don't abort when parsing w/out any 
	  renderer registered (the NullGui will rely on this)
	* gui/sdl.cpp (run): use _xsize, _ysize when notifying mouse move.
	* gui/gtk.cpp (motion_notify_event): take xscale/yscale
	  into account, (configure_event): invoke Gui::resize_view
	  with an object.
	* gui/gui.{h,cpp}: split _scale into x/y components,
	  resize_view method made non-static so it can update
	  _xscale and _yscale.

2006-10-06 Markus Gothe <nietzsche@lysator.liu.se>

	* server/ref_counted, libbase/ref_counted.h: Moved file.
	* server/Makefile.am: Removed ref_counted.h.
	* server/impl.cpp, server/ref_counted.h: Moved code to ref_counted.h

2006-10-06 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/Makefile.am: Automake directives may not be indented, so remove
	  the indentation.

2006-10-06 Sandro Santilli <strk@keybit.net>

	* libbase/log.cpp: remove useless xml includes
	* gui/Makefile.am: don't link against unecessary libs
	* backend/Makefile.am: don't link against unecessary libs

2006-10-06 Hannes Mayr <hannes.mayr@indunet.it>

	* macros/jpeg.m4: fixed typo.

2006-10-05 Patrice Dumas <pertusus@free.fr>
	
	* testsuite/misc-ming.all/Makefile.am: Change clean to clean-local.
	* packaging/redhat/gnash.spec: Add new buildrequires in specfile
	  and use gstreamer sound backend.
	* libbase/Makefile.am: Remove reference to smart_ptr.hpp 

2006-10-05  Rob Savoye  <rob@bertha.welcomehome.org>
	
	* configure.ac: Add --enable-write option to optionally write the
	  Flash movie to disk when using the plugin.
	* plugin/plugin.h, plugin.cpp: Optionally write the streaming
	  Flash movie to disk.
	* macros/boost/m4: Look for the Boost thread library using a
	  variety of names.
	* macros/boost.m4: Also look for libboost_thread-mt if
	  libboost_thread doesn't exist.

2006-10-05 Sandro Santilli <strk@keybit.net>

	* server/as_object.cpp (setPropFlags): added support for
	  property arg being a comma-separated list string, minor
	  cleanups to reduce memory copies.

2006-10-05 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/log.cpp: Added #define BOOST_HAS_THREADS.
	* libbase/smart_ptr.hpp: Removed.

2006-10-05 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp: handle print requests (with an
	  "unimplemented" message, but better then nothing)
	* testsuite/actionscript.all/swf_exists.exp: build and run
	  each test with SWF target versions 5 to 7.

2006-10-05 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/swf_exists.exp: allow inclusion
	  of non-text chars in messages (needed to also print line
 	  number of tests).

2006-10-05 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/swf_exists.exp: add test filename
	  in output.

2006-10-05 Sandro Santilli  <strk@keybit.net>

	* testsuite/actionscript.all/swf_exists.exp: make compatible
	  with expect/tcl found in debian stable.
	* gui/gnash.cpp: fixed typo in usage string (-k for height)

2006-10-04 Sandro Santilli  <strk@keybit.net>

	* server/swf/ASHandlers.cpp: cleanly handle recursion (with
	  loops check) in enumerate actions.
	* server/asobj/Global.cpp (as_global_object_ctor): fix
	  copy constructor of the Object class.
	* testsuite/actionscript.all/Object.as: added copy-reference
	  tests.
	* server/as_object.cpp (set_member_default): minor cleanups.
	* testsuite/libbase/Makefile.am: added required boost lib
	  (couldn't find a way to have the dependency derived from
	  libgnashbase.la)
	* libbase/Makefile.am: added required boost libs
	* testsuite/actionscript.all/Object.as: add enumeration test.

2006-10-04 Sandro Santilli  <strk@keybit.net>

	* server/asobj/Global.cpp (as_global_assetpropflags):
	  delegate work to as_object::setPropFlags().
	* server/as_object.{cpp,h}: add setPropFlags() method.
	* server/xml.h (get_member): invoke get_member_default() when
	  the requested member is not a builtin.
	* testsuite/actionscript.all/Object.as: add test for
	  getter/setter (addProperty)

2006-10-03 Sandro Santilli  <strk@keybit.net>

	* gui/NullGui.h: changed constructor to take do_loop arg.
	* gui/Player.cpp: propagate the do_loop setting to the NullGui
	  (gnash -r0 -1 works now)

2006-10-03 Sandro Santilli  <strk@keybit.net>

	* server/asobj/Global.cpp (as_global_assetpropflags):
	  removed complain about ASSetProfFlag not implemented
	  for a NULL property argument (seems actually implemented)
	* server/swf/ASHandlers.cpp (ActionEnumerate): log 'testing'
	  rather then 'unimplemented' (seems actually working).

2006-10-03 Patrice Dumas <pertusus@free.fr>

	* testsuite/actionscript.all/Makefile.am,
	  testsuite/libbase/Makefile.am:
	  - distribute XMLNode.as, *.as files included in other *.as files,
	    *.swf used in checks, but not generated from .as.
	  - use CLEANFILES and clean-local: instead of a rewritten
	    'clean' target.

2006-10-03 Rob Savoye <rob@bertha.welcomehome.org>

	* plugin/plugin.cpp: Use cout instead of dbglogfile to reduce
	  dependancies.
	* plugin/Makefile.am: Don't link in log.cpp directly.
	* plugin/plugin.cpp: Use cout instead of Gnash debugging library
	  since Firefox doesn't print to stdout anyway unless you build from
	  source. This removes all dependancies on Gnash libraries.
	* macros/boost.m4: Look for mutex.hpp instead of weak_ptr.hpp.
	* configure.ac: Print the packages to install to add Boost
	  threads.
	
	* gui/Makefile.am: Add BOOST_CFLAGS and BOOST_LIBS.
	* libbase/Makefile.am: Add BOOST_CFLAGS and BOOST_LIBS.
	* utilities/Makefile.am: Add BOOST_CFLAGS and BOOST_LIBS.
	* libbase/log.cpp: Use Boost::mutex to make debug logging support
	thread-safe.

2006-10-03 Sandro Santilli  <strk@keybit.net>

	* gui/gnash.cpp (usage): document -j and -k switches.
	* backend/render_handler_cairo.cpp: removed compiler warnings.

2006-10-03 Patrice Dumas <pertusus@free.fr>

	* gui/Makefile.am: add gtk_glue.h to GTK_SRCS, comment
	  out missing kde_glue_cairo files.

2006-10-03 Sandro Santilli  <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: fixed clean rule,
	  avoid to build .swf movies by a simple 'make' call.

2006-10-03 Patrice Dumas <pertusus@free.fr>

	* Makefile.am, libbase/Makefile.am, testsuite/libbase/Makefile.am,
	  testsuite/misc-ming.all/Makefile.am:
	  simplify check handling by putting testsuite in SUBDIRS and mark;
	  check programs as check_ instead of noinst_; add smart_ptr.hpp to
	  distributed files

2006-10-03 Sandro Santilli  <strk@keybit.net>

	* testsuite/libbase/NoSeekFileTest.cpp: fixed test, added test
	  for named cache file.
	* testsuite/libbase/Makefile.am: improved clean rule.
	* libbase/noseek_fd_adapter.cpp: fixed named-cache operation
	  (cache file was not opened for read)

2006-10-03 Patrice Dumas <pertusus@free.fr>
	
	* macros/ffmpeg.m4: Fixed failure.

2006-10-03 Sandro Santilli  <strk@keybit.net>

	* libbase/noseek_fd_adapter.{cpp,h}: accept const char* as 
	  cache filename.
	* server/parser/movie_def_impl.{cpp,h}: wiped out SDL threads stuff.

2006-10-03 Sandro Santilli  <strk@keybit.net>

	* server/parser/movie_def_impl.cpp (create_instance):
	  ensure frame0 has been loaded before attempting to
	  execute the actions therein.
	* server/parser/movie_def_impl.h: documented weird
	  side-effect of creating an instance of a movie_def_impl
	  (execution of actions in first frame)

2006-10-03 Markus Gothe <nietzsche@lysator.liu.se>

	* server/parser/movie_def_impl.cpp: remove ensure_frame_loaded inlining.
	* server/xml.cpp, server/xmlsocket.{cpp,h}, 
	  server/impl.cpp, server/timers.h, server/spriteinstance.cpp,
	  server/asobj/MovieClipLoader.cpp, utilities/processor.cpp: 
	  tu_string -> std::string.

2006-10-03 Sandro Santilli  <strk@keybit.net>

	* server/sprite_instance.cpp: removed unused blocks of code.

2006-10-02 Sandro Santilli  <strk@keybit.net>

	* gui/Player.cpp (run): set base url before parsing.
	* server/swf/tag_loaders.cpp (import_loader):
	resolve relative urls against base url 
	* server/ActionExec.cpp: more SIZET_FMT usage.
	* server/samples => testsuite/samples:
	moved sample movies under testsuite.

2006-10-02  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Look for ffmpeg paths. Add --enable-sound=ffmpeg
	or --enable-sound=mad.
	* macros/ffmpeg.m4: Look for ffmpeg paths.
	* Makefile.am: Print ffmpeg paths for dumpconfig target.

2006-10-02 Bastiaan Jacques <bastiaan@bjacques.org>

	* libamf/amf.h: Prevent character type overflow warnings by using int
	type.
	* libbase/log.h: Implement macro SIZET_FMT, to be used in printf-like
	functions in which a size_t modifier is desired. This prevents
	compiler warnings.
	* all over the place: Utilise SIZET_FMT to clear up compiler warnings.

2006-10-02 Sandro Santilli  <strk@keybit.net>

	* server/fontlib.cpp: minor cleanups.
	* server/parser/movie_def_impl.cpp: set startup_frames to 0
	  (I feel lucky)
	* gui/Player.cpp, gui/Player.h: make sure the sound_handler
	  is not destroyed before use, initialize sound handling and
	  gui when run() is invoked, not a construction time.

2006-10-02 Bastiaan Jacques <bastiaan@bjacques.org>

	* plugin/plugin{.cpp, .h}: Pipe the SWF file to Gnash's standard
	  input.

2006-10-02 Markus Gothe <nietzsche@lysator.liu.se>

	* server/movie_interface.h, server/button_character_instance.h: 
	  Clean up.
	* server/gnash.h: Added include <string> for create_movie(tu_file*,
	  std::string&).
	* server/xml.cpp, server/xmlnode.cpp, server/xmlattrs.cpp,
	  server/as_value.h, server/asobj/Global.cpp: Don't include 
	  "smart_ptr.h".

2006-10-02 Sandro Santilli  <strk@keybit.net>

	* gui/Player.cpp: don't use cache files (they are broken anyway,
	  and with cache files disabled a bug is exposed that we must
	  fix before 0.7.2 release - #17385)

2006-10-02 Sandro Santilli  <strk@keybit.net>

	* gui/Player.{cpp,h}: some functions split and cleanups.

2006-10-02 Sandro Santilli  <strk@keybit.net>

	* gui/Player.cpp (Player::run): read from stdin when infile == "-"
	* server/impl.cpp, server/gnash.h: exposed a create_movie(tu_file*,
	  std::string&) function to let callers use arbitrary data sources
	  for movie loading.

2006-10-01 Bastiaan Jacques <bastiaan@bjacques.org>

	* testsuit/libbase/URLTest.cpp: Testcase for bug #17725.

2006-10-01 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gtk.cpp: Fix gtkgl assertion by making sure that the configure
	event isn't fired before the drawing area is OpenGL-initialised.

2006-10-01 Sandro Santilli  <strk@keybit.net>

	* server/builtin_function.h: doxygen dox.

2006-09-30  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/boost.m4: Look for Boost paths.
	* macros/agg.m4: Look for Antigrain paths.
	* configure.ac: Look for Antigrain and Boost headers and
	libraries. Add an "agg" option to --enable-renderer.
	* Makefile.am: Print AGG and Boost flags for the dumpconfig.

006-09-30 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/noseek_fd_adapter.cpp: fixed typecasting.

2006-09-30 Sandro Santilli  <strk@keybit.net>

	* libbase/noseek_fd_adapter.{h,cpp}, libbase/Makefile.am:
	  new tu_file adapter for nonseekable streams.
	* testsuite/libbase/NoSeekFileTest.cpp: test unit for the
	  noseek_fd_adapter.
	* testsuite/libbase/Makefile.am: enabled URLTest, NoSeekFileTest
	  and RcTest runs at 'make check' time (assigned to TEST variable)

2006-09-29 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac, libbase/container.h: fixed HAVE_STRCASECMP collision.
	* libbase/container.h: Fixed non-void function not returning warning.
	* server/xml.cpp: Fixed unused bool's ret = true;
	* libbase/curl_adapter.cpp: %u->%lu.  Add static_typecast.

2006-09-29 Sandro Santilli  <strk@keybit.net>

	* gui/Player.cpp: handle failures in movie loading.
	* backend/render_handler_cairo.cpp: fixed unused parameter warnings.
	* gui/gtk_glue_cairo.cpp: fixed unused parameter warnings.
	* server/movie.h: fix set_display_callback signature (was changed
	  when erroneously commented out unused parameter)
	* server/sprite_instance.h (attach_display_callback): removed
	  cast of set_display_callback() first arg (see above item).
	* server/parser/movie_def_impl.cpp: cast to void* when printing 
	  args with format %p
	* server/xmlsocket.cpp: fixed unused variable warning.

2006-09-29 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/triangulate_impl.h, server/ActionExec.cpp, server/fontlib.cpp
	  server/shm.cpp, server/xmlnode.cpp, server/parser/action_buffer.cpp,
	  server/swf/ASHandlers.cpp, utilities/processor.cpp: Added
	  static_cast<unsigned long>() for %lu.
	* gui/Player.h, server/action.h, server/as_value.h, server/asobj/Key.h,
	  server/movie_root.h, server/gnash.h, libbase/curl_adapter.h: 
	  Added DSOEXPORT.
	* libbase/triangulate_impl.h: %zd -> %lu.
	* libamf/amf.h: comma at end of enumerator list.
	* server/parser/action_buffer.cpp, server/ActionExec.cpp,
	  server/fontlib.cpp, server/swf/ASHandlers.cpp: %zd -> %lu.
	* utilities/parser.cpp, utilities/processor.cpp: Fixed definition of
	  getopt() to compile with -pedantic in gcc.
	
2006-09-28 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/smart_ptr.hpp: Added #define's to ensure it's not included
	  more than one time.
	* plugin/plugin.cpp: Fixed warning on redefing MIN()/MAX(). Added
	  Id:-tag.
	* gui/gtk_glue_gtkglext.cpp, gui/sdl.cpp, gui/kde_glue_opengl.cpp: 
	  Removed unused "OVERSIZE". Added id-tags.

2006-09-28 Sandro Santilli  <strk@keybit.net>

	* libbase/curl_adapter.cpp: set curl user agent (gnash-VERSION).
	* gui/Player.cpp: stop calling get_movie_info, and be really
	  streaming instead :)
	* gui/gtk.cpp: reintroduced ifdef hell in a struggle to 
	  have a renderer registered in Gui::init.
	* gui/sdl.cpp: fixed compiler warnings.
	* gui/gtk.cpp, gui/sdl.cpp: moved render handler creation
	  from createWindow() to init().
	* gui/gui.h: added doxygen comment about init() function
	  (the need to initialize the renderer)

2006-09-28 Sandro Santilli  <strk@keybit.net>

	* backend/render_handler_cairo.cpp, backend/render_handler_cairo.h:
	  set up a renderer::cairo namespace, split renderer construction
	  and window association (to be able to create a renderere before
	  knowing width and height of the window)
	* server/gnash.h: commented out create_render_handler_cairo
	  (see render_handler_cairo.h for new interface)
	* gui/gtk_glue_cairo.cpp : moved cairo window association code
	  from createRenderHandler() to prepDrawingArea().
	* gui/gtk.cpp : moved glue.prepDrawingArea call *after* window
	  creation.
	* gui/sdl.cpp : updated call for cairo handler creation.

2006-09-27 Markus Gothe <nietzsche@lysator.liu.se>
	
	* plugin/Makefile.am: set path to top-dir.
	* README: Clarifying that Mozilla has to be built with gtk2. Put an
	  emphasis on not trying with gtk1.

2006-09-27 Sandro Santilli  <strk@keybit.net>

	* plugin/Makefile.am: don't link the plugin lib
	  to any gnash library as it only calls it trough
	  a system() call. Include libbase/log.cpp in sources
	  as it is used.

2006-09-27 Sandro Santilli  <strk@keybit.net>

	* doc/C/gnash.xml: updated -u and -U dox.
	* server/asobj/MovieClipLoader.cpp (moviecliploader_loadclip):
	  resolve relative URLS against base url, not target movie url.

2006-09-27 Sandro Santilli  <strk@keybit.net>

	* server/impl.cpp, server/gnash.h: changed get_base_url() to
	  return a "const" URL.
	* server/swf/ASHandlers.cpp (CommonGetUrl): use base url
	  for relative urls resolution.

2006-09-27 Sandro Santilli  <strk@keybit.net>

	* plugin/plugin.cpp: use the new -U switch when invoking
	  gnash (pass it the base url)

2006-09-27 Sandro Santilli  <strk@keybit.net>

	* server/gnash.h, server/impl.cpp: added set_base_url() and
	  get_base_url() function.
	* gui/Player.{h,cpp}: added setBaseUrl method.
	* gui/gnash.cpp: added -U switch to set base url.

2006-09-27 Sandro Santilli  <strk@keybit.net>

	* plugin/plugin.cpp: cleanup and use of getCurrentPageURL()
	* plugin/mozilla-sdk/np_entry.cpp, plugin/mozilla-sdk/npn_gate.cpp:
	  Added NPN_GetStringIdentifier, NPN_GetProperty and
	  NPN_ReleaseObject interfaces (tested with firefox 1.0.4!)
	* gui/gui.cpp: added missing render_handler.h include, removed
	  gnash.h include
	* gui/gui.h: removed gnash.h include, added forward declaration
	  for render_handler
	* plugin/plugin.cpp, plugin/plugin.h: added getCurrentPageURL
	  method (still untested, but compiles fine).

2006-09-27 Vitaly Alexeev <tishka92@yahoo.com>

	* gui/Player.cpp,
	* libbase/getopt_win32.H,
	* libbase/getopt_win32.cpp:
	porting to win32

2006-09-27 Sandro Santilli  <strk@keybit.net>

	* configure.ac: don't require gtkglext unless GTK/opengl
	  combination is requested.

2006-09-26 Markus Gothe <nietzsche@lysator.liu.se>

	*  server/timers.cpp: Removed unused header. Added ID-tag.
	*  server/asobj/Key.h: Removed unused header. Added ID-tag.

2006-09-26 Sandro Santilli  <strk@keybit.net>

	* backend/Makefile.am, backend/render_handler.h,
	  backend/render_handler_cairo.cpp, backend/render_handler_ogl.cpp,
	  server/Makefile.am, server/gnash.h, server/render.h,
	  server/parser/Makefile.am:
	  moved render_handler class definition in it's own file
	  under backend/
	* server/asobj/MovieClip.cpp: removed useless includes.
	* backend/Makefile.am, backend/render_handler.h:
	  moved render_handler class definitino in it's own header.

2006-09-26 Sandro Santilli  <strk@keybit.net>

	* backend/Makefile.am, backend/gnash.cpp, backend/gtksup.cpp,
	  backend/gtksup.h: removed obsoleted files.
        * server/font.{cpp,h}: reduced headers inclusion.
	* backend/render_handler_cairo.cpp: make sure that
	  the bitmap_info we receive are actually bitmap_info_cairo
	  type (don't just assume it).
	* server/parser/bitmap_character_def.cpp,
	  server/parser/bitmap_character_def.h: changed interface
	  to construct bitmap_info at construction time, and to
	  take image::rgb(a) by std::auto_ptr (fixes memory leaks).
	* server/swf/tag_loaders.cpp: updated calls to bitmap_character_def.
	* server/parser/movie_def_impl.h: doxygen comments update.
	* server/Makefile.am, server/bitmap_character_instance.cpp,
	  server/bitmap_character_instance.h,
	  server/parser/bitmap_character_def.cpp,
	  server/parser/bitmap_character_def.h:
	  Removed bitmap_character_instance (bitmap characters never
	  get instantiated). Had bitmap_character directly derive
	  from ref_counted (it is *not* internally used as a character_def
	  becase it is stored in a separate container in movie_def_impl)

2006-09-25 Sandro Santilli  <strk@keybit.net>

	* gui/Player.cpp: make sure gui.createWindow() 
	  is called *before* actual parsing (quick solution
	  to our renderer calls within the parser)
	* server/parser/.cvsignore: new file
	* server/render.cpp: abort when bitmap_info creation is 
	  requested but a renderer is not defined.
	* server/Makefile.am, server/parser/Makefile.am,
	  server/bitmap_character_instance.cpp,
	  server/bitmap_character_instance.h,
	  server/parser/bitmap_character_def.cpp,
	  server/parser/bitmap_character_def.h:
	  Split bitmap_character into definition and instance;
	  had bitmap_character_def initialized by image::rgb
	  and image::rgba instead as with bitmap_info, made bitmap_info
	  creation a lazy process inside get_bitmap_info (to be called
	  only *after* parsing, when renderer is registered).
	* server/parser/movie_def_impl.cpp, server/parser/movie_def_impl.h,
	  server/parser/movie_definition.h, server/parser/sprite_definition.h:
	  Renamed movie_definition methods to add/get bitmap_character_*defs*
	* server/generic_character.h, server/styles.cpp,
	  server/parser/morph2_character_def.cpp,
	  server/swf/tag_loaders.cpp:
	  Updated creation of bitmap_character_def and calls to add them
	  to movie_definitions.

2006-09-25 Vitaly Alexeev <tishka92@yahoo.com>

	* gui/Player.cpp: reverted

2006-09-25 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/getopt.c => libbase/getopt_win32.cpp.
	* libbase/getopt.h => libbase/getopt_win32.h:
	  renamed to avoid collision with standard header file.

2006-09-25 Vitaly Alexeev <tishka92@yahoo.com>

	* gui/sdl.cpp, gnash.cpp, Player.cpp,
	* libbase/getopt.c, getopt.h:
	porting to win32
	
2006-09-24 Sandro Santilli  <strk@keybit.net>

	* server/edit_text_character.{h,cpp}: added private
	  registerTextVariable() method to handle variablenames.

2006-09-24 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/ogl.cpp: Removed unsed TU-file.
	* libbase/tu_opengl_includes.h: Fixed Darwin glx.h-include, removed
	  PROC_NAME_PREFIX.
	
2006-09-23 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/Makefile.am: libgnashplayer.so uses symbols from libgnashgui.so
	and linking should reflect this relationship.

2006-09-23 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/log{.cpp, .h}: Implement LogFile << unsigned long, so the
	build will succeed for platforms where size_t is defined to unsigned
	long.

2006-09-23 Vitaly Alexeev <tishka92@yahoo.com>

	* server/sprite_instance.cpp, gnash.h,
	* server/parser/movie_def_impl.cpp, sprite_definition.cpp:
	The improved version of create_empty_movieclip().
	Thanks Sandro Santilli

2006-09-23 Sandro Santilli  <strk@keybit.net>

	* gui/Player.cpp: avoid using get_movie_info, so we don't
	  open the stream twice (including curl if it's a remote url)

2006-09-23 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/smart_ptr.hpp: Imported and cleaned-up from boost.
	
2006-09-23 Sandro Santilli  <strk@keybit.net>

	* gui/Makefile.am, gui/gnash.cpp: build libgnashplayer, have gnash
	  executable use the new class.
	* gui/gtk.cpp, gui/gtksup.h, gui/gui.h, gui/sdl.cpp, gui/sdlsup.h:
	  const-corrected createWindow() function.
	* gui/Player.{h,cpp}: new class to simplify player startup.
	* gui/gnash.cpp, gui/sdl.cpp: moved parsing of -c switch from
	  gnash to sdl gui.

2006-09-22 Patrice Dumas <pertusus@free.fr>

	* testsuite/Makefile.am, testsuite/actionscript.all/Makefile.am,
	  testsuite/libbase/Makefile.am: fix make distcheck.

2006-09-22 Sandro Santilli  <strk@keybit.net>

	* plugin/mozilla-sdk/np_entry.cpp, plugin/mozilla-sdk/npp_gate.cpp,
	  plugin/mozilla-sdk/pluginbase.h: commented out unused parameters.

2006-09-21 Vitaly Alexeev <tishka92@yahoo.com>

	* server/sprite_instance.cpp: has completed
	  sprite_create_empty_movieclip(), added sprite_remove_movieclip()
	* server/parser/movie_def_impl.cpp: fixed range check error,
	 added DO_EMPTY_MOVIECLIP
	* web/gnash/snapshots/gnash-win32.zip: added zlibwapi.dll

2006-09-21 Sandro Santilli  <strk@keybit.net>

	* server/edit_text_character.cpp (ctor): set textfield variable
	  when available.
	* server/sprite_instance.{h,cpp}: added new set_textfield_variable
	  public method and a lazily-allocated map for textfield variables;
	  scan textfield variable names in both set_member and get_member.

2006-09-21 Sandro Santilli  <strk@keybit.net>

	* server/as_environment.{cpp,h}: parse_path() made a public
	  static method.
	* server/edit_text_character.cpp, server/edit_text_character.h,
	  server/parser/edit_text_character_def.cpp,
	  server/parser/edit_text_character_def.h:
	  get_default_name() => get_variable_name(), moved
	  warning about missing VariableName support closer to where
	  we should implement it.

2006-09-21 Udo Giacomozzi <udo.gnash@nova-sys.net>

	* server/shape.cpp (edge::tesselate_curve): don't add curves
	  on a straight edge.

2006-09-21 Sandro Santilli  <strk@keybit.net>

	* server/as_environment.{h,cpp}: doxygen comments, minor
	  interface cleanup (use references when appropriate)
	* server/parser/edit_text_character_def.cpp: added comment
	  about why we're doing the wrong thing with VariableName
	  (related to bug#17806)

2006-09-21 Deanna Phillips <deanna>

	* plugin/Makefile.am: removed unneeded explicit copy of shared
	  object for OBSD.

2006-09-21 Sandro Santilli  <strk@keybit.net>

	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c:
	  put the TextField inside a movieclip and it's associated
	  variable on the root. This is to ensure that using
 	  the variable name as an instance name would clearly NOT work;
	  equip with xtrace and print more info.
	* server/dlist.{cpp,h}: dump() method made public, print
	  character "name" as part of the dump.

2006-09-20 Sandro Santilli  <strk@keybit.net>

	* testsuite/misc-ming.all/DefineEditTextVariableNameTest.c,
	  testsuite/misc-ming.all/Makefile.am: added test for VariableName
	  attribute of DefineEditText.
	* server/parser/edit_text_character_def.cpp,
	  server/parser/edit_text_character_def.h: tu_string => std::string,
	  use new string reader methods.
	* server/stream.{h,cpp}: added memory-friendly string reader
	  functions.
	* server/parser/button_character_def.cpp: more symbolic
	  names.

2006-09-20 Vitaly Alexeev <tishka92@yahoo.com>

	* server/sprite_instance.cpp,
	* server/sprite_instance.h,
	* server/dlist.cpp,
	* server/dlist.h:
	added swapDepths(), getDepth(), unfinished createEmptyMovieClip() 
	methods
	
2006-09-20 Markus Gothe <nietzsche@lysator.liu.se>

	* Fixed bug submitted by Onkar Shinde.

2006-09-19 Vitaly Alexeev <tishka92@yahoo.com>

	* server/sprite_instance.cpp: added duplicateMovieClip() method
	
2006-09-19 Sandro Santilli  <strk@keybit.net>

	* testsuite/actionscript.all/gen-index.sh: Changed embed.html
	  page generation to reflect new "remote tracing" feature.
	* testsuite/actionscript.all/check.as: use rtrace rather
	  then xtrace when ONLINE is defined (must actually set 
	  the correct testreport.php url in order to work).
	* testsuite/actionscript.all/rtrace.as,
	  testsuite/actionscript.all/testreport.php:
	  code for online testcases automation.
	* server/asobj/Math.cpp: added missing "log.h" include
	* backend/render_handler_ogl.cpp: hush little compiler
	  (use explicit const_cast)
	* server/sprite_instance.cpp (sprite_hit_test): stub for hitTest() 
	* server/sprite_instance.cpp (call_frame_actions): fixed
	  premature deletion of action buffers (also optimized somehow).
	* testsuite/actionscript.all/Makefile.am,
	  testsuite/actionscript.all/gen-index.sh: generate
	  a page with all testcases for each SWF target.
	* testsuite/actionscript.all/Makefile.am,
	  testsuite/actionscript.all/Number.as:
	  new testcase (small, but already failing for gnash)
	* testsuite/actionscript.all/TODO: new file
	* server/swf/ASHandlers.cpp (ActionEqual): fixed behavior.
	* server/swf.h: Added info about ACTION_EQUAL.
	* server/swf/ASHandlers.cpp (CommonGetUrl): added comments about
	  relative url resolution "known" bug. Added parsing of method
	  bitfield flags and warnings about unsupported features.

2006-09-18 Sandro Santilli  <strk@keybit.net>

	* libbase/URL.cpp: removed call to set_workdir.

2006-09-18 Vitaly Alexeev <tishka92@yahoo.com>

	* libamf/amf.cpp: function must return a value
	* gui/sdl.cpp: Don't hog the CPU.
	* web/gnash/snapshots/gnash.zip: renamed to gnash-win32.zip
	* backend/sound_handler_sdl.cpp: fixed out of range bug
		
2006-09-18 Sandro Santilli  <strk@keybit.net>

	* server/swf/ASHandlers.cpp: added initial support for
	  GetUrl2 method 64.

2006-09-18 Patrice Dumas <pertusus@free.fr>

	* gui/gtksup.h: remove extra qualifier from private method.

2006-09-18 Sandro Santilli  <strk@keybit.net>

	* macros/curl.m4: always run AC_CHECK_HEADER and AC_CHECK_LIB
	* server/as_value.h: added is_null() method.
	* README: updated section about plugin compatibility.

2006-09-18 Samuel Lidn Borell <samuellb@bredband.net>

	* gui/gtk.cpp, gui/gtksup.h: Forward GTK keyboard events
	  (Patch #5393)

2006-09-18 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/container.h: #ifdef HAVE_STRCASECMP-bug-fix.
	* Fixed bug #17786...

2006-09-17  Rob Savoye  <rob@ute.welcomehome.org>

	* testsuite/actionscript.all/Makefile.am: Add test driver name to
	the command line. Don't pass --srcdir, runtest doesn't need it
	anymore, and it breaks the site.exp setting of the same value. 
	* testsuite/misc-ming.all/Makefile.am: Don't pass --srcdir,
	runtest doesn't need it anymore, and it breaks the site.exp
	setting of the same value. 
	* testsuite/actionscript.all/swf_exists.exp: Don't use the file
	name, just let makeswf use the default output file, out.swf.
	* Makefile.am: Don't have dejagnu as an option, just change to the
	testsuite directory and run make check.
	* configure.ac: Remove unused configure options. Have dumpconfig
	display if libCurl has RTMP support.
	* backend/Makefile.am: Remove dejagnu from AUTOMAKE_OPTIONS.
	* doc/C/appendix.xmlfdl-appendix.xml, gnash.xml,
	internals.xml, localconnection.xml, logging.xml,
	netconnection.xml, opcodes.xml, plugin.xml, rtmp.xml, sources.xml,
	: Change <code> to <emphasis>, as the xmlto tools on FC5 don't
	grok <code> anymore.
	* libamf/Makefile.am: Put amftest.cpp in EXTRA_PROGAMS.
	* libamf/amf.cpp, amf.h: Use unsigned char instead of signed char
	when pointing to RTMP message data.
	* libbase/container.cpp, container.h: Define STRCASECMP in the
	source file, not the header.
	* libbase/network.cpp: Fix the warning message about not binding
	to a port. Don't include fn_call.h or xml.h.
	* libbase/network.h: Don't include fn_call.h or xml.h.
	* macros/opengl.m4: Look in X11R6 too.
	* plugin/Makefile.am: Remove dejagnu from AUTOMAKE_OPTIONS.
	* server/asobj/NetConnection.h: Add private variables for the
	connect message to the server.
	* server/asobj/System.cpp, Video.cpp: Tweak the unimplemented
	messages.
	
2006-09-17 Patrice Dumas <pertusus@free.fr>

	* libbase/Makefile.am: Don't include anything from the server
	directory.
	* libbase/log.cpp: Don't include gnash.h.
	* libbase/network.h, cpp: Don't include xml.h.

2006-09-17 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/URL.cpp: Don't treat local filenames as query strings (bug
	#17725).

2006-09-17 Markus Gothe <nietzsche@lysator.liu.se>

	* autogen.sh: Applied patch from Mike Heffner.

2006-09-17 Bastiaan Jacques <bastiaan@bjacques.org>

	* plugin/plugin.cpp: add NULL checks to avoid attempting to create an
	std::string from a NULL character pointer (bug #17776).

2006-09-16 Patrice Dumas <pertusus@free.fr>

	* libbase/log.cpp, libbase/network.cpp, libbase/network.h:
	  removed useless includes.

2006-09-16 Sandro Santilli  <strk@keybit.net>

	* plugin/plugin.cpp: SIGINT => SIGTERM (fixes bug #17082)

2006-09-15 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase/tu_config.h: __declspec(dllimport) temporarily is
	  commented because of VC++ compiler problems.
	* web/gnash/snapshots/gnash.zip: added Standalone executable files
	  & dependences.
	* web/gnash/snapshots/gnash.exe, npgnash.dll: removed.
	
2006-09-15 Markus Gothe <nietzsche@lysator.liu.se>

	* Finished task #5848. Implementing GCC-visibility.

2006-09-14 Vitaly Alexeev <tishka92@yahoo.com>

	* server/swf/ASHandler.cpp: fixed bug #17738.
	
2006-09-14 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/URL.cpp: Fixed bug #17727.
	* configure.ac, libgeometery/bsp.cpp: Fixed bug #17748.
	* libbase/tu_types.h: Fixed bug #17749.
	* Removed usage of create_bitmap_info_empty().
	* server/asobj/Global.cpp, server/stream.cpp: Fixed mem leak.
	* libbase/container.{h, cpp}: fixed termination '0' -> '\0'.
	* backend/sound_handler_gst.cpp: Fixed mem-management.
	* Fixed mozilla-sdk for use with the actual mozilla >=1.7.13.
	* configure.ac: Check for GCC -fvisibility-support.
	* libbase/tu_config.h: Visibility-hack (DSOLOCAL and DSOEXPORT).

2006-09-13 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/smart_prt.h: Added dtor for weak_ptr.

2006-09-11 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase\URL.cpp: parsing of win32 path

2006-09-11 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase\URL.cpp: Current working directory of Flash is
	  a directory of the first swf file.
	* server\action.h, action.cpp: attach_extern_movie() is reanimated 
	* server\swf\ASHandlers.h, ASHandlers.cpp: loadMovie() should be 
	  compatible with Flash
	* server\impl.h: a bit cleanup
	
2006-09-09 Sandro Santilli  <strk@keybit.net>

	* plugin/plugin.cpp: removed the waitpid call again
	  (see bug #17082).

2006-09-08 Sandro Santilli  <strk@keybit.net>

	* plugin/plugin.cpp, plugin/plugin.h: wait for child pid
	  (no more zombies). Avoid killing pid == -1 on gnash error !

2006-09-08 Sandro Santilli  <strk@keybit.net>

	* gui/gnash.cpp: FlashVars == flashvars (this is how the browser
	  sends parameters)
	* plugin/plugin.cpp, plugin/plugin.h: added support for
	  passing parameters.
	* plugin/player.h: removed obsoleted file

2006-09-08 Markus Gothe <nietzsche@lysator.liu.se>

	* testsuite/movies.all/zoomhenge.swf: Added.
	* plugin/plugin.cpp: Declare maxargc as 'const'. Fixed memory 
	  management for char *argv[].

2006-09-02  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Check to see if libCurl supports RTMP.
	* macros/curl.m4: Add support to use curl-config. Look to see what
	protocols it supports.

2006-09-02 Sandro Santilli  <strk@keybit.net>
STRCASECMP
	* gui/gnash.cpp, doc/C/gnash.xml: added -P switch to set
	  contextual parameters (see
	  http://www.permadi.com/tutorial/flashVars/index.html) 
	* libbase/URL.{cpp,h}, testsuite/libbase/URLTest.cpp:
	  added support for query strings (+tests).
	* server/swf/ASHandlers.cpp (ActionGetUrl2): log a warning
	  when an undefined url parameter is on the stack.
	* server/as_value.h: added is_undefined() method.

2006-09-01 Sandro Santilli  <strk@keybit.net>

	* plugin/plugin.{cpp,h}: Call gnash with -u switch to set
	  original movies url.
	* gui/gnash.cpp, doc/C/gnash.xml: make the -u switch working
	  and documented.
	* server/gnash.h, server/impl.cpp:
	  Changed create_movie and create_library_movie to optionally
	  take a "real" url (for use with caches). If given, the "real"
	  url will be used as a label for the "movie library". Note that
	  no host-checking is performed on the "real" url (only the
	  "effective" url will be checked).
	* plugin/player.cpp: removed obsoleted file.

2006-09-01 Tomas Groth Christensen <tomasgroth@yahoo.dk>

        * doc/C/internals.xml: Small doc fixes.

2006-09-01 Sandro Santilli  <strk@keybit.net>

	* server/swf/ASHandlers.cpp (CommonGetUrl): support
	  relative urls (testing).
	* libbase/URL.{cpp,h}, testsuite/libbase/URLTest.cpp:
	  Added anchor support in URL class (+tests).

2006-08-31  Rob Savoye  <rob@bertha.welcomehome.org>

	* doc/C/Makefile.am: Add --encoding=us-ascii//TRANSLIT so control
	characters don't slide in that prevent db2x_texixml from working.
	
	* gui/images: New directory for images. Patch #5346.
	* gui/images/gnash_128_96.ico: New icon for GTK executable. Patch
	#5346.
        * gui/Makefile.am: Install icon image. Patch #5346.
        * gui/gtk.cpp: Add icon to GTK executable. Patch #5346.
        * gui/gtksup.h: Add methods for adding and finding pixmaps. Patch
	#5346.
	* plugin/Makefile.am: For OpenBSD, copy the actual shared libary
	when installing since libtool doesn't appear to do this. Baswed on
	patch #5345.

2006-08-31 Sandro Santilli  <strk@keybit.net>

	* server/swf/tag_loaders.cpp (frame_label_loader): added
	  primitive support for anchor-labels (just print a warning).

2006-08-31 Markus Gothe <nietzsche@lysator.liu.se>

	* server/parser/movie_def_impl.cpp: Removed 'using namespace std;'
	  since it's not needed and cause problems on non-gcc-compilers.
	* mozilla-sdk/include/jni.h: "using namespace std;" for va_list.
	* plugin/plugin.cpp: Added include for tu_types.h
	
2006-08-30 Patrice Dumas <pertusus@free.fr>

	* Patch for the doc system.

2006-08-30 Sandro Santilli  <strk@keybit.net>

	* libamf/amf.{cpp,h}: changed amf_element_t.data type to
	  'const' unsigned char. This fixed compiler warnings.
	* server/gstring.h, server/asobj/gstring.h,
	  server/string.cpp, server/asobj/string.cpp,
	  server/Makefile.am, server/asobj/Makefile.am:
	  Moved string class files to asobj lib.

2006-08-30 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase\tu_opengl_includes.h: added win32 opengl #define
	* libbase\jpeg.cpp: a cleanup
	* server\URLAccessManager.cpp: a cleanup
	
2006-08-30 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/tu_types.h: rededifine __FUCTION__
 	* libbase/rc.cpp: include tu_types.h where __PRETTY_FUNCTION__ is
	decl.
	* configure.ac: Check if sqrt() needs -lm.
	* libbase/tu_math.h: Fixed IRIX 6.5-compability.
	* server/asobj/Math.cpp: Include "tu_math.h"
	* server/asobj/Gmath.h: Deconfuse MIPSPRO/SGI/IRIX.
	* libgeometry/axial_box.h: Fixed picky-compiler warnings.
	* libbase/network.cpp: renamed struct sockaddr fsin since not
	allowed.
	* utilities/processor.cpp, utilities/parser.cpp: Compability fixes.
	* plugin/Makefile.am: Fixed bug that made non-gnu make crash.
	* autogen.sh: Don't run automake with '--gnu'. It'll figure it out
	self.

2006-08-29 Patrice Dumas <pertusus@free.fr>

	* packaging/redhat/gnash.spec: unusefull gnash-devel
	  subpackage removed; groups changed; other minor cleanups.

2006-08-29 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase\jpeg.cpp: fixed bug #17507

2006-08-29 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/sound_handler_gst.cpp, backend/sound_handler_sdl.cpp: 
	  added typecasting.
	* libbase/container.h Fixed bugs for compilers missing ext/hashmap.
	* libbase/log.h Fixed bugs for non-gcc-compilers.
	* libbase/tu_config.h: Added namespace to exit() since MIPSPro is
	  picky. 

2006-08-29 Sandro Santilli  <strk@keybit.net>

	* server/morph.cpp, server/morph.h,
	  Makefile.am: removed obsoleted files.

2006-08-28 Markus Gothe <nietzsche@lysator.liu.se>
	
	* Disabled building of static-libraries as default.
	* libbase/tu_opengl_includes.h: Modern Non-SGI OGL-ABIs include 
	  glext.h in gl.h.
	* Fixed isinf() and isnan() for platforms that doesn't include it
	in C++ (It however usually is in the later C99, esp. in IRIX).

2006-08-28 Sandro Santilli  <strk@keybit.net>

	* libbase/utility.{cpp,h} (dump_memory_stats): removed compiler
	  warning.
	* server/ActionExec.cpp, server/action.cpp, server/impl.cpp,
	  server/sprite_instance.h: removed "stream.h" inclusion.
	* server/morph.cpp: log_msg -> log_parse, minor indentations
	* server/parser/movie_def_impl.cpp (resolve_import):
	  fixed infinite loop.

2006-08-28 Markus Gothe <nietzsche@lysator.liu.se>
	
	* Merged in klash-patch sent by Patrice Dumas <pertusus@free.fr>.
	* Misc clean-ups in headers.
	* server/parser/action_buffer.cpp, server/tesselate.cpp, 
	  serasobj/System.cppver/ActionExec.cpp, libgeometry/bsp.cpp,
	  libbase/image.cpp, libamf/amf.cpp:
	  Removed unused <cstdlib>.

2006-08-27 Markus Gothe <nietzsche@lysator.liu.se>
	
	* server/swf/tagloaders, server/ActionExec.cpp
	  server/swf/ASHandlers.cpp, libgeometry/kd_tree_dynamic.cpp
	  libamf/amf.cpp, libamf/amftest.cpp: Changed '+= 1' to '++'.
	* Removed headers from log.{cpp,h} since it speed up compilation
	  time. Try avoiding unnecessary includes of <iostream> as much as
	  possible. 
	* utilities/parser.cpp, utilities/processor.cpp: Fixed strange -h 
	  output.

2006-08-27 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase\utility.h,
	* server\types.cpp, sprite_instance.cpp,
	edit_text_character.cpp, button_character_instance.cpp:
	Macromedia Flash changes infinite to zero when works a matrix

2006-08-27 Vitaly Alexeev <tishka92@yahoo.com>

	* backend\gnash.cpp,
	* server\swf\tag_loaders.h,
	* libbase\tu_opengl_includes.h,
	* libbase\image.h:
	porting to WIN32

2006-08-27 Markus Gothe <nietzsche@lysator.liu.se>

	* Merged in klash-patch sent by Patrice Dumas <pertusus@free.fr>.
	* configure.ac: Added "-cvs-BUILDDATE" to VERSION for making life 
	  more easy when people file bugs and such.
	* Fixed an issue with the moz-plugin, i.e. library-naming.
	* server/parser/movie_def_impl.cpp: Optimized freeing memory.
	* gui/gnash.cpp, plugin/player.cpp, utilities/parser.cpp, 
	  backend/gnash.cpp(deprecated!), utilities/processor.cpp:
	  Clean-up and minor bugfixes related to empty logfiles.

2006-08-27 Sandro Santilli  <strk@keybit.net>

	* server/movie_def_impl.{h,cpp}: fixed _swf_end_pos for compressed
	  movie (needed after zlib_adapter fix); enabled get_bytes_loaded.
	* libbase/zlib_adapter.cpp: fixed tell() function to include
	  header size.
	* Split button.{h,cpp} into button_character_instance.{cpp,h},
	  mouse_button_events.h and parser/button_character_def.{cpp,h};
	  headers inclusion shaking.

2006-08-26 Markus Gothe <nietzsche@lysator.liu.se>

	* server/asobj/Global.cpp, libbase/image.cpp: Found and fixed
	  memory leakage.
	* Optimized the zlib code, which is a bottleneck according to my
	  profiling.
	* Fixed macros/pthread.m4 for portability to other architectures. 
	  See: http://autoconf-archive.cryp.to/acx_pthread.html.
	* Added macros/archflag.m4 for optimizations. 
	  See: http://autoconf-archive.cryp.to/ax_gcc_archflag.html
	* server/render.cpp, server/xmlnode.cpp, server/xmlnode.h,
	  server/xmlattrs.cpp, server/xmlattrs.h, server/xml.h: 
	  Don't include "log.h" unless debugging is on. Speeding up 
	  compilation, especially on non-gcc compilers, since <iostream> 
	  is considered a hog.
	* server/as_enviroment.cpp, server/as_enviroment.h, 
	  server/movie_instance.cpp, server/timers.h, server/action.h
	  server/parser/bitmap_character_def.h, server/character.h
	  backend/gtksup.h, gui/sdlsup.h, gui/kdesup, gui/gtksup.h, 
	  gui/gui.cpp, libamf/rtmp.h, libbase/network.h, libbase/URL.cpp
	  plugin/plugin.h, server/swf/ASHandlers.h, server/xmlsocket.h
	  server/asobjs/Video.h, server/asobjs/TextSnapshot.h,
	  server/asobjs/System.h, server/impl.h, server/asobj/MovieClip.cpp
	  server/sound.cpp, server/string.cpp, server/textformat.h
	  server/shm.h: 
	  Remove "log.h" since not used.

2006-08-26 Sandro Santilli  <strk@keybit.net>

	* server/URLAccessManager.cpp (allow): always allow from local host.
	* server/morph2.{cpp,h}, server/parser/morph2_character_def.{cpp,h},
	  server/Makefile.am, server/parser/Makefile.am, server/impl.cpp,
	  server/swf/tag_loaders.cpp:
	  moved morph2 definition class to parser dir.
	* server/render.cpp: add a DEBUG_RENDER_CALLS macro to
	  enable function calls info log.

2006-08-25 Vitaly Alexeev <tishka92@yahoo.com>

	* server\character.h, dlist.h, edit_text_character.h,
	generic_character.h, movie.h, sprite_instance.h, button.cpp
	fixed events handling bug. 3kines.swf is played now.
	
2006-08-25 Markus Gothe <nietzsche@lysator.liu.se>

	* Misc header clean-ups...
	* Minor variable assignment optimizations.
	* libamf/rtmp.cpp: Replaced "stdlib.h" with <cstdlib>.
	* libbase/network.cpp: Always include <cerrno>.
	* plugin/plugin.cpp, plugin/player.cpp: #include <csignal>.

2006-08-25 Markus Gothe <nietzsche@lysator.liu.se>

	* gui/sdl.cpp, gui/kde.cpp, libbase/network.cpp: Replaced <iostream>
	  for speeding up compilation.
	* libbase/tu_file.cpp: Changed structs to classes.
	* server/gnash.h, backend/render_handler_xbox.cpp, libbase/tu_file.cpp
	  libbase/image.cpp, libbase/ogl.cpp, server/xmlsocket.cpp,
	  server/movie_interface.h, server/as_object.h, server/action.h:
	  libbase/utility.h, libbase/tu_types.h, libbase/tu_math.h, 
	  libbase/tu_file.h, libbase/dlmalloc.h, server/asobj/GMath.h:
	  Changed #include <X.h> to <cX>.

2006-08-25 Markus Gothe <nietzsche@lysator.liu.se>

	* backend/sound_handler_mp3.cpp, backend/sound_handler_sdl.cpp, 
	  backend/sound_handler_gst.cpp, backend/render_handler_xbox.cpp
	  backend/render_handler_xbox.cpp, backend/render_handler_d3d.cpp,
	  backend/render_handler_cairo.cpp, libbase/jpeg.cpp, 
	  libgeometry/kd_tree_dynamic.cpp: Changed structs to classes.
	* libbase/jpeg.cpp, libbase/utf8.cpp, libgeometry/kd_tree_dynamic.cpp,
	  libgeometry/bsp.cpp, plugin/player.cpp plugin/plugin.cpp: 
	  Changed #include <X.h> to <cX>.

2006-08-24 Markus Gothe <nietzsche@lysator.liu.se>
	
	* backend/render_handler_ogl.cpp: Changing structs to classes
	  with everything public, mostly for understanding and readability 
	  (it's the same thing in C++ afaik).
	* server/parser/movie_def_impl.cpp, backend/render_handler_ogl.cpp:
	  inlining unlock()/lock() and opengl_accessible().
	* Fixed task #5837.
	
2006-08-24 Sandro Santilli  <strk@keybit.net>

	* server/sprite_instance.cpp, server/swf/tag_loader.cpp,
	  server/parser/text_character_def.h,
	  server/parser/text_character_def.cpp,
	  server/text.h, server/text.cpp:
	  moved 'text_character_def' class under server/parser/

2006-08-24 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\URLAccessmanager.cpp, StreamProvider.cpp, dlist.cpp,
	* libbase\URL.cpp
	porting to win32

2006-08-24 Sandro Santilli  <strk@keybit.net>

	* configure.ac, gui/Makefile.am, gui/gtk.cpp, gui/gui.cpp,
	  server/Makefile.am, server/MovieClip.cpp, server/MovieClip.h,
	  server/Object.h, server/action_buffer.cpp, server/action_buffer.h,
	  server/bitmap_character_def.h, server/character_def.cpp,
	  server/character_def.h, server/edit_text_character_def.cpp,
	  server/edit_text_character_def.h, server/movie_def_impl.cpp,
	  server/movie_def_impl.h, server/movie_definition.h,
	  server/shape_character_def.cpp, server/shape_character_def.h,
	  server/sprite_definition.cpp, server/sprite_definition.h,
	  server/sprite_instance.h, server/asobj/Makefile.am,
	  server/asobj/MovieClip.cpp, server/asobj/MovieClip.h,
	  server/parser/Makefile.am, server/parser/action_buffer.cpp,
	  server/parser/action_buffer.h, server/parser/bitmap_character_def.h,
	  server/parser/character_def.cpp, server/parser/character_def.h,
	  server/parser/edit_text_character_def.cpp,
	  server/parser/edit_text_character_def.h,
	  server/parser/movie_def_impl.cpp, server/parser/movie_def_impl.h,
	  server/parser/movie_definition.h,
	  server/parser/shape_character_def.cpp,
	  server/parser/shape_character_def.h,
	  server/parser/sprite_definition.cpp,
	  server/parser/sprite_definition.h,
	  server/parser/text_character_def.h:
	Moved some of parser's files under their own dir/lib (not yet
	finished); also moved MovieClip under asobj/, where it belongs.

2006-08-23 Sandro Santilli  <strk@keybit.net>

	* server/swf_function.h, server/swf_function.cpp:
	  added missing include, out-lined set_length to avoid
	  action_buffer.h include.
	* server/impl.h, server/swf_event.h, sprite_instance.cpp:
	  moved swf_event class into its own header.
	* server/swf/ASHandlers.cpp (CommonGetUrl): simplified and fixed
	  URL parsing code by use of the URL class; added check for
	  NULL urls and comments about future improvements; use the
	  newly-exported URLAccessManager::allow function
	* server/URLAccessManager.h, server/URLAccessManager.cpp,
	  server/Makefile.am, server/StreamProvider.cpp:
	  moved URLAccessManager code into it's own file, export a
	  single allow(URL&) function of it, updated StreamProvider
	  accordingly

2006-08-23 Markus Gothe <nietzsche@lysator.liu.se>
	
	* server/movie_def_impl.cpp: Use pthread_cancel(pthread_self())
	  instead of pthread_exit(NULL).
	
2006-08-23 Sandro Santilli  <strk@keybit.net>

	* server/Makefile.am, server/movie_instance.cpp,
	  server/movie_instance.h, server/sprite_instance.cpp,
	  server/sprite_instance.h, server/movie_def_impl.cpp,
	  server/movie_root.cpp:
	  new 'movie_instance' class derived from 'sprite_instance'
	  and representing the "main" movie read from a SWF file.
	* libamf/amf.cpp, server/dlist.cpp: fixed compiler warnings, or
	  added some notes about problems arised from them.

2006-08-23 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac, plugin/Makefile.am: For OpenBSD, omit some linker
	options to successfully build the plugin.
	* plugin/plugin{.cpp, h}: Cleanup: Remove threading code, because it's
	broken and generally useless.

2006-08-23 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\sprite_instance.cpp: action_list.size() may be changed
	  due to actions

2006-08-23 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\dlist.cpp: That there was no crash gnash 
	we iterate characters through the copy of displaylist

2006-08-23 Vitaly Alexeev <tishka92@yahoo.com>
	
	* backend\render_handler_ogl.cpp: commented assert(bi->m_texture_id);
	 
2006-08-23 Markus Gothe <nietzsche@lysator.liu.se>
	
	* libbase/network.cpp, server/xmlsocket.cpp, 
	  server/shm.cpp: Fixed #include for fcntl.h so it conforms 
	  to the POSIX-standard.	
	* gui/sdl.cpp: Fixed basename() under IRIX.
	* libbase/tu_types.h: Fixed #include <sys/endian> under IRIX.
	* server/action.cpp: added extern "C" for "gdk/gdk.h".	
	* server/asobj/GMath.h:
	 Fixed #define __MATH_H__ under IRIX and other platforms.

2006-08-23 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\sprite_instance.cpp, sprite_instance.h:
	 The second attempt to fix goto_frame() bug
	
2006-08-22 Sandro Santilli  <strk@keybit.net>

	* server/dlist.cpp: removed signed/unsigned comparison warning.
	* server/gnash.h: removed unused parameter warnings.
	* server/render.h: doxygen comments.
	* libbase/Thread.cpp: removed unused parameter warnings.
	* server/as_value.cpp: removed const cast warning.
	* server/font.cpp, server/textformat.cpp:
	  removed unused parameter warning.
	* libbase/image.cpp: removed initialization order warning.
	* macros/kde.m4: never add -fno-rtti.

2006-08-22 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\sprite_instance: fixed goto_frame() bug (I hope :-) )
	
2006-08-21 Sandro Santilli  <strk@keybit.net>

	* server/swf/tag_loaders.cpp (do_init_action_loader):
	  fixed short read when not in verbose parse mode.
	* server/sprite_instance.cpp: fix compiler warnings.
	* server/movie_def_impl.{cpp,h}: use USE_SDL_THREADS macro
	  to switch between SDL and straight POSIX threads calls (defaults
	  to straight POSIX).

2006-08-21 Sandro Santilli  <strk@keybit.net>

	* gui/gnash.cpp: fix bug #17467
	* server/gnash.h: doxygen comments on render_handler struct
	* utilities/processor.cpp: don't show -vp and -va options if
	  verbose parsing and action is not compiled in (bug #17367).
	* gui/gnash.cpp: fix -vp when VERBOSE_ACTION is undefined (bug #17367).
	* server/movie_def_impl.cpp: implement MovieLoader::lock 
	  and MovieLoader::unlock for SDL. Fix MovieLoader::wait_for_frame
	  for SDL.
	* gui/sdl.cpp: fix movie advance delay
	* server/gnash.h: fixed compiler warning about initialization order.
	* server/movie_def_impl.cpp:
	  fixed SDL version of signal_frame_loaded.
	* server/movie_def_impl.cpp:
	  added LOAD_MOVIES_IN_A_SEPARATE_THREAD define to switch between
	  threaded or sequential movie load.

2006-08-21 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\movie.h: fixed a bit bit but opposite bug
	
2006-08-21 Vitaly Alexeev <tishka92@yahoo.com>
	
	* backend\render_handler_ogl.cpp: a bit cleanup
	
2006-08-21 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\movie_def_impl.cpp, gnash.h:
	* backend\render_handler_ogl.cpp:
	* libbase\image.cpp, image.h:
	attempting to do multithread opengl
	
2006-08-21 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/{action_buffer.cpp, swf/ASHandlers{.cpp, .h}: Solve problems
	associated with initialisation of SWFHandler's static variables by
	making the variables in-function statics.

2006-08-21 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\movie_def_impl.h, movie_impl.cpp: SDL MovieLoader stuff

2006-08-20 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/{action_buffer.cpp, swf/ASHandlers.cpp}: Initialise
	SWFHandlers::_handlers before class SWFHandlers is instantiated (bug
	#17476).

2006-08-20 Sandro Santilli  <strk@keybit.net>

	* utilities/processor.cpp: fixed bug #17367

2006-08-19  Rob Savoye  <rob@bertha.welcomehome.org>

	* server/swf/ASHandlers.cpp (CommonGetUrl): Check the domain, and
	don't go to the remote URL if it's in the blacklist. This ignores
	all attempts to allow the non-local domain if listed.

2006-08-19 Bastiaan Jacques <bastiaan@bjacques.org>

	* plugin/klash/klash_part.cpp: Make extra sure we don't kill all
	processes.

2006-08-19 Sandro Santilli  <strk@keybit.net>

	* server/sprite_instance.h, server/sprite_instance.cpp
	  (execute_frame_tags, execute_frame_tags_reverse):
	  modified to take size_t for frame number; small cleanups
	  and optimizations by use of standard algorithms.
	* server/button.cpp, server/morph2.cpp: added missing
	  IF_VERBOSE_PARSE wrapping.
	* server/swf/ASHandlers.cpp: fixed read of 'skip' count in
	  ActionWaitForFrame handler. Commented out 'testing' logging
	  from both WaitForFrame handlers (I'd consider them tested).
	* server/movie_def_impl.h, server/movie_def_impl.cpp,
	  server/sprite_instance.cpp: added MovieLoader::lock()
	  and unlock() functions, lock loader at every iteration
	  of read_all_swf() and from within wait_for_frame,
	  only ensure next frame is loaded (rather then loading
	  next *chunk* at every advance_root call).

2006-08-18 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\sprite_instance.cpp: a bit cleanup

2006-08-17 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\dlist.h, dlist.cpp, sprite_instance.cpp:
	added deleting the display objects created during execution 
	of frames 2,... and not displayed in the 1-st frame.
	Macromedia Flash does not call remove display object tag
	for 1-st frame
	* server\movie_def_impl.cpp: _loader.start() is switched off
	 temporarily on win32
	* win32\gnash\gnash.vcproj: updated gnash version
	 
2006-08-16 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\character.h, sprite_instance.cpp:
	 If we already have object with same events on this plane, 
	 then move it instead of replacing

2006-08-16 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\movie_def_impl.h, libamf\amf.cpp, libamf\rtmp.cpp:
	  porting to WIN32
	* win32\gnash\gnash.vcproj: added pthread.h

2006-08-14 Sandro Santilli  <strk@keybit.net>

	* server/movie_def_impl.cpp, server/movie_def_impl.h,
	  server/movie_definition.h, server/sprite_definition.h,
	  server/swf/tag_loaders.cpp: initial implementation of
	  movie loading into a separate frame. Needs more cleanup
	  work, but the intro1.swf and elvis.swf seems to be both
	  playing nice.

2006-08-14 Sandro Santilli  <strk@keybit.net>

	* server/swf/tag_loaders.h, server/swf/tag_loaders.cpp:
	  allow define_font_info_loader to be called for DEFINEFONTINFO2
	  tag, updated doc.
	* libbase/container.cpp: removed extra ';'
	* server/font.cpp, server/font.h, server/impl.cpp, server/swf.h:
	  initial support for DefineFontInfo2 tag, stricter use of
	  SWF::tag_type type.

2006-08-14  Rob Savoye  <rob@bertha.welcomehome.org>

	* doc/C/rtmp.xml: Add RTMP chapter with graphic of the RTMP
	protocol.
	* doc/C/gnash.xml: Add entity for rtmp.xml.
	* doc/C/Makefile.am: Add rtmp.xml.
	* doc/C/amf.xml: Rewrite AMF chapter now that I understand how it
	really works.

	* macros/atk.m4: Look for atk.h, not atkgl.h.
	* macros/opengl.m4: Put the single tick mark before the rest of
	the statement so it gets expanded correctly.
	* macros/gtkglext.m4: Add -I when --with-opengl-incl is used. Also
	set the version when using this option so the other tests still
	work.

2006-08-14 Tomas Groth Christensen <tomasgroth@yahoo.dk>

        * doc/C/internals.xml: Added info about how the soundhandlers works.

2006-08-13 Sandro Santilli  <strk@keybit.net>

	* server/edit_text_character_def.cpp, server/shape_character_def.cpp,
	 server/sprite_definition.cpp, server/styles.cpp, server/text.cpp,
	 server/tools.cpp, server/types.cpp, server/swf/tag_loaders.cpp:
	remove newline ending from log_parse calls.
	* server/stream.cpp (open_tag): add SWF offset in parse logging.

2006-08-13 Sandro Santilli  <strk@keybit.net>

	* libbase/log.cpp: fixed strip of CR ending in input operator.
	* gui/gnash.cpp (fs_callback): removed unused parameter warning,
	  reduced log_msg calls.
	* libamf/rtmp.cpp, libbase/network.cpp, libbase/network.h,
	  server/fontlib.cpp: removed compiler warnings.

2006-08-13 Patrice Dumas <pertusus@free.fr>

	* macros/pango.m4: fixed pango version detection.

2006-08-13 Sandro Santilli  <strk@keybit.net>

	* server/character.cpp, server/character.h:
	safely handle ActionScript code referencing '..' 
	from the root character.

2006-08-12 Rob Savoye  <rob@ripple.welcomehome.org>

	* Makefile.am: Build klash if it's enabled, but the plugin
	isn't.
	* backend/Makefile.am: Add lib dependancies for libgnashbase and
	libgnashserver.
	* gui/Makefile.am: Spell DEPENDANCIES right.
	* libamf/Makefile.am: Make amftest only build for testing.
	* libbase/Makefile.am: Add mor dependent libraries, add ogl.h to
	the package.
	* macros/kde.m4: Fix how KDE_LDFLAGS gets set.
	* server/Makefile.am: Add lib dependancies for libgnashbase and
	libgnashasobjs.
	* server/asobj/Makefile.am: Add lib dependancies for libgnashbase and
	libgnashamf.

2006-08-12  Sandro Santilli  <strk@keybit.net>

	* server/Makefile.am, server/thread.h: removed duplicated code
	(use libbase/Thread.h)

2006-08-11  Sandro Santilli  <strk@keybit.net>

	* gui/gtk.cpp: removed unused parameter warnings.
	* backend/sound_handler_gst.cpp: removed compiler warnings;
	minor optimizations and cleanups.

2006-08-11 Vitaly Alexeev <tishka92@yahoo.com>
	
	* plugin\win32\npgnash.rc: updated include file name
	
2006-08-11 Vitaly Alexeev <tishka92@yahoo.com>
	
	* libbase\curl_adapter.cpp: fixed VC++ compiler error
	
2006-08-11 Vitaly Alexeev <tishka92@yahoo.com>
	
	* server\swf\ASHandlers.cpp: removed assert(0),
	no actionscript operation should lead to crash player, including
	"x=new MyClass();". 

2006-08-10  Rob Savoye  <rob@bertha.welcomehome.org>

	* gui/Makefile.am: Add more libraries to AM_LDFLAGS.
	* libamf/Makefile.am: Remove the rest of the amftest.
	* libamf/amf.cpp, amf.h, rtmp.cpp, rtmp.h: Much rearranging of
	code, plus additional code till libamf actually works now.
	* libamf/rtmp.h: Use gnash namespace instead of rtmp one.
	* libbase/log.h, log.cpp: Add support to hexify to optionally
	print ascii characters in a hex dump.
	* libbase/network.cpp: Add WriteNet().
	* libbase/utility.h: Include math.h for Darwin.
	* macros/gtkglext.m4: Use pkg-config if it exists.
	* macros/kde.m4: Add -L to KDE_LDFLAGS.
	* plugin/klash/klash.cpp: External variables are now defined
	here.
	* macros/pango.m4: Work around PPC Linux bug (YDL) with gtkglext
	and pango library dependancies.

2006-08-10 Vitaly Alexeev <tishka92@yahoo.com>
	
	* gui\sdl.cpp, sdlsup.h: added key events handler and removed
	showlogo(useless) 
	
2006-08-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* plugin/plugin{.cpp,.h}: General plugin code cleanup.

2006-08-10 Vitaly Alexeev <tishka92@yahoo.com>
	
	* gui\sdl.cpp, sdlsup.h: added progress bar & showlogo stuf

2006-08-10  Sandro Santilli  <strk@keybit.net>

	* gui/gui.cpp: always call advance_root, no matter play_state
	  (the advance_root function should take care of that); reintroduce
	  check for gui loop
	* libbase/curl_adapter.cpp: removed compiler warnings.

2006-08-10 annonygmouse <annonygmouse@yahoo.co.uk>

	* gui/gtk.cpp, gui/gui.cpp: 
	  make "CTRL- q, w, p" and ESC work again. 

2006-08-10  Sandro Santilli  <strk@keybit.net>

	* server/asobj/NetConnection.cpp: added 'using namespace rtmp'
	directory, erroneously removed by a previous commit.
	* server/action_buffer.cpp: fixed hexify() call after it's
	signature change.

2006-08-09 Vitaly Alexeev <tishka92@yahoo.com>

	* server\dlist.cpp: It is corrected (already again) 
	a bug leading the wrong order of execution actionscript code/events

2006-08-09 Vitaly Alexeev <tishka92@yahoo.com>

	* win32\readme.txt: warning was reduced
	* npgnash.dll:  updated

2006-08-09 Vitaly Alexeev <tishka92@yahoo.com>

	* plugin\plugin.cpp, plugin.h: added win32 multithread plugin stuff
	* plugin\player.cpp, player.h : removed, becouse source it is moved
	  to plugin.cpp & plugin.h
	* win32\npgnash.vcproj: updated options
	* gnash.vcproj:  removed, becouse it is moved to \win32\gnash folder

2006-08-09 Bastiaan Jacques <bastiaan@bjacques.org>
	
	* plugin/plugin.cpp: Revise URL parsing to work for a single
	option=value pair.

2006-08-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* plugin/plugin.cpp: Don't abort on URL arguments without a name;
	merely ignore them (bug #17161). 

2006-08-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gtk_glue_gtkglext.cpp: Fix typo. Properly dereference the
	argument to getopt() (bug #17265).
	* gui/gui.cpp: Remove an unused variable.

2006-08-08  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/atk.m4, curl.m4, glib.m4, gtk2.m4, jpeg.m4, libXML.m4,
	mad.m4, pango.m4, sdl.m4: Add /opt/local,{include,lib}, which is
	the path used by Darwin Ports.
	* server/as_object.h: Add math.h for Darwin.
	* server/movie_def_impl.h: Use %zu to print a size_t.
	* server/sprite_instance.cpp: Add math.h for Darwin.
	* server/asobj/Global.cpp: Include GMath.h now.
	* server/asobj/Makefile.am: Renameed Math.h to Gmath.h.
	* server/asobj/Math.cpp: Include GMath.h now.
	* server/asobj/NetConnection.cpp: Removed lines 49-48.
	* server/asobj/Math.h: Renamed to Gmath.h to avoid a name
	collision on Darwin.

2006-08-08 Vitaly Alexeev <tishka92@yahoo.com>

	* gui\gnash.cpp: ported to win32
	* gui\NullGui.cpp:  ported to win32
	* gui\sdl.cpp:  ported to win32

2006-08-08 Vitaly Alexeev <tishka92@yahoo.com>

	* plugin\mozilla-sdk\npplat.h: ported to win32
	* libamf\amf.cpp: fixed compiler warning
	* libbase\container.cpp: stricmp --> _stricmp
	* libamf\rtmp.cpp: ported to win32
	* libbase\tu_timer.cpp: added win32 include file
	* ibbase\URL.cpp: cleanuped comment
	* win32\gnash\gnash.vcproj: updated VC++ options
	* win32\npgnash\npgnash.vcproj: updated VC++ options

2006-08-08 Sandro Santilli <strk@keybit.net>

	* gui/gnash.cpp, utilities/processor.cpp: notify about -vp -va
	  requests being ignored when VERBOSE_ACTION and VERBOSE_PARSE
	  are undefined.
	* server/dlist.cpp: commented out GNASH_REPORT_FUNCTION (we should
	  also make these no-op with a macro).

2006-08-08 Sandro Santilli <strk@keybit.net>

	* libbase/log.cpp (log_action): don't check getActionDump(),
	  assume callers use IF_VERBOSE_ACTION instead.
	* libbase/log.h: added IF_VERBOSE_ACTION and VERBOSE_ACTION
	  macros (latter is defined by default).
	* server/ActionExec.cpp, server/action_buffer.cpp, server/array.cpp,
	  server/as_environment.cpp, server/button.cpp, server/morph.cpp,
	  server/styles.cpp, server/swf/ASHandlers.cpp: wrap all log_action
	  calls inside IF_VERBOSE_ACTION

2006-08-08 Sandro Santilli <strk@keybit.net>

	* server/text.cpp: wrapper log_parse calls in IF_VERBOSE_PARSE.
	* libbase/log.h: fixed IF_VERBOSE_PARSE macro

2006-08-08 Sandro Santilli <strk@keybit.net>

	* libbase/log.cpp (log_parse): removed check for
	  dbglogfile.getParserDump() - it's checked by IF_VERBOSE_PARSE
	  macro.
	* libbase/log.h: added IF_VERBOSE_PARSE macro, either no-op
	  or checks for dbglogfile.getParserDump(), depending on
	  VERBOSE_PARSE macro (defaults to 1).
	* server/edit_text_character_def.cpp, server/font.cpp,
	  server/movie_def_impl.cpp, server/shape_character_def.cpp,
	  server/sprite_definition.cpp, server/stream.cpp, server/styles.cpp,
	  server/swf/tag_loaders.cpp: wrapped all log_parse calls inside
	  IF_VERBOSE_PARSE().

2006-08-07 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp: allow WaitForFrame actions	
	  to always wait (and never skip actions) by mean of
	  a compile-time define.
	* server/sprite_instance.cpp: simplified code in advance_root
	  to use the new specialized movie_definition::load_next_frame_chunk()
	* server/movie_def_impl.cpp: implemented frame chunk loading,
	  with chunks currently set to 64 frames (FRAMELOAD_CHUNK def);
	  Added DEBUG_FRAMES_LOAD define.
	* server/movie_definition.h, server/sprite_definition.h,
	  server/movie_def_impl.h:
	  Added load_next_frame_chunk() virtual method.
	* server/ActionExec.cpp (skip_actions): simplified code.
	* server/swf/ASHandlers.cpp (ActionBranchIfTrue):
	  assertion checking, minor cleanup.
	* gui/gui.cpp: removed unused parameters warnings
	* server/stream.h: added skip_bytes() method 
	* server/swf/tag_loaders.cpp: fixed compiler warnings.

2006-08-07 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/movie_def_impl.h: Fix return types to match declarations. 

2006-08-07 Sandro Santilli <strk@keybit.net>

	* server/asobj/NetConnection.cpp: added rtmp namespace in
	  search path (didn't build with g++ 3.3.5 otherwise)

2006-08-06 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase/URL.cpp: added win32 path parsing
	* win32: added new folder with VC++ projects of gnash & gnash plugin.
	  This folder also contains executable files: "gnash.exe" and firefox
	  plugin "gnash.dll".
	* plugin/win32/: added new folder with stuff of Win32 Firefox plugin.
	* gnash.vcproj: Remove as this now live in win32.
 	
2006-08-05  Rob Savoye  <rob@bertha.welcomehome.org>

	* configure.ac: Rewrite strcasecmp to use AC_TRY_COMPILE instead
	of AC_CHECK_HEADER which keeps failing on FC5-x86.
	* libbase/container.cpp, container.h, jpeg.cpp, membuf.cpp,
	network.cpp, rc.cpp, triangulate_impl.h, tu_file.cpp, utility.cpp,
	zlib_adapter.cpp, axial_box.h, collision.cpp: Minor tweaks to
	remove compiler warnings with the latest GCC on FC5. Printing
	size_t should use %zd, and many unused parameters are commented
	out to reduce warnings.
	* libgeometry/kd_tree_dynamic.cpp, kd_tree_packed.cpp: Minor
	tweaks to remove compiler warnings with the latest GCC on
	FC5. Printing size_t should use %zd, and many unused parameters
	are commented out to reduce warnings.
	* macros/kde.m4: Use dnl to comment out serial, it's a reserved
	word now.
	* server/ActionExec.cpp, MovieClip.cpp, action_buffer.cpp,
	as_environment.h, button.cpp, dlist.cpp, font.cpp, fontlib.cpp,
	movie.h, movie_root.cpp, shape_character_def.cpp, /shm.cpp,
	sound.cpp, sprite_definition.cpp, sprite_instance.cpp,
	sprite_instance.h, xml.cpp, xmlnode.cpp, xmlsocket.cpp: Minor
	tweaks to remove compiler warnings with the latest GCC on
	FC5. Printing size_t should use %zd, and many unused parameters
	are commented out to reduce warnings.
	* server/asobj/NetConnection.cpp, NetConnection.h: Minor tweaks to
	remove compiler warnings with the latest GCC on FC5. Printing
	size_t should use %zd, and many unused parameters are commented
	out to reduce warnings. 
	* server/swf/ASHandlers.cpp: Minor tweaks to remove compiler
	warnings with the latest GCC on FC5. Printing size_t should use
	%zd, and many unused parameters are commented out to reduce
	warnings. 
	* utilities/parser.cpp:  Minor tweaks to remove compiler warnings
	with the latest GCC on FC5. Printing size_t should use %zd, and
	many unused parameters are commented out to reduce warnings.
	* plugin/klash/Makefile.am: Add libamf.

2006-08-05 Sandro Santilli <strk@keybit.net>

	* server/ActionExec.cpp: handled case where pc gets far after stop_pc
	* server/movie_def_impl.cpp: added comments about assertion in
	  ensure_frame_loaded() for target frame < loaded frame case.
	* server/sprite_definition.h: fixed ensure_frame_loaded() to not
	  proxy to movie_definition but rather always return true (includes
	  comment about it)
	* server/sprite_instance.cpp: added FRAMELOAD_CHUNK define to load
	  frames in chunks in advance_root(); reintroduced ensure_frame_loaded()
	  call in goto_frame()
	* server/sprite_instance.h: added get_loaded_frame() public method.
	* server/swf/ASHandlers.cpp: simplified WaitForFrame action handlers
	  to use the new sprite_instance::get_loaded_frame() method.

2006-08-04 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp: implemented ActionWaitForFrame
	  and ActionWaitForFrameExpression()
	* server/sprite_instance.cpp, server/sprite_instance.h:
	  added get_frame_number(as_value& frame_spec) for common
	  use in swf tags.
	* server/movie_definition.h: added doxygen comment 
	* server/ActionExec.cpp, server/ActionExec.h: added
	  skip_actions() for use with WaitForFrame
	* server/execute_tag.h: removed unused parameter warning.
	* gui/NullGui.h: removed unused parameters warnings.
	* server/character.h, server/movie_def_impl.cpp,
	  server/movie_def_impl.h, server/movie_definition.h,
	  server/movie_interface.h, server/movie_root.cpp,
	  server/movie_root.h, server/sprite_definition.h,
	  server/sprite_instance.cpp, server/sprite_instance.h:
	  Fixed more frame number types to be size_t rather then int;
	  added some doxygen comments; fixed ensure_frame_loaded calls
	  to not erroneusly using sprite frames rather then movie frames;
	  removed ensure_frame_loaded calls from goto_frame (will need
	  further thinking about it).

2006-08-04 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: added rule to cleanup
	  temporary files created by new ming versions.
	* server/sprite_instance.cpp (init_builtins): don't init builtins
	  more then once.
	* testsuite/misc-ming.all/spritehier.c: fixed code to really
	  include 3 DoAction blocks.

2006-08-04 Sandro Santilli <strk@keybit.net>

	* libbase/smart_ptr.h, server/action_buffer.h, server/character.h,
	  server/impl.h: removed unused parameter warning.
	* testsuite/misc-ming.all/spritehier.c: updated to test
	  framesloaded/currentframe.
	* server/sprite_instance.cpp: fixed _framesloaded
	  member to return loaded (not total) frames.
	* server/sprite_definition.cpp: added check for
	  nested DefineSprite (malformed SWF).

2006-08-03 Sandro Santilli <strk@keybit.net>

	* server/character.h, server/impl.cpp, server/movie.h,
	  server/movie_def_impl.cpp, server/movie_def_impl.h,
	  server/movie_definition.h, server/movie_interface.h,
	  server/movie_root.cpp, server/movie_root.h,
	  server/sprite_definition.cpp, server/sprite_definition.h,
	  server/sprite_instance.cpp, server/sprite_instance.h,
	  server/swf/ASHandlers.cpp:
	  Implemented incremental loading of movie (streaming);
	  fixed lots of references to frame numbers to be expressed
	  with size_t type rather then int.
	

2006-08-03 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp: warn only once and avoid parsing
	  tags when no GST sound backend is selected and unsupported sound
	  tags are encountered.
	* server/gnash.h, server/impl.cpp, server/movie_def_impl.cpp,
	  server/movie_def_impl.h, server/sound.cpp, server/sound.h,
	  server/swf/tag_loaders.cpp, server/swf/tag_loaders.h:
	  Moved sound tag loaders to tag_loaders, moved s_sound_handler
	  instance to globals namespace, made adpcm_expand a static
	  method of sound_handler class.

2006-08-03 Sandro Santilli <strk@keybit.net>

	* libbase/rc.cpp: initialize RcInitFile::_delay to 0 (undefined).
	* server/as_environment.cpp, server/swf/ASHandlers.cpp:
	  removed superflous newlines at end of debug messages.

2006-08-02 Sandro Santilli <strk@keybit.net>

	* server/font.cpp, server/font.h: tu_hash => std::map, minor
	  optimizations, more verbose parsing.
	* gui/Makefile.am: use a GNASH_LIBS variable, to make future
	  additions cleaner. Fixes missed link of libamf.la in 'gnash'
	  executable,

2006-08-01  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* libamf/Makefile.am: Don't bother to build amftest, now that I
	can debug with live data.
	
	* libamf/amf.cpp, amf.h: Changes for cleaner 64 bit support.
	* libamf/rtmp.cpp, rtmp.h: Read multiple packets till the entire
	body is read in.
	* macros/kde.m4: Remove 64 libraries as weel as 32 bit ones for
	sed.

2006-08-01  Rob Savoye  <rob@darkstar.welcomehome.org>

	* configure.ac: Change testing to disabled by default.
	* Makefile.am: Always build libamf now, the networking code
	requires it.
	* gui/Makefile.am: Add libamf to the link line.
	* gui/gnash.cpp: Add support for reading the config file.
	* libamf/Makefile.am: Add RTMP support files.
	* libbase/network.cpp: Add = operator. Add support for passing a
	timeout to all functions using select().
	* libamf/rtmp.h, rtmp.cpp: New RTMP protocol support, both client
	side and server side.
	* libamf/protocol.h: Bases class for network protocols.
	* libbase/network.h: Always compile in the accesors, the =
	operator needs them.
	* libbase/rc.cpp, rc.h: Add documentroot variable.
	* plugin/Makefile.am: Add libamf to the link line.
	* server/asobj/Makefile.am: Add libamf to the link line.
	* server/asobj/NetConnection.cpp: Add establishing the RTMP
	connection for connect().
	* utilities/Makefile.am: Add libamf to the link line.

2006-08-01 Sandro Santilli <strk@keybit.net>

	* server/font.h: fixed extra qualification in declaration (bug #17247)
	* configure.ac: output cleanups
	* server/shape_character_def.cpp: cleanups in read_fill_styles
	  and read_line_styles.

2006-08-01 annonygmouse <annonygmouse@yahoo.co.uk>

	* gui/gnash.cpp, gui/gtk.cpp, gui/gtksup.h, gui/gui.h, gui/sdl.cpp,
	  gui/sdlsup.h: add Gui::createWindow() function taking window
	  title, with default implementation discarding it. Changed
	  gui/gnash.cpp to use the new signature.

2006-08-01 Sandro Santilli <strk@keybit.net>

	* server/font.h, server/font.cpp: split read of DefineFont and
	  DefineFont2 tags
	* server/swf/tag_loaders.cpp: more use of symbolic names for SWF tags.
	* server/samples/sound1.README: added description of sound1.swf.
	* backend/Makefile.am, backend/sound_handler_mp3.cpp,
	  backend/sound_handler_sdl.cpp, server/Makefile.am,
	  server/sound_handler_mp3.cpp:
	  Moved sound_handler_mp3 from server/ to backend/,
	  enabled build (needs --enable-sound=sdl --enable-mp3)
	* configure.ac: disable sound by default, set nogo=true
	  when sdl sound is requested but dependencies are not
	  met (bug#17225)

2006-07-31 Sandro Santilli <strk@keybit.net>

	* gui/Makefile.am, gui/NullGui.cpp, gui/NullGui.h,
	  gui/gnash.cpp, gui/gui.h:
	  Moved NullGui class into its own files, implemented
	  frame delay in NullGui so that sound doesn't choke.

2006-07-31 Sandro Santilli <strk@keybit.net>

	* gui/gui.h: added NullGui class definition.
	* gui/gnash.cpp: use Gui trough a pointer, to allow for
	  dynamic polymorphism. Use NullGui when rendering is
	  disabled.

2006-07-30  Rob Savoye  <rob@darkstar.welcomehome.org>

	* libbase/Thread.h, Thread.cpp: Base class for handling threads.
	* server/network.h, network.cpp: Remove as they now live in
	libbase.
	* server/Makefile.am: Remove network.
	* libbase/network.h, network.cpp: Move from server as this is
	really a base class.
	* server/Makefile.am: Add network to libbase library.
	
2006-07-29 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp, server/swf/ASHandlers.h:
	  merged GetUrl and GetUrl2 common code into a CommonGetUrl
	  method. 
	* server/movie_root.cpp, server/movie_root.h:
	  assert that movie_root::get_url is never called.

2006-07-29  Rob Savoye  <rob@ripple.welcomehome.org>

	* macros/glib.m4: Use pkg-config if it exists.

2006-07-29 Sandro Santilli <strk@keybit.net>

	* libbase/URL.cpp, libbase/URL.h, server/StreamProvider.cpp:
	  moved host security checking from URL class to StreamProvider
	  class. Do not check security for local files anymore, and
	  prevents checking security on temporary URL instances
	  (used for relative urls resolution)

2006-07-29 Sandro Santilli <strk@keybit.net>

	* testsuite/libbase/Makefile.am, plugin/Makefile.am,
	  testsuite/libbase/Makefile.am:
	  commented out AM_LDFLAGS (rely on helper libs deps)
	* backend/Makefile.am: make sure GLIB_LIBS is listed
	  before other libraries
	* gui/Makefile.am, utilities/Makefile.am:
	  add GLIB_LIBS to AM_LDFLAGS to make sure
	  user-provided paths are used rather then the
	  ones found by libtool in dependent packages
	  (seems not the cleanest solution, but it worked for me)

2006-07-29 Sandro Santilli <strk@keybit.net>

	* macros/pthreads.m4: don't add -I/usr/include
 	  (should already be in the default search path)
	* gui/gnash.cpp: fixed typo in -r help 
	* gui/Makefile.am: comment out AM_LDFLAGS (rely on dependencies
	  extracted from .la files)
	* Makefile.am: add KDE_INCLUDES and KDE_LDFLAGS to
	  'dumpconfig' output.

2006-07-28 Rob Savoye <rob@wharfrat.welcomehome.org>

	* macros/opengl.m4: Make sure glu.h and libGLU also exist.
	* macros/kde.m4: Don't force KDE_LDFLAGS to have /usr/lib.
	* macros/libXML.m4: Remove /usr/lib from the output of
	xml2-config.
	* configure.ac: Only enable -pedantic -ansi when
	--enable-lotsa-warnings is used when configuring.

2006-07-28 Sandro Santilli <strk@keybit.net>

	* macros/libXML.m4: don't use -L when lib dir is /usr/lib
          (this prevents polluting the libs search path).
	  Note that this won't work if xml2-config spits out -L/usr/lib,
          but you can still override it with explicit --with-xml-libraries.

2006-07-27 Sandro Santilli <strk@keybit.net>

	* utilities/Makefile.am: remove all LIBS references, deps
	  are derived from Gnash libs (simplifies things a lot)
	* macros/glib.m4: Fix the fix of --with-glib-lib.

2006-07-27  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* macros/glib.m4: Fix --with-glib-incl and --with-glib-lib options
	to actually work.

2006-07-27 Tomas Groth Christensen <tomasgroth@yahoo.dk>

        * backend/sound_handler_gst.cpp: Made the log messages more
	informative.

2006-07-27 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Allow us to specify --enable-sound=none. Default to
	-pedantic -Wno-long-long for GCC.
	* backend/render_handler_ogl.cpp: Remove unneeded #includes.
	* gui/gtk_glue_cairo{.cpp, h}: Move an include to the .cpp file,
	where it's actually used.
	* libbase/jpeg.cpp: Don't let jpeglib.h redefine HAVE_STDLIB_H.
	* libbase/Makefile.am: Remove ogl{.cpp,h} from the build.
	* macros/cairo.m4: Add -lcairo to the Cairo LDFLAGS, if needed.
	* plugin/plugin.cpp: trivially fix warnings.
	* server/shm.cpp: Remove an unused variable.
	* server/asobj/Date.cpp: Make sure the recipient buffer size
	matches the size parameter passed to snprintf(), to prevent
	overflows.

2006-07-27 Sandro Santilli <strk@keybit.net>

	* macros/gstreamer.m4: fixed handling of --with-gst-lib,
	  big cleanups
	* utilities/Makefile.am: added GSTREAMER_LIBS
	* doc/C/gnash.xml: updated doc for -r switch
	* gui/gnash.cpp: changed semantic of -r switch:
		0: disable both rendering and sound
		1: enable rendering only (changed!)
		2: enable sound only (as before)
		3: enable both (new, previously done by 2)

2006-07-27 Bastiaan Jacques <bastiaan@bjacques.org>

	* all over the place: Facilitate the use of -pedantic in combination
	with -ansi by avoiding non-ISO C++. Avoid extra semicolons. Use the
	`l' instead of the `z' length modifier in printf-style sequences.

2006-07-27 Ivor Blockley <meteoryte@yahoo.com.au>

	* gui/{gtk.cpp, gui.cpp, gui.h, sdl.cpp}, server/{movie.h,
	movie_interface.h, movie_root.cpp, movie_root.h}: Make sure that no
	mouse events are ignored by handling them outside of the advance_movie
	loop.

2006-07-27 Sebasti Annonygmouse <annonygmouse@yahoo.co.uk>

	* plugin/plugin.cpp: Don't assume anything about the value of
	string::npos.

2006-07-26 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* gnash.vcproj: Added backend/sound_handler_gst.cpp.
	* backend/sound_handler_gst.cpp: Use of more gstreamer plugins.
	* backend/gnash.cpp, backend/sound_handler_sdl.cpp, 
	plugin/player.cpp, plugin/klash/klash.cpp, server/gnash.h, 
	server/sound.cpp: Use SOUND_GST and SOUND_SDL to select which
	soundbackend to use.
	* server/swf/ASHandlers.cpp: Stop soundplayback when gotoframe
	and stop is called.

2006-07-26 Sandro Santilli <strk@keybit.net>

	* gui/gnash.cpp: use SOUND_GST and SOUND_SDL to switch
	  between sound handlers.
	* utilities/Makefile.am: add CAIRO_LIBS.
	* macros/gtk2.m4: fixed typo
	* libbase/Makefile.am: don't build ogl.cpp when not using OPENGL
	  rendered. Don't build tu_file_SDL.cpp if HAS_SDL is not set.
	* configure.ac: don't complain about missing SDL_Mixer
	  if Gstreamer sound is requested

2006-07-26 Vitaly Alexeev <tishka92@yahoo.com>

	* server/movie_def_impl.cpp: fixing bug #17110
	* server/sprite_instance.cpp: xscale & yscale may be > 100

2006-07-26 Vitaly Alexeev <tishka92@yahoo.com>

	* server/AutoExec.cpp: small optimization is done

2006-07-26 Sandro Santilli <strk@keybit.net>

	* configure.ac: print GSTREAMER flags if gst sound is enabled
	  (also abort if the lib is not found)
	* macros/glib.m4: fixed to allow for custom glib installations
	* configure.ac, backend/Makefile.am: add --enable-sound option
	  to select between SDL or GSTREAMER
	* backend/sound_handler_gst.cpp: don't use broken HAVE_GST_GST_H
	  macro, rather trust builder and use what's specified in
	  --enable-sound

2006-07-26 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/sound_handler_gst.cpp: When reallocating, don't forget to
	copy the old buffer contents.

2006-07-25 Sandro Santilli <strk@keybit.net>

	* configure.ac: move XML2 and GLIB macro calls before gstreamer
	  one, so we can use LIBXML_CFLAGS and GLIB_CFLAGS when checking
	  for gstreamer headers.
	* macros/gstreamer.m4: always run AC_CHECK_HEADERS for gstreamer
	  so to get HAVE_GST_GST_H defined; fixed AC_CHECK_LIB call to
	  use an actually available function in libgstreamer-0.10.so
	* macros/gstreamer.m4: --with-gstreamer => --with-gst,
	  look for libgstreamer-0.10.so rather then for libgstplaybin.so,
	  fixed handling of --with-gst-libs (was using value given to
	  --with-gst-incl instead)
	* libbase/log.cpp: another small optimization.
	* server/ActionExec.cpp: don't call stack dumper
	  unless -va is given (another optimization)

2006-07-25 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: The correct option is --enable-plugin, not
	--disable-plugin.
	* backend/sound_handler_gst.cpp: Don't use realloc() on operator
	new-allocated pointers. Do some trivial cleanup.
	* backend/sound_handler_sdl.cpp: Trivially fix warnings.
	* server/edit_text_character.cpp: Likewise.
	* server/sound.cpp: Ensure that the sample rate is in the acceptable
	range, to avoid invalid memory accesses.

2006-07-25 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase/log.cpp: small optimization is done

2006-07-25  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* macros/gstreamer.m4: Fix the --with options. Change to
	--with--gst, instead of --with-gstreamer. Look for the correct
	header file and library.

2006-07-25 Lukasz Stelmach <stlman@poczta.fm>

	* macros/sdl.m4: fix --with-sdl-mixer-lib handling.

2006-07-25 Vitaly Alexeev <tishka92@yahoo.com>

	* server/edit_text_character.h, edit_text_character.cpp: 
	fixed input_edit_text cursor bug (center, right alignment)

2006-07-25 Sandro Santilli <strk@keybit.net>

	* plugin/klash/Makefile.am: fixed libgnashasobj.la path.
	* backend/Makefile.am: gtk stuff is source for
	  the deprecated backend/gnash.cpp, not libbackend
	  (which should rely on RENDERER_SORCES instead)

2006-07-25 Rob Savoye <rob@wharfrat.welcomehome.org>

	* Makefile.am: Print the Gstreamer paths for dumpconfig.
	* macros/pkg.m4: Add macros to find pkg-config.	
	* macros/gstreamer.m4: If pkg-config exists, use it, otherwise
	look for the correct header file and libraries.
	* configure.ac: Look for pkg-config.

2006-07-24 Sandro Santilli <strk@keybit.net>

	* macros/gstreamer.m4: report result of headers checking
	  (note: doesn't work with required gstreamer version)
	* plugin/Makefile.am: fixed reference to libgnashasobjs.la

2006-07-24 Tomas Groth Christensen <tomasgroth@yahoo.dk>

        * backend/sound_handler_gst.cpp,  backend/sound_handler_sdl.cpp,
	server/button.cpp, server/gnash.h, server/movie_def_impl.h,
	server/movie_definition.h, server/sound.cpp, 
	server/sprite_definition.h, server/asobj/ASSound.cpp: 
	Restructured the way sound streams are treated. Not much different
	in playing yet, but it will help later.

2006-07-24 Vitaly Alexeev <tishka92@yahoo.com>
	* gnash.vcproj: added /server/asobj files
	* server/swf/ASHandlers.h: small optimization is done
	* server/swf/ASHandlers.cpp: small optimization is done

2006-07-24 Tomas Groth Christensen <tomasgroth@yahoo.dk>

        * Makefile.am, backend/Makefile.am, backend/gnash.cpp, 
	backend/sound_handler_gst.cpp gui/gnash.cpp, plugin/player.cpp, 
	server/gnash.h: Added the new Gstreamer based soundbackend. It still
	needs some work!

2006-07-23 Sandro Santilli <strk@keybit.net>

	* gui/gnash.cpp: fixed delay to respect FPS.
	* configure.ac, backend/Makefile.am, gui/Makefile.am,
	server/ASSound.cpp, server/ASSound.h, server/Boolean.cpp,
	server/Boolean.h, server/Camera.cpp, server/Camera.h,
	server/Color.cpp, server/Color.h, server/ContextMenu.cpp,
	server/ContextMenu.h, server/CustomActions.cpp,
	server/CustomActions.h, server/Date.cpp, server/Date.h,
	server/Error.cpp, server/Error.h, server/Global.cpp, server/Key.cpp,
	server/Key.h, server/LoadVars.cpp, server/LoadVars.h,
	server/LocalConnection.cpp, server/LocalConnection.h,
	server/Makefile.am, server/Math.cpp, server/Math.h,
	server/Microphone.cpp, server/Microphone.h, server/Mouse.cpp,
	server/Mouse.h, server/MovieClipLoader.cpp, server/MovieClipLoader.h,
	server/NetConnection.cpp, server/NetConnection.h, server/NetStream.cpp,
	server/NetStream.h, server/Selection.cpp, server/Selection.h,
	server/SharedObject.cpp, server/SharedObject.h, server/Stage.cpp,
	server/Stage.h, server/System.cpp, server/System.h,
	server/TextSnapshot.cpp, server/TextSnapshot.h, server/Video.cpp,
	server/Video.h, server/asobj/ASSound.cpp, server/asobj/ASSound.h,
	server/asobj/Boolean.cpp, server/asobj/Boolean.h,
	server/asobj/Camera.cpp, server/asobj/Camera.h,
	server/asobj/Color.cpp, server/asobj/Color.h, server/asobj/.cvsignore,
	server/asobj/ContextMenu.cpp, server/asobj/ContextMenu.h,
	server/asobj/CustomActions.cpp, server/asobj/CustomActions.h,
	server/asobj/Date.cpp, server/asobj/Date.h, server/asobj/Error.cpp,
	server/asobj/Error.h, server/asobj/Global.cpp, server/asobj/Key.cpp,
	server/asobj/Key.h, server/asobj/LoadVars.cpp, server/asobj/LoadVars.h,
	server/asobj/LocalConnection.cpp, server/asobj/LocalConnection.h,
	server/asobj/Makefile.am, server/asobj/Math.cpp, server/asobj/Math.h,
	server/asobj/Microphone.cpp, server/asobj/Microphone.h,
	server/asobj/Mouse.cpp, server/asobj/Mouse.h,
	server/asobj/MovieClipLoader.cpp, server/asobj/MovieClipLoader.h,
	server/asobj/NetConnection.cpp, server/asobj/NetConnection.h,
	server/asobj/NetStream.cpp, server/asobj/NetStream.h,
	server/asobj/Selection.cpp, server/asobj/Selection.h,
	server/asobj/SharedObject.cpp, server/asobj/SharedObject.h,
	server/asobj/Stage.cpp, server/asobj/Stage.h,
	server/asobj/System.cpp, server/asobj/System.h,
	server/asobj/TextSnapshot.cpp, server/asobj/TextSnapshot.h,
	server/asobj/Video.cpp, server/asobj/Video.h, utilities/Makefile.am:
	Moved ActionScript built-in objects (client api) under own directory
	(asobj).
	* configure.ac: fixed tip (suggest --enable-gui, not --with-gui)

2006-07-17 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/curl_adapter.cpp, server/{ActionExec.cpp, action_buffer.cpp,
	array.cpp, swf/ASHandlers.cpp, swf/tag_loaders.cpp}: Trivially fix
	compiler warnings.

2006-07-16 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/kde.cpp: Update setCallback() to match the arguments in the
	parent class.
	* plugin/plugin.{h,cpp}: Remove more unused OpenGL and GTK code.

2006-07-15 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gnash.cpp: Make sure the argument count is greater than two
	before treating an argument as a variable.
	* gui/gui.{cpp,h}: Remove unused member _xembed.
	* gui/{gnash.cpp,kdesup.h,sdl.cpp,sdlsup.h,gtk.cpp,gtksup.h}: Remove
	the unused first argument to setCallback().
	* plugin/plugin.cpp: Don't do any OpenGL initialization in the plugin,
	because the forked gnash does this on its own.

2006-07-14 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gui.cpp: Don't ignore the arguments passed to the Gui class
	constructor.

2006-07-14 Bastiaan Jacques <bastiaan@bjacques.org>

	* Makefile.am: revert latest change to fix the build.

2006-07-11 Sandro Santilli <strk@keybit.net>

	* Makefile.am: don't make in backend/ (but distribute it)
	* configure.ac: fixed plugin config message to avoid confusion
	(default is disabled, not enabled).

2006-07-11 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/{gtk.cpp, gtk_glue.h, gtk_glue_cairo.cpp, gtk_glue_cairo.h,
	gtk_glue_gtkglext.cpp, gtk_glue_gtkglext.h, gtksup.h}: To facilitate
	moving some GtkGlExt code into the appropriate glue, add a Gtk
	configure event	handler to the GtkGlue class and derivatives. Disable
	some unused Gtk event handlers.

2006-07-10 Sandro Santilli <strk@keybit.net>

	* gui/gtk.cpp: added missing gtkgl.h include
	* backend/render_handler_cairo.cpp: removed comma at end of
	enumeration list (pedantic error).
	* backend/Makefile.am: commented out 'gnash' build
	(there will be a 'gnash' program built under gui/)
	* Makefile.am: added gui/ subdir
	* server/edit_text_character.cpp: fixed tu_string => std::string
	attempt bug.
	* testsuite/actionscript.all/swf_exists.exp:
	use gprocessor -v rather then backend/gnash (we/re moving to gui).
	clean up also <file>.swf.frame0.pp (new preprocessor output name
	from upcoming Ming 0.4)

2006-07-10 Vitaly Alexeev <tishka92@yahoo.com>

	* server\action.h, action.cpp: added SETFOCUS & KILLFOCUS events codes
	* server\edit_text_character_def.h:  added get_readonly() for
	edit_text_character entity
	* server\edit_text_character.h, edit_text_character.cpp: 
	added SETFOCUS & KILLFOCUS event handler and input edit text stuff
	* server\Key.h, Key.cpp:  keypress event handler moved to movie_root,
	because every root must have own event handler
	* server\movie_root.h, movie_root.cpp: added m_active_input_text which
	points to current entity having focus and related get_active_entity,
	set_active_entity
	* server\button.cpp:  added SETFOCUS & KILLFOCUS events initiator
	* server\array.h, as_function.h, as_object.cpp: ported to WIN32
	* backend\gnash.cpp: fixed bug that led to processing of not arisen
	events.
	* server\button.cpp, sprite_instance.cpp:  
	add_keypress_listener --> m_root.add_keypress_listener
	* gnash.vcproj: added new files

2006-07-10 Sandro Santilli <strk@keybit.net>

	* gui/.cvsignore: new file

2006-07-08 Sandro Santilli <strk@keybit.net>

	* server/Function.cpp, server/Function.h: removed obsoleted files.
	* TODO: removed ActionNewMethod from missing opcodes
	* server/swf/ASHandlers.cpp: implemented ActionNewMethod,
	added static construct_object() utility function.
	* server/System.cpp: handled 'new System' attempts.
	* testsuite/actionscript.all/System.as: don't try
	to instantiate the non-instantiatable 'System' class.
	* server/action.cpp, server/action.h: cleaned up and documented
	call_method function.
	* server/as_object.h, server/as_object.cpp:
	added public dump_members() and private set_prototype()
	methods.

2006-07-07 Stefan Schweizer <sschweizer@gmail.com>

	* libamf/Makefile.am, libgeometry/Makefile.am, plugin/Makefile.am,
	plugin/mozilla-sdk/Makefile.am:
	Use CXXFLAGS where appropriate; install plugin using libtool.

2006-07-07 Sandro Santilli <strk@keybit.net>

	* TODO: updated
	* server/swf/ASHandlers.cpp: implemented ActionEnum2
	(enumerate object), fixed ActionEnumerate to always set
	enumeration end.
	* server/ActionExec.cpp, server/Function.cpp, server/Function.h,
	server/Global.cpp, server/Makefile.am, server/MovieClipLoader.cpp,
	server/System.cpp, server/System.h, server/action.cpp,
	server/action_buffer.cpp, server/array.cpp, server/as_function.cpp,
	server/as_function.h, server/as_object.cpp, server/as_value.cpp,
	server/builtin_function.h, server/impl.cpp, server/impl.h,
	server/sprite_instance.cpp, server/string.cpp, server/swf_function.cpp,
	server/swf_function.h, server/timers.cpp, server/xml.cpp,
	server/xmlattrs.cpp, server/xmlnode.cpp, server/xmlsocket.cpp,
	server/swf/ASHandlers.cpp, server/swf/tag_loaders.cpp:
	Split Function.{h,cpp} into as_function.{h,cpp}, swf_function.{h,cpp}
	and builtin_function.{h,cpp}.

2006-07-07 Sandro Santilli <strk@keybit.net>

	* server/action_buffer.cpp: don't log action at parse time
	(is redundant, as they are logged at execution time).
	* server/Function.cpp: fixed local registers handling in operator()
	for function2 (see the 1-based register WARNING below).
	* server/as_environment.cpp, server/as_environment.h:
	outlined local register functions, adding assertion checking.
	* server/ActionExec.cpp, server/MovieClipLoader.cpp,
	server/as_environment.cpp, server/as_environment.h,
	server/character.cpp, server/character.h, server/sprite_instance.cpp,
	server/sprite_instance.h, server/swf/ASHandlers.cpp:
	Changed as_environment's target to be a character rather
	then a sprite_instance (it seems buttons are valid targets);
	Handled invalid values for sprite_instance members
	_xscale and _yscale.
	* server/action_buffer.cpp, server/swf/ASHandlers.cpp:
	removed -pedantic compiler warnings, fixed a bug in
	fix_stack_underrun pushing more undefined values then
	required.

2006-07-06 Sandro Santilli <strk@keybit.net>

	* server/array.cpp, server/array.h: implemented
	Array.sort(flags=0) method.
	* server/Global.cpp, server/array.cpp, server/array.h:
	had Array unimplemented methods print an ERROR with -v,
	renamed array_init  to array_class_init and change signature
	to take by-ref.
	* server/array.cpp: most functions made module-statics, indentation
	* testsuite/actionscript.all/array.as: "tostring" => "toString"
	(SWF 7 and up are case-sensitive in this); added tests for
	Array constants and instanceOf.
	* server/ActionExec.cpp, server/Function.cpp, server/Global.cpp
	server/as_environment.cpp, server/as_environment.h,
	server/swf/ASHandlers.cpp: environment's global and local registers
	made private; provided accessor methods checking for out of bound
	conditions; added dumpers for them. Updated all users.
	WARNING: 1-based register must be checked, but ming is unable
	to output Function2 code...
	

2006-07-05 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Function.as:
	handled differences between player versions.
	* server/gstring.cpp:
	Provide all of "String" class interface as static methods
	(actionscript.all/String.swf testcases passes all now).
	* server/ActionExec.cpp, server/Function.cpp, server/Function.h,
	server/Global.cpp, server/MovieClip.cpp, server/MovieClipLoader.cpp,
	server/System.cpp, server/action.cpp, server/action.h,
	server/action_buffer.cpp, server/array.cpp, server/as_object.cpp,
	server/as_object.h, server/as_value.cpp, server/as_value.h,
	server/gstring.h, server/resource.h, server/sprite_instance.cpp,
	server/string.cpp, server/timers.cpp, server/xml.cpp,
	server/xmlsocket.cpp, server/swf/ASHandlers.cpp,
	server/swf/tag_loaders.cpp:
	Refactored ActionScript functions model.
	We now have a base as_function class and builting_function and
	swf_function being for builtin and user-defined functions/classes.
	(actionscript.all/Function.swf testcases passes all now).

2006-07-05 Vitaly Alexeev <tishka92@yahoo.com>

	* backend\gnash.cpp:  mouse_scaling.patch from Samuel Liden Borell <samuellb@bredband.net>
	* backend\gtksup.cpp:  mouse_scaling.patch from Samuel Liden Borell <samuellb@bredband.net>
	* server\button.cpp:  added button keypress event handler
	* server\Key.cpp: added button keypress event handler


2006-07-04 Sandro Santilli <strk@keybit.net>

	* server/Function.h, server/swf/ASHandlers.cpp:
	most function_as_object members made private.

2006-07-03 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am,
	testsuite/actionscript.all/inheritance.as:
	New ActionScript inheritance test.

2006-07-02 Sandro Santilli <strk@keybit.net>

	* server/ActionExecp.cpp: dump stack after each action execution
	when -va is provided (can switch off undefining DEBUG_STACK).
	* server/as_object.cpp: reduced noise on -va.
	* gui/gui.cpp: fixed Gui constructors to correctly set scale.
	Mouse events now work as expected.
	* server/MovieClipLoader.cpp, server/action.cpp,
	server/as_environment.cpp, server/as_environment.h,
	server/button.cpp, server/button.h, server/character.h,
	server/character_def.cpp, server/character_def.h,
	server/edit_text_character.cpp, server/edit_text_character.h,
	server/edit_text_character_def.cpp, server/edit_text_character_def.h,
	server/generic_character.h, server/sprite_definition.cpp,
	server/sprite_definition.h, server/sprite_instance.cpp,
	server/sprite_instance.h:
	Characters's parents are now characters (not sprite_instances).
	This is required to have child characters for buttons and
	edit_text and other characters (see Vitaly's patch for bug #16969
	for reference).

2006-07-01 Vitaly Alexeev <tishka92@yahoo.com>

	* server\button.cpp:  fixed bug #16969

2006-07-01 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp, server/as_environment.h:
	changed register-related functions to use unsigned
	ints rather the ints for offsets.
	* server/as_environment.cpp, server/as_environment.h:
	added a get_version() method to hide implementation.
	* server/ActionExec.cpp, server/sprite_instance.cpp,
	server/swf/ASHandlers.cpp: use env.get_version()
	rather then own-rolled version extracter.
	* server/Global.cpp: tolerate (don't abort) unimplemented
	ASSetPropFlags with non-object 'props' argument.

2006-06-30 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp (ActionGetUrl): fixed read
	of 'target' parameter (action still not fully implemented,
	see bug #16435).
	* server/dlist.cpp: (advance): keep characters alive
	during advancement of them, in case they get removed
	from the DisplayList (see bug #16815).
	* server/swf/ASHandlers.cpp: fixed bugus stack drop
	in ActionWaitForFrame, added pseudo-code implementation of
	it and ActionWaitForFrameExpresion.
	* server/swf/ASHandlers.cpp, server/swf/ASHandlers.h:
	added ensure_stack() function to use by action handlers
	to check stack size before attempting to fetch from it.
	This cleanly handles malformed SWF and prints an error about
	it.

2006-06-30 Vitaly Alexeev <tishka92@yahoo.com>

	* server\sprite_instance.cpp:  fixed elvis.swf bug

2006-06-30 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp (SWFHandlers::ActionLogicalOr):
	"or" values, don't "and" them.

2006-06-30 Vitaly Alexeev <tishka92@yahoo.com>

	* server\character.h:  fixed small bug
	* server\swf\ASHandlers.cpp:  fixed small bug


2006-06-30 Sandro Santilli <strk@keybit.net>

	* server/Global.cpp: removed useless C-style casts.
	* server/ActionExec.cpp: print stack debugging
	informations during actions execution if DEBUG_STACK
	is defined (undef by default) and -v is given on command line.
	* server/swf/ASHandlers.cpp, server/swf/ASHandlers.h:
	static action handlers made private in SWFHandlers class;
	added an SWFHandlers::action_name(action_type) utility method.
	* server/as_environment.h (dump_stack): display stack contents
	on a single line, to enhance readibility of stack changes.
	* server/action.cpp: removed useless ASHandlers.h include.
	* gui/gui.cpp: added missing sprite_instance.h
	include after refactoring commit.

2006-06-29 Vitaly Alexeev <tishka92@yahoo.com>

	* server\actionexec.h:  ported to win32
	* server\ActionExec.cpp: commented unnecessary log_msg
	* server\character_def.h: ported to win32
	* server\as_environment.h: ported to win32
	* server\action_buffer.cpp: ported to win32
	* server\dlist.cpp: added "onClipEvent(construct, unload)" handlers
	* server\Function.cpp: fixed tiny bug
	* server\Global.cpp: removed unnecessary assert
	* server\sprite_instance.cpp: added lost m_display_list.reset()
	* server\swf\tag_loaders.cpp: added "onClipEvent(construct) handler
	* server\swf\ASHandlers.cpp: ported to win32
	* gnash.vcproj: added new files


2006-06-29 Sandro Santilli <strk@keybit.net>

	* server/ASHandlers.cpp (ActionWaitForFrame): added stack size check.
	* server/ASSound.cpp, server/ActionExec.cpp, server/Function.cpp,
	server/Global.cpp, server/MovieClipLoader.cpp, server/action.cpp,
	server/as_environment.cpp, server/as_environment.h,
	server/as_value.cpp, server/as_value.h, server/button.cpp,
	server/button.h, server/character.cpp, server/character.h,
	server/character_def.cpp, server/character_def.h,
	server/edit_text_character.cpp, server/edit_text_character.h,
	server/edit_text_character_def.cpp, server/edit_text_character_def.h,
	server/generic_character.h, server/impl.cpp, server/morph2.cpp,
	server/movie.h, server/movie_def_impl.cpp, server/movie_interface.h,
	server/movie_root.cpp, server/movie_root.h,
	server/shape_character_def.cpp, server/sprite_definition.cpp,
	server/sprite_definition.h, server/sprite_instance.cpp,
	server/sprite_instance.h, server/timers.cpp, server/xmlsocket.cpp,
	server/swf/ASHandlers.cpp:
	Big cleanup aimed at reducing model complexity.
	Use of the 'movie' has been drastically reduced, the aim
	is completely drop it.
	Every sprite is a sprite_instance, including the
	_root movie. We still have a movie_root class
	(with a sprite_instance pointer being the _root movie)
	representing the actual movie being played.

2006-06-28 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp, server/Function.cpp: updated to work
	with the private as_environment::m_target.
	* server/as_environment.h:  m_target made private.
	* server/as_environment.cpp (find_target): assert that
	an as_value of type OBJECT can be cast to an object.
	* server/Makefile.am, server/character_def.cpp, server/impl.cpp:
	Put character_def implementation in its own file.
	* server/character_def.h: Added missing forward declarations.

2006-06-27 Sandro Santilli <strk@keybit.net>

	* server/swf/ASHandlers.cpp, server/ActionExec.cpp: moved
	all known action handlers implementations from ActionExec
	to ASHandlers, general cleanups.
	* server/swf/ASHandlers.cpp: fixed bug in ActionDefineFunction2.

2006-06-26 Sandro Santilli <strk@keybit.net>

	* server/Function.h, server/Function.cpp: added assertion checking
	in set_length() and constructor by action_buffer.
	* server/swf/ASHandlers.cpp: fixed ActionDefineFunction impl.
	* server/ActionExec.cpp: fixed handling of ACTION_RETURN.

2006-06-25 Sandro Santilli <strk@keybit.net>

	* server/ActionExec.cpp, server/ActionExec.h,
	server/Makefile.am: new class for action_buffer
	execution context.
	* server/Function.cpp, server/Function.h:
	use action_buffer by const pointers .
	* server/action_buffer.cpp, server/action_buffer.h:
	added utility functions to read data from the buffer
	to eventually use a stream instead.
	* server/swf/ASHandlers.cpp, server/swf/ASHandlers.h:
	SWFHandlers made a singleton (hopefully fixes the static
	initialization problem), used a fixed-size vector
	for SWFHandlers::_handlers  (faster). Ported some
	ActionHandlers from ActionExec (work unfinished).

2006-06-24 Sandro Santilli <strk@keybit.net>

	* server/movie_def_impl.h, server/movie_definition.h,
	server/sprite_definition.h: changed add_init_action()
	signature to drop unused sprite_id parameter.
	* server/Boolean.cpp, server/Camera.cpp, server/Color.cpp,
	server/ContextMenu.cpp, server/CustomActions.cpp
	server/Date.cpp, server/Error.cpp, server/ASSound.cpp,
	server/Key.cpp, server/LoadVars.cpp, server/LocalConnection.cpp,
	server/Microphone.cpp, server/Mouse.cpp, server/NetStream.cpp,
	server/Selection.cpp, server/SharedObject.cpp, server/Stage.cpp,
	server/System.cpp, server/TextSnapshot.cpp, server/Video.cpp,
	server/action.cpp, server/button.cpp, server/character.h,
	server/character_def.h, server/execute_tag.h, server/movie.h,
	server/movie_root.h, server/swf/tag_loaders.cpp:
	removed unused parameter warnings.

2006-06-22 Sandro Santilli <strk@keybit.net>

	* server/Function.cpp, server/MovieClipLoader.cpp, server/action.cpp,
	server/as_environment.cpp, server/as_environment.h,
	server/sprite_instance.cpp, server/sprite_instance.h,
	server/textformat.cpp, server/timers.cpp, server/xml.cpp,
	server/xmlsocket.cpp, server/swf/ASHandlers.cpp:
	Added as_environment::{get,set}_variable{,_raw} versions
	w/out with_stack argument, those with "with_stack" arg moved
	to private space. All files updated to avoid use of dummy
	(empty) with_stack objects.
	* server/Function.cpp, server/Function.h:
	updated doxygen comments, used size_t for action_buffer
	offsets and length.

2006-06-21 Vitaly Alexeev <tishka92@yahoo.com>

	* server/action_buffer.h: removed unnecessary operator=
	* server/action.cpp: fixed "static SWFHandlers ash;" problem
	* server/swf/ASHandler.cpp: fixed "static SWFHandlers ash;" problem
	* server/action_buffer.cpp: fixed "static SWFHandlers ash;" problem
	* server/action_buffer.h: added operator=
	* server/gnash.h: ported to win32
	* server/impl.h: removed read() from swf_event
	* server/swf/tag_loader.cpp: added multi-event handler
	* gnash.vcproj: added new files

2006-06-21 Sandro Santilli <strk@keybit.net>

	* doc/C/internals.xml: more info about writing ActionScript tests
	and layout under testsuite/
	* testsuite/actionscript.all/xtrace.as: commented out xtrace
	engagement message (not more needed since check.as prints testfile
	info)
	* testsuite/actionscript.all/String.as: added inheritance checks.
	* testsuite/actionscript.all/Makefile.am: fixed duplicated
	defines when building online tests.
	* testsuite/actionscript.all/: added rcsid variable
	to all testfiles, had check.as print testfile info at
	the beginning rather then at each check.
	* testsuite/actionscript.all/Makefile.am: made online-test rule
	work with external build dir.

2006-06-20 Sandro Santilli <strk@keybit.net>

	* server/Makefile.am, server/action.cpp, server/action.h,
	server/action_buffer.cpp, server/action_buffer.h,
	server/as_environment.cpp, server/impl.h, server/textformat.cpp,
	server/with_stack_entry.h, server/swf/ASHandlers.cpp:
	moved action_buffer and with_stack_entry classes in their own
	files.

2006-06-19 Michael Carlson <corfe83dev@gmail.com>

	* server/string.cpp: Eliminate wasteful if/else and 
	string_method function,	implement several string functions
	* testsuite/actionscript.all/string.as: Initial String tests
	* testsuite/actionscript.all/Makefile.am: Build string.swf

2006-06-19 Vitaly Alexeev <tishka92@yahoo.com>

	* server/movie_def_impl.h: fixed bug #16882

2006-06-19 Vitaly Alexeev <tishka92@yahoo.com>

	* server/character.h: added has_keypress_event() method
	* server/action.h: updated  event name
	* server/action.cpp: updated  event name
	* server/Key.h: added keypress event handler
	* server/Key.cpp: added keypress event handler
	* server/sprite_instance.h: added m_has_keypress_event
	* server/sprite_instance.cpp: added call to keypress listeners
	* server/swf/tag_loaders.cpp: updated s_code_bits

2006-06-19 Sandro Santilli <strk@keybit.net>

	* server/sound_handler_mp3.cpp: fix build bug #16836.
	* server/swf.h: added symbolic names for fill_style types.
	* server/styles.h: some indentation and doxygen comments.
	* server/styles.cpp: use symbolic names for fill_style types,
	stricter checks on them, accept hard-edges versions of
	CLIPPED and TILED bitmap fills.

2006-06-15 Sandro Santilli <strk@keybit.net>

	* server/action.cpp (call_method): include method name in 
	not-a-function error message.
	* server/as_environment.h: changed drop(), top() and bottom()
	methods to take size_t rather then int and to check stack
	size; added (public) stack_size() method.
	* server/swf/ASHandlers.cpp (SWFHandlers::ActionPop):
	handle empty stack condition.
	* server/edit_text_character.cpp: don't abort when text doesn't
	fit into the defined boundaries (fixes bug #16637).
	* server/edit_text_character.h: more stuff made private.
	* server/edit_text_character_def.h: added do_word_wrap() method.

2006-06-15 Vitaly Alexeev <tishka92@yahoo.com>

	* server/action.h:  add clip_event_keypress & clip_event_construct hack
	* server/action.cpp:   add clip_event_keypress & clip_event_construct hack
	* backend/gnash.cpp:  add SDLK_0 -- SDLK_9
	* server/swf/tag_loaders.cpp:  add clip_event_keypress & clip_event_construct hack
	* server/movie_root.cpp: small optimization
	* server/sprite_instance.cpp:  small optimization

2006-06-14 Vitaly Alexeev <tishka92@yahoo.com>

	* server/movie.h: comment on_event_load()
	* server/movie_root.h: comment m_on_event_load_called
	* server/sprite_instance.h: add advance_root(), advance_sprite()
	* server/dlist.cpp: replace on_event_load -->execute_frame_tags(0)
	* server/movie_def_impl.cpp: add execute_frame_tags(0)
	* server/movie_root.cpp: replace advance() --> advance_root()
	* server/sprite_instance.cpp:  add advance_root(), advance_sprite(), update advance()


2006-06-13 Sandro Santilli <strk@keybit.net>

	* server/movie.h: removed most warnings about unused
	parameters, indentation.
	* testsuite/media/Bitstream Vera Sans.COPYRIGHT,
	testsuite/media/Bitstream Vera Sans.fdb: added
	fdb font from Ming project, for embedding in test
	units.
	* testsuite/media/README: info about media files
	(incomplete).
	* testsuite/misc-ming.all/Makefile.am,
	testsuite/misc-ming.all/DefineEditTextTest.c:
	updated DefineEditTextTest file to use embedded
	fonts, we can now reproduce bug #16637.

2006-06-12 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/DefineEditTextTest.c,
	testsuite/misc-ming.all/Makefile.am,
	testsuite/misc-ming.all/defineedittext.c:
	defineedittext.c renamed to DefineEditTextTest.c,
	added some more code to get closer to what's in the
	testfile from bug #16637 (missing embedded fonts)
	* server/swf/ASHandler.cpp: (ActionDeleteVar): fixed
	call to as_object::set_member (as_value passed by
	const ref, not pointer).

2006-06-11 Vitaly Alexeev <tishka92@yahoo.com>

	* libbase/log.cpp: fix trace("") bug
	* libbase/rc.cpp: porting to WIN32
	* libbase/URL.cpp: porting to WIN32
	* backend/gnash.cpp: add mysql_db call
	* server/gnash.h: add register_component(...)
	* server/action.cpp: add register_component(...)
	* server/movie_root.cpp: add next_random() call to advance()
	* server/System.cpp: porting to WIN32
	* server/swf/ASHandler.cpp: add ActionDeleteVar
	* extensions/mysql/mysql_db.cpp: new file
	* extensions/mysql/mysql_db.h: new file
	* extensions/mysql/mysql_table.cpp: new file
	* extensions/mysql/mysql_table.h: new file
	* extensions/mysql/README: new file
	gnash.vcproj: new file


2006-06-10 Sandro Santilli <strk@keybit.net>

	* libbase/log.cpp: avoid buffer overflows.

2006-06-08 Sandro Santilli <strk@keybit.net>

	* server/impl.cpp: save URL::str() return into a local variable.
	* gui/gnash.cpp: updated to use new dbgfile facilities.
	* backend/gtksup.cpp: fixed compiler warnings.
	* utilities/parser.cpp, utilities/processor.cpp:
	use extern rcfile.

2006-06-08 Rob Savoye <rob@wharfrat.welcomehome.org>

	* plugin/plugin.cpp: Adjust the size of the URL buffer based on
	size. Gracefully handle an error when we get "&&" in a URL so
	Firefox doesn't crash.
	* plugin/klash/klash.cpp: Use new logging functions for actions
	and parsing.


	* libbase/URL.cpp: Add support for using the config file for
	security settings. Add host_check() to compare a hostname against
	security settings before accessing remote Flash movies. Look for
	_WIN32 as well as just WIN32.
	* libbase/URL.h: Add host_check().
	* libbase/rc.cpp: Default all security settings to false.
	* server/Date.cpp: Look for _WIN32 as well as just WIN32.
	* server/action.cpp: Look for _WIN32 as well as just WIN32.

2006-06-07 Rob Savoye <rob@darkstar.welcomehome.org>

	* configure.ac: Add config dir for compat files like
	getopt.c. Look for getopt, and replace it if it doesn't exist.
	* backend/gnash.cpp: Remove getopt code for win32, it's in it's
	own file now.
	* libbase/container.h: Look for _WIN32 as well as just WIN32. 
	* libbase/curl_adapter.cpp: Look for _WIN32 as well as just WIN32. 
	* libbase/log.cpp: Look for _WIN32 as well as just WIN32. 
	* libbase/log.h: Look for _WIN32 as well as just WIN32. 
	* libbase/tu_types.h: Look for _WIN32 as well as just WIN32. 
	* libbase/utility.h: Look for _WIN32 as well as just WIN32. 
	* libbase/tu_timer.h: Look for _WIN32 as well as just WIN32. 
	* libbase/tu_opengl_includes.h: Look for _WIN32 as well as just
	WIN32.
	* libbase/getopt.c: Replacement function for win32.
	
	* backend/gnash.cpp: Load config file, and use those values if
	they exist. Command line options override config file settings.
	* backend/gtksup.cpp: Trap the shift and control modifier keys
	too.
	* backend/gtksup.h: Don't initialize externs.
	* backend/sound_handler_sdl.cpp: Use new logging macros.
	* libbase/Makefile.am: Add SDL libs.
	* libbase/log.cpp: Add log_action() and log_parse() to replace the
	old macros.
	* libbase/log.h: Add support for optionally logging actions and
	parsing.
	* libbase/rc.cpp: Add support for optionally logging actions and
	parsing. Add extractNumber() for numeric config file values. Add
	dump() method.
	* libbase/rc.h: Add new config file options for optionally logging
	actions and parsing.
	* server/ASSound.cpp: Use new logging functions for actions and
	parsing. 
	* server/Function.cpp: Use new logging functions for actions and
	parsing.
	* server/Global.cpp: Use new logging functions for actions and
	parsing. Put in gnash namespace.
	* server/Key.cpp, Key.h: Add copyright notice.
	* server/action.cpp: Use new logging functions for actions and
	parsing.
	* server/array.cpp: Use new logging functions for actions and
	parsing.
	* server/as_environment.cpp: Use new logging functions for actions
	and parsing.
	* server/as_object.cpp: Use new logging functions for actions and
	parsing.
	* server/button.cpp: Use new logging functions for actions and
	parsing.
	* server/dlist.cpp: Use new logging functions for actions and
	parsing.
	* server/edit_text_character_def.cpp: Use new logging functions
	for actions and parsing.
	* server/font.cpp: Use new logging functions for actions and
	parsing.
	* server/fontlib.cpp: Use new logging functions for actions and
	parsing.
	* server/impl.cpp: Use new logging functions for actions and
	parsing.
	* server/morph.cpp: Use new logging functions for actions and
	parsing.
	* server/morph2.cpp: Use new logging functions for actions and
	parsing.
	* server/movie_def_impl.cpp: Use new logging functions for actions
	and parsing.
	* server/movie_root.cpp: Use new logging functions for actions and
	parsing.
	* server/shape_character_def.cpp: Use new logging functions for
	actions and parsing.
	* server/sound.cpp: Use new logging functions for actions and
	parsing.
	* server/sound_handler_mp3.cpp: Use new logging functions for
	actions and parsing.
	* server/sprite_definition.cpp: Use new logging functions for
	actions and parsing.
	* server/sprite_instance.cpp:Use new logging functions for actions
	and parsing.
	* server/stream.cpp:Use new logging functions for actions and
	parsing.
	* server/styles.cpp:Use new logging functions for actions and
	parsing.
	* server/text.cpp: Use new logging functions for actions and
	parsing.
	* server/types.cpp:Use new logging functions for actions and
	parsing.
	* server/types.h:Use new logging functions for actions and
	parsing.
	* server/swf/ASHandlers.cpp: Use new logging functions for actions
	and parsing.
	* server/swf/tag_loaders.cpp: Use new logging functions for actions
	and parsing.
	* testsuite/libbase/Makefile.am: Comment out Log test case for
	now.
	* testsuite/libbase/gnashrc.in: Add items for all config values.
	* utilities/parser.cpp: Use new logging functions for actions
	and parsing.
	* utilities/processor.cpp: Use new logging functions for actions
	and parsing.

2006-06-01 Vitaly Alexeev <tishka92@yahoo.com>
	* server/Math.h: porting to WIN32
	* server/network.h: porting to WIN32
	* server/network.cpp: porting to WIN32
	* server/Global.cpp: LocalConnection & NetConnection in WIN32 now
	* server/impl.cpp: commented printf
	* libbase/curl_adapter.h: porting to WIN32

2006-05-30  Rob Savoye  <rob@ripple.welcomehome.org>

	* plugin/plugin.h: Comment out debug print statements.
	* plugin/plugin.cpp: General code cleanup, comment out debug print
	statements.
	* plugin/Makefile.am: Copy, don't use libtool to install the
	plugin.
	
2006-05-29  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* plugin/plugin.cpp: Change the description strings so the flash
	version is detected correctly.
	* macros/opengl.m4: Look in 64 bit directories after the 32 bit
	ones.
	* macros/zlib.m4: Look in 64 bit directories after the 32 bit
	ones.
	* libbase/rc.h: Add extractSetting() for support function to get
	values from the config file.
	* libbase/rc.cpp: Use extractSetting(), rather than duplicating
	all the code.
	* libbase/tu_types.h: Check for more variations of the ENDIAN
	constants. Bug #16682.

2006-05-30 Rob Savoye <rob@wharfrat.welcomehome.org>

	* configure.ac: Link to the test config file in
	testuites/libbase.
	* libbase/Makefile.am: Add rc.{h,cpp}.
	* libbase/rc.h, rc.cpp: Config file support.
	* testsuite/libbase/Makefile.am: Add Rc file test case.

2006-05-29 Stefan Schweizer <sschweizer@gmail.com>

	* macros/gtkglext.m4: Fix gnash building with confcache.

2006-05-29 Sandro Santilli <strk@keybit.net>

	* server/dlist.h, server/dlist.cpp: renamed display_list
	to DisplayList and made a real class, many functions moved
	to private space, abstracted underlying container to allow
	for future modifications aimed at performance improvements;
	current implementation done with std::list.
	* server/sprite_instance.h, server/sprite_instance.cpp:
	updated to use the new DisplayList class interface.

2006-05-27 Vitaly Alexeev <tishka92@yahoo.com>

	* server/action.h: updated forward declaration.
	* server/resource.h: updated forward declaration.
	* server/fn_call.h: updated forward declaration.
	* server/gnash.h: added some sound_handler methods.
	* server/ASHandler.cpp: added stopAllSounds;
	* server/ASSound.cpp: added some sound methods.
	* server/button.cpp: added 3-rd parameter in play_sound.
	* server/sound.cpp: added 3-rd parameter in play_sound.
	* libbase/log.cpp: fixed va_start bug.
	* backend/sound_handler_sdl.cpp: added some sound methods.

2006-05-26 Sandro Santilli <strk@keybit.net>

        * testsuite/misc-ming.all/PlaceObject2Test.c,
        testsuite/misc-ming.all/RemoveObject2Test.c,
        testsuite/misc-ming.all/Makefile.am: added
        tests for PlaceObject2 and RemoveObject2 tags.

2006-05-26 Patrice Dumas <pertusus@free.fr>

	* doc/C/.cvsignore: add more doc files. 
	
2006-05-25 Vitaly Alexeev <tishka92@yahoo.com>

	* Forward declarations should correspond to definition in Visual
	C. Updated all headers where it not so.
	* container.h: added hash from gameSWF. There are problems with
	stdext:hash in WIN32. 
	* backend/gnash.cpp: fixing upside-down (flipped horizontally). 

2006-05-25 Vitaly Alexeev <tishka92@yahoo.com>

	* Forward declarations should correspond to definition in Visual C.
	Updated all headers where it not so.
	* container.h: added hash from gameSWF. There are problems with
	stdext:hash in WIN32. 
	* tu_types.h: added types from inttypes.h for WIN32
	* action.cpp: ported to WIN32
	* global.cpp: The network for WIN32 is commented. It does not work.
	* log.cpp: ported to WIN32

2006-05-24 Patrice Dumas <pertusus@free.fr>

	* server/Makefile.am: swap order of lib_LTLIBRARIES.
	* plugin/Makefile.am: remove redundant lib flags for plugin.
	* configure.ac, plugin/Makefile.am: removed references to
	the unused Xmu library.
	* macros/atk.m4, macros/glib.m4, macros/gstreamer.m4,
	macros/gtk2.m4, macros/gtkglext.m4, macros/pango.m4,
	macros/sdl.m4: added namespace-like prefixes to commonly
	used ${version} and ${topdir} variables.

2006-05-24 Bernhard Rosenkraenzer <bero@arklinux.org>

	* plugin/klash/klash.cpp: made URL aware.

2006-05-24 Sandro Santilli <strk@keybit.net>

	* plugin/klash/klash.cpp: removed obsoleted
	file_opener callback use.

2006-05-23 Sandro Santilli <strk@keybit.net>

	* macros/gtkglext.m4: check for gtkglext no matter
	wheter plugin has been requested or not, fixed
	messages during autodetection attempts, cleanly
	handled --with-glext-incl switch (make sure to
	set the $version variable).

2006-05-23 Patrice Dumas <pertusus@free.fr>

	* Makefile.am: gui and plugin unconditionnaly in DIST_SUBDIRS.
	* server/Makefile.am: distribute fn_call.h.
	* doc/omf.make: don't use -p $(scrollkeeper_localstate_dir) such
	that nothing is installed in the staged install directory.

2006-05-22 Sandro Santilli <strk@keybit.net>

	* gui/sdl.cpp: fixed bug in SDL gui preventing movie advances.
	* configure.ac: abort with an error at configure time if gui==gtk 
	and libgtkgl is not found.

2006-05-21 Sandro Santilli <strk@keybit.net>

	* server: action.h, fn_call.h, *: moved
	fn_call struct definition in its own file
	* server/gen-files.sh: added fn_call.h include
	in implementation file and as_object.h include
	in header file. Updated all files for new header.

2006-05-20 Vitaly Alexeev <tishka92@yahoo.com>

	* server/gnash.h: struct font; --> class font;
	* server/impl.h: struct font; --> class font;
	* server/resource.h: struct font; --> class font;
	* server/swf/tag_loaders.h: class movie_definition; --> struct
	movie_definition; 
	* server/swf/TagLoaderTable.h:  class movie_definition; --> struct
	movie_definition; 
	* server/edit_text_character_def.cpp:  class movie_definition; -->
	struct movie_definition; 
	* server/as_value.cpp: porting to WIN32
	* server/backend/gnash.cpp: getopt for WIN32
	* server/SreamProvider.cpp: porting to WIN32
	* server/System.cpp: porting to WIN32
	* server/swf/tag_loaders.cpp: pow(2,... --> pow(2.0,...
	* libbase/URL.cpp: porting to WIN32


2006-05-19 Sandro Santilli <strk@keybit.net>

	* server/Makefile.am, server/action.cpp, server/action.h,
	server/as_environment.cpp,  server/as_environment.h,
	server/movie.h: put as_environment class in it's own
	files.
	* testsuite/libbase/.cvsignore: new file
	* testsuite/misc-ming.all/.cvsignore: new file
	* server/swf/tag_loaders.{cpp,h}: doxygen comments for
	define_font_info_loader().
	* server/font.{cpp,h}: doxygen comments.
	* testsuite/misc-ming.all/Makefile.am,
	testsuite/misc-ming.all/defineedittext.c:
	added test for DefineEditText tag (gnash crashes)

2006-05-18 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/definebitsjpeg2.c: added copyright
	header
	* testsuite/misc-ming.all/moviecliploader_test.c: added
	copyright header
	* Makefile.am, configure.ac, macros/firefox.m4:
	moved handling of --enable-plugin from firefox macro
	to top-level configure so you can disable build in
	the plugin/ dir (--disable-plugin didn't work).
	* server/edit_text_character_def.h, server/edit_text_character.cpp
	edit_text_character_def made a real class, ensuring data
	members are never changed. Type of variables holding twips
	values changed from float to uint16_t (a definition is immutable
	anyway, and we read uint16_t from the stream)
	* server/edit_text_character.h, server/edit_text_character_def.cpp:
	updated to use edit_text_character_def interface (no more
	direct members access). Added a private 'font' member to allow
	for replacement of it from ActionScript code (not sure this
	is required).
	* server/text.cpp, server/text.h: changed text_style::m_font
	member to be a const pointer.
	* server/StreamProvider.cpp: fixed compiler warning
	in absence of libcurl.
	* server/Makefile.am, server/edit_text_character.cpp
	server/edit_text_character.h, server/edit_text_character_def.cpp,
	server/edit_text_character_def.h, server/text.h,
	server/swf/tag_loaders.cpp: extracted edit_text_character
	class from text.h.
	* server/generic_character.h: struct => class, headers
	inclusion streamlined.
	* server/Makefile.am, server/edit_text_character_def.cpp,
	server/edit_text_character_def.h, server/text.cpp,
	server/text.h: moved edit_text_character_def class and
	implementation in its own file.
	* server/textformat.cpp: fixed compiler warnings

2006-05-18 Patrice Dumas <pertusus@free.fr>

	* doc/omf.make: don't use DESTDIR for scrollkeeper-update cache
        directory, such that scrollkeeper-update fails if not run at
        root, instead of creating directories that are left over when
        doing staged install.
	* doc/C/Makefile.am: add - in front of the install-info version
	test to ignore errors.

2006-05-17 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/gnash.cpp: Create the OpenGL render handler only after
	OpenGL has been initialised.

2006-05-17 Sandro Santilli <strk@keybit.net>
	
	* server/StreamProvider.cpp: added temporary support for
	prompting user about Grant/Bock of URL accesses. If input
	is not a terminal default to allow from all.
	* backend/gtksup.h: fixed preprocessor instructions comments
	* gui/gnash.cpp: fixed handling of -h flag (force exit 
	after printing usage string); added comments to
	removal of file_opener stuff.
	* gui/Makefile.am: use new USE_GUI_* conditionals
	to avoid references to unrequested dependencies.
	Move KDE deps to klash_LDFLAGS (from AM_LDFLAGS)
	* configure.ac: fixed handling of --enable-gui switch,
	added AM_CONDITIONALs USE_GUI_<what>
	* server/xml.cpp: fixed compiler warnings.

2006-05-16 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gnash.cpp: Update to recent API changes.

2006-05-16 Bastiaan Jacques <bastiaan@bjacques.org>

	* macros/gtkglext.m4: Prepend only one -I per added include dir.

2006-05-16 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/gnash.cpp, gui/{gtk_glue_gtkglext,kde_glue_opengl}.cpp:
	Remove OpenGL initialisation code.
	* backend/render_handler_opengl.cpp: Add OpenGL initialisation code
	into create_render_handler_ogl().
	* server/gnash.h, backend/render_handler_cairo.cpp: Modify
	create_render_handler_cairo() to accept an argument which is the Cairo
	handle to which the renderer will draw.
	* backend/gnash.cpp: Remove the hacky cairo binding. If you
	want to try the Cairo backend, use the GUI library in gui/.

2006-05-16 Sandro Santilli <strk@keybit.net>

	* server/action.cpp: use GUI_GTK rather then HAVE_GTK2
	* macros/gtk2.m4: fixed ac_cv_path_gtk2_incl setting to
	always include -I, compute ${version} even when
	--with-gtk2-incl is used (needed to find gdkconfig.h).

2006-05-16 Rob Savoye <rob@wharfrat.welcomehome.org>

	* macros/glib.m4: Look for the config file the brute force
	way.
	* macros/gtk2.m4: Look for the config file the brute force
	way.
	* macros/gtkglext.m4: Look for the config file the brute force
	way.
	* macros/opengl.m4: Look in /usr/lib*/opengl/xorg-x11/lib for
	libGL.

2006-05-16 Sandro Santilli <strk@keybit.net>

	* backend/gnash.cpp, server/gnash.h,
	server/Makefile.am, server/StreamProvider.cpp,
	server/StreamProvider.h, server/impl.cpp,
	utilities/processor.cpp: removed register_file_opener_callback()
	global call, added gnash::globals namespace with streamProvider
	default instance for the new StreamProvider class.
	* gui/sdlsup.h: don't attempt at including cairo.h
	if not using cairo rendered.
	* server/swf/ASHandlers.cpp: fixed compiler
	warnings, print value of failed target for
	callMethod tags.
	* server/MovieClipLoader.cpp, server/gnash.h,
	server/impl.cpp: create_movie() split to
	create_swf_movie() and create_jpeg_movie().
	The former will call one of the latters based
	on input stream magic number.
	* server/MovieClipLoader.cpp: fixed relative url resolution
	to use target's parent url, not target url.
	* server/gnash.h, server/impl.cpp: changed definition
	of file_opener_callback, create_movie and
	create_library_movie to take an URL parameter.
	* server/swf/tag_loaders.cpp, server/MovieClipLoader.cpp,
	server/action.cpp: updated to use new signatures of
	movie loaders.
	* backend/gnash.cpp, utilities/processor.cpp:
	updated file_opener signature, use curl_adapter
	when available.
	* server/movie_def_impl.{h,cpp}: changed
	read() method to return bool (false on error)

2006-05-15 Sandro Santilli <strk@keybit.net>

	* server/as_object.cpp: fixed compiler warnings.
	* libbase/: GnashException.h, Error.h, curl_adapter.cpp,
	URL.cpp: renamed gnash::Error to gnash::GnashException
	( we already had an Error class, modeling an ActionScript
	object )
	* libbase/URL.cpp: throw gnash::Error on error.
	* libbase/: Makefile.am, Error.h, curl_adapter.cpp:
	moved Error class to own file, and in gnash namespace.
	* server/: Makefile.am, as_value.cpp, action.cpp:
	moved as_value class implementation from action.cpp
	to as_value.cpp.
	* libbase/URL.{cpp,h}: refactored path normalization procedure
	to split path in components, remove unneeded ones and
	resolve back-references, removed all uses of <cstring>
	* testsuite/libbase/URLTest.cpp: added check.as-like macros,
	new tests for path normalization, changed expected paths
	for 'file' urls to always start with three slashes (file:///)

2006-05-14 Rob Savoye <rob@darkstar.welcomehome.org>

	* libbase/Makefile.am: Remove OPENGL_LIBS from _LIBADD, it causes
	OpenGL to hang on my Ubuntu system.
	* libbase/log.cpp: Add hexify() for printing numbers. Trap '\n'
	when coming in from log_msg() and convert to std::endl.
	* libbase/log.h: Add hexify().
	* server/Makefile.am: Add swf/ASHandlers to libgnashserver.
	* server/action.cpp: Remove old switch table for processing
	opcodes and use ASHandlers instead.
	* server/swf/tag_loaders.cpp: Add dbglogfile instead of
	log_msg().
	* server/swf/ASHandlers.cpp, ASHandlers.cpp: New file for SWF
	opcode handlers. These used to be part of action.cpp.

2006-05-14 Sandro Santilli <strk@keybit.net>

	* libbase/URL.{cpp,h}: handling of relative paths containing
	"../" components, handling of CWD-relative paths.
	* testsuite/libbase/URLTest.cpp: tests for "../"
	components in relative paths.

2006-05-13 Stefan Schweizer <genstef@gentoo.org>

	* libbase/Makefile.am: add CURL_LIBS and OPENGL_LIBS
	to libbase/Makefile.am, where it belongs.

2006-05-13 Sandro Santilli <strk@keybit.net>

	* configure.ac, testsuite/Makefile.am,
	testsuite/libbase/Makefile.am,
	testsuite/libbase/URLTest.cpp,
	testsuite/libbase/CurlStreamTest.cpp: unit
	testing for curl_adapter and URL class.
	* libbase/Makefile.am: add URL.{cpp,h} files
	* libbase/URL.{cpp,h}: initial implementation of
	an URL class.

2006-05-12 Sandro Santilli <strk@keybit.net>

	* utililites/Makefile.am, backend/Makefile.am: add CURL_LIBS.
	* libbase/Makefile.am: curl_adapter build.
	* Makefile.am: CURL config dump.
	* macros/curl.m4: libcurl detection macro.
	* libbase/curl_adapter.cpp, libbase/curl_adapter.h: initial
	implementation of a libcurl adapter for tu_file.

2006-05-12 Rob Savoye <rob@ripple.welcomehome.org>

	* configure.ac: Enable conditional for KDE.
	* gui/gnash.cpp: Reduce delay to 300 ms.
	* gui/gtk.cpp: Add support for configure event, so we can resize
	the viewport.
	* gui/gtk_glue_gtkglext.cpp: Unreference _glconfig and glcontext
	so Firefox doesn't crash.
	* gui/gtksup.h: Add unrealize event, remove resizeWindow.
	* gui/gui.cpp, gui/gui.h: Add method to resize the viewport. 
	* gui/kde.cpp: Use setGeometry() instead of resize(). Handle the
	resize event, and mouse events.
	* gui/kde_glue_opengl.cpp: Set the view so it's oriented
	correctly.
	* gui/kdesup.h: Add mouse event handlers.
	* gui/sdl.cpp, gui/sdlsup.h: Remove resizeWindow().
	* server/impl.cpp: Don't assert, return NULL if not initilized so
	we can use this to check the state.
	
	* gui/kde.cpp: New file for KDE support.
	* gui/kde_glue.h: New file for KDE support.
	* gui/kde_glue_opengl.cpp: New file for KDE support.
	* gui/kde_glue_opengl.h: New file for KDE support.
	* gui/kdesup.h: New file for KDE support.
	* gui/Makefile.am: Add support for Klash and KDE.
	* gui/gnash.cpp: Add support for building with KDE support.
	* gui/gtk.cpp: Use Gui class methods for movie control instead of
	having the code here.
	* gui/gtksup.h: run() now takes an argument.
	* gui/gui.cpp: Include movie_definition. Add methods for movie
	control. Move advance_movie() from gnash.cpp to here.
	* gui/gui.h: Add non virtual init() and createWindow(). Add static
	methods for movie control.
	* gui/sdl.cpp: run() now takes an argument.
	* gui/sdlsup.h: run() now takes an argument.
	
	* macros/glib.m4: Look for the internal config file in the lib dir
	in addition to the regular headers.
	* macros/gtk2.m4: Look for the internal config file in the lib dir
	in addition to the regular headers.
	* macros/gtkglext.m4: Look for the internal config file in the lib
	dir in addition to the regular headers.

	* configure.ac: Print a warning, not an error if Cairo or
	SDL_Mixer aren't installed. For bug #16560.
	* gui/*: Update to latest version of the Mozilla exemption.
	
	* configure.ac: Use AC_CONFIG_SRCDIR, and add the version number
	to AC_INIT. Define conditional for KDE. Add partial support to use
	kde and fltk as configure options to --enable-gui. Comment out
	visibility-inlines-hidden as it's unstable on some platforms.
	* macros/kde.m4: Define variables for conditional if KDE is
	installed.
	* plugin/klash/klash.cpp: Add code to replace SDL_GetTicks() so we
	don't have an SDL dependancy still.
	* server/Makefile.am: Don't have $OPENGL_LIBS in
	libgnashserver_la_LIBADD for now, for some reason it makes the
	executable not ever render an image if installed.

2006-05-12 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Use GTK as the default GUI.
	* gui/gtk_glue.h, gui/gtk_glue_cairo.{cpp,h},
	gui/gtk_glue_gtkglext.{cpp,h}: Introduce an abstraction class
	for Gtkglext and "GtkCairo" which connect (glue) GTK to the OpenGL
	and Cairo renderers, respectively.
	* gui/Makefile.am: Build the appropriate glue.
	* gui/README: Deprecate the SDL-based Firefox plugin.
	* gui/{gnash.cpp,gui.h,sdl.cpp}: No longer handle the OpenGL LOD bias
	parameter. It is now handled in the glue class.
	* gui/{gtk.cpp,gtksup.h}: Migrate to the new glue.
	* gui/gui.h: No longer handle the OpenGL LOD bias parameter.
	* gui/sdl.cpp: Scale mouse event coordinates according to the movie
	scale.

2006-05-11 Stefan Schweizer <genstef@gentoo.org>

	* libbase/Makefile.am, server/Makefile.am, plugin/klash/Makefile.am:
	Link needed libraries which are needed to link with --as-needed.

2006-05-11 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp: removed compiler warnings.
	* server/movie_def_impl.h: improved doc of
	the read() method.
	* configure.ac: added --enable-gui switch,
	defined GUI_SDL or GUI_GTK
	* backend/gnash.cpp: make ue of GUI_* defines rather
	then HAVE_GTK2 ones (you can have GTK2 and still want
	SDL gui).
	* gui/gnash.cpp: don't realy on HAVE_* defines to
	set GUI_* ones, but use GUI_* defines from config.h

2006-05-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gtk_cairo_create.h: Introduce an implementation for
	gdk_cairo_create() when it's not available.
	* gui/gtk.cpp: Include gtk_cairo_create.h for GTK < 2.8.

2006-05-10 Sandro Santilli <strk@keybit.net>

	* gui/DESIGN: a few design notes about the new gui efforts
	* macros/gtkglext.m4: fix AC_DEFINE macros to include a value
	* configure.ac: don't complain about missing CAIRO when not required
	* gui/gtk.cpp: include cairo.h if RENDERER_CAIRO is defined
	* gui/gtksup.h: include cairo.h if RENDERER_CAIRO is defined
	* macros/cairo.m4: search cairo dev files even if plugin is disabled
	* macros/gtk2.m4: fixed handling of --with-gtk2-lib, fixed AC_DEFINE
	call to actually give a value to HAVE_GTK2 define (some code in
	backend/gnash.cpp would fail otherwise - #ifndef HAVE_GTK2 namely)

2006-05-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gnash.cpp: Remove unused includes and do small cleanups.
	* gui/{gtk.cpp,gtksup.h}: Only compile OpenGL code if we have OpenGL.
	* gui/gui.cpp: Remove unused includes.

2006-05-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: SDL is not a backend, so don't pretend it is one.
	* configure.ac, macros/{atk,glib.gtk2,pango}.m4: We still want to know
	if these packages are available if gtkglext isn't, so remove the
	gtkglext checks, and fix the indentation to match.

2006-05-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/swf/tag_loaders.cpp: Struct swf_event is declared in namespace
	gnash, not gnash::SWF::tag_loaders; move the implementation into
	namespace gnash.

2006-05-09 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/moviecliploader_test.c,
	testsuite/misc-ming.all/Makefile.am:
	moviecliploader_test fixed to build using the new media dir
	and to test both relative and absolute url, both jpeg 
	and swf medias.
	* testsuite/media/green.swf, testsuite/media/lynch.swf,
	testsuite/media/offspring.swf: added definejpeg2 swf
	versions of the corresponding jpeg files.
	* testsuite/misc-ming.all/definebits_jpeg2.c,
	testsuite/misc-ming.all/Makefile.am:
	use argument to definebits_jpeg2 to find jpeg.
	* testsuite/media: new dir for storing media files, moved
	jpegs from actionscript.all to this new dir
	* server/movie_definition.h: added get_url() virtual method
	* server/movie_def_impl.cpp, server/movie_def_impl.h:
	implemented get_url() method, added url argument to the
	read() method.
	* server/sprite_definition.h, server/sprite_instance.cpp:
	implemented get_url() method.
	* server/impl.cpp: updated movie_def_impl constructions to
	pass the url method.
	* server/xmlattrs.h: fixed compiler warning about %p format used
	for non-void pointer.
	* libbase/zlib_adapter.h: doxygen comments
	* server/stream.h, server/stream.cpp: doxygen comments
	* server/sprite_definition.h, server/sprite_definition.cpp,
	server/impl.cpp: modified sprite_definition constructor to
	automatically read the SWF stream.
	* server/swf: new swf directory for SWF parsing related classes.
	* server/swf/TagLoadersTable.{h,cpp}: new class modeling a
	table of tag loaders.
	* server/swf/tag_loaders.{h,cpp}: tag loaders extracted
	from impl.cpp file and grouped into the swf namespace.
	* server/impl.cpp: (define_shape_loader) symbolic names for
	tag types 
	* server/movie_def_impl.cpp, server/movie_def_impl.h:
	new CharacterDictionary class.
	* server/movie_definition.h: updated doxygen comments.
	* server/sprite_definition.h: update doxygen comments.
	* configure.ac: added misc-ming.all directory's Makefile;
	fixed name of debian package for gtk2 (libgtk2-dev => libgtk2.0-dev)
	* testsuite/Makefile.am: added misc-ming.all subdir,
	* testsuite/actionscript.all/Makefile.am: Removed ming-generated
	binaries rules (moved to misc-ming.all)
	* testsuite/misc-ming.all: new test directory for ming-generated
	test files.

2006-05-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Compile with -fvisibility-inlines-hidden, if we're
	using gcc-4 or newer.

2006-05-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/gnash.cpp: Use the GTK backend by default; if GTK isn't
	available, fall back to SDL.
	* gui/{gtk.cpp,sdl.cpp}: Fix includes to match recent filename
	changes.

2006-05-08 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Build with -ansi by default.
	* libbase/tu_types.h: No longer depend on SDL for the endianness
	macros.
	* all over the place: Switch to the int types from inttypes.h rather
	than SDL.h. This will allow us to remove the dependency on SDL when
	sound is disabled and a frontend for Gnash other than SDL is used.

2006-05-08 Sandro Santilli <strk@keybit.net>

	* server/as_value.h, server/button.h, server/impl.cpp,
	backend/render_handler_ogl.cpp:
	removed commas at end of enums (for -ansi)

2006-05-08 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/tu_types.h: Use [u]int64_t rather than SDL 64-bit types.
	* all over the place: Use s[u]int64 (typedef'ed to [u]int64_t)
	rather than SDL 64-bit types. We can now compile with -ansi.

2006-05-08 Sandro Santilli <strk@keybit.net>

	* server/ASSound.h, server/Global.cpp, server/Global.h,
	server/Key.h, server/Makefile.am, server/Object.cpp,
	server/Object.h, server/action.cpp, server/action.h,
	server/as_member.h, server/as_object.cpp, server/as_object.h,
	server/as_prop_flags.h, server/as_value.h, server/gnash.h,
	server/movie_interface.h, server/ref_counted.h,
	server/textformat.cpp, server/textformat.h, server/types.cpp:

	* server/bitmap_character_def.h, server/character.cpp,
	server/character_def.h, server/character.h,
	server/generic_character.h, server/movie.h, server/ref_counted.h,
	server/resource.h, server/shape_character_def.cpp,
	server/shape_character_def.h, server/as_object.h, server/button.h,
	server/character_def.h, server/font.cpp, server/fontlib.cpp,
	server/gnash.h, server/impl.cpp, server/impl.h,
	server/Makefile.am, server/morph2.cpp, server/morph2.h,
	server/movie_def_impl.cpp, server/movie_def_impl.h,
	server/Object.h, server/shape.cpp, server/shape.h,
	server/styles.h, server/tesselate.h, server/text.cpp:
	new class files for as_member, as_object, as_prop_flags,
	as_value, character, shape_character_def, movie.

2006-05-07 Bernhard Rosenkraenzer <bero@arklinux.org>

	* plugin/klash/klash.cpp: include movie_definition.h
	instead of Movie.h

2006-05-07 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/sdl.cpp, gui/sdlsup.h: implement an SDL frontend. Implemented
	backends are Cairo and OpenGL.
	* gui/gtk.cpp, gui/gtksup.h: shuffle some code around, integrate
	better with Gui class. Make event handlers work.
	* gui/Makefile.am: Enable the SDL frontend.
	* gui/gnash.cpp: Implement the remaining features from the old
	gnash.cpp; make the commandline options work.
	* gui/gui.cpp, gui/gui.h: Add some needed variables and methods. Do
	some cleanup.

2006-05-07 Sandro Santilli <strk@keybit.net>

        * server/Makefile.am, server/Object.h,
        server/bitmap_character_def.h, server/button.h,
        server/character_def.h, server/generic_character.h,
        server/gnash.h, server/impl.cpp, server/impl.h, server/morph2.cpp,
        server/movie_def_impl.cpp, server/movie_def_impl.h,
        server/ref_counted.h, server/resource.h, server/shape.cpp,
        server/shape.h, server/styles.h: new class files for
	bitmap_character_def, character_def, generic_character,
	ref_counted and resource
	* renamed Movie.{h,cpp} to MovieClip.{h,cpp}
	* server/Makefile.am, server/Movie.cpp, server/Movie.h,
	server/Sprite.cpp, server/Sprite.h,
	server/impl.cpp, server/impl.h,
	server/sprite_definition.cpp, server/sprite_definition.h,
	server/sprite_instance.cpp, server/sprite_instance.h,
	backend/gnash.cpp, server/ASSound.cpp, server/Global.cpp,
	server/MovieClipLoader.cpp, server/action.cpp, server/button.cpp,
	server/font.cpp, server/fontlib.cpp, server/gnash.h,
	server/morph2.cpp, server/movie_def_impl.cpp,
	server/movie_def_impl.h, server/movie_definition.h,
	server/movie_interface.h, server/movie_root.cpp,
	server/movie_root.h, server/sound.cpp, server/styles.cpp,
	server/text.cpp, utilities/processor.cpp: 
	sprite_instance and sprite_definition are now real classes
	and are defined in their own files, named after the class
	themselves, same split for Movie.h file.

2006-05-05  Rob Savoye  <rob@ripple.welcomehome.org>

	* plugin/plugin.cpp: Don't compare supportsXEmbed to PR_TRUE.
	* packaging/redhat/gnash.spec: Make a gnash-klash package instead
	of just klash.
	* README: Update version number and date.

2006-05-04 Sandro Santilli <strk@keybit.net>

	* server/MovieClipLoader.cpp: cleanly handle
	attempts to load an external jpeg (complain
	rather then crash - see bug #15762

2006-05-03 Sandro Santilli <strk@keybit.net>

	* configure.in: accept OpenGL and Cairo args to
	--enable-renderer, as advertised in the help string.
	Print selected renderer in summary. Fixed a couple
	of typos.

2006-05-04 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui: Add a very initial implementation of the frontend (gui)
	library, which has a replacement for backend/gnash.cpp. The gui
	subdirectory has not yet been enabled.

2006-05-03  Tomas Groth Christensen  <tomasgroth@yahoo.dk>

	* server/Makefile.am: Compile ASSound.{cpp,h} instead of Sound.{cpp,h}

2006-05-03 Patrice Dumas <pertusus@free.fr>

	* doc/C/Makefile.am:  use $< instead of gnash.info for for
	install such that gnash.info from srcdir may be used; replace
	/sbin/install-info by install-info everywhere 
	* plugin/player.h: distribute player.h

2006-05-03 Sandro Santilli <strk@keybit.net>

	* server/array.cpp: removed compiler warnings
	* server/: Sound.cpp => ASSound.cpp, Sound.h => ASSound.h

2006-05-02 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Add --enable-renderer={opengl,cairo}.
	* backend/Makefile.am, backend/gnash.cpp, server/gnash.h:
	Compile and use Cairo if requested.

2006-05-02 Timothy Lee <timothy.lee@siriushk.com>

	* render_handler_cairo.cpp: Initial Cairo renderer backend
	implementation.

2006-04-30 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/gnash.cpp: Use the right signal name.

2006-04-29 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/{gnash.cpp,gtksup.cpp,gtksup.h}: Add a gtkgl
	unrealize_event handler which facilitates destruction of
	some gdkgl objects. This fixes shutdown leaks.

2006-04-28 Sandro Santilli <strk@keybit.net>

	* server/array.cpp: fixed bug in copy constructor.
	* server/Function.cpp, server/Function.h: added
	isBuiltin() public method and new constructor as
	a better support for built-in classes (I think we
	really need an abstract class and two derivates for
	user defined functions and built-in classes).
	* server/action.cpp: changed doActionNew to handle
	construction of built-in classes.
	* server/System.cpp, server/System.h, server/array.cpp,
	server/array.h: ported to new built-in class construction
	mechanism. Optimized and embellished as_array_object::join()
	method, inspired by Bastiaan :)

2006-04-28 Rob Savoye <rob@darkstar.welcomehome.org>

	* README: Add comments about runing autogen.sh and configure for
	bug #16451.
	* doc/C/sources.xml: Add comments about runing autogen.sh and
	configure for bug #16451.

2006-04-27 Rob Savoye <rob@wharfrat.welcomehome.org>

	* configure.ac: Comment out warnings about FLTK and Xft, these are
	only used by code under development for now.
	* macros/jpeg.m4: Make sure the head exists, not the lib before
	runing lib tests.
	* utilities/Makefile.am: Add PTHREAD_LIBS.


2006-04-27 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/Key.cpp: Stop using cleanup_listeners(). Use
	iterators instead of array indexing for listeners. Use
	C++-style rather than C-style casts.
	* server/Key.h: Remove cleanup_listeners().

2006-04-27 Stefan Schweizer <genstef@gentoo.org>

	* plugin/klash/Makefile.am: added KDE_LDFLAGS to AM_LDFLAGS.

2006-04-27 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/array.as: turned length()
	method calls to length data member accesses, completed
	switch to check_equals() macro usage, removed .pop() calls
	in macro args (would have unexpected results when macro fails).
	* server/: (Function.h, Function.cpp): added new constructor
	taking exported interface as argument.
	* server/: (System.cpp, System.h, Global.cpp): added System
	AS class registration, System.capabilities.version
	implementation and scheleton for AS instanciation of it
	(the latter being untested).
	* doc/C/internals.xml: added note about check_equals() macro
	under testing section.
	* server/: (Sound.cpp, Sound.h): added missing files
	* server/: (array.cpp, array.h): big cleanup, provided
	overrides for get_member() and set_member() to add support
	for the special 'length' element, turned array_as_object into
	a real class, enabled support for class-statics.
	* server/: (Object.cpp, Object.h): moved get_member
	and set_member to get_member_default and set_member_default
	with protected access level, provided public virtuals
	invoking the protected non-virtuals. This is to allow cleaner
	hooking for ActionScript classes.

2006-04-26  Timo Lindfors <timo.lindfors@iki.fi>

	* testsuite/actionscript.all/Boolean.as: added some
	simple checks for toString() and valueOf() methods.

2006-04-26  John Radio Gilmore  <gnu@radio.toad.com>

	* doc/C/sources.xml:  Fix typos, update misc build info.

2006-04-26 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/check.as: added check_equals()
	macro.
	* testsuite/actionscript.all/Global.as: example usage of
	the check_equals() macro.
	* server/gen-files.sh: fixed escaping in sed code
	* testsuite/actionscript.all/array.as: more use
	of the check_equals() macro
	* testsuite/actionscript.all/Makefile.am: fixed a bug
	in the v8-online-tests rule
	* server: Global.cpp, Global.h, Key.cpp, Key.h,
	Makefile.am, Math.cpp, Math.h, action.cpp, action.h,
	array.cpp, array.h: more code splitting.

2006-04-25  Rob Savoye  <rob@darkstar.welcomehome.org>

	* packaging/debian/changelog: Reverse the order of entries so it
	it uses the right GPG key for packages.
	* packaging/debian/control: Fix cut & paste error in Depends
	list.
	* packaging/debian/gnash-klash.install: Add klash executable.
	* server/shape.cpp: Support alternate tag value
	
	* plugin/klash/klash.cpp: Add player control menu for the right
	mouse button.
	* plugin/klash/Makefile.am: Build a MOC file for klash.cpp.
	
	* packaging/debian/gnash-klash.install: Add the klash executable.
	* packaging/redhat/gnash.spec: Add the klash executable.
	
	* libbase/jpeg.cpp: Add support for grayscale jpegs.
	* plugin/klash/Makefile.am: Add klash executable.
	* plugin/klash/klash.cpp: Build a KDE version of the standalone
	player for Konqueror.

2006-04-25 Bastiaan Jacques <bastiaan@bjacques.org>

	* libbase/smart_ptr.h: Introduce noref_ptr, a smart pointer without
	reference counting.

2006-04-24  Rob Savoye  <rob@ripple.welcomehome.org>

	* All GPL'd files: Update Mozilla copyright exemption to the
	latest version.

2006-04-24  Timothy Lee  <timothy.lee@siriushk.com>
	
	* libbase/image.cpp: Remove read_swf_jpeg2(), it's unnecessary now
	that read_jpeg() reads multiple headers.
	* libbase/jpeg.cpp: Read a jpeg with with multiple headers
	correctly.
	* server/impl.cpp: Call read_jpeg() instead of read_swf_jpeg2().

2006-04-23  Bastiaan Jacques  <bastiaan@bjacques.org>

	* server/Movie.cpp, server/Movie.h, server/Object.h,
	server/font.h, server/morph2.h, server/shape.h,
	server/stream.h, server/styles.h: Switch structs to classes.

2006-04-23  Bastiaan Jacques  <bastiaan@bjacques.org>

	* server/Movie.h: make movie_def_impl a friend of import_info.
	* server/Movie.cpp: adjust the users of import_info to match
	changes to Movie.h.

2006-04-22  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* doc/omf.make: Rename omf-hook to be more consistant.
	* doc/xmldocs.make: Set enable-ghelp and enable-docbook together.
	* doc/C/Makefile.am: Use /sbin/install-info. Don't try to run
	install-info if it doesn't exist.
	* packaging/redhat/gnash.spec: Remove the info/dir file.

	* macros/atk.m4: Look for libraries in /usr/X11R6/lib, and headers
	in /usr/X11R6/include.
	* macros/gtk2.m4: Look for libraries in /usr/X11R6/lib, and
	headers in /usr/X11R6/include.
	* macros/gtkglext.m4: Look for libraries in /usr/X11R6/lib.
	* macros/pango.m4: Look for libraries in /usr/X11R6/lib.
	
	* macros/fltk.m4: Look in X11R6 for headers.
	* macros/gtkglext.m4: Look in X11R6 for headers.
	* macros/pango.m4: Look in X11R6 for headers.
	* macros/sdl.m4: Find SDL on FreeBSD where vesion SDL11 is used
	instead of SDL-1.1.

2006-04-22  Bastiaan Jacques  <bastiaan@bjacques.org>

	* server/Movie.h: Make the import_info struct a proper class.
	* server/Movie.cpp: Adjust the users of import_info to match
	changes to Movie.h.
	
2006-04-21  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* packaging/redhat/gnash.spec: Install the dir file so the rpm
	builds.
	
	* doc/C/Makefile.am: Handle the different options the different
	versions of install-info support.
	
	* doc/C/Makefile.am: Create the info dir if it doesn't exist.
	* packaging/debian/changelog: Add new entry and up the version.
	* packaging/redhat/gnash.spec: Up the minor version. Install the
	info file.
	
	* packaging/debian/rules: Don't attempt to apply a patch that
	doesn't exist. Install the info file.
	* packaging/redhat/gnash.spec: Install the info file too.
	* plugin/Makefile.am: Add npplat.h to the dist target.
	* plugin/plugin.cpp: Don't include player.h, it's unused these
	days.
	
	* doc/xmldocs.make: Add the hook for installing and uninstalling
	the info file.
	* doc/C/Makefile.am: Install the info file.

2006-04-20  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/font.cpp: Delete the pointer the proper way.
	* doc/C/gnash-man.xml: Add the -j and -k options to the man page.
	
	* README: Clarify that no event handling means mouse clicks don't
	work with the SDL version of the plugin.
	* doc/C/internals.xml: Clarify that no event handling means mouse
	clicks don't work with the SDL version of the plugin.
	* doc/C/plugin.xml: Clarify that no event handling means mouse
	clicks don't work with the SDL version of the plugin.
	
	* libbase/triangulate_impl.h: Use the z modifier when printing a
	size_t.
	* plugin/plugin.cpp: Define start and end as a size_t, not an
	unsigned int.

	* configure.ac: Add FLTK. Don't create mozilla-sdk/Makefile.
	* Makefile.am: Add a dumpconfig target to see what configure
	found.
	* macros/fltk.m4: New configure tests for FLTK toolkit.
	* packaging/redhat/gnash.spec: Don't build libmozsdk, it's now
	part of the plguin.
	* plugin/Makefile.am: Build the sources in mozilla-sdk as part of
	the plugin, rather than as an additional shared library.
	* server/array.cpp: Use the z modifier when printing a size_t.
	* server/button.cpp: Use the z modifier when printing a size_t.
	* server/fontlib.cpp: Use the z modifier when printing a size_t.
	* server/shm.cpp: Use the z modifier when printing a size_t.
	* server/xmlnode.cpp: Use the z modifier when printing a size_t.
	* server/sound_handler_mp3.cpp: Remove unused variable.

2006-04-19  Bastiaan Jacques <bastiaan@bjacques.org>

	* server/action.cpp: fixed compiler warnings.

2006-04-18  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* backend/gnash.cpp: Turn off sound by default, since it doesn't
	work yet, and it grabs the sound device preventing other programs
	from working. Delete the gnash-dbg.log file if we don't want it
	writing to disk. Add -u option to set the root URL when navigating
	web pages with frames.

2006-04-15  Sandro Santilli  <strk@keybit.net>

	* backend/gnash.cpp: verbose SDL_SetVideoMode() failure message.

2006-04-11  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Check for a SDL, SDL_Mixer, and Gstreamer based on
	whether the library exists, not the headers. Comment out Gstreamer
	warning for now, it's not used anyway.
	* macros/gstreamer.m4: Remove extraneous setting of
	ac_cv_path_gstreamer_incl. Remove extraneous MSG_RESULT.
	* macros/gtk2.m4: Remove extraneous setting of
	ac_cv_path_gtk2_incl. Check for the versioned directory before the
	unversioned directory.
	* macros/gtkglext.m4: Remove extraneous setting of
	ac_cv_path_glext_incl. Remove extraneous MSG_RESULT.
	* macros/pango.m4: Always add the library name if we have a legit
	path.
	* macros/sdl.m4: Remove extraneous MSG_RESULTs.
	* server/action.cpp: Tweak the test for getURL() to include https
	as well as http.

2006-04-10  Sandro Santilli  <strk@keybit.net>

	* server/action.cpp: fix compiler error in as_global_parseint()

2006-04-10  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/action.cpp: It the url for getUrl() starts with a
	"http:", then remotely tell firefox to load the page.

2006-04-09  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* plugin/klash/klash_part.cpp: Use the new options to set the
	window size of the browser window correctly.
	* server/NetConnection.cpp: Catch trying to access a URL that is
	set to "null", instead of zero.
	* packaging/debian/gnash-klash.install: Add klash_part.desktop to
	the package.
	* packaging/debian/control: Add more dependancies.
	* doc/C/gnash-C.omf: Install in "Sound and Video" instead of
	Multimedia.

2006-04-07  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* packaging/debian/: Add packaging files. 

	* macros/kde.m4: Also look for QT with qt-3.3 as well as qt3.
	* README: minor typo corrections.
	* packaging/redhat/gnash.spec: Build klash, add additional
	dependancies, and tweak till it works.

2006-04-07  Patrice Dumas <pertusus at free.fr>

	* macros/ghelp.m4: Don't warn if the user doing ./configure
	isn't root.
	* doc/omf.make, doc/xmldocs.make, doc/C/Makefile.am: use '-hook'
	targets for omf files installation, and '-local' targets for xml
	files installation. Remove intermediate useless targets. If ghelp
	isn't enabled, disable only the omf files installation. Remove
	the @ in front of make rules.

2006-04-06  Rob Savoye  <rob@wharfrat.welcomehome.org>
	
	* backend/gnash.cpp: Make width and height global variables.
	* backend/gtksup.cpp: Reset the width and height global variables
	when we get a configure event, as the window has been resized.

2006-04-05  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Fix --disable-xml option.
	* macros/firefox.m4: Don't use the mozilla or firefox config
	script to get the path to install the plugin. Check the users
	home directory and install there in the plugins directory.
	* macros/libXML.m4: Don't do anything if XML support is disabled.
	* macros/opengl.m4: Adjust how the libray path gets set so we
	don't wind up with a path with no -L option.

2006-04-04  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* backend/Makefile.am: Don't use ../backend in the path to
	libgnashbackend.la, as it causes problems with parallel
	builds using -j.

	* macros/libXML.m4: Don't configure XML if it's disabled.

2006-04-04  John Gilmore  <gnu@toad.com>

	* README:  Add more basic information.  Thank contributors.
	* server/{xmlsocket.cpp, MovieClipLoader.cpp, Sprite.cpp,
	  network.cpp, shape.cpp}:  Lint.
	* backend/gnash.cpp:  Revise --version and --help for GNU Coding
	  Standards.
	* plugin/player.cpp:  Lint.
	* plugin/plugin.cpp:  Describe the plugin more fully.  It's the
	  GNU Flash Player.  Add copyright notice, version number, more
	  links.

2006-04-04  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* backend/gnash.cpp: Add -j and -k options to set the width and
	height of the window. This is used only by the plugin. Uncomment
	gtk_plug() code, it works now! If the window ID is set, don't set
	the window size again.
	* plugin/plugin.cpp: Always return the value when Mozilla
	asks. Add -j and -k options to set the window size for the player
	instead of letting it default to the movie size.
	* libbase/image_filters.cpp: Add struct name to eliminate
	warning.
	* macros/gstreamer.m4: Change where the -I and -L gets added.
	* macros/opengl.m4: Change where the -I and -L gets added.
	* plugin/mozilla-sdk/pluginbase.h: Add a destructor to eliminate
	warnings.
	* testsuite/actionscript.all/Makefile.am: Add the test case source
	files to the distribution tarball. Include the generated swf
	movies so people don't need Ming installed to have "make check"
	work.

2006-04-02  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* gnash/Makefile.am: Move libamf to DIST_SUBDIRS, since it's not
	really used yet anyway. Tweak the path for building deb and rpm
	files.
	* doc/C/Makefile.am: Don't error out if Makeinfo has problems.

2006-04-02  Rob Savoye  <rob@cree.moongulch.net>

	* doc/C/gnash-man.xml: Add the -x and -w options.
	* doc/C/gnash.xml: Rewrite overview and intro chapter.

	* doc/C/gnash.xml: Add a constant for the opcodes chapter. Add -w
	option to list of command line options. 
	* doc/C/sources.xml: Add new dependancies, gtkglext, atk, pango,
	cairo, glib, gtk2, gstreamer 0.10, and kde. Update plugin
	section. Add all the new configure options of the last few
	months.
	* doc/C/internals.xml: Change the names of the libraries to match
	current versions. Add asobjs, plugin, and klash libraries. Update
	plugin section. Add info about GUI toolkit usage. Add section on
	Klash. 
	* doc/C/opcodes.xml: New chapter on opcodes that lists what's
	still unimplemented.
	* doc/C/localconnection.xml: Update text. Add section about AMF.
	* doc/C/plugin.xml: Add section on plugin event handling.
	* libbase/Makefile.am: Optionally compile the demo.
	* libbase/demo.cpp: Add the demo namespace and open ogl.

2006-03-31  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* macros/atk.m4: Fix finding the proper path with the version
	number.
	* macros/glib.m4: Fix finding the proper path with the version
	number.
	* macros/pango.m4: Fix finding the proper path with the version
	number.

	* Makefile.am: Add libamf and plugin to STD_DIRS.
	* configure.ac: Call KDE_SET_PREFIX to set KDECONFIG.
	* doc/C/Makefile.am: Change the invocation of db2_teximl for
	version 0.8.5. Also change the file name the gets renmoved, so
	make it part of the conditional test.
	* macros/kde.m4: Fix KDE_SET_PREFIX to not trash the value of
	$prefix.
	* plugin/klash/Makefile.am: Fix how the moc file gets built and as
	a dependancy.
	* plugin/mozilla-sdk/Makefile.am: Add all the headers to
	noinst_HEADERS so makedistcheck works.
	
2006-03-30  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* plugin/Makefile.am: Pass in the prefix as a constant so we can
	use it to find the Gnash executable from within the plugin.
	* gnash.cpp: For now, ignore command line arguments with a equal
	sign in them.
	* plugin/plugin.cpp: Build the argv array correctly so we don't
	core dump Firefox. Use a GNASH_PLAYER environment variable, or the
	configured exec_prefix to find the gnash executable to fork.
	* plugin/plugin.h: Also store the childpid and the process name.
	* configure.ac: Add options to toggle between forking the
	standalone player and using a thread.
	
2006-03-30 Petter Reinholdtsen <pere@hungry.com>

	* libamf/Makefile.am: Remove -Wall, it's set in configure.ac now.
	* libbase/triangulate_impl.h: Add const to some type casting.
	* libbase/tu_file.cpp: Remove const from *_tell_func API.
	* libbase/tu_file.h: Remove const from *_tell_func API.
	* libbase/tu_file_SDL.cpp: Remove const from *_tell_func API.
	* libbase/zlib_adapter.cpp: Remove const from *_tell_func API.
	* libgeometry/geometry.h: Swap static and const, they're in the
	wrong order.
	* libgeometry/kd_tree_packed.cpp: Use unsigned interger to compare
	to the result from size() for an STL container.
	* server/Makefile.am: Remove -Wall, it's set in configure.ac now.
	* server/action.cpp: Add const to definition of character
	pointer.
	* server/dlist.cpp: Add const when casting display_object_info.
	* server/network.cpp: Return false for now if
	Network::createClient is called with only the port number.
	* server/shape.cpp: Use const when casting nmesh)_set.
	* server/sound_handler_mp3.cpp: Use unsigned interger to compare
	to the result from size() for an STL container.
	* server/xml.cpp: Define the niodename before using it.
	* server/xmlnode.cpp: Return NULL if we can't return an object
	pointer.
	* utilities/Makefile.am: Add MP3_LIB to the linker list.

2006-03-29  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* plugin/Makefile.am: Include the backend directory in the include
	paths.
	* plugin/player.cpp: Nuke the SDL support and start replacing it
	with GTK2. This file is currently unused as the standalone player
	is used instead.
	* plugin/plugin.cpp: Support GTK2 and GTKGLExt if they exist for
	the plugin. Fork the plugin instead of using a thread. Enable
	XEmbed.
	* plugin/plugin.h: XSync after setting the context.
	* plugin/klash/Makefile.am: Move klash_part.moc to _SOURCES.
	* plugin/mozilla-sdk/Makefile.am: We don't need the FIREFOX_DEFS
	now.

2006-03-29  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Add --enable-lotsa-warnings, to turn on many more
	warning messages. By default only -Wall is used when using
	GCC. Based on a patch by Petter Reinholdtsen <pere@hungry.com>

2006-03-28  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* README: Add text from web site about the mailing lists, and
	where to submit bug reports and patches.
	* configure.ac: Use $glext instead of $plugin for GTK.
	* backend/Makefile.am: Add new files gtksup.h and gtksup.cpp.
	* backend/gtksup.{h,cpp}: New files for GTK menu and event support.
	* backend/gnash.cpp: Use GTK2 and GtkGLExt if they exist. Use GTK
	event handlers and menus. Default to SDL.
	* libbase/Makefile.am: Don't both to build the demo.
	* libbase/image_filters.cpp: Add debugging trace messages.
	* libbase/log.{h,cpp}: Handle just a single char.
	* libgeometry/Makefile.am: Add the library paths.
	* macros/atk.m4: Define ac_cv_path_atk_lib correctly for when we
	do find it in the list of paths. 
	* macros/cairo.m4: Don't do anything unless $glext is enabled.
	* macros/firefox.m4: Don't do anything unless $plugin is enabled.
	* macros/ghelp.m4: Move the conditional.
	* macros/glib.m4: Define ac_cv_path_glib_lib correctly for when we
	do find it in the list of paths. 
	* macros/gstreamer.m4: Add error message if only the older
	gstreamer version is found. 0.10 is required.
	* macros/gtk2.m4: Don't do anything unless $glext and $plugin are
	enabled. Define the library names with the version or we get the
	wrong one.
	* macros/gtkglext.m4: Enable by default, but support --disable.
	* macros/opengl.m4: Define ac_cv_path_opengl_lib correctly for when we
	do find it in the list of paths. 
	* macros/pango.m4: Define ac_cv_path_pango_lib correctly for when we
	do find it in the list of paths. 
	* server/shape.cpp: Reformat into GNU style.
	* server/styles.cpp: Reformat into GNU style.
	* utilities/Makefile.am: Add the graphics libraries.

2006-03-20  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* doc/C/Makefile.am: Optionally use dblatex or pdfxmltex to build
	PDFs if FOP doesn't exist.
	* macros/docbook.m4: Also look for dblatex and pdfxmltex.

2006-03-19  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac, macros/gstreamer.m4: Look for Gstreamer.

2006-03-18  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/Movie.cpp: Add GNASH_REPORT_FUNCTION to some functions.
	* server/Sprite.cpp: Add GNASH_REPORT_FUNCTION to some functions.
	* server/dlist.cpp: Add GNASH_REPORT_FUNCTION to some functions.
	* server/impl.h: Add GNASH_REPORT_FUNCTION to some functions.
	* server/morph2.cpp: Add GNASH_REPORT_FUNCTION to some functions.
	* server/shape.cpp: Add GNASH_REPORT_FUNCTION to some functions.
	* server/text.cpp: Add GNASH_REPORT_FUNCTION to some functions.
	* plugin/mozilla-sdk/include/{prcvar.h, prerr.h, prerror.h,
	prinit.h, prinrval.h, prlock.h, prthread.h, prwin16.h}: New files
	copied from Firefox so we can use NSPR without Firefox sources.
	* backend/gnash.cpp: Add -w option to enable producing the disk
	based log file, instead of enabling it by default as it can get
	huge. This log is only useful to developers. This disk log *is*
	produced by default when using the plugin.
	* libbase/log.h: Add a log_trace() function that works like
	GNASH_REPORT_FUNCTION, but also prints the pointer of the current
	instance. Useful for debugging multi-threaded programs. Tracing
	now always prints to the disk file, and only the terminal display
	is controlled by the verbosity level.
	* libbase/log.cpp: Add a log_trace() function that works like
	GNASH_REPORT_FUNCTION, but also prints the pointer of the current
	instance. Useful for debugging multi-threaded programs. Tracing
	now always prints to the disk file, and only the terminal display
	is controlled by the verbosity level. Strip the CR from messages
	passed to the log_* wrapper and replace it with a endl so the
	timestamps work for all the old messages too.
	* server/types.cpp: Small fix to color matrix loading, /256.0
	instead of /255.0/
	* plugin/player.cpp: Use Mozilla NSPR API for mutexes, threads and
	condition variables instead of SDL. For now, only play the movie
	once.
	* plugin/plugin.cpp: Use Mozilla NSPR API for mutexes, threads,
	and condition variables instead of SDL.
	* plugin/plugin.h: Use Mozilla NSPR API for mutexes, threads, and
	condition variables instead of SDL.

2006-03-18  Tomas Groth Christensen  <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Make mp3-support depend on
	HAVE_MAD_H instead of GAMESWF_MP3_SUPPORT.
	* macros/docbook.m4: Include the J2REDIR enviroment variable
	in the list of where java could be.
	
2006-03-17  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/button.cpp: Clear() m_actions after resizing when
	destructing a button. Bug #16105

2006-03-11  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* doc/C/Makefile.am: Add logging.xml.
	* libbase/log.h: Only print TRACE messages at verbose level 2. Add
	getVerbosity() accessor.
	* server/impl.cpp: Add fixme_loader(), and set the unimplemented
	tags to that so we know when we hit one.
	* server/impl.h: Add prototype for fixme_loader().
	* server/text.cpp: Clean up warning message.

	* doc/C/internals.xml: Add section on the new debug logging
	system. 
	* doc/C/logging.xml: New section on the new debug logging
	system.

	* utilities/Makefile.am: Add libxml flags and libs.
	* utilities/parser.cpp: Use getopt for processing command line
	arguments. Reindent to project coding standards. Add GNU standard
	options. Use new logging system, delete the old one.
	* utilities/processor.cpp: Use getopt for processing command line
	arguments. Reindent to project coding standards. Add GNU standard
	options. Use new logging system, delete the old one.
	* backend/gnash.cpp: Use getopt for processing command line
	arguments. Add GNU standard options. Use new logging system,
	delete the old one.
	* libbase/tu_file.h: Reformat to be more readable.
	* libbase/tu_file.cpp: Reformat to be more readable.

2006-03-10 Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/log.h: Moved to libbase.
	* server/log.cpp: Moved to libbase.
	* libbase/log.h: Add support for an STL streams based interface to
	the C based API for debugging messsages. 
	* libbase/log.cpp: Add support for an STL streams based interface to
	the C based API for debugging messsages. 
	* backend/gnash.cpp: Add support for new logging system, delete
	old callback system.
	* backend/render_handler_ogl.cpp: Cleanup some formating.
	* libbase/Makefile.am: Add log.h and log.cpp.
	* server/Makefile.am: Remove log.cpp and log.h.
	* server/xml.cpp: Use the new debugging macros.
	* utilities/Makefile.am: Add XML flags and libs.
	* utilities/parser.cpp: Add support for new logging system, delete 
	old callback system.
	* utilities/processor.cpp: Add support for new logging system,
	delete old callback system.

2006-03-08  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Make using XML the default.

2006-03-10  Rob Savoye  <rob@cree.moongulch.net>

	* plugin/Makefile.am: Use DESTDIR when making directory.
	* mkinstalldirs: Add so we have it when not using the install
	utility (using libtool) to make directories.
	* utilities/Makefile.am: Add ZLIB_LIBS to ldflags.

2006-03-09 Michael Carlson <corfe83dev@gmail.com>

	* server/array.cpp: Add TODO to make sort constants static
	* server/Date.h: Add functions convertTM, setFromTM, Normalize
	(for internal use), improve comments on utility functions
	* server/Date.cpp: Implement getTime, setUTC functions, fix 
	problem with regular Set functions, fix return values on
	several functions, add comments, TODOs, asserts, and fix a typo

2006-03-09  Rob Savoye  <rob@cree.moongulch.net>

	* backend/Makefile.am: Add ZLIB_LIBS to LDFLAGS.

	* All GPL'd files: Updated the copyright message in all GPL'd
	files with the new Mozilla exemption as crafted by the FSF. This
	enables Gnash to be used in Mozilla without requiring all the
	other plugins to be GPL'd.

2006-03-09 Michael Carlson <corfe83dev@gmail.com>

	* server/Date.cpp: Implement all Date::getUTC functions, convert	
	to tab indenting, create convertUTC() for internal use, 
	implement a sane (but probably non-standard) Date::toString
	* server/Date.h: Add Date::convertUTC function for internal use,
	convert to tab indenting

2006-03-08  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Make using XML the default.

2006-03-08 Michael Carlson <corfe83dev@gmail.com>

	* backend/gnash.cpp: Fix typo in and add newline to error message
	Avoid infinite loop and make gnash still poll for SDL events when
	libxml is not present
	* server/Date.cpp: Implement Date::gettimezoneoffset, all the 
	basic "set" functions, cleanup messages to user a bit, rename
	set() to setDate(), in accordance with two unofficial references
	* server/Date.h: Add minutesEast variable to store timezone,
	rename set() to setDate()
	* server/array.cpp: Add some constants related to sorting

2006-03-07  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* doc/C/plugin.xml: New file for internals on writing Mozilla
	plugins.
	* doc/C/internals.xml: Include new plugin section.
	* doc/C/Makefile.in: Add plugin.xml to the list of doc chapters.

2006-03-07  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* doc/C/plugin.xml: New file for internals on writing Mozilla
	plugins.
	* doc/C/internals.xml: Include new plugin section.
	* doc/C/Makefile.in: Add plugin.xml to the list of doc chapters.

2006-03-06  Rob Savoye  <rob@cree.moongulch.net>

	* server/shm.cpp: Clear up ifdef mess... Both shm_open() and
	shmget() use file descriptors.

2006-03-05  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/Date.cpp: If we don't have gettimeofday, use
	ftime instead.
	* server/shm.h:  Add support for win32 shared memory.
	* server/shm.cpp: Add support for win32 shared memory.
	* server/network.h: Add support to use winsock.
	* server/network.cpp: Add support to use winsock.
	* configure.ac: Add tests for sysconf(), shmget(), shmat(),
	mmap(), gettimeofday(), socket(), CreateFileMapping(), and
	winsock.h. This covers all the differences between mingw builds
	and native unix builds.
	* libbase/container.h: Don't use pthread hack for BSD whcn cross
	compiling with mingw.
	* libbase/utility.h: Don't define windows specific assert()
	replacement when using mingw.
	* libgeometry/kd_tree_dynamic.cp: Include wctype.h and wchar.h to
	shut up mingw.
	
	* server/action.cpp (gnash): Replace isblank() with testing for
	space and tab so it compiles with mingw32.

	* macros/kde.m4: Use our zlib tests, not the KDE one because the
	Gnash test works when cross compiling.

2006-03-04  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* Makefile.am: Always build the plugin now.
	* configure.ac: Look for stdint, which is used by some old BSDs
	that for the Mozilla header files. Arg. Don't use AC_CHECK_FUNCS
	for finite and isfinite, try to compile code. On some systems
	these are functions, and on some they're constants, so this covers
	both cases to return a meaningful result. We always build the
	plugin now, so having firefox-config isn't a failure anymore.
	* libbase/dlmalloc.h: Move USE_DL_MALLOC ifdef up a few lines. 
	* macros/firefox.m4: Add new macro to replace the old one, which
	is renamed. Turns out none of the flags from mozill-config are
	needed, so only find the path to install the plugin.
	* macros/kde.m4: Turn more errors into notices so the build
	doesn't stop if KDE parts aren't installed. We only want to use
	them if building klash. Optionally skip some tests if klash isn';t
	installed. Otherwise they get set if they're installed even if
	you aren't building klash.
	* plugin/Makefile.am: Don't use the DEFS from firefox-config,
	only MOZ_X11 is needed by the SDK. Add include path to our own
	Mozilla headers.
	* plugin/mozilla-sdk/Makefile.am: Add include path to our own
	Mozilla headers.
	* servers/Object.h: Reverse ifdef test for HAVE_FINITE so it works
	even with configure errors.
	* plugin/mozilla-sdk/include: Copy critical header files from
	Firefox sources so you don't need the development packages
	installed, nor do you need fierfox-config, which isn't included at
	all in some distributions.
	
	* macros/docbook.m4: Patch from Pavekl Roskin <proski@gnu.org>, to
	fix configure test error.
	* macros/libXML.m4: Patch from Pavekl Roskin <proski@gnu.org>, to
	correctly use xml2-config, instead of pkg-config.

	* plugin/player.cpp: Define NO_NSPR_10_SUPPORT so we don't have
	header file typedef conflicts. We don't care about the older NSPR
	10 anyway...

2006-03-03  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* plugin/klash: Build klash, a Gnash customized Konquerer plugin
	that works similar to MozPlugger. Contributed by Koos Vriezen
	<koos.vriezen@gmail.com>.
	* configure.ac: Add Klash support, which optionally invokes a
	bunch of KDE tests. Add --enable-klash to build Konquerer plugin.
	* macros/kde.m4: KDE config macros that seem to be a default
	collection. These have been tweaked so the errors if QT or KDE
	isn't found are removed. This is done later in configure.in, and
	we want to build all the other code on systems without KDE.
	* plugin/mozplugger:  Add patch to add Gnash support to
	MozPlugger.
	* plugin/klash/README, klash.desktop, klash_part.cpp,
	klash_part.desktop, klash_part.h, klashpartui.rc,
	klashplayer.lsm, klashrc, pluginsinfo: New files from contributed
	Konquer plugin (works similar to MozPlugger)

2006-03-02  Rob Savoye  <rob@cree.moongulch.net>

	* plugin/plugin.cpp: Always lock the display before locking X. Add
	the locking to the function calls themselves, rather than wrapping
	all the function calls. Add debug background thread for now. We
	don't need SDL in the plugin now at all. Changes what gets setup
	and when. Use a POSIX condition to signal the threads when they
	have a movie to play.
	* plugin.h: Add unsetGL() to unset the context. important for
	threads. Add tons of silly debug messages.
	* player.cpp: Extern the mutexes, and condition variables. Always
	lock the display before locking X.
	* macros/hashmap.m4: New configure test for hash_map extension.
	* configure.as: Look for hash_map extension. Check for vsnprintf,
	strcasecmp, and stricmp.
	* libbase/container.h:  Include config.h. Use configure support to
	define template.
	* libbase/container.cpp: Include config.h. Use ifdefs based on
	configure tests for vsnprintf, strcasecmp, and stricmp. 
	* libbase/utility.cpp: Don't build anything if dmalloc isn't
	enabled.
	* libbase/config.h: Remove as it doesn't appear to be used, and
	conflicts with the autoconf generated one.
	* libbase/Makefile.am: Include files from the src server directory
	too, and the top level where config.h is. Don't include the
	removed config.h in the header list.

2006-02-28  Jim Garrison  <garrison@users.sourceforge.net>

	* server/MovieClipLoader.cpp, server/Sprite.cpp,
	server/action.cpp, server/array.cpp, server/text.cpp,
	server/xml.cpp, server/xmlsocket.cpp: first step in migration to 
	std::string

2006-02-28  Tomas Groth Christensen  <tomasgroth@yahoo.dk>

	* testsuite/actionscript.all/gen-test.sh: made the test-generator
	use case-sensitivity, since MM flashplayer is case sensitive.

2006-02-28  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Look for finite and isfinite.
	* server/Object.h: Define finite to be isfinite if isfinite
	doesn't exist.
	* macros/docbook.m4: Make not needing the docbook2X tools the
	default.

2006-02-27  Jim Garrison  <garrison@users.sourceforge.net>

	* libbase/Makefile.am: removed unused files
	* libbase/cschema.h: moved to Attic
	* libbase/file_util.cpp: moved to Attic
	* libbase/file_util.h: moved to Attic
	* libbase/png_helper.cpp: moved to Attic
	* libbase/png_helper.h: moved to Attic

2006-02-27  Rob Savoye  <rob@cree.moongulch.net>

	* plugin/player.cpp: Include Movie.h, which is where movie
	definitions get defined now. Include gnash.h before other local
	headers.

2006-02-26  Jim Garrison  <garrison@users.sourceforge.net>

	* libbase/container.h: hash class is now implemented using
	hash_map
	* server/Movie.cpp: partial migration to hash_map API
	* server/Movie.h: partial migration to hash_map API
	* server/Object.cpp: partial migration to hash_map API
	* server/Sprite.h: partial migration to hash_map API
	* server/action.cpp: partial migration to hash_map API
	* server/impl.h: partial migration to hash_map API

2006-02-26 Sandro Santilli <strk@keybit.net>

	* server/action.cpp: fixed bug in doActionCallFunction making
	samples/slider.swf play fine.
	* server/: merged movie_definition_sub into
	movie_definition.
	* testsuite/actionscript.all/Makefile.am: provided
	OUTPUT_VERSION define for *.swf and *.vswf rules

2006-02-26  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* libbase/dlmalloc.h: Include stdlib.h instead of the depreciated
	malloc.h.
	* libbase/tu_swap.h: OpenBSD defines swap macros with the same
	name as these functions, so use our implementation intead.
	* macros/pthread.h: Reqwrite to handle weird NetBSD Pth versus
	Pthread problem.
	* macros/sdl.m4: Throw out compile test for something simpler and
	more portable.
	* utilities/Makefile.am: Add pthread header and library.
	* server/Makefile.am: Add pthread header and library.
	* backend/Makefile.am: Add pthread header and library.
	* libbase/container.h: Add ugly NetBSD specific hack so it'll use
	pthread, not Pth if both are installed.
	* libgeometry/kd_tree_dynamic.cp: Include stdio so __sputc() is
	defined on NetBSD.

2006-02-25  Jim Garrison  <garrison@users.sourceforge.net>

	* backend/render_handler_d3d.cpp: substituted array<> with
	std::vector<>.
	* backend/render_handler_xbox.cpp: substituted array<> with
	std::vector<>.
	* libbase/container.cpp: substituted array<> with std::vector<>
	* server/morph.cpp: substituted array<> with std::vector<>
	* server/morph.h: substituted array<> with std::vector<>

2006-02-25 Michael Carlson <corfe83dev@gmail.com>

	* server/sound_handler_mp3.cpp: Use std::vector<> instead of
	array<>

2006-02-24  Jim Garrison  <garrison@users.sourceforge.net>

	* backend/sound_handler_sdl.cpp: substituted array<> with
	std::vector<>
	* libbase/container.h: removed array<> definition
	* libbase/grid_index.h: substituted array<> with std::vector<>
	* libbase/image_filters.cpp: substituted array<> with std::vector<>
	* libbase/triangulate.h: substituted array<> with std::vector<>
	* libbase/triangulate_float.cpp: substituted array<> with
	std::vector<>
	* libbase/triangulate_impl.h: substituted array<> with
	std::vector<>
	* libbase/triangulate_sint32.cpp: substituted array<> with 
	std::vector<>
	* libgeometry/kd_tree_dynamic.cpp: substituted array<> with 
	std::vector<>
	* libgeometry/kd_tree_dynamic.h: substituted array<> with 
	std::vector<>
	* libgeometry/tqt.h: substituted array<> with std::vector<>
	* server/Function.cpp: substituted array<> with std::vector<>
	* server/Function.h: substituted array<> with std::vector<>
	* server/Movie.cpp: substituted array<> with std::vector<>
	* server/Movie.h: substituted array<> with std::vector<>
	* server/MovieClipLoader.cpp: substituted array<> with std::vector<>
	* server/Sprite.cpp: substituted array<> with std::vector<>
	* server/Sprite.h: substituted array<> with std::vector<>
	* server/action.cpp: substituted array<> with std::vector<>
	* server/action.h: substituted array<> with std::vector<>
	* server/button.cpp: substituted array<> with std::vector<>
	* server/button.h: substituted array<> with std::vector<>
	* server/dlist.h: substituted array<> with std::vector<>
	* server/font.cpp: substituted array<> with std::vector<>
	* server/font.h: substituted array<> with std::vector<>
	* server/fontlib.cpp: substituted array<> with std::vector<>
	* server/fontlib.h: substituted array<> with std::vector<>
	* server/impl.cpp: substituted array<> with std::vector<>
	* server/impl.h: substituted array<> with std::vector<>
	* server/shape.cpp: substituted array<> with std::vector<>
	* server/shape.h: substituted array<> with std::vector<>
	* server/stream.cpp: substituted array<> with std::vector<>
	* server/stream.h: substituted array<> with std::vector<>
	* server/styles.h: substituted array<> with std::vector<>
	* server/tesselate.cpp: substituted array<> with std::vector<>
	* server/text.cpp: substituted array<> with std::vector<>
	* server/text.h: substituted array<> with std::vector<>
	* server/textformat.cpp: substituted array<> with std::vector<>
	* server/timers.cpp: substituted array<> with std::vector<>
	* server/timers.h: substituted array<> with std::vector<>
	* server/xml.cpp: substituted array<> with std::vector<>
	* server/xmlsocket.cpp: substituted array<> with std::vector<>
	* server/xmlsocket.h: substituted array<> with std::vector<>
	* utilities/processor.cpp: substituted array<> with std::vector<>

2006-02-24  Jim Garrison  <garrison@users.sourceforge.net>

	* backend/sound_handler_sdl.cpp: fixed int, unsigned int comparisions
	* libbase/grid_index.h: fixed int, unsigned int comparisions
	* libbase/image_filters.cpp: fixed int, unsigned int comparisions
	* libbase/triangulate_impl.h: fixed int, unsigned int comparisions
	* libgeometry/kd_tree_dynamic.cpp: fixed int, unsigned int comparisions
	* libgeometry/tqt.cpp: fixed int, unsigned int comparisions
	* plugin/plugin.cpp: fixed int, unsigned int comparisions
	* server/Movie.cpp: fixed int, unsigned int comparisions
	* server/Sprite.cpp: fixed int, unsigned int comparisions
	* server/action.cpp: fixed int, unsigned int comparisions
	* server/button.cpp: fixed int, unsigned int comparisions
	* server/dlist.cpp: fixed int, unsigned int comparisions
	* server/font.cpp: fixed int, unsigned int comparisions
	* server/fontlib.cpp: fixed int, unsigned int comparisions
	* server/impl.cpp: fixed int, unsigned int comparisions
	* server/morph2.cpp: fixed int, unsigned int comparisions
	* server/shape.cpp: fixed int, unsigned int comparisions
	* server/styles.cpp: fixed int, unsigned int comparisions
	* server/tesselate.cpp: fixed int, unsigned int comparisions
	* server/text.cpp: fixed int, unsigned int comparisions
	* server/xmlnode.cpp: fixed int, unsigned int comparisions
	* server/xmlsocket.cpp: fixed int, unsigned int comparisions

2006-02-23  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* plugin/Makefile.am: Add flags for GTKGLExt
	dependancies. Remove ogl_sdl.cpp and ogl_sdl.h. Use -d instead of
	-z to see if the directory exists.
	* plugin/plugin.cpp: Don't use ogl_sdl, move the functionality
	into the nsPluginInstance class. Add locking around all GL and X11
	calls. Add Doxygen style comments blocks.
	* plugin/plugin.h:  Don't use ogl_sdl, move the definitions
	into the nsPluginInstance class.
	* plugin/ogl_sdl.{h,cpp}: Move functionality into nsPluginInstance
	class. Remove files.
	
	* doc/C/sources.html: Add section on cross compiling Gnash.
	* libgeometry/kd_tree_packed.cpp: Comment out the two somewhat
	bogus assertions so this file can be cross compiled.
	* configure.ac: If the plugin is disabled, or glext is disabled,
	don't spew errors messages, since we didn't bother to look for
	those components anyway. Rename the macros where the prefix
	changed.
	* macros/firefox.m4: Don't try to configure if the plugin is
	disabled.
	* macros/jpeg.m4: Look in $prefix for headers and libraries,
	useful for cross-compiling. Rename to use GNASH_ instead of AM_
	for the prefix.
	* macros/libXML.m4:  Look in $prefix for headers and libraries,
	useful for cross-compiling.
	* macros/mad.m4:  Look in $prefix for headers and libraries,
	useful for cross-compiling. Rename to use GNASH_ instead of AM_
	for the prefix.
	* macros/ming.m4: Rename to use GNASH_ instead of AM_ for the
	prefix.
	* macros/ogg.m4:  Look in $prefix for headers and libraries,
	useful for cross-compiling. Rename to use GNASH_ instead of AM_
	for the prefix.
	* macros/opengl.m4:  Look in $prefix for headers and libraries,
	useful for cross-compiling. Rename to use GNASH_ instead of AM_
	for the prefix.
	* macros/png.m4:  Look in $prefix for headers and libraries,
	useful for cross-compiling. Rename to use GNASH_ instead of AM_
	for the prefix.
	* macros/sdl.m4:  Look in $prefix for headers and libraries,
	useful for cross-compiling. Rename to use GNASH_ instead of AM_
	for the prefix.
	* macros/zlib.m4:  Look in $prefix for headers and libraries,
	useful for cross-compiling. Rename to use GNASH_ instead of AM_
	for the prefix.
	* macros/gtkglext.m4: If --enable-glext is passed to configure,
	enable configuring pango, cairo, atk, glib, and gtk2 macros.
	* macros/atk.m4: New file to look for Gnome ATK, which is
	unfortunately a dependancy of GtkGlext.
	* macros/cairo.m4:  New file to look for Cairo, which we wanted to
	do eventually anyway, by GtkGlext needs it too.
	* macros/glib.m4:  New file to look for Glib, which is
	unfortunately a dependancy of GtkGlext.
	* macros/gtk2.m4:  New file to look for GTK+ version 2.x, which is
	a dependancy of GtkGlext, but Firefox uses it too.
	* macros/pango.m4:  New file to look for Gnome ATK, which is
	unfortunately a dependancy of GtkGlext.
	
	* doc/C/gnash.xml: Add the -x command line option.
	* doc/C/internals.xml: Add section under Plugin about using
	Mozplugger to use the standalone player.

2006-02-22  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* backend/gnash.cpp: Add -x option to pass in the X window ID from
	mozplugger. If a window ID is passed in, use that to display
	in. This lets the standalone player be embedded in the browser
	window.

2006-02-20  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Add GNASH_PATH_GLEXT.
	* macros/gtkglext.m4: New config file to find GtkGLext package.

	* packaging: New directory to hold config files to build packages
	for distributions.
	* packaging/debian: New directory for DEB building config files.
	* packaging/redhat: New directory for RPM building config files.
	* packaging/redhat/gnash.spec: Contributed spec file for building
	RPMs.
		
	* macros/zlib.m4,sdl.m4,pthreads.m4,png.m4,opengl.m4,
	ogg.m4,mad.m4,libtool.m4,libXML.m4,jpeg.m4,dmalloc.m4:
	Look for /lib64 and /usr/lib64, and use those for search paths if
	they exist.
	* configure.ac: Blindly add -L/usr/lib64, so the autoconf library
	checking functions get the right path.

2006-02-17  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/shm.cpp (closeMem): Use shmctl(), not shm_unlink to
	remove a shared memory segment on BSD machines.

2006-02-15  Rob Savoye  <rob@cree.moongulch.net>

	* config.guess: Updated to latest autoconf release.
	* config.sub: Updated to latest autoconf release.
	* ltmain.sh: Updated to latest libtool release.
	* backend/render_handler_ogl.cpp: Migrate patch from GameSWF.
	* server/action.h: Make set_local_frame_top multiline so it's
	easier to read.
	* server/gnash.h: Add prototype for cxform::clamp().
	* server/types.cpp: Add cxform::clamp().
	* server/shape.cpp: Fix a few warnings about comparison and sign.
	* server/shm.cpp (attach): Use SVR4 styles shared memory segments
	if there is no POSIX shared memory support, like NetBSD or
	OpenBSD.
	* server/shm.h: Add private data to store the SV4 shared memory
	key, and the SVR4 shared memory ID.
	* server/xml.cpp: Move a few methods outside
	ENABLE_TESTING. Return NULL from a few unimplemented methods.
	* server/xml.h: Move a few methods outside ENABLE_TESTING. 
	* server/xmlnode.h: Move a few methods outside ENABLE_TESTING. 
	* server/xmlnode.cpp: Move a few methods outside ENABLE_TESTING. 
	* testsuite/actionscript.all/XML.as: Make some tests unresolved
	because I'm not clear what the proper behaviour is.

2006-02-15 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Makefile.am: added online-tests rule.
	* testsuite/actionscript.all/Function.as: avoided === test, not
	available in versions < 6.
	* testsuite/actionscript.all/gen-index.sh: utility script for
	the online-tests rule: generates index.html and index.wiki.
	* testsuite/actionscript.all/check.as: support for ONLINE define,
	using XTRACE and only printing failures when that's defined.
	* testsuite/actionscript.all/gen-test.as: changed to use the check
	macro.
	* testsuite/actionscript.all: Boolean.as, Camera.as, Color.as,
	ContextMenu.as, CustomActions.as, Error.as, LoadVars.as,
	Microphone.as, Mouse.as, NetStream.as, Selection.as,
	SharedObject.as, Stage.as, System.as, TextSnapshot.as, Video.as:
	regenerated.
	* server/swf.h: added note about which action_buffer private
	method implmements which ACTION_DELETE* block.
	* testsuite/actionscript.all/Global.as: added test for
	_global.escape.

2006-02-14  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Look for shm_open().
	* server/shm.cpp: If we don't have POSIX shared memory (like *BSD
	systems), don't try to compile anything for now.
	* server/shm.h: If we don't have POSIX shared memory (like *BSD
	systems), don't try to compile anything for now.
	
2006-02-14 Sandro Santilli <strk@keybit.net>

	* server/Object.{h,cpp}: new instanceOf(function_as_object*) method.
	* server/action.{h,cpp}: ACTION_INSTANCEOF and ACTION_CASTOP
	implemented.  Fixed ACTION_DELETE.
	* testsuite/actionscript.all/Inheritance.as: instanceOf tests.
	* testsuite/actionscript.all/delete.as: delete tests.
	* testsuite/actionscript.all/Date.as: changed to use the check() macro.

2006-02-14 Michael Carlson <corfe83dev@gmail.com>

	* server/array.cpp: Make tostring() and join() not output any 
	enclosing parentheses, and handle empty array case better
	* testsuite/actionscript.all/array.as: Change all tests to use
	new check macro. Add tests for all implemented array functions,
	as well as several tests for the unimplemented sort function.
	* libbase/jpeg.cpp: don't ever crash by trying to read
	headers of the same jpeg twice

2006-02-13  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* macros/firefox.m4: Set FIREFOX_PLUGINS correctly at the proper
	time. Add another pattern to the sed rule to munge the path.
	* configure.ac: Print out where the plugin will get installed.

	* libamf/Makefile.am: DOn't link in the other libraries so libamf
	can be standalone.
	* libamf/amf.cpp: Default to not using log_msg().
	* libamf/amftest.cpp: Don't build unless you have dejagnu.h.
	* configure.ac: Check for the dejagnu.h header for unit testing.

2006-02-13 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/xtrace.as: trace window enlarged.
	* testsuite/actionscript.all/Inheritance.as: inheritance test
	* server/Object.h: new header file for definitions from as_object
	up to as_value (will split again at sometime).
	gnash::as_object_interface class definition merged with
	gnash::as_object, now directly derived from gnash::resource.
	* server/action.cpp: doActionEquals and doActionStrictEquals private
	action_buffer methods. Made as_value::to_object valid for AS_FUNCTION
	value types
	* server/Function.{cpp,h}: Made 'Function' an AS_FUNCTION to allow for
	'prototype' based inheritance. Implemented Function.call
	

2006-02-12 Michael Carlson <corfe83dev@gmail.com>

	* server/action.cpp: Fix silly '!' that breaks _global.isfinite

2006-02-12  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* libamf/amf.h: New file for AMF encoder/decoder library.
	* libamf/amfutf8.h: New file for AMF encoder/decoder library to
	handle UTF8 strings.
	* libamf/amf.cpp:  New file for AMF encoder/decoder library.
	* libamf/Makefile.am: New makefile for amf library.
	* libamf/amftest.cpp: New test case for AMF library.
	* Makefile.am: Add libamf directory.
	* configure.ac: Add libamf directory.

2006-02-11  Jim Garrison  <garrison@users.sourceforge.net>

	* libbase/container.h: changed array to derive from std::vector
	instead of being custom implemented, renamed hash::is_empty()
	to hash::empty()
	* libbase/grid_index.h: changed to std::vector API
	* libbase/triangulate_impl.h: changed to std::vector API
	* server/Movie.cpp: changed to std::vector API
	* server/MovieClipLoader.cpp: create explicit empty array instead
	of passing the value 0
	* server/Sprite.h: set each element of std::vector<bool> to
	false instead of using memset
	* server/action.cpp: changed to std::vector API
	* server/dlist.cpp: changed to std::vector API
	* server/font.cpp: changed hash::is_empty() to hash::empty()
	* server/fontlib.cpp: changed to std::vector API
	* server/impl.cpp: changed to std::vector API
	* server/shape.cpp: changed to std::vector API, typecast
	std:vector::size() to an integer to fix an assertion
	* server/tesselate.cpp: changed to std::vector API
	* server/textformat.cpp: create explicit empty array instead
	of passing the value 0
	* server/timers.cpp: create explicit empty array instead
	of passing the value 0
	* server/xml.cpp: create explicit empty array instead
	of passing the value 0
	* server/xmlsocket.h: changed to std::vector API

2006-02-11  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/xmlnode.{h,cpp): Implement nodeType property.
	* testsuite/actionscript.all/XMLNode.as: Add test for
	XMLNode::nodeType property.
	* doc/C/xmlnode.xml: New file for accidentally skipped class.
	* doc/C/internals.xml: Update section on using as_value
	objects. Include XMLNode section.
	* macros/docbook.m4: Extract and save the version of the Docbook2X
	tools, because there are two big differences in command line
	options depending which version you have.
	* configure.ac: Print the version of the Docbook2X tools, if
	--enable-docbook is specified.
	* doc/C/Makefile.am: Check the version of the Docbook2X tools when
	running db2x_texixml.
	* macros/sdl.m4: Define HAVE_SDL_MIXER_H if we have SDL Mixer
	installed.

2006-02-10  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* backend/render_handler_ogl.cpp (render_handler): Migrated patch
	from GameSWF that fixed a problem that meant that bitmap fill
	styles would not respect colour modulation (e.g. the use of Tint
	in Flash).
	* server/types.h: Define cxform::clamp.
	* server/types.cpp: Implementation of cxform::clamp.

	* doc/C/internals.xml: Add section on adding properties to an 
	ActionScript class. Add section on using as_value objects.

	* testsuite/actionscript.all/dejagnu.as: Implement the DejaGnu
	unit testing API for ActionScript.
	* testsuite/actionscript.all/XML.as: Use new DejaGnu API for test
	output.
	* testsuite/actionscript.all/XMLNode.as: New test case for
	XMLNode to test the methods and properties.
	* server/xmlnode.h: Add prototypes for new methods.
	* server/xmlnode.cpp: Implement appendChild() cloneNode()
	methods, and nodeName, nodeValue, firstChild, lastChild,
	previousSibling, nextSibling, parentNode properties.
	* server/xml.h: Define properties correctly. 
	* server/xml.cpp: Add properties to a node as other operations
	on the node are done.
	* configure.ac: Disable the XMLReader by default.
	* libbase/membuf.cpp: Free, don't delete the pointer in the
	destructor.
	* server/action.cpp: Define virtual destructor for
	as_property_interface.
	* server/gnash.h: Define virtual destructor for import_visitor.
	* server/shape.{h,cpp}: Define destructor for tesselating_shape.
	* server/styles.h: Define destructors for base_fill_style and
	base_line_style.
	* server/tesselate.{h,cpp}: Define destructor for
	trapezoid_accepter.
	
2006-02-10 Sandro Santilli <strk@keybit.net>

	* server/action.{cpp,h}: added doActionCallMethod,
	doActionCallFunction, doActionDefineFunction,
	doActionGetMember and doActionDefineFunction2 private
	methods to action_buffer. Changed text representation
	of generic objects from [object Object] to a more
	interesing value, fixed <c_function 0x0x###>
	* testsuite/actionscript.all/Function.as: more tests.
	* server/Object.cpp: reworked get_member/set_member to map
	"__proto__" to m_prototype.
	* server/Function.{h,cpp}: mapped m_properties to
	"prototype". Set prototype.constructor at properties
	initialization time.

2006-02-09  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* macros/ghelp.m4: Disable ghelp support by default. Use
	--enable-ghelp to turn it back on.
	* doc/omf.make: Don't try to install anything if GHELP isn't
	defined.

2006-02-09 Sandro Santilli <strk@keybit.net>

	* doc/C/Makefile.am: spaces => tab
	* doc/C/internals.xml: about writing tests
	* testsuite/actionscript.all/Global.as: added two more tests,
	fixed existing test to bypass preprocessor mangling.
	* testsuite/actionscript.all/Function.as: added some tests
	for prototype, prototype.constructor and __proto__ (inheritance)
	* server/action.{cpp,h}: moved ACTION_NEW and ACTION_INSTANCEOF
	handling code in action_buffer private doActionNew and
	doActionInstanceOf (the latter being under development).

2006-02-09 Michael Carlson <corfe83dev@gmail.com>

	* server/action.cpp: Implement _global.parseInt for all cases.
	Also implement _global.parseFloat, and _global.isNan,
	_global.isFinite, _global.unescape
	* server/action.h: add as_value::is_finite(), set_nan for
	ease of use
	* testsuite/actionscript.all: add and fix up parseInt test cases
	also add some parseFloat test cases

2006-02-08  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/shm.cpp (exists): Move to be within the ENABLE_TESTING
	block.

2006-02-08  Rob Savoye  <rob@cree.moongulch.net>

	* Makefile.am: Rearrange directories for SUBDIRS and
	DIST_SUBDIRS.
	* autogen.sh: Remove hardcoded path to /usr/bin.
	* doc/C/appendix.xml: Add section to "Coding Style" about Doxygen
	style somments.
	* doc/C/internals.xml: Metion code generation scripts in
	CVS. Expand "Adding ActionScript" section  Add sectioj on
	parameter passing for callbacks. Add section on testing Gnash.
	* server/Makefile.am: Add xmlattrs and xmlnodes to the list of
	headers and source files.
	* server/xml.h: Move XMLAttrs and XMLNode to their own source
	files to reduce clutter. Use std::vector instead of "tu
	array". Add new accessors to use for testing. Move a few method
	definitions to the source file.
	* server/xml.cpp:  Move XMLAttrs and XMLNode to their own source
	files to reduce clutter. Use std::vector instead of "tu array".
	Add new accessors to use for testing. Move a few method
 	definitions from the header file. Implement XML::appendChild(),
	XMLNode::appendChild(), XML::createElement(), XML::cloneNode(),
	and XML::createTextNode().
	* testsuite/actionscript/XML.as: Add tests for the new methods.
	
	* server/xmlattrs.{h,cpp}: New file for XMLAttr class moved out of
	xml.h.
	* server/xmlnode.{h,cpp}:  New file for XMLAttr class moved out of
	xml.h.

2006-02-06  Patrice Dumas  <pertusus at free.fr>

	* macros/docbook.m4: enable by default. Add an AM_CONDITIONNAL for
	each of the formats.
	* macros/ghelp.m4: enable by default. Correct AC_PATH_PROG 3rd arg.
	Don't check for the user is root (the user needs to be root only
	for make install, in case he wants to run scrollkeeper-update).
	* doc/omf.make: don't use $(GHELP) it is never set. Test for the
	user being root only when running scrollkeeper-update, any user
	may install the files. Use $(omffile) instead of $(srcdir)/*.omf.
	Add $(DESTDIR).
	* doc/xmldocs.make: move general stuff to doc/C/Makefile.am 
	(EXTRA_DIST, CLEANFILES, xml_files). Similarly, define all-local 
	and not all. Add amissing $(DESTDIR). Take dist-hook and 
	install-data-hook from doc/C/Makefile.am.
	* doc/C/Makefile.am: use the GHELP automake conditionnal to 
	conditionnally include scrollkeeper stuff. Remove XML_FILES, as
	xml_files from the scrollkeeper code is the same. Distribute
	info and texi files. Simplify rules to build docs and 
	conditionnalize on automake conditionnals. If the tools aren't
	there, touch the files. As the doc files requires specific 
	tools to build, flag them as MAINTAINERCLEANFILES.
	* doc/C/gnash.omf: rename to gnash-C.omf and minor changes.

2006-02-08 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Global.as: _global functions tests
	* testsuite/actionscript.all/Function.as: modified to use check.as
	* testsuite/actionscript.all/Object.as: modified to use check.as
	* testsuite/actionscript.all/check.as: framework for dejagnu testing

2006-02-08 Michael Carlson <corfe83dev@gmail.com>

	* server/action.cpp: implement _global.parseInt's simplest case

2006-02-06 Sandro Santilli <strk@keybit.net>

	* server/action.h: Added as_environment::dump_stack(), more dox
	* server/action.cpp: Fixed <as_function 0x0x####>, cleanups
	* server/swf.h: Added dox for ACTION_CALLMETHOD
	* libbase/container.h: Doxygen comments for smart_ptr class
	* testsuite/actionscript.all/Function.as: more tests for
	Function.apply()
	* testsuite/actionscript.all/Makefile.am: rule to build
	'visual tracing' version of tests (.vswf)
	* server/Function.cpp: implemented Function.apply()

2006-02-05 Sandro Santilli <strk@keybit.net>

	* server/action.cpp used symbolic names in s_instruction_table.

2006-02-05  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* testsuite/actionscript.all/testin.xml: XML test file to test the
	parser.

	* plugin/plugin.cpp (NewStream): Add support to parse the options
	passed in when the plugin is invoked to play a stream. Add special
	debug flags so we can attach GDB at leisure and not have to screw
	with loading shared libraries.
	* server/xml.{h,cpp}: Fix capitalization errors in
	names. Implement getBytesTotal(), getBytesLoaded(),
	and hasChildNodes().
	* testsuite/actionscript.all/XML.as: Add tests for
	getBytesTotal(), getBytesLoaded(), and hasChildNodes().
	
	* server/xml.h: Add stubs for the missing methods and
	properties. Fix bit rot with get_member() so it actually works
	again.
	* server/xml.cpp:  Add stubs for the missing methods and
	propeties.
	* testsuite/actionscript.all/XML.as: New file to test XML class.

2006-02-05 Sandro Santilli <strk@keybit.net>

	* server/swf.h: added SWF::ACTION_DEFINEFUNCTION2 (0x8e)
	* server/action.cpp: added support for Object copy construction
	obj = new Object(otherobj).
	* server/: renamed as_as_function to as_function_object, moved
	it's definition in Function.{h,cpp}. Moved as_object methods
	from action.cpp to Object.cpp (new file). Fixed definition
	of prototipal ::apply and ::call members for Function object.

2006-02-05 Michael Carlson <corfe83dev@gmail.com>

	* server/Sprite.cpp: goto_frame now uses mutator to stop instead
	of directly changing state (so now it resets dt counter too)

2006-02-04  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/shm.{h,cpp}: New support code for using POSIX named
	shared memory segments.
	* server/LocalConnection.h: Alternatively use shared memory
	instead of a socket connection.
	* server/LocalConnection.cpp: Alternatively use shared memory
	instead of a socket connection.
	* testsuite/actionscript.all/LocalConnection.as: Add addiotnal
	tests for when using a shared memory subsystem.
	* server/Makefile.am: Add shm.h, shm.cpp, network.cpp, network.h.
	* configure.ac: Add --enable flag to switch using shared memory to
	networking for local connections.
	
	* server/LocalConnection.h: Change API for connect(), and
	domain().
	* server/LocalConnection.cpp: Change API for connect(), and
	domain(). Initial implementations of domain(), connect(), and
	close().

	* server/network.cpp: Replace code with networking code from one
	of my other GPL'd projects, PowerGuru. That code is much more
	fully functional in a generic sense, and pretty solid too. Add
	more accessors to use for testing LocalConnection. 
	* server/network.h: Add more accessors to use for testing
	LocalConnection.
	* testsuite/actionscript.all/LocalConnection.as: Test the newly
	implemented methods.

	* server/network.{h,cpp}: New files to hold base networking class
	for use by other ActionScript objects. This base class contains
	the code for custom methods that implement accessors to the data
	to enable unit testing derived classes like NetConnection and
	LocalConnection. 
	* server/NetConnection.h: Move all testing code to network.h.
	* server/NetConnection.cpp: Move all testing code to
	network.cpp. Setup callbacks for our custom methods using the
	Network, instead of NetConnection class.

	* Makefile.am: Rearrange variable definitions so the dist and
	distcheck Makefile targets actually work. Add DIST directories so
	everything makes it into the tarball.
	* doc/C/Makefile.am: Define XML_FILES for all the other xml doc
	files. Add DESTDIR to the install path. Rearrange variable
	definitions so the distcheck Makefile target actually works. 

2006-02-04  John Gilmore  <gnu@toad.com>

	* backend/gnash.cpp:  Set window title to "gnash: " and movie name.
	Correct help/usage string.

2006-02-04 Sandro Santilli <strk@keybit.net>

	* libbase/container.h:  Doxygen-compatible comments for hash
	struct. Const-correct size() method.
	* server/action.cpp: opcode 0x43 (Declare Object / INITOBJECT)
	implemented.

2006-02-04  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* doc/C/netconnection.xml: Update with more detailed data on this
	class.

	* server/NetConnection.cpp: Implement part of the connect()
	method. Add C++ accessor methods as AS methods, and we can call
	our custom methods from testing code to examine the internal state
	of a class.
	* server/NetConnection.h: Add C++ accessor methods as AS methods,
	* testsuite/actionscript.all/NetConnection.as: Test the connect()
	method to make sure the URL gets parsed correctly, if specified.
	* configure.ac: Add --disble-testing option to not build
	additional code used for testing.

2006-02-04 Michael Carlson <corfe83dev@gmail.com>

	* server/Date.cpp: Clean up Date, and implement getDate()
	* server/action.cpp: Fix SetTargetDynamic opcode and further fix
	SetTarget opcode

2006-02-03  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* macros/docbook.m4: Fix improper use of 3rd parameter to
	AC_PATH_PROG.

	* configure.ac: Add --enable-sdk-install to install headers for
	those who want to use Gnash as a development library.
	* plugin/ogl_sdl.cpp: Drop old demo code.
	* libbase/Makefile.am: Rename libbase to libgnashbase to
	reduce the chance of name collision.
	* libgeometry/Makefile.am: Rename libgeometry to libgnashgeo to
	reduce the chance of name collision.
	* server/Makefile.am: Rename libserver to libgnashserver, and
	libasobjs to libgnashasobjs to reduce the chance of name
	collision. 
	* backend/Makefile.am: Rename libgbackend to libgnashbackend to
	reduce the chance of name collision. Use the new library names to
	link.
	* utilities/Makefile.am: Use the new library names to link.
	* plugin/Makefile.am: Rename libgnash to be libgnashplugin to
	reduce the chance of name collision. Use the new library names to
	link.
	
	* server/action.cpp: Add missing opcodes to disassembler table,a
	and rename the unsupported ones to have a "_fixme" attached when
	printing debug information.
	* backend/Makefile.am (AM_LDFLAGS): Add $(X_LIBS) so we can link
	with libraries in /usr/X11R6/lib.

	* Makefile.am (ACLOCAL_AMFLAGS): Add so autoreconf works. 

2006-02-03 Michael Carlson <corfe83dev@gmail.com>

	* server/action.cpp: SetTarget is now implemented for targets
	other than ""
	* backend/render_handler_ogl.cpp: use TWIPS_TO_PIXELS macro
	instead of hardcoded 20 value

2006-02-03 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Function.as: tests for user-defined
	  class definition
	* server/swf.h: moved SWF namespace definition in it's own header,
	  added action_type enum, added ACTION_EXTENDS, ACTION_CASTOBJECT,
	  ACTION_IMPLEMENTS tag_types, added dox on some action_types.
	* server/action.cpp: used symbolic names for SWF action tag ids
	* testsuite/actionscript.all/Object.as: test for Object class
	* testsuite/actionscript.all/Makefile.am: added support for
	  user-defined flags to ``makeswf'' invocation
	  (for -DUSE_XTRACE, mainly)
	* libbase/: image.h, jpeg.h: Doxygen-compatible comments

2006-02-03 Michael Carlson <corfe83dev@gmail.com>

	* server/textformat.cpp: fix typo in textformat_new log message
	* server/action.cpp: modulus operand in actionscript now returns
	NaN on division by zero
	* server/Date.h: Setup basic time storage variables
	* server/Date.cpp: Implement default constructor, basic time
	reading operations

2006-02-02  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* testsuite/actionscript.all/Makefile.am: Use the standard
	automake way to build the test cases.

	* Makefile.am (STD_DIRS): Remove testsuite. Nothing actually needs
	to be done at "make all" time anyway. So now the testuites can
	only be run from the testsuite subdirctory.
	* macros/png.m4: Fix various typos and other stupid errors that
	kept the --with-png-incl and --with-png-lib options from working
	correctly.
	* configure.ac: Tweak test for PNG support.

2006-02-01  Rob Savoye  <rob@cree.moongulch.net>

	* testsuite/actionscript.all/gen-test.sh: Developer utility script
	that uses the NOTES file to generate a Ming style "as" source file,
	which can be used to test an ActionScript class.
	* server/gen-files.sh: Developer utility script that uses the
	NOTES file to generate header and source file templates for an
	ActionScript class.
	* doc/C/gen-doc.sh: Developer utility script that uses the NOTES
	file to generate a documentation template for an ActionScript
	class.
	* doc/C/NOTES: Data file for file generation scripts. This is only
	of interest to other developers. If you change this file, you may
	break the other developer gen-* scripts.
	* testsuite/Makefile.am: Add dejagnu to AUTOMAKE_OPTIONS. Reset
	RUNTESTDEFAULTFLAGS to not use the --tool option.
	* testsuite/actionscript.all/Makefile.am: Add dejagnu to
	AUTOMAKE_OPTIONS. Reset	RUNTESTDEFAULTFLAGS to not use the --tool
	option.
	* testsuite/actionscript.all/swf_exists.exp: Test driver for
	DejaGnu to run the new test cases.
	* testsuite/actionscript.all/Boolean.as, Date.as, Microphone.as,
	SharedObject.as, Camera.as, Error.as, Mouse.as, Stage.as,
	Color.as, server/Makefile.am, backend/Makefile.am, 
	Function.as, NetConnection.as, System.as, ContextMenu.as,
	LoadVars.as, NetStream.as, TextSnapshot.as, CustomActions.as,
	LocalConnection.as, Selection.as, Video.as: New Ming based test
	cases for ActionScript classes. Currently all these do is test for
	the existance of a class, and all of it's methods.
	* server/Boolean.cpp, Date.cpp,	Microphone.cpp,	SharedObject.cpp,
	Camera.cpp, Error.cpp, Mouse.cpp, Stage.cpp, Color.cpp,
	Function.cpp, NetConnection.cpp, System.cpp, ContextMenu.cpp,
	LoadVars.cpp, NetStream.cpp, TextSnapshot.cpp, CustomActions.cpp,
	LocalConnection.cpp, Selection.cpp, Video.cpp: New stubs for
	missing ActionScript classes. All they do for now is print
	"unimplemented", but as all the hard code to tie a class and it's
	methods into Gnash is done, it'll be much easier to fill in
	functionality.

2006-01-30 Michael Carlson <corfe83dev@gmail.com>

	* backend/render_handler_ogl.cpp: tentative implementation
	of line_style_width with appropriate TODO message

2006-01-30  Rob Savoye  <rob@ripple.welcomehome.org>

	* doc/C/accessibility.xml, button.xml, camera.xml,
	contextmenu.xml, customactions.xml, date.xml,
	error.xml, internals.xml, key.xml,
	loadvars.xml, localconnection.xml,
	microphone.xml, mouse.xml, netstream.xml,
	selection.xml, sharedobject.xml, sound.xml,
	stage.xml, textsnapshot.xml, video.xml,
	xml.xml, xmlsocket.xml: Add content.
	* doc/C/accessibility.xml camera.xml, color.xml, contextmenu.xml,
	customactions.xml, date.xml, error.xml, function.xml, key.xml,
	loadvars.xml, localconnection.xml, microphone.xml, mouse.xml,
	movieclip.xml, moviecliploader.xml, netstream.xml, object.xml,
	selection.xml, sharedobject.xml, sound.xml, stage.xml, system.xml,
	textfield.xml,	textformat.xml,textsnapshot.xml. video.xml,
	xml.xml, xmlsocket.xml: New machine generated templates for
	ActionScript class documentaion.

	* doc/C/array.xml, boolean.xml, button.xml, math.xml,
	netconnection.xml, number.xml, string.xml: New docs, one for each
	ActionScript class.

2006-01-29  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* doc/C/internals.xml: Add a table of what ActionScript classes
	are implemented, and to what degree.
	* doc/C/sources.xml: Add section on PNG and JPEG dependancies. Add
	section on using Doxygen.

	* doc/Doxyfile.in (INPUT): Change to using @top_srcdir@, so the
	doxygen usage supports building the docs when configuring with a
	separate build tree from the sources.

2006-01-28  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* doc/C/internals.xml: Add section on adding new ActionScript
	classes with reasonable detail.

	* doc/C/sources.xml: New file extracted from gnash.xml, and made a
	standalone file since it's grown in size.
	* doc/C/appendix.xml: New file for Appendix content.
	* doc/C/gnash.xml: Move some sections to separete files. Include
	the new files.

	* doc/C/Makefile.am: Add pdf and info to SUFFIXES so the rules
	actually work.

	* doc/omf.make (install-data-hook-omf): Only install if you are
	root, as this requires writing to system directories.
	* configure.ac: Link the doc/C/images directory to the build
	directory so we can find images when producing output files. Check
	state of DocBook when it's enabled.
	* macros/docbook.m4: Add path to stylesheets for Ubuntu. Look for
	fop.sh, and the DocBook2X conversion tools. Make DocBook optional,
	use --enable-docbook to enable. When disableed, you can't build
	any of the docs.
	* macros/ghelp.m4: Check for Scrollkeeper tools. Using GNOME Help
	is disabled by default. Use --enable-ghelp to enable.
	* doc/C/Makefile.am: Use variables defined by configure for all
	the conversion tools.

2006-01-27  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* plugin/player.cpp: Use GLinitialized instead of
	surface_activated, which turns out to be a system definition on
	some Unixes. Make main_loop take a nsPluginInstance as an argument
	so we have all the data we need. Setup a thread to run the
	player.
	* server/Makefile.am, backend/Makefile.am,
	plugin/Makefile.am, utility/Makefile.am,
	plugin/mozilla-sdk/Makefile.am: Don't use VORBIS variables
	anymore.
	* macros/libXML.m4: Use xml2-config instead of pkg-config.
	* maxros/mad.m4: Add BSD path prefix, /usr/pkg.
	* libbase/triangulate_impl.h: Drop the long modifier when printing
	a size.
	* libbase/Makefile.am: Make dmalloc build conditionally when
	--enable-dmalloc is passed to configure.
	* backend/sound_handler_sdl.cpp: Only compile if SDL_Mixer is
	installed.
	* backend/gnash.cpp: xml_fd should always be defined. Make using
	SDL_Mixer for sound be conditional, since a machine may have SDL
	installed, but not SDL_Mixer, but we still want the player to
	build.
	* server/xmlsocket.h, xmlsocket.cpp: Include config.h as generated
	by configue if it exists.
	* server/xml.h, xml.cpp: Include config.h as generated
	by configue if it exists.
	* configure.ac: Enable test for pthread.h and libpthread. Don't
	look for Vorbis, the Ogg tests are enough.
	* server/Movie.cpp, Sprite.cpp, impl.cpp, array.cpp: Include
	pthread.h to get around a data type definition problem on
	NetBSD. This seems to be required when using STL containers on
	NetBSD. 
	* macros/opengl.m4: Use mad.m4 as a template and rewrite to be
	more portable.
	* macros/png.m4: Use mad.m4 as a template and rewrite to be
	more portable.
	* macros/jpeg.m4: Use mad.m4 as a template and rewrite to be
	more portable.
	* macros/sdl.m4: Look for SDL specific directory before and after
	the include or lib since some platforms install these differently.
	* macros/pthreads.m4: Look for POSIX Thread support. This turns
	out to be very messy with NetBSD, as the old version is also
	installed, and we have to link with the right one for any
	executable to work.

2006-01-26  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* plugin/Makefile.am: Link in shared libraries. Install the plugin
	in the users home directory for mozilla or firefox plugins.
	* server/Makefile.am, backend/Makefile.am,
	plugin/Makefile.am, plugin/mozilla-sdk/Makefile.am: Sigh, back to
	building and installing shared libraries because AMD64-linux
	doesn't support linking the plugin with static libraries.

	* configure.ac: Don't complain about missing libxml2 libraries if
	--disable-xml was specified.
	* backend/gnash.cpp: Always define gofast and goslow, even if XML
	support is disabled.
	* libbase/tu_types.h: If the Mozilla obsolete Prototypes file has
	been included, don't redefine the 64 bit data types.

	* testsuite/movies.all/elvis.swf: Remove URL ping to spyware
	server.

	* libbase/triangulate_impl.h: Change %ld to %d in print statement.
	* libbase/tu_types.h: Use SDL typedefs always.

2006-01-24  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* macros/opengl.m4: Update based on mad.m4 template.
	* macros/mad.m4: Fix typo, -I should be a -L.

2006-01-24 Michael Carlson <corfe83dev@gmail.com>

	* server/array.h: as_array_object now uses deque instead of vector
	* server/array.cpp: Implement array::unshift, shift, reverse,
	concat, slice, toString, join - also make push return the new
	length as it should have done before

2006-01-23  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* plugin/player.cpp, player.h: Neew file for Flash player within
	plugin code.
	* plugin/ogl_sdl.cpp, ogl_sdl.h: New files for OpenGL and SDL
	specific code.
	* plugin/Makefile.am: Build a static archive library instead of a
	shared one. Link to the static libraries.
	* server/Makefile.am: Build a static archive library instead of a
	shared one. Link to the static libraries.
	* backend/Makefile.am: Build a static archive library instead of a
	shared one. Link to the static libraries.
	* plugin/Makefile.am: Build a static archive library instead of a
	shared one.
	* plugin/mozilla-sdk/Makefile.am: Build a static archive library
	instead of a shared one.
	
	* server/Makefile.am: Don't install the libraries.
	* backend/Makefile.am: Don't install the libraries.
	* plugin/Makefile.am: Don't install the
	libraries. Pass-no-undefined to libtool so all symbols are
	resolved in the final shared library.
	* plugin/mozilla-sdk/Makefile.am: Don't install the libraries.

	* configure.ac: Use new DMALLOC test.
	* macros/dmalloc.m4: New macro for dmalloc support.
	* utilities/Makefile.am: Add support for dmalloc.
	* server/Makefile.am: Add support for dmalloc.
	* backend/Makefile.am: Add support for dmalloc.
	* plugin/Makefile.am: Add support for dmalloc.
	* libbase/utility.cpp: Only build if we have mallinfo. 

2006-01-23 Michael Carlson <corfe83dev@gmail.com>

	* server/action.h: Create utility funcs as_value::is_inf, is_nan
	* server/action.cpp: Let as_value String<->Number conversions
	use NaN, +Infinity, -Infinity where appropriate
	* server/string.cpp: Make charCodeAt() return a NaN value when
	appropriate
	* server/array.cpp: Array now checks for NaN after converting
	index string to_number(), instead of the old hacked-up way

2006-01-23  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* server/styles.cpp: Fix condition for gradient test.

	* configure.ac: Remove AM_MKINSTALLDIRS macro, it's now unneeded.

2006-01-23 Michael Carlson <corfe83dev@gmail.com>

	* server/array.h: Move new array code into array.cpp, array.h
	* server/array.cpp: Move new array code into array.cpp, array.h
	* server/action.cpp: Move new array code into array.cpp, array.h
	* server/Makefile.am: Move new array code into array.cpp, array.h
        * server/font.cpp: Report an error and continue when we get two
	of the same kerning pairs for a font, instead of crashing

2006-01-22  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Make text at end of configure more detailed about
	dependency errors.
	* macros/mad.m4: New macro to find libmad for mp3 support.
	* utilities/Makefile.am: Make MP3 support truly optional.
	* server/Makefile.am: Make MP3 support truly optional.
	* backend/Makefile.am: Make MP3 support truly optional.
	* plugin/Makefile.am: Make MP3 support truly optional.

2006-01-21  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Add tests for Ogg and Vorbis.
	* backend/Makefile.am: Add flags and libs for Ogg and Vorbis as
	separete flags.
	* utilities/Makefile.am: Add flags and libs for Ogg and Vorbis as
	separete flags.
	* plugin/Makefile.am: Add flags and libs for Ogg and Vorbis as
	separete flags.

	* server/styles.cpp: Don't abort if we read a bad gradient.

	* macros/sdl.m4: Store the compilation flags so the compilation
	tests works on ppc-linux.

2006-01-21 Michael Carlson <corfe83dev@gmail.com>

        * server/action.cpp: Initial implementation of as_array_object
        ( get_member, set_member, push, pop, and length )
	
2006-01-20  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* backend/Makefile.am: Make the OGL and SDL support a library so
	it can also be used by the plugin.
	* libbase/Makefile.am: Add SDL_MIXER_CFLAGS to the include paths.
	* macros/sdl.m4: Correct typo so --with-sdl_mixer-lib actually
	works. Add /usr/bin/X11 to the default search path for
	sdl-config.
	* server/styles.cpp: Print a better error message wh.en a bad
	gradient value is read before aborting.

2006-01-19  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* utilities/Makefile.am: Link with AM_LDFLAGS.
	* utilities/parser.cpp: Include config.h. Define gofast, goslow,
	and nodelay.
	* utilities/processor.cpp: Include config.h. Define gofast,
	goslow, and nodelay.
	* configure.ac: Look for mkinstalldirs. Remove test for GLUT, it's
	not used anymore.
	* doc/C/gnash.xml: Update copyright year.
	* backend/gnash.cpp: Include config.h. Give default values to
	gofast and goslow.
	* backend/Makefile.am: Don't install compatibility_include.h.
	* libbase/Makefile.am: Remove unused install hook.
	* libgeometry/Makefile.am: Remove unused install hook.
	* server/Makefile.am: Remove unused install hook.
	* config.mk.in: Remove GLUT variable.
	* All GPL'd Files: Update copyright year.
	* macros/firefox.m4: Get the java and plugin flags from
	$mconfig. Don't look for GLUT, it'sm not needed.
	* plugin/Makefile.am: Add include paths for all the Gnash
	directories and libxml2.

2006-01-08  Rob Savoye  <rob@wharfrat.welcomehome.org>

	* configure.ac: Print out an error message if any of the critical
	development packages aren't installed.

	* testsuite/movies.all: New sub directory for whole movies used
	for demos and testing.
	* testsuite/movies.all/ORIGIN: List where all these movies came
	from originally.
	* testsuite/movies.all/elvis.swf: Dancing figures movie. Makes a
	decent performance test.
	
	* testsuite/actionscript.all/movieclip_test.swf,
	moviecliploader_test.swf, text_formatting.swf, text_sizes.swf,
	visible_and_transparency.swf: New test cases.
	* testsuite/actionscript.all/green.jpg,lynch.jpg,offspring.jpg:
	New image files for the MovieClip and MovieClipLoader test cases.

	* testsuite: New directory for DejaGnu test suite.
	* testsuite/config: New directory for DejaGnu config files.
	* testsuite/lib: New directory for DejaGnu library files.
	* testsuite/actionscript.all: New directory for ActionScript test
	cases.

2006-01-07  Rob Savoye  <rob@bertha.welcomehome.org>

	* server/impl.cpp (gnash): Use unsigned int for for loops so we
	don't have problems with comparing integers.

2006-01-07  Rob Savoye  <rob@darkstar.welcomehome.org>

	* plugin/plugin.cpp (eventThread): Add background thread for
	processing flash movies. Merge in OpenGL/SDL support from the
	standalone player. Start a thread for each new stream.

2006-01-06  Rob Savoye  <rob@bertha.welcomehome.org>

	* server/sound_handler_mp3.cpp: Build if libmad exists.
	* configure.ac: Rearrange the final display lines, and the order
	some of the tests are done in. Look for libmad.
	* backend/Makefile.am: Add OpenGL flags so Darwin is happy.
	* libgeometry/Makefile.am:  Add OpenGL flags so Darwin is happy.
	* server/Makefile.am: Add sound_handler_mp3.cpp.

	* macros/opengl.m4: Rewrite completely. Add --with-opengl optins
	for the paths, and also make --disable-opengl work correctly.

	* libgeometry/geometry.h(math): Rename _X, _Y, or _Z because on
	Darwin they conflict with system header definitions.

	* configure.in, config.h.in, all Makefiles.in: Remove generated
	files from CVS. Running autogen.sh will regenerate them.

2006-01-05  Rob Savoye  <rob@bertha.welcomehome.org>

	* server/action.cpp: Cast to void * to print the pointer address.

	* libbase/triangulate.h: Migrate patch from GameSWF.
	* libbase/triangulate_impl.h:  Migrate patch from GameSWF.
	* libbase/triangulate_float.cpp:  Migrate patch from GameSWF.
	* libbase/triangulate_sint32.cpp:  Migrate patch from GameSWF.

2005-12-27  Rob Savoye  <rob@bertha.welcomehome.org>

	* doc/C/gnash.xml: Add sections on software dependancies,
	configuring, installing, and running Gnash.
	
	* server/Makefile.am: Don't install the libraries in a package
	subdirectory of $libdir.
	* libbase/Makefile.am: Don't install the libraries in a package
	subdirectory of $libdir.
	* libgeometry/Makefile.am: Don't install the libraries in a
	package subdirectory of $libdir.

	* autogen.sh: If any command arguments are supplied, don't run
	automake, as nothing has changed but the configure script. This is
	to reduce clutter in the checkin messages when only a configure
	change has been made.

	* macros/libXML.m4: Don't look for XML libraries in the prefix
	directory.
	* macros/firefox.m4: Don't look for Firefox libraries in the
	prefix directory.

2005-12-26  Rob Savoye  <rob@bertha.welcomehome.org>

	* Makefile.am: Add doc subdirectory to DIST_SUBDIRS so it gets
	included in the tarball, but isn't part of the SUBDIRS, since we
	don't always want to build the docs.

	* macros/libXML.m4: Make the --with-libxml-include and
	--with-libxml-libraries add the library to the path. Test if
	pk-config exists. Use it if it does, but if it doesn't, do a brute
	force check of standard install locations for the XML2 headers and
	library.

	* backend/gnash.cpp: Define gofast and goslow here instead of
	xmlsocket.cpp.
	* server/xmlsocket.cpp: Reference gofast and goslow as externs so
	gnash actually builds with --disable-xml.

2005-12-25  Rob Savoye  <rob@bertha.welcomehome.org>

	* plugin/plugin.cpp: Fix plugin name so it's recognized correctly
	to play flash movies looking for the proprietary Flash
	player. Instead of rendering the flash movie, copy the byte stream
	to /tmp instead so we can collect more test cases.

	* configure.ac: Fix the --disable-xml option so it actually
	works.

2005-12-21  Rob Savoye  <rob@bertha.welcomehome.org>

	* macros/firefox.m4: Move enable test to here. If firefox-config
	doesn't exist, look for mozilla-config. If neither exists, the
	plugin won't be built as the mozilla development headers and
	libraries aren't installed.
	* Makefile.am: Don't try to build the plugin if the mozilla
	development SDK isn't installed.

	* config.h.in: Checkin header file produced by autoheader so Gnash
	builds on machines without the Autotools installed.
	* doc/C/images/car_crash.txt: Add file for alt text so conversion
	to info works correctly.

	* doc/C/gnash.xml: Update legal notices.
	* doc/C/fdl-appendix.xml: Add FDL in DocBook format.

2005-12-20  Rob Savoye  <rob@bertha.welcomehome.org>

	* libbase/Makefile.am, libgeometry/Makefile.am,
	server/Makefile.am: Don't install the headers.
	* plugin/mozilla-sdk/Makefile.am: Install the SDK library.

	* doc/C/gnash.xml: Add more content beyond just the command line
	arguments. Add a screenshot of the car crash test case.
	* configure.ac: Drop the plugin/test directory, it's unused for
	now.

2005-12-11  Rob Savoye  <rob@bertha.welcomehome.org>

	* server/xml.cpp, xml.h: Update copyright notice.
	* server/xmlsocket.cpp, xmlsocket.h: Update copyright notice.

2005-12-10  Rob Savoye  <rob@bertha.welcomehome.org>

	* AUTHORS, README, NEWS: Add content.

